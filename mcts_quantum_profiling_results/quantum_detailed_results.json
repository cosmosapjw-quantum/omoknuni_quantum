[
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -3.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "classical",
    "num_simulations": 1000,
    "wave_size": 3072,
    "total_time_ms": 23.732959998596925,
    "simulations_per_second": 42135.49426869296,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 6.548799991607666,
        "cpu_time_ms": 7.132809005270246,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.5980479717254639,
        "cpu_time_ms": 1.920646995131392,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.130079984664917,
        "cpu_time_ms": 1.450454001314938,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "backup",
        "gpu_time_ms": 5.0503997802734375,
        "cpu_time_ms": 5.472935001307633,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      }
    ],
    "peak_gpu_memory_mb": 2833.96923828125,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 90.9,
    "avg_ram_usage_mb": 1161.97265625,
    "final_tree_nodes": 9,
    "final_tree_edges": 8,
    "tree_memory_mb": 50.92288589477539,
    "efficiency_score": 15224.846320953468,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 0,
    "total_kernel_calls": 5,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         9224 function calls (6981 primitive calls) in 0.022 seconds\n\n   Ordered by: cumulative time\n   List reduced from 170 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.021    0.021 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:214(search)\n        1    0.000    0.000    0.018    0.018 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:296(_run_search_wave_vectorized)\n        4    0.000    0.000    0.018    0.004 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:394(_profile_phase)\n        1    0.000    0.000    0.008    0.008 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:369(instrumented_select)\n        1    0.003    0.003    0.007    0.007 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:320(_select_batch_vectorized)\n        1    0.000    0.000    0.006    0.006 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:378(instrumented_backup)\n        1    0.004    0.004    0.005    0.005 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:747(_backup_batch_vectorized)\n       14    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:372(instrumented_expand)\n        3    0.002    0.001    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n       13    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n       10    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:375(instrumented_evaluate)\n  2254/14    0.001    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        1    0.002    0.002    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n       13    0.002    0.000    0.002    0.000 {built-in method torch._C._cuda_synchronize}\n       10    0.000    0.000    0.002    0.000 {built-in method builtins.next}\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:845(_extract_policy)\n       10    0.000    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:196(timer)\n        5    0.000    0.000    0.001    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n        5    0.000    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:178(end_timer)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:791(_add_dirichlet_noise_to_root)\n        3    0.001    0.000    0.001    0.000 {built-in method torch.where}\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:699(_evaluate_batch_vectorized)\n        2    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:126(batch_ucb_selection)\n        4    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        1    0.001    0.001    0.001    0.001 {built-in method time.sleep}\n        1    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n      2/1    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n        1    0.001    0.001    0.001    0.001 {built-in method torch._unique2}\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:974(batch_action_to_child)\n       39    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n       31    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n       31    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n       14    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n       31    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n        2    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n       10    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n        5    0.000    0.000    0.000    0.000 /usr/lib/python3.12/contextlib.py:132(__enter__)\n      6/4    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n        1    0.000    0.000    0.000    0.000 {method 'to' of 'torch._C.TensorBase' objects}\n        4    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n        5    0.000    0.000    0.000    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:169(start_timer)\n       10    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1056(current_stream)\n        2    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n        2    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 747,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.003501323,
        "cumulative_time": 0.0048579090000000005,
        "time_percent": 3.8285417634032566,
        "time_per_call": 0.0048579090000000005
      },
      {
        "rank": 2,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 320,
        "function_name": "_select_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00299978,
        "cumulative_time": 0.006821019,
        "time_percent": 5.375678323835855,
        "time_per_call": 0.006821019
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.001906333,
        "cumulative_time": 0.001940415,
        "time_percent": 1.5292505203028977,
        "time_per_call": 0.000646805
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0016897050000000001,
        "cumulative_time": 0.0017244500000000002,
        "time_percent": 1.3590474510536827,
        "time_per_call": 0.0017244500000000002
      },
      {
        "rank": 5,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.0016480470000000001,
        "cumulative_time": 0.0016480470000000001,
        "time_percent": 1.2988338743174166,
        "time_per_call": 0.00012677284615384617
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 14,
        "primitive_calls": 2254,
        "total_time": 0.001313188,
        "cumulative_time": 0.001747705,
        "time_percent": 1.377374829913176,
        "time_per_call": 0.00012483607142857144
      },
      {
        "rank": 7,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0010621880000000002,
        "cumulative_time": 0.0010621880000000002,
        "time_percent": 0.8371155405722459,
        "time_per_call": 0.00035406266666666674
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 699,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0008032720000000001,
        "cumulative_time": 0.000889421,
        "time_percent": 0.7009570256972469,
        "time_per_call": 0.000889421
      },
      {
        "rank": 9,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0007773750000000001,
        "cumulative_time": 0.0007773750000000001,
        "time_percent": 0.6126530269145853,
        "time_per_call": 0.00038868750000000004
      },
      {
        "rank": 10,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000632033,
        "cumulative_time": 0.0006450420000000001,
        "time_percent": 0.5083607445403286,
        "time_per_call": 0.0006450420000000001
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0005936580000000001,
        "cumulative_time": 0.0005936580000000001,
        "time_percent": 0.4678647636624009,
        "time_per_call": 0.0005936580000000001
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 974,
        "function_name": "batch_action_to_child",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000515685,
        "cumulative_time": 0.00056768,
        "time_percent": 0.4473913752292931,
        "time_per_call": 0.00056768
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.000296875,
        "cumulative_time": 0.0025358660000000003,
        "time_percent": 1.9985283560055083,
        "time_per_call": 0.00018113328571428574
      },
      {
        "rank": 14,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'to' of 'torch._C.TensorBase' objects>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000263771,
        "cumulative_time": 0.000263771,
        "time_percent": 0.20787921088572062,
        "time_per_call": 0.000263771
      },
      {
        "rank": 15,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 2516,
        "primitive_calls": 2516,
        "total_time": 0.000199234,
        "cumulative_time": 0.000199234,
        "time_percent": 0.15701728659179995,
        "time_per_call": 7.918680445151034e-08
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.00019252800000000002,
        "cumulative_time": 0.00019252800000000002,
        "time_percent": 0.15173225530253903,
        "time_per_call": 1.3752000000000001e-05
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.00017775400000000002,
        "cumulative_time": 0.00017775400000000002,
        "time_percent": 0.14008879388477274,
        "time_per_call": 1.2696714285714288e-05
      },
      {
        "rank": 18,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 791,
        "function_name": "_add_dirichlet_noise_to_root",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000171838,
        "cumulative_time": 0.001248425,
        "time_percent": 0.9838898281084949,
        "time_per_call": 0.001248425
      },
      {
        "rank": 19,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 214,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00016604,
        "cumulative_time": 0.020817739000000002,
        "time_percent": 16.406561584650667,
        "time_per_call": 0.020817739000000002
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 1719,
        "primitive_calls": 1719,
        "total_time": 0.00015843400000000002,
        "cumulative_time": 0.00015843400000000002,
        "time_percent": 0.12486260770694377,
        "time_per_call": 9.216637579988367e-08
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.000154857,
        "cumulative_time": 0.000154857,
        "time_percent": 0.12204355657039644,
        "time_per_call": 2.58095e-05
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000135787,
        "cumulative_time": 0.000240699,
        "time_percent": 0.1896960552182843,
        "time_per_call": 0.0001203495
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.00012697200000000002,
        "cumulative_time": 0.00012697200000000002,
        "time_percent": 0.10006725214137158,
        "time_per_call": 1.8138857142857144e-05
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1100,
        "function_name": "remove_virtual_loss",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00010327700000000001,
        "cumulative_time": 0.000128684,
        "time_percent": 0.10141648768673611,
        "time_per_call": 0.000128684
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 126,
        "function_name": "batch_ucb_selection",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00010081300000000001,
        "cumulative_time": 0.0007433940000000001,
        "time_percent": 0.5858724351698231,
        "time_per_call": 0.0007433940000000001
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 9.5909e-05,
        "cumulative_time": 0.017825166,
        "time_percent": 14.04810021566805,
        "time_per_call": 0.0044562915
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 9.370400000000001e-05,
        "cumulative_time": 9.370400000000001e-05,
        "time_percent": 0.07384857917221972,
        "time_per_call": 1.3386285714285715e-05
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 8.8016e-05,
        "cumulative_time": 8.8016e-05,
        "time_percent": 0.06936583864533094,
        "time_per_call": 1.76032e-05
      },
      {
        "rank": 29,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 845,
        "function_name": "_extract_policy",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 8.690400000000001e-05,
        "cumulative_time": 0.0015621830000000002,
        "time_percent": 1.2311640373622867,
        "time_per_call": 0.0015621830000000002
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 7.427200000000001e-05,
        "cumulative_time": 7.427200000000001e-05,
        "time_percent": 0.05853412524843234,
        "time_per_call": 3.7136000000000005e-05
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 564,
        "primitive_calls": 564,
        "total_time": 7.024200000000001e-05,
        "cumulative_time": 0.000149679,
        "time_percent": 0.11796274952956837,
        "time_per_call": 2.653882978723404e-07
      },
      {
        "rank": 32,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1095,
        "function_name": "apply_virtual_loss",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 6.5994e-05,
        "cumulative_time": 6.5994e-05,
        "time_percent": 0.052010193096254896,
        "time_per_call": 6.5994e-05
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x71c7179d2700>",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 6.0078e-05,
        "cumulative_time": 6.0078e-05,
        "time_percent": 0.04734776465795074,
        "time_per_call": 6.0078e-06
      },
      {
        "rank": 34,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 39,
        "primitive_calls": 39,
        "total_time": 5.9010000000000006e-05,
        "cumulative_time": 0.000453652,
        "time_percent": 0.35752535258511714,
        "time_per_call": 1.1632102564102564e-05
      },
      {
        "rank": 35,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py",
        "line_number": 179,
        "function_name": "record",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 5.7108e-05,
        "cumulative_time": 0.000290382,
        "time_percent": 0.22885146970446837,
        "time_per_call": 2.90382e-05
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 547,
        "primitive_calls": 547,
        "total_time": 5.66e-05,
        "cumulative_time": 5.66e-05,
        "time_percent": 0.044606735903991675,
        "time_per_call": 1.0347349177330896e-07
      },
      {
        "rank": 37,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 4.9940000000000006e-05,
        "cumulative_time": 7.9465e-05,
        "time_percent": 0.06262675386237983,
        "time_per_call": 2.5633870967741937e-06
      },
      {
        "rank": 38,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 450,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 4.8968e-05,
        "cumulative_time": 4.8968e-05,
        "time_percent": 0.03859191950082446,
        "time_per_call": 4.8968e-05
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 4.5879000000000006e-05,
        "cumulative_time": 4.5879000000000006e-05,
        "time_percent": 0.03615746354309601,
        "time_per_call": 2.2939500000000003e-05
      },
      {
        "rank": 40,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 4.3480000000000004e-05,
        "cumulative_time": 7.9437e-05,
        "time_percent": 0.06260468692589023,
        "time_per_call": 4.672764705882353e-06
      },
      {
        "rank": 41,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 4.2372e-05,
        "cumulative_time": 0.0019154570000000002,
        "time_percent": 1.5095809988419113,
        "time_per_call": 0.00019154570000000002
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 4.2146e-05,
        "cumulative_time": 4.2146e-05,
        "time_percent": 0.03321546804610659,
        "time_per_call": 1.4048666666666666e-05
      },
      {
        "rank": 43,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 4.1141000000000005e-05,
        "cumulative_time": 0.001922899,
        "time_percent": 1.515446075318899,
        "time_per_call": 0.0001479153076923077
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 4.1025e-05,
        "cumulative_time": 4.1025e-05,
        "time_percent": 0.03233200248164768,
        "time_per_call": 8.205e-06
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method __new__ of type object at 0xa43b40>",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 3.6856e-05,
        "cumulative_time": 3.6856e-05,
        "time_percent": 0.029046393259320093,
        "time_per_call": 1.365037037037037e-06
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 3.4206000000000004e-05,
        "cumulative_time": 3.4206000000000004e-05,
        "time_percent": 0.026957915341553697,
        "time_per_call": 1.1402000000000002e-05
      },
      {
        "rank": 47,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 812,
        "function_name": "_get_device_index",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 3.3111e-05,
        "cumulative_time": 0.000374246,
        "time_percent": 0.29494509691034043,
        "time_per_call": 1.2072451612903226e-05
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 3.3083e-05,
        "cumulative_time": 3.3083e-05,
        "time_percent": 0.02607287356734552,
        "time_per_call": 3.3083e-05
      },
      {
        "rank": 49,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 770,
        "function_name": "_get_device_attr",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 3.2806000000000004e-05,
        "cumulative_time": 0.00030994400000000004,
        "time_percent": 0.24426837726195752,
        "time_per_call": 9.998193548387098e-06
      },
      {
        "rank": 50,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1056,
        "function_name": "current_stream",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 3.2391e-05,
        "cumulative_time": 0.000248427,
        "time_percent": 0.1957865296894159,
        "time_per_call": 2.4842700000000002e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": true,
      "quantum_config": "QuantumConfig(quantum_level='tree_level', min_wave_size=3072, optimal_wave_size=3072, hbar_eff=0.1, temperature=1.0, coupling_strength=0.1, decoherence_rate=0.01, measurement_noise=0.0, path_integral_steps=10, path_integral_beta=1.0, use_wick_rotation=True, interference_alpha=0.05, interference_method='minhash', minhash_size=64, phase_kick_strength=0.1, use_mixed_precision=True, cache_corrections=True, fast_mode=True, enable_quantum=True, uncertainty_decay=0.99, phase_temperature=1.0, device='cuda')",
      "enable_virtual_loss": true,
      "virtual_loss_value": -3.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "tree_level",
    "num_simulations": 1000,
    "wave_size": 3072,
    "total_time_ms": 26.352164000854827,
    "simulations_per_second": 37947.54768403693,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 9.76854419708252,
        "cpu_time_ms": 10.061401000712067,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.0702719688415527,
        "cpu_time_ms": 1.3783160029561259,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.3584959506988525,
        "cpu_time_ms": 1.6888620011741295,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.707327842712402,
        "cpu_time_ms": 5.093490006402135,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      }
    ],
    "peak_gpu_memory_mb": 2840.4775390625,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 90.8,
    "avg_ram_usage_mb": 1218.03515625,
    "final_tree_nodes": 9,
    "final_tree_edges": 8,
    "tree_memory_mb": 50.92288589477539,
    "efficiency_score": 13680.195774855167,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Consider using classical selection for hot paths",
      "Tree-level quantum may be excessive - consider one-loop for balance",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 8,
    "total_kernel_calls": 16,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         10949 function calls (8212 primitive calls) in 0.025 seconds\n\n   Ordered by: cumulative time\n   List reduced from 175 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.024    0.024 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:214(search)\n        1    0.000    0.000    0.022    0.022 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:845(_extract_policy)\n        4    0.000    0.000    0.015    0.004 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:394(_profile_phase)\n        1    0.000    0.000    0.011    0.011 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:369(instrumented_select)\n        2    0.002    0.001    0.008    0.004 {built-in method time.sleep}\n        1    0.003    0.003    0.004    0.004 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:747(_backup_batch_vectorized)\n       17    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       11    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        1    0.002    0.002    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n  2737/17    0.002    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:375(instrumented_evaluate)\n       13    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        4    0.002    0.000    0.002    0.000 {built-in method torch.where}\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:372(instrumented_expand)\n       13    0.002    0.000    0.002    0.000 {built-in method torch._C._cuda_synchronize}\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:915(_get_quantum_phases)\n        3    0.001    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n       10    0.000    0.000    0.001    0.000 {built-in method builtins.next}\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:320(_select_batch_vectorized)\n       10    0.000    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:196(timer)\n        5    0.000    0.000    0.001    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:791(_add_dirichlet_noise_to_root)\n        5    0.000    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:178(end_timer)\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:699(_evaluate_batch_vectorized)\n        3    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:450(_expand_batch_vectorized)\n        3    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:812(bcat)\n        6    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:126(batch_ucb_selection)\n        2    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:974(batch_action_to_child)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n      2/1    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n        1    0.001    0.001    0.001    0.001 {built-in method torch._unique2}\n       43    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n        3    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:795(cat)\n        9    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:765(open_binary)\n        9    0.000    0.000    0.000    0.000 {built-in method _io.open}\n        3    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n       31    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n        1    0.000    0.000    0.000    0.000 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:296(_run_search_wave_vectorized)\n       17    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n        1    0.000    0.000    0.000    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:378(instrumented_backup)\n       31    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n       31    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n       10    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n        3    0.000    0.000    0.000    0.000 {method 'to' of 'torch._C.TensorBase' objects}\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 747,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00297927,
        "cumulative_time": 0.004348346,
        "time_percent": 3.2518800941148442,
        "time_per_call": 0.004348346
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0023498530000000003,
        "cumulative_time": 0.008180588,
        "time_percent": 6.117795427354394,
        "time_per_call": 0.004090294
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.002075266,
        "cumulative_time": 0.002116593,
        "time_percent": 1.582879247429441,
        "time_per_call": 0.002116593
      },
      {
        "rank": 4,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00177595,
        "cumulative_time": 0.00177595,
        "time_percent": 1.328131766226344,
        "time_per_call": 0.0004439875
      },
      {
        "rank": 5,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.0015596730000000001,
        "cumulative_time": 0.0015596730000000001,
        "time_percent": 1.1663905268873227,
        "time_per_call": 0.00011997484615384617
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 17,
        "primitive_calls": 2737,
        "total_time": 0.001538723,
        "cumulative_time": 0.002087722,
        "time_percent": 1.5612882723328896,
        "time_per_call": 0.00012280717647058826
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.001436324,
        "cumulative_time": 0.001466946,
        "time_percent": 1.0970452895287988,
        "time_per_call": 0.000488982
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 699,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.001116975,
        "cumulative_time": 0.001149555,
        "time_percent": 0.859686653635702,
        "time_per_call": 0.001149555
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 450,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.001036475,
        "cumulative_time": 0.001048833,
        "time_percent": 0.7843624115355022,
        "time_per_call": 0.001048833
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 915,
        "function_name": "_get_quantum_phases",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0008310040000000001,
        "cumulative_time": 0.00148999,
        "time_percent": 1.1142785834959263,
        "time_per_call": 0.00148999
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0008022130000000001,
        "cumulative_time": 0.0008022130000000001,
        "time_percent": 0.5999293722119058,
        "time_per_call": 0.00040110650000000004
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000571196,
        "cumulative_time": 0.000571196,
        "time_percent": 0.42716492713275866,
        "time_per_call": 0.000571196
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 974,
        "function_name": "batch_action_to_child",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0005663080000000001,
        "cumulative_time": 0.0006133940000000001,
        "time_percent": 0.45872240581809287,
        "time_per_call": 0.0006133940000000001
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 320,
        "function_name": "_select_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000565093,
        "cumulative_time": 0.001367748,
        "time_percent": 1.0228607601523407,
        "time_per_call": 0.001367748
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 214,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000493811,
        "cumulative_time": 0.023560396,
        "time_percent": 17.619477098157095,
        "time_per_call": 0.023560396
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.000382444,
        "cumulative_time": 0.00038932,
        "time_percent": 0.2911502346503225,
        "time_per_call": 4.325777777777778e-05
      },
      {
        "rank": 17,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.00029323500000000003,
        "cumulative_time": 0.0029436230000000002,
        "time_percent": 2.201367839237867,
        "time_per_call": 0.00017315429411764708
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'to' of 'torch._C.TensorBase' objects>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.000255584,
        "cumulative_time": 0.000255584,
        "time_percent": 0.19113670392702153,
        "time_per_call": 8.519466666666667e-05
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 2086,
        "primitive_calls": 2086,
        "total_time": 0.00024811900000000004,
        "cumulative_time": 0.00024811900000000004,
        "time_percent": 0.1855540559724735,
        "time_per_call": 1.1894487056567596e-07
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 3003,
        "primitive_calls": 3003,
        "total_time": 0.000222367,
        "cumulative_time": 0.000222367,
        "time_percent": 0.1662956031760204,
        "time_per_call": 7.404828504828505e-08
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.000218569,
        "cumulative_time": 0.000218569,
        "time_percent": 0.1634552954826013,
        "time_per_call": 1.2857e-05
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.00021026,
        "cumulative_time": 0.00021026,
        "time_percent": 0.15724146804062678,
        "time_per_call": 1.2368235294117648e-05
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.000171432,
        "cumulative_time": 0.00025402300000000003,
        "time_percent": 0.18996932101248043,
        "time_per_call": 8.467433333333334e-05
      },
      {
        "rank": 24,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.00017016200000000002,
        "cumulative_time": 0.000170478,
        "time_percent": 0.12749077803020056,
        "time_per_call": 5.6826e-05
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 791,
        "function_name": "_add_dirichlet_noise_to_root",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000155625,
        "cumulative_time": 0.001209266,
        "time_percent": 0.9043411066851353,
        "time_per_call": 0.001209266
      },
      {
        "rank": 26,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.00011507600000000001,
        "cumulative_time": 0.00011507600000000001,
        "time_percent": 0.08605878044441723,
        "time_per_call": 1.6439428571428572e-05
      },
      {
        "rank": 27,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 845,
        "function_name": "_extract_policy",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00010127700000000001,
        "cumulative_time": 0.021855635,
        "time_percent": 16.344583526871986,
        "time_per_call": 0.021855635
      },
      {
        "rank": 28,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1100,
        "function_name": "remove_virtual_loss",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000100574,
        "cumulative_time": 0.000124339,
        "time_percent": 0.09298605010322215,
        "time_per_call": 0.000124339
      },
      {
        "rank": 29,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 126,
        "function_name": "batch_ucb_selection",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 9.233e-05,
        "cumulative_time": 0.0008255830000000001,
        "time_percent": 0.6174064629952667,
        "time_per_call": 0.0008255830000000001
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 8.8998e-05,
        "cumulative_time": 8.8998e-05,
        "time_percent": 0.06655653083173071,
        "time_per_call": 2.9666e-05
      },
      {
        "rank": 31,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 7.0208e-05,
        "cumulative_time": 0.014792527000000001,
        "time_percent": 11.062487689102104,
        "time_per_call": 0.0036981317500000004
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 664,
        "primitive_calls": 664,
        "total_time": 6.5895e-05,
        "cumulative_time": 6.5895e-05,
        "time_percent": 0.04927911412792305,
        "time_per_call": 9.923945783132531e-08
      },
      {
        "rank": 33,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1095,
        "function_name": "apply_virtual_loss",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 6.280700000000001e-05,
        "cumulative_time": 6.280700000000001e-05,
        "time_percent": 0.04696977496065655,
        "time_per_call": 6.280700000000001e-05
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'readline' of '_io.BufferedReader' objects>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 6.1046e-05,
        "cumulative_time": 6.1046e-05,
        "time_percent": 0.04565282344719918,
        "time_per_call": 2.0348666666666667e-05
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 6.0928000000000003e-05,
        "cumulative_time": 6.0928000000000003e-05,
        "time_percent": 0.045564577973838616,
        "time_per_call": 7.6160000000000004e-06
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 680,
        "primitive_calls": 680,
        "total_time": 6.0658e-05,
        "cumulative_time": 0.000136266,
        "time_percent": 0.1019055734995912,
        "time_per_call": 2.0039117647058825e-07
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 6.0165000000000004e-05,
        "cumulative_time": 6.0165000000000004e-05,
        "time_percent": 0.044993973768973225,
        "time_per_call": 6.016500000000001e-06
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x71c7179d2700>",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 5.8710000000000005e-05,
        "cumulative_time": 5.8710000000000005e-05,
        "time_percent": 0.04390586221185769,
        "time_per_call": 5.871e-06
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 43,
        "primitive_calls": 43,
        "total_time": 5.4296e-05,
        "cumulative_time": 0.00043521900000000004,
        "time_percent": 0.32547548025860146,
        "time_per_call": 1.0121372093023257e-05
      },
      {
        "rank": 40,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 4.6006e-05,
        "cumulative_time": 7.606500000000001e-05,
        "time_percent": 0.056884677382813074,
        "time_per_call": 2.453709677419355e-06
      },
      {
        "rank": 41,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 4.4594e-05,
        "cumulative_time": 0.002133683,
        "time_percent": 1.5956598842068324,
        "time_per_call": 0.00019397118181818182
      },
      {
        "rank": 42,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 196,
        "function_name": "timer",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 4.4295e-05,
        "cumulative_time": 0.001360117,
        "time_percent": 1.0171539702606922,
        "time_per_call": 0.0001360117
      },
      {
        "rank": 43,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 4.2954e-05,
        "cumulative_time": 0.00184865,
        "time_percent": 1.3824999519323917,
        "time_per_call": 0.00014220384615384616
      },
      {
        "rank": 44,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 4.1569e-05,
        "cumulative_time": 7.5608e-05,
        "time_percent": 0.05654291313428949,
        "time_per_call": 4.7255e-06
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 4.1505e-05,
        "cumulative_time": 4.1505e-05,
        "time_percent": 0.03103922349008948,
        "time_per_call": 1.3835e-05
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'split' of 'bytes' objects>",
        "total_calls": 166,
        "primitive_calls": 166,
        "total_time": 4.074e-05,
        "cumulative_time": 4.074e-05,
        "time_percent": 0.030467123599234914,
        "time_per_call": 2.4542168674698794e-07
      },
      {
        "rank": 47,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 4.0582000000000005e-05,
        "cumulative_time": 0.00038078300000000004,
        "time_percent": 0.28476589900558347,
        "time_per_call": 0.00012692766666666668
      },
      {
        "rank": 48,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 812,
        "function_name": "bcat",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 4.0227e-05,
        "cumulative_time": 0.001039246,
        "time_percent": 0.7771928407464529,
        "time_per_call": 0.0003464153333333333
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 3.9676000000000004e-05,
        "cumulative_time": 3.9676000000000004e-05,
        "time_percent": 0.029671418653000606,
        "time_per_call": 1.3225333333333335e-05
      },
      {
        "rank": 50,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 770,
        "function_name": "_get_device_attr",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 3.7625e-05,
        "cumulative_time": 0.000298287,
        "time_percent": 0.2230718433246192,
        "time_per_call": 9.622161290322581e-06
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": true,
      "quantum_config": "QuantumConfig(quantum_level='one_loop', min_wave_size=3072, optimal_wave_size=3072, hbar_eff=0.1, temperature=1.0, coupling_strength=0.1, decoherence_rate=0.01, measurement_noise=0.0, path_integral_steps=10, path_integral_beta=1.0, use_wick_rotation=True, interference_alpha=0.05, interference_method='minhash', minhash_size=64, phase_kick_strength=0.1, use_mixed_precision=True, cache_corrections=True, fast_mode=True, enable_quantum=True, uncertainty_decay=0.99, phase_temperature=1.0, device='cuda')",
      "enable_virtual_loss": true,
      "virtual_loss_value": -3.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "one_loop",
    "num_simulations": 1000,
    "wave_size": 3072,
    "total_time_ms": 27.253713000391144,
    "simulations_per_second": 36692.2481346174,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 10.220255851745605,
        "cpu_time_ms": 10.536012996453792,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.147968053817749,
        "cpu_time_ms": 1.4611099977628328,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.3580479621887207,
        "cpu_time_ms": 1.6719529958209023,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "backup",
        "gpu_time_ms": 5.488863945007324,
        "cpu_time_ms": 5.735644001106266,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      }
    ],
    "peak_gpu_memory_mb": 2839.9248046875,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 91.8,
    "avg_ram_usage_mb": 1218.22265625,
    "final_tree_nodes": 9,
    "final_tree_edges": 8,
    "tree_memory_mb": 50.92288589477539,
    "efficiency_score": 13230.2313173333,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Consider using classical selection for hot paths",
      "One-loop quantum is a good balance - monitor overhead",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 13,
    "total_kernel_calls": 21,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         10954 function calls (8230 primitive calls) in 0.026 seconds\n\n   Ordered by: cumulative time\n   List reduced from 175 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.024    0.024 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:214(search)\n        1    0.000    0.000    0.021    0.021 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:296(_run_search_wave_vectorized)\n        4    0.000    0.000    0.021    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:394(_profile_phase)\n        1    0.000    0.000    0.011    0.011 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:369(instrumented_select)\n        2    0.002    0.001    0.008    0.004 {built-in method time.sleep}\n        1    0.000    0.000    0.006    0.006 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:378(instrumented_backup)\n        3    0.003    0.001    0.005    0.002 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n       17    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        3    0.002    0.001    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n        1    0.002    0.002    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:375(instrumented_evaluate)\n  2737/17    0.002    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       11    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       13    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:372(instrumented_expand)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:845(_extract_policy)\n       13    0.002    0.000    0.002    0.000 {built-in method torch._C._cuda_synchronize}\n        1    0.001    0.001    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:915(_get_quantum_phases)\n       10    0.000    0.000    0.002    0.000 {built-in method builtins.next}\n       10    0.000    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:196(timer)\n        4    0.001    0.000    0.001    0.000 {built-in method torch.where}\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:320(_select_batch_vectorized)\n        5    0.000    0.000    0.001    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:791(_add_dirichlet_noise_to_root)\n        5    0.000    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:178(end_timer)\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:699(_evaluate_batch_vectorized)\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:450(_expand_batch_vectorized)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:126(batch_ucb_selection)\n        6    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        2    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:974(batch_action_to_child)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n      2/1    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n        1    0.001    0.001    0.001    0.001 {built-in method torch._unique2}\n        3    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n      9/6    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n       43    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n        6    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n       31    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n       10    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n        3    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n       17    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n       31    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n        3    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n       31    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n        5    0.000    0.000    0.000    0.000 /usr/lib/python3.12/contextlib.py:132(__enter__)\n        3    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.003087157,
        "cumulative_time": 0.0046660650000000005,
        "time_percent": 3.126660910769161,
        "time_per_call": 0.0015553550000000002
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0021583600000000002,
        "cumulative_time": 0.008443329000000001,
        "time_percent": 5.657749461497788,
        "time_per_call": 0.004221664500000001
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.002112895,
        "cumulative_time": 0.002145129,
        "time_percent": 1.4374191085759285,
        "time_per_call": 0.000715043
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0020608410000000003,
        "cumulative_time": 0.002094451,
        "time_percent": 1.403460532851853,
        "time_per_call": 0.002094451
      },
      {
        "rank": 5,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.001695188,
        "cumulative_time": 0.001695188,
        "time_percent": 1.1359203217282556,
        "time_per_call": 0.0001303990769230769
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 17,
        "primitive_calls": 2737,
        "total_time": 0.0015991450000000002,
        "cumulative_time": 0.002089404,
        "time_percent": 1.4000786130507674,
        "time_per_call": 0.00012290611764705883
      },
      {
        "rank": 7,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.001465715,
        "cumulative_time": 0.0014778550000000001,
        "time_percent": 0.9902887037117484,
        "time_per_call": 0.00036946375000000004
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 320,
        "function_name": "_select_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.001344776,
        "cumulative_time": 0.001362555,
        "time_percent": 0.9130278847965202,
        "time_per_call": 0.001362555
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 699,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.001053097,
        "cumulative_time": 0.0010860540000000001,
        "time_percent": 0.7277486680499503,
        "time_per_call": 0.0010860540000000001
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 450,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0010478240000000002,
        "cumulative_time": 0.0010599350000000001,
        "time_percent": 0.710246713763334,
        "time_per_call": 0.0010599350000000001
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0008885690000000001,
        "cumulative_time": 0.0008885690000000001,
        "time_percent": 0.5954169002834815,
        "time_per_call": 0.00044428450000000004
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 915,
        "function_name": "_get_quantum_phases",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000880496,
        "cumulative_time": 0.001607048,
        "time_percent": 1.0768590157509077,
        "time_per_call": 0.001607048
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 974,
        "function_name": "batch_action_to_child",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0006550890000000001,
        "cumulative_time": 0.0007192110000000001,
        "time_percent": 0.48193261780433827,
        "time_per_call": 0.0007192110000000001
      },
      {
        "rank": 14,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000538575,
        "cumulative_time": 0.000538575,
        "time_percent": 0.3608911148939205,
        "time_per_call": 0.000538575
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.00029073900000000004,
        "cumulative_time": 0.002919629,
        "time_percent": 1.9564000647757918,
        "time_per_call": 0.00017174288235294118
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'to' of 'torch._C.TensorBase' objects>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.000252805,
        "cumulative_time": 0.000252805,
        "time_percent": 0.16940087880194507,
        "time_per_call": 8.426833333333333e-05
      },
      {
        "rank": 17,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 214,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00022594300000000002,
        "cumulative_time": 0.024388909,
        "time_percent": 16.342645982558366,
        "time_per_call": 0.024388909
      },
      {
        "rank": 18,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.000223663,
        "cumulative_time": 0.000343142,
        "time_percent": 0.22993436187518854,
        "time_per_call": 0.00011438066666666667
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 3003,
        "primitive_calls": 3003,
        "total_time": 0.00022225,
        "cumulative_time": 0.00022225,
        "time_percent": 0.14892642674682974,
        "time_per_call": 7.400932400932401e-08
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.00021300100000000002,
        "cumulative_time": 0.00021300100000000002,
        "time_percent": 0.1427288091046186,
        "time_per_call": 1.2529470588235295e-05
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.00020386500000000001,
        "cumulative_time": 0.00020386500000000001,
        "time_percent": 0.13660691108545533,
        "time_per_call": 1.1992058823529413e-05
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 2086,
        "primitive_calls": 2086,
        "total_time": 0.00018916900000000002,
        "cumulative_time": 0.00018916900000000002,
        "time_percent": 0.1267593395782724,
        "time_per_call": 9.068504314477469e-08
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 791,
        "function_name": "_add_dirichlet_noise_to_root",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00016121400000000002,
        "cumulative_time": 0.001255471,
        "time_percent": 0.8412724855535167,
        "time_per_call": 0.001255471
      },
      {
        "rank": 24,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.000144188,
        "cumulative_time": 0.000144188,
        "time_percent": 0.09661823900909736,
        "time_per_call": 1.602088888888889e-05
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 747,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00013351000000000001,
        "cumulative_time": 0.00013351000000000001,
        "time_percent": 0.08946306967365238,
        "time_per_call": 0.00013351000000000001
      },
      {
        "rank": 26,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.00011832800000000001,
        "cumulative_time": 0.00011832800000000001,
        "time_percent": 0.07928983677884757,
        "time_per_call": 3.944266666666667e-05
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x71c7179d2700>",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 0.000101018,
        "cumulative_time": 0.000101018,
        "time_percent": 0.06769066266416758,
        "time_per_call": 1.01018e-05
      },
      {
        "rank": 28,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1100,
        "function_name": "remove_virtual_loss",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 9.8584e-05,
        "cumulative_time": 0.000121984,
        "time_percent": 0.08173966812276841,
        "time_per_call": 0.000121984
      },
      {
        "rank": 29,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 9.654200000000001e-05,
        "cumulative_time": 0.021173497000000003,
        "time_percent": 14.188046118986364,
        "time_per_call": 0.005293374250000001
      },
      {
        "rank": 30,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 126,
        "function_name": "batch_ucb_selection",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 9.301200000000001e-05,
        "cumulative_time": 0.001001046,
        "time_percent": 0.6707860687928321,
        "time_per_call": 0.001001046
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 8.8115e-05,
        "cumulative_time": 8.8115e-05,
        "time_percent": 0.05904455384835502,
        "time_per_call": 1.2587857142857144e-05
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 8.7355e-05,
        "cumulative_time": 8.7355e-05,
        "time_percent": 0.05853528912697104,
        "time_per_call": 2.9118333333333335e-05
      },
      {
        "rank": 33,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 845,
        "function_name": "_extract_policy",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 7.6746e-05,
        "cumulative_time": 0.0017191670000000002,
        "time_percent": 1.15198829377308,
        "time_per_call": 0.0017191670000000002
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 664,
        "primitive_calls": 664,
        "total_time": 6.528500000000001e-05,
        "cumulative_time": 6.528500000000001e-05,
        "time_percent": 0.043746509652044005,
        "time_per_call": 9.832078313253014e-08
      },
      {
        "rank": 35,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1095,
        "function_name": "apply_virtual_loss",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 6.3827e-05,
        "cumulative_time": 6.3827e-05,
        "time_percent": 0.04276952548917841,
        "time_per_call": 6.3827e-05
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 680,
        "primitive_calls": 680,
        "total_time": 6.0896e-05,
        "cumulative_time": 0.000136241,
        "time_percent": 0.09129307224483613,
        "time_per_call": 2.0035441176470588e-07
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 6.0542000000000004e-05,
        "cumulative_time": 6.0542000000000004e-05,
        "time_percent": 0.04056829573951211,
        "time_per_call": 6.0542e-06
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 5.9276000000000006e-05,
        "cumulative_time": 5.9276000000000006e-05,
        "time_percent": 0.039719967927311944,
        "time_per_call": 7.409500000000001e-06
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 43,
        "primitive_calls": 43,
        "total_time": 5.4804000000000006e-05,
        "cumulative_time": 0.000435659,
        "time_percent": 0.29192863059661234,
        "time_per_call": 1.0131604651162791e-05
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'split' of 'bytes' objects>",
        "total_calls": 166,
        "primitive_calls": 166,
        "total_time": 4.8997000000000005e-05,
        "cumulative_time": 4.8997000000000005e-05,
        "time_percent": 0.03283216257059356,
        "time_per_call": 2.9516265060240966e-07
      },
      {
        "rank": 41,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 4.8353e-05,
        "cumulative_time": 7.8105e-05,
        "time_percent": 0.05233700139960016,
        "time_per_call": 2.519516129032258e-06
      },
      {
        "rank": 42,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 4.5305e-05,
        "cumulative_time": 0.002001496,
        "time_percent": 1.3411727668304736,
        "time_per_call": 0.00018195418181818183
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 4.5117e-05,
        "cumulative_time": 4.5117e-05,
        "time_percent": 0.030232232150896366,
        "time_per_call": 1.5039000000000001e-05
      },
      {
        "rank": 44,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 4.198e-05,
        "cumulative_time": 7.5345e-05,
        "time_percent": 0.050487566358784645,
        "time_per_call": 4.7090625e-06
      },
      {
        "rank": 45,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 4.1066e-05,
        "cumulative_time": 0.001959358,
        "time_percent": 1.3129367183703704,
        "time_per_call": 0.00015071984615384616
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 3.8824e-05,
        "cumulative_time": 3.8824e-05,
        "time_percent": 0.02601538624080503,
        "time_per_call": 1.9412e-05
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 3.6609e-05,
        "cumulative_time": 3.6609e-05,
        "time_percent": 0.0245311476120346,
        "time_per_call": 7.3218e-06
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method __new__ of type object at 0xa43b40>",
        "total_calls": 30,
        "primitive_calls": 30,
        "total_time": 3.6240000000000005e-05,
        "cumulative_time": 3.6240000000000005e-05,
        "time_percent": 0.024283886188099485,
        "time_per_call": 1.2080000000000001e-06
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 3.4016e-05,
        "cumulative_time": 3.4016e-05,
        "time_percent": 0.022793616792891613,
        "time_per_call": 1.1338666666666667e-05
      },
      {
        "rank": 50,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 770,
        "function_name": "_get_device_attr",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 3.1862e-05,
        "cumulative_time": 0.00029982200000000004,
        "time_percent": 0.20090627275630144,
        "time_per_call": 9.67167741935484e-06
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -3.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "classical",
    "num_simulations": 5000,
    "wave_size": 3072,
    "total_time_ms": 44.639697996899486,
    "simulations_per_second": 112007.92622627693,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 6.8276801109313965,
        "cpu_time_ms": 8.100188999378588,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8995199799537659,
        "cpu_time_ms": 1.212522001878824,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0743039846420288,
        "cpu_time_ms": 1.3553969984059222,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.574207782745361,
        "cpu_time_ms": 4.945480002788827,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 10.175264358520508,
        "cpu_time_ms": 10.8251339988783,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.1909760236740112,
        "cpu_time_ms": 1.4833000022917986,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0543040037155151,
        "cpu_time_ms": 1.3193010017857887,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.338687896728516,
        "cpu_time_ms": 4.640439001377672,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      }
    ],
    "peak_gpu_memory_mb": 2828.73095703125,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 92.7,
    "avg_ram_usage_mb": 1218.22265625,
    "final_tree_nodes": 9,
    "final_tree_edges": 8,
    "tree_memory_mb": 50.92288589477539,
    "efficiency_score": 40546.84528078309,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 16,
    "total_kernel_calls": 37,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         18223 function calls (13737 primitive calls) in 0.043 seconds\n\n   Ordered by: cumulative time\n   List reduced from 167 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.001    0.001    0.041    0.041 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:214(search)\n        2    0.000    0.000    0.037    0.019 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:296(_run_search_wave_vectorized)\n        8    0.000    0.000    0.037    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:394(_profile_phase)\n        2    0.000    0.000    0.020    0.010 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:369(instrumented_select)\n        2    0.008    0.004    0.018    0.009 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:320(_select_batch_vectorized)\n        2    0.000    0.000    0.010    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:378(instrumented_backup)\n        2    0.006    0.003    0.009    0.004 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:747(_backup_batch_vectorized)\n       28    0.000    0.000    0.005    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       25    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        2    0.004    0.002    0.004    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n       20    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       18    0.000    0.000    0.004    0.000 {built-in method builtins.next}\n       18    0.000    0.000    0.003    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:196(timer)\n  4508/28    0.003    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        2    0.000    0.000    0.003    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:372(instrumented_expand)\n        2    0.000    0.000    0.003    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:375(instrumented_evaluate)\n        9    0.000    0.000    0.003    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n        9    0.000    0.000    0.003    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:178(end_timer)\n        4    0.003    0.001    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n       25    0.003    0.000    0.003    0.000 {built-in method torch._C._cuda_synchronize}\n        6    0.002    0.000    0.002    0.000 {built-in method torch.where}\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:845(_extract_policy)\n        2    0.000    0.000    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n        2    0.002    0.001    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:699(_evaluate_batch_vectorized)\n        2    0.000    0.000    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:126(batch_ucb_selection)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:791(_add_dirichlet_noise_to_root)\n        2    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:974(batch_action_to_child)\n        8    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        3    0.001    0.000    0.001    0.000 {built-in method time.sleep}\n        2    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n      4/2    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        2    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        2    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n        2    0.001    0.001    0.001    0.001 {built-in method torch._unique2}\n        2    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n        2    0.001    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:450(_expand_batch_vectorized)\n       75    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n       59    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n       28    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n       59    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n       18    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n       59    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n        9    0.000    0.000    0.000    0.000 /usr/lib/python3.12/contextlib.py:132(__enter__)\n        4    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n     5008    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}\n        9    0.000    0.000    0.000    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:169(start_timer)\n       18    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1056(current_stream)\n     12/8    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n        8    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n        1    0.000    0.000    0.000    0.000 {method 'to' of 'torch._C.TensorBase' objects}\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 320,
        "function_name": "_select_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.007777357,
        "cumulative_time": 0.017536758,
        "time_percent": 6.847434748702177,
        "time_per_call": 0.008768379
      },
      {
        "rank": 2,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 747,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0057999620000000005,
        "cumulative_time": 0.008511302,
        "time_percent": 3.3233386166073764,
        "time_per_call": 0.004255651
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0037117340000000004,
        "cumulative_time": 0.003768618,
        "time_percent": 1.4715015083052696,
        "time_per_call": 0.001884309
      },
      {
        "rank": 4,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.0029919530000000003,
        "cumulative_time": 0.0029919530000000003,
        "time_percent": 1.168243465450326,
        "time_per_call": 0.00011967812000000001
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.002969218,
        "cumulative_time": 0.003009486,
        "time_percent": 1.1750894328434436,
        "time_per_call": 0.0007523715
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 28,
        "primitive_calls": 4508,
        "total_time": 0.002557165,
        "cumulative_time": 0.0034557420000000004,
        "time_percent": 1.3493353705028925,
        "time_per_call": 0.00012341935714285716
      },
      {
        "rank": 7,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.002346102,
        "cumulative_time": 0.002346102,
        "time_percent": 0.9160632973779803,
        "time_per_call": 0.000391017
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 699,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0015851390000000002,
        "cumulative_time": 0.001649578,
        "time_percent": 0.6440972566248928,
        "time_per_call": 0.000824789
      },
      {
        "rank": 9,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.001191005,
        "cumulative_time": 0.0012031820000000001,
        "time_percent": 0.4697966543082241,
        "time_per_call": 0.0004010606666666667
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 974,
        "function_name": "batch_action_to_child",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.001174535,
        "cumulative_time": 0.001268032,
        "time_percent": 0.49511810445615545,
        "time_per_call": 0.000634016
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0011681570000000002,
        "cumulative_time": 0.0011681570000000002,
        "time_percent": 0.45612072845731755,
        "time_per_call": 0.0005840785000000001
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00089915,
        "cumulative_time": 0.00089915,
        "time_percent": 0.35108376099479527,
        "time_per_call": 0.000449575
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 450,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000877811,
        "cumulative_time": 0.0008911720000000001,
        "time_percent": 0.34796865645693564,
        "time_per_call": 0.00044558600000000004
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 214,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0008174870000000001,
        "cumulative_time": 0.041472953,
        "time_percent": 16.193605426013875,
        "time_per_call": 0.041472953
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.0004883,
        "cumulative_time": 0.004853397000000001,
        "time_percent": 1.8950663096934397,
        "time_per_call": 0.00017333560714285717
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 5008,
        "primitive_calls": 5008,
        "total_time": 0.000395203,
        "cumulative_time": 0.000395203,
        "time_percent": 0.15431168948053833,
        "time_per_call": 7.891433706070287e-08
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'to' of 'torch._C.TensorBase' objects>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00036021800000000004,
        "cumulative_time": 0.00036021800000000004,
        "time_percent": 0.14065138210312314,
        "time_per_call": 0.00036021800000000004
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.00033917400000000003,
        "cumulative_time": 0.00033917400000000003,
        "time_percent": 0.1324345031992979,
        "time_per_call": 1.2113357142857144e-05
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.000331623,
        "cumulative_time": 0.000331623,
        "time_percent": 0.12948612586595895,
        "time_per_call": 1.1843678571428572e-05
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 3437,
        "primitive_calls": 3437,
        "total_time": 0.00031905700000000003,
        "cumulative_time": 0.00031905700000000003,
        "time_percent": 0.12457958241863581,
        "time_per_call": 9.283008437590923e-08
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1100,
        "function_name": "remove_virtual_loss",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000210845,
        "cumulative_time": 0.000255099,
        "time_percent": 0.09960642422956266,
        "time_per_call": 0.0001275495
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.000190459,
        "cumulative_time": 0.000190459,
        "time_percent": 0.07436697106746115,
        "time_per_call": 3.80918e-05
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 126,
        "function_name": "batch_ucb_selection",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00018155000000000002,
        "cumulative_time": 0.0016405780000000002,
        "time_percent": 0.640583100089328,
        "time_per_call": 0.0008202890000000001
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000175674,
        "cumulative_time": 0.00028477600000000004,
        "time_percent": 0.11119416017466921,
        "time_per_call": 7.119400000000001e-05
      },
      {
        "rank": 25,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.000173928,
        "cumulative_time": 0.000173928,
        "time_percent": 0.06791224643530307,
        "time_per_call": 1.4494e-05
      },
      {
        "rank": 26,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.000173382,
        "cumulative_time": 0.000173382,
        "time_percent": 0.06769905427214545,
        "time_per_call": 1.2384428571428572e-05
      },
      {
        "rank": 27,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 791,
        "function_name": "_add_dirichlet_noise_to_root",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00017130700000000002,
        "cumulative_time": 0.001505063,
        "time_percent": 0.587669664209653,
        "time_per_call": 0.001505063
      },
      {
        "rank": 28,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.000149201,
        "cumulative_time": 0.037300886000000005,
        "time_percent": 14.564572479917818,
        "time_per_call": 0.004662610750000001
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 1093,
        "primitive_calls": 1093,
        "total_time": 0.00014693600000000002,
        "cumulative_time": 0.00014693600000000002,
        "time_percent": 0.057372900523306715,
        "time_per_call": 1.3443366880146388e-07
      },
      {
        "rank": 30,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1095,
        "function_name": "apply_virtual_loss",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00012746800000000002,
        "cumulative_time": 0.00012746800000000002,
        "time_percent": 0.04977138947504261,
        "time_per_call": 6.373400000000001e-05
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 1121,
        "primitive_calls": 1121,
        "total_time": 0.00012263200000000001,
        "cumulative_time": 0.00024687200000000003,
        "time_percent": 0.0963940946942191,
        "time_per_call": 2.202247992863515e-07
      },
      {
        "rank": 32,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 75,
        "primitive_calls": 75,
        "total_time": 0.000113973,
        "cumulative_time": 0.0007964980000000001,
        "time_percent": 0.31100207247381684,
        "time_per_call": 1.0619973333333334e-05
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 9.8985e-05,
        "cumulative_time": 9.8985e-05,
        "time_percent": 0.03864986496365435,
        "time_per_call": 2.474625e-05
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 9.4097e-05,
        "cumulative_time": 9.4097e-05,
        "time_percent": 0.036741287503005336,
        "time_per_call": 9.4097e-06
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x71c7179d2700>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 9.366000000000001e-05,
        "cumulative_time": 9.366000000000001e-05,
        "time_percent": 0.0365706556801118,
        "time_per_call": 5.203333333333334e-06
      },
      {
        "rank": 36,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 8.752900000000001e-05,
        "cumulative_time": 0.004273418,
        "time_percent": 1.6686066437667308,
        "time_per_call": 0.00017093672
      },
      {
        "rank": 37,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 59,
        "primitive_calls": 59,
        "total_time": 8.2787e-05,
        "cumulative_time": 0.00013610300000000002,
        "time_percent": 0.053143027439998464,
        "time_per_call": 2.3068305084745767e-06
      },
      {
        "rank": 38,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 845,
        "function_name": "_extract_policy",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 8.1817e-05,
        "cumulative_time": 0.0018246590000000002,
        "time_percent": 0.7124597055585854,
        "time_per_call": 0.0018246590000000002
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 8.0136e-05,
        "cumulative_time": 8.0136e-05,
        "time_percent": 0.031290049792669646,
        "time_per_call": 1.3356e-05
      },
      {
        "rank": 40,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 20,
        "primitive_calls": 20,
        "total_time": 7.9691e-05,
        "cumulative_time": 0.0037052910000000003,
        "time_percent": 1.4467747315355235,
        "time_per_call": 0.00018526455
      },
      {
        "rank": 41,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py",
        "line_number": 179,
        "function_name": "record",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 7.764000000000001e-05,
        "cumulative_time": 0.000558247,
        "time_percent": 0.2179741492788316,
        "time_per_call": 3.101372222222222e-05
      },
      {
        "rank": 42,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 6.703400000000001e-05,
        "cumulative_time": 0.00012424000000000002,
        "time_percent": 0.04851097866428667,
        "time_per_call": 4.601481481481482e-06
      },
      {
        "rank": 43,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 812,
        "function_name": "_get_device_index",
        "total_calls": 59,
        "primitive_calls": 59,
        "total_time": 6.135e-05,
        "cumulative_time": 0.000645845,
        "time_percent": 0.2521778253013219,
        "time_per_call": 1.0946525423728814e-05
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 5.8627000000000006e-05,
        "cumulative_time": 5.8627000000000006e-05,
        "time_percent": 0.02289160613450688,
        "time_per_call": 9.771166666666667e-06
      },
      {
        "rank": 45,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 770,
        "function_name": "_get_device_attr",
        "total_calls": 59,
        "primitive_calls": 59,
        "total_time": 5.7479e-05,
        "cumulative_time": 0.00052981,
        "time_percent": 0.20687058601195846,
        "time_per_call": 8.979830508474577e-06
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 5.6361000000000005e-05,
        "cumulative_time": 5.6361000000000005e-05,
        "time_percent": 0.0220068196112191,
        "time_per_call": 4.335461538461539e-06
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method __new__ of type object at 0xa43b40>",
        "total_calls": 50,
        "primitive_calls": 50,
        "total_time": 5.6278000000000006e-05,
        "cumulative_time": 5.6278000000000006e-05,
        "time_percent": 0.02197441127872445,
        "time_per_call": 1.12556e-06
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'split' of 'bytes' objects>",
        "total_calls": 221,
        "primitive_calls": 221,
        "total_time": 5.2316000000000005e-05,
        "cumulative_time": 5.2316000000000005e-05,
        "time_percent": 0.020427401479401332,
        "time_per_call": 2.3672398190045252e-07
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 5.1298e-05,
        "cumulative_time": 5.1298e-05,
        "time_percent": 0.020029911329045216,
        "time_per_call": 6.41225e-06
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'scatter_add_' of 'torch._C.TensorBase' objects>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 5.1026e-05,
        "cumulative_time": 5.1026e-05,
        "time_percent": 0.0199237057093037,
        "time_per_call": 1.27565e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": true,
      "quantum_config": "QuantumConfig(quantum_level='tree_level', min_wave_size=3072, optimal_wave_size=3072, hbar_eff=0.1, temperature=1.0, coupling_strength=0.1, decoherence_rate=0.01, measurement_noise=0.0, path_integral_steps=10, path_integral_beta=1.0, use_wick_rotation=True, interference_alpha=0.05, interference_method='minhash', minhash_size=64, phase_kick_strength=0.1, use_mixed_precision=True, cache_corrections=True, fast_mode=True, enable_quantum=True, uncertainty_decay=0.99, phase_temperature=1.0, device='cuda')",
      "enable_virtual_loss": true,
      "virtual_loss_value": -3.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "tree_level",
    "num_simulations": 5000,
    "wave_size": 3072,
    "total_time_ms": 41.83168199961074,
    "simulations_per_second": 119526.63055830573,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 7.342463970184326,
        "cpu_time_ms": 7.805656998243649,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.833791971206665,
        "cpu_time_ms": 1.1145109965582378,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9705600142478943,
        "cpu_time_ms": 1.2695050027105026,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.140096187591553,
        "cpu_time_ms": 4.442058998392895,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 10.49120044708252,
        "cpu_time_ms": 10.944407003989909,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8286399841308594,
        "cpu_time_ms": 1.1358609990566038,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.5297280550003052,
        "cpu_time_ms": 1.8128750016330741,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.0286078453063965,
        "cpu_time_ms": 4.326428999775089,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      }
    ],
    "peak_gpu_memory_mb": 2846.16748046875,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 93.3,
    "avg_ram_usage_mb": 1218.78515625,
    "final_tree_nodes": 9,
    "final_tree_edges": 8,
    "tree_memory_mb": 50.92288589477539,
    "efficiency_score": 43003.53739954444,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Consider using classical selection for hot paths",
      "Tree-level quantum may be excessive - consider one-loop for balance",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 29,
    "total_kernel_calls": 50,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         18283 function calls (13797 primitive calls) in 0.040 seconds\n\n   Ordered by: cumulative time\n   List reduced from 175 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.039    0.039 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:214(search)\n        2    0.000    0.000    0.036    0.018 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:296(_run_search_wave_vectorized)\n        8    0.000    0.000    0.036    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:394(_profile_phase)\n        2    0.000    0.000    0.020    0.010 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:369(instrumented_select)\n        2    0.006    0.003    0.018    0.009 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:320(_select_batch_vectorized)\n        2    0.000    0.000    0.010    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:378(instrumented_backup)\n        2    0.005    0.003    0.008    0.004 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:747(_backup_batch_vectorized)\n        8    0.005    0.001    0.005    0.001 {built-in method torch.where}\n       28    0.000    0.000    0.005    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        2    0.001    0.001    0.004    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:915(_get_quantum_phases)\n        2    0.000    0.000    0.004    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:375(instrumented_evaluate)\n       20    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       25    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n  4508/28    0.002    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        2    0.000    0.000    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:372(instrumented_expand)\n       18    0.000    0.000    0.002    0.000 {built-in method builtins.next}\n       18    0.000    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:196(timer)\n       25    0.002    0.000    0.002    0.000 {built-in method torch._C._cuda_synchronize}\n        4    0.002    0.001    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n        9    0.000    0.000    0.002    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n        2    0.002    0.001    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:974(batch_action_to_child)\n        9    0.000    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:178(end_timer)\n        3    0.002    0.001    0.002    0.001 {built-in method time.sleep}\n        2    0.002    0.001    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n        2    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n        2    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:126(batch_ucb_selection)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:845(_extract_policy)\n        8    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:791(_add_dirichlet_noise_to_root)\n        2    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n      4/2    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        2    0.001    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:450(_expand_batch_vectorized)\n        2    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        2    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n        2    0.001    0.000    0.001    0.000 {built-in method torch._unique2}\n        2    0.001    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:699(_evaluate_batch_vectorized)\n       75    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n        2    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n       59    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n       59    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n       28    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n       18    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n       59    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n     12/8    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n        8    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n        4    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n        4    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n        4    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n        9    0.000    0.000    0.000    0.000 /usr/lib/python3.12/contextlib.py:132(__enter__)\n     5008    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 320,
        "function_name": "_select_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.005530443,
        "cumulative_time": 0.018131815000000003,
        "time_percent": 7.366323578636158,
        "time_per_call": 0.009065907500000001
      },
      {
        "rank": 2,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 747,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.005462137000000001,
        "cumulative_time": 0.007841201,
        "time_percent": 3.1856062843750297,
        "time_per_call": 0.0039206005
      },
      {
        "rank": 3,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.004852756000000001,
        "cumulative_time": 0.004852756000000001,
        "time_percent": 1.9715053867562675,
        "time_per_call": 0.0006065945000000001
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 28,
        "primitive_calls": 4508,
        "total_time": 0.0024746710000000003,
        "cumulative_time": 0.003267134,
        "time_percent": 1.3273225112193052,
        "time_per_call": 0.00011668335714285715
      },
      {
        "rank": 5,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.002377393,
        "cumulative_time": 0.002377393,
        "time_percent": 0.9658517976046277,
        "time_per_call": 9.509572e-05
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.002320064,
        "cumulative_time": 0.0023561940000000003,
        "time_percent": 0.9572393838146398,
        "time_per_call": 0.0005890485000000001
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 974,
        "function_name": "batch_action_to_child",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0019564870000000002,
        "cumulative_time": 0.0020413740000000003,
        "time_percent": 0.8293390059966312,
        "time_per_call": 0.0010206870000000002
      },
      {
        "rank": 8,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0017839660000000001,
        "cumulative_time": 0.001829417,
        "time_percent": 0.743228274844952,
        "time_per_call": 0.0006098056666666667
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0015841330000000002,
        "cumulative_time": 0.0016160570000000002,
        "time_percent": 0.6565475537622689,
        "time_per_call": 0.0008080285000000001
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 915,
        "function_name": "_get_quantum_phases",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.001395538,
        "cumulative_time": 0.004324509000000001,
        "time_percent": 1.7568970680940807,
        "time_per_call": 0.0021622545000000003
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 450,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000969564,
        "cumulative_time": 0.000981219,
        "time_percent": 0.3986350321523681,
        "time_per_call": 0.0004906095
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0009650660000000001,
        "cumulative_time": 0.0009650660000000001,
        "time_percent": 0.39207263204152937,
        "time_per_call": 0.00048253300000000005
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 699,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000785415,
        "cumulative_time": 0.000863447,
        "time_percent": 0.3507883791557908,
        "time_per_call": 0.0004317235
      },
      {
        "rank": 14,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000646878,
        "cumulative_time": 0.000646878,
        "time_percent": 0.2628039533770337,
        "time_per_call": 0.000323439
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.000471441,
        "cumulative_time": 0.004582699,
        "time_percent": 1.8617906534724924,
        "time_per_call": 0.00016366782142857142
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 5008,
        "primitive_calls": 5008,
        "total_time": 0.00036294100000000003,
        "cumulative_time": 0.00036294100000000003,
        "time_percent": 0.14745026054776017,
        "time_per_call": 7.24722444089457e-08
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.00032827400000000004,
        "cumulative_time": 0.00032827400000000004,
        "time_percent": 0.1333662684322119,
        "time_per_call": 1.172407142857143e-05
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 3437,
        "primitive_calls": 3437,
        "total_time": 0.000309189,
        "cumulative_time": 0.000309189,
        "time_percent": 0.12561269905715094,
        "time_per_call": 8.995897585103288e-08
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.000296697,
        "cumulative_time": 0.000296697,
        "time_percent": 0.12053763546620193,
        "time_per_call": 1.0596321428571429e-05
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 214,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000270108,
        "cumulative_time": 0.039010432000000005,
        "time_percent": 15.848576938071698,
        "time_per_call": 0.039010432000000005
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00023212900000000003,
        "cumulative_time": 0.00038652600000000005,
        "time_percent": 0.15703202285904194,
        "time_per_call": 9.663150000000001e-05
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.00022477,
        "cumulative_time": 0.00022477,
        "time_percent": 0.09131620583874528,
        "time_per_call": 1.8730833333333334e-05
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'to' of 'torch._C.TensorBase' objects>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.000220169,
        "cumulative_time": 0.000220169,
        "time_percent": 0.08944698012773374,
        "time_per_call": 4.4033800000000005e-05
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1100,
        "function_name": "remove_virtual_loss",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000192732,
        "cumulative_time": 0.000235858,
        "time_percent": 0.09582087323359338,
        "time_per_call": 0.000117929
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 791,
        "function_name": "_add_dirichlet_noise_to_root",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000174283,
        "cumulative_time": 0.001150034,
        "time_percent": 0.4672186744919499,
        "time_per_call": 0.001150034
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 126,
        "function_name": "batch_ucb_selection",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00016842700000000002,
        "cumulative_time": 0.0014551210000000002,
        "time_percent": 0.5911648741214615,
        "time_per_call": 0.0007275605000000001
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.00016327300000000002,
        "cumulative_time": 0.00016327300000000002,
        "time_percent": 0.06633212117235156,
        "time_per_call": 1.1662357142857144e-05
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.000153043,
        "cumulative_time": 0.000153043,
        "time_percent": 0.06217602923067622,
        "time_per_call": 3.0608600000000004e-05
      },
      {
        "rank": 29,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.00014604800000000002,
        "cumulative_time": 0.03616645,
        "time_percent": 14.693166315151885,
        "time_per_call": 0.00452080625
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000141065,
        "cumulative_time": 0.000141065,
        "time_percent": 0.05730978589955333,
        "time_per_call": 3.526625e-05
      },
      {
        "rank": 31,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1095,
        "function_name": "apply_virtual_loss",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000118591,
        "cumulative_time": 0.000118591,
        "time_percent": 0.048179384110969614,
        "time_per_call": 5.92955e-05
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 1093,
        "primitive_calls": 1093,
        "total_time": 0.00010892600000000001,
        "cumulative_time": 0.00010892600000000001,
        "time_percent": 0.044252831949064236,
        "time_per_call": 9.965782250686185e-08
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 9.3338e-05,
        "cumulative_time": 9.3338e-05,
        "time_percent": 0.03791997161799532,
        "time_per_call": 9.3338e-06
      },
      {
        "rank": 34,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 75,
        "primitive_calls": 75,
        "total_time": 9.3176e-05,
        "cumulative_time": 0.0007357580000000001,
        "time_percent": 0.29891279519287967,
        "time_per_call": 9.810106666666667e-06
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 1121,
        "primitive_calls": 1121,
        "total_time": 9.238700000000001e-05,
        "cumulative_time": 0.00021139300000000001,
        "time_percent": 0.08588159763700619,
        "time_per_call": 1.8857537912578056e-07
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x71c7179d2700>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 8.9981e-05,
        "cumulative_time": 8.9981e-05,
        "time_percent": 0.03655613968757458,
        "time_per_call": 4.9989444444444445e-06
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 8.9033e-05,
        "cumulative_time": 8.9033e-05,
        "time_percent": 0.036171000375677394,
        "time_per_call": 6.3595e-06
      },
      {
        "rank": 38,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 845,
        "function_name": "_extract_policy",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 8.139900000000001e-05,
        "cumulative_time": 0.00140331,
        "time_percent": 0.5701158731840087,
        "time_per_call": 0.00140331
      },
      {
        "rank": 39,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 59,
        "primitive_calls": 59,
        "total_time": 8.062000000000001e-05,
        "cumulative_time": 0.000131723,
        "time_percent": 0.05351445736395891,
        "time_per_call": 2.2325932203389834e-06
      },
      {
        "rank": 40,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 20,
        "primitive_calls": 20,
        "total_time": 7.8229e-05,
        "cumulative_time": 0.0035412240000000004,
        "time_percent": 1.4386757116390307,
        "time_per_call": 0.00017706120000000002
      },
      {
        "rank": 41,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 7.6389e-05,
        "cumulative_time": 0.0035103010000000004,
        "time_percent": 1.426112776046418,
        "time_per_call": 0.00014041204000000003
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 7.400000000000001e-05,
        "cumulative_time": 7.400000000000001e-05,
        "time_percent": 0.030063617173409045,
        "time_per_call": 1.2333333333333334e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 7.2876e-05,
        "cumulative_time": 7.2876e-05,
        "time_percent": 0.029606975204450776,
        "time_per_call": 1.8219e-05
      },
      {
        "rank": 44,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 6.4687e-05,
        "cumulative_time": 0.000119006,
        "time_percent": 0.048347984126198874,
        "time_per_call": 4.40762962962963e-06
      },
      {
        "rank": 45,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py",
        "line_number": 179,
        "function_name": "record",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 6.299100000000001e-05,
        "cumulative_time": 0.0005059660000000001,
        "time_percent": 0.20555632603731191,
        "time_per_call": 2.8109222222222226e-05
      },
      {
        "rank": 46,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 812,
        "function_name": "_get_device_index",
        "total_calls": 59,
        "primitive_calls": 59,
        "total_time": 5.8189e-05,
        "cumulative_time": 0.000607811,
        "time_percent": 0.2469323948349584,
        "time_per_call": 1.0301881355932203e-05
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 5.649e-05,
        "cumulative_time": 5.649e-05,
        "time_percent": 0.02294991532602536,
        "time_per_call": 4.345384615384615e-06
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 5.5581e-05,
        "cumulative_time": 5.5581e-05,
        "time_percent": 0.022580620352908757,
        "time_per_call": 9.2635e-06
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method __new__ of type object at 0xa43b40>",
        "total_calls": 50,
        "primitive_calls": 50,
        "total_time": 5.5176e-05,
        "cumulative_time": 5.5176e-05,
        "time_percent": 0.022416082988648882,
        "time_per_call": 1.10352e-06
      },
      {
        "rank": 50,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 178,
        "function_name": "end_timer",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 5.2864e-05,
        "cumulative_time": 0.0020203160000000003,
        "time_percent": 0.8207838755853119,
        "time_per_call": 0.00022447955555555558
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": true,
      "quantum_config": "QuantumConfig(quantum_level='one_loop', min_wave_size=3072, optimal_wave_size=3072, hbar_eff=0.1, temperature=1.0, coupling_strength=0.1, decoherence_rate=0.01, measurement_noise=0.0, path_integral_steps=10, path_integral_beta=1.0, use_wick_rotation=True, interference_alpha=0.05, interference_method='minhash', minhash_size=64, phase_kick_strength=0.1, use_mixed_precision=True, cache_corrections=True, fast_mode=True, enable_quantum=True, uncertainty_decay=0.99, phase_temperature=1.0, device='cuda')",
      "enable_virtual_loss": true,
      "virtual_loss_value": -3.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "one_loop",
    "num_simulations": 5000,
    "wave_size": 3072,
    "total_time_ms": 43.7667629958014,
    "simulations_per_second": 114241.94200698956,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 8.869888305664062,
        "cpu_time_ms": 9.478650004894007,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7755200266838074,
        "cpu_time_ms": 1.0797470022225752,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0835200548171997,
        "cpu_time_ms": 1.3544609973905608,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.826111793518066,
        "cpu_time_ms": 5.167920004168991,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.59660816192627,
        "cpu_time_ms": 9.163484995951876,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8104320168495178,
        "cpu_time_ms": 1.1118990005343221,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.5542720556259155,
        "cpu_time_ms": 1.8799649988068268,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.398079872131348,
        "cpu_time_ms": 4.742606004583649,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      }
    ],
    "peak_gpu_memory_mb": 2848.57177734375,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 91.1,
    "avg_ram_usage_mb": 1218.78515625,
    "final_tree_nodes": 9,
    "final_tree_edges": 8,
    "tree_memory_mb": 50.92288589477539,
    "efficiency_score": 41067.509530773656,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Consider using classical selection for hot paths",
      "One-loop quantum is a good balance - monitor overhead",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 36,
    "total_kernel_calls": 57,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         18283 function calls (13797 primitive calls) in 0.042 seconds\n\n   Ordered by: cumulative time\n   List reduced from 175 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.041    0.041 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:214(search)\n        2    0.000    0.000    0.038    0.019 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:296(_run_search_wave_vectorized)\n        8    0.000    0.000    0.038    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:394(_profile_phase)\n        2    0.000    0.000    0.020    0.010 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:369(instrumented_select)\n        2    0.000    0.000    0.011    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:378(instrumented_backup)\n        2    0.003    0.001    0.009    0.004 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:320(_select_batch_vectorized)\n        2    0.006    0.003    0.009    0.004 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:747(_backup_batch_vectorized)\n        3    0.003    0.001    0.008    0.003 {built-in method time.sleep}\n       28    0.001    0.000    0.005    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       20    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        2    0.000    0.000    0.004    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:375(instrumented_evaluate)\n  4508/28    0.003    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        2    0.004    0.002    0.004    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n        8    0.003    0.000    0.003    0.000 {built-in method torch.where}\n       25    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        2    0.000    0.000    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:372(instrumented_expand)\n        2    0.002    0.001    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:915(_get_quantum_phases)\n       25    0.003    0.000    0.003    0.000 {built-in method torch._C._cuda_synchronize}\n       18    0.000    0.000    0.003    0.000 {built-in method builtins.next}\n       18    0.000    0.000    0.003    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:196(timer)\n        9    0.000    0.000    0.002    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n        4    0.002    0.001    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n        9    0.000    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:178(end_timer)\n        2    0.000    0.000    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n        2    0.002    0.001    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:450(_expand_batch_vectorized)\n        2    0.000    0.000    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:126(batch_ucb_selection)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:845(_extract_policy)\n        8    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:791(_add_dirichlet_noise_to_root)\n        2    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:974(batch_action_to_child)\n        2    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n      4/2    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        2    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        2    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n        2    0.001    0.001    0.001    0.001 {built-in method torch._unique2}\n        2    0.001    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:699(_evaluate_batch_vectorized)\n       75    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n        8    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n       59    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n        2    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n        4    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n       28    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n     12/8    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n       59    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n       59    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n       18    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n        4    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n       25    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:490(__init__)\n        9    0.000    0.000    0.000    0.000 /usr/lib/python3.12/contextlib.py:132(__enter__)\n       28    0.000    0.000    0.000    0.000 {built-in method torch._C._cuda_memoryStats}\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 747,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0061546560000000005,
        "cumulative_time": 0.008833353,
        "time_percent": 3.4416079350761875,
        "time_per_call": 0.0044166765
      },
      {
        "rank": 2,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.003504987,
        "cumulative_time": 0.003574916,
        "time_percent": 1.3928413449378534,
        "time_per_call": 0.001787458
      },
      {
        "rank": 3,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.0032967400000000003,
        "cumulative_time": 0.0032967400000000003,
        "time_percent": 1.2844597678687888,
        "time_per_call": 0.00041209250000000003
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 320,
        "function_name": "_select_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0028963960000000003,
        "cumulative_time": 0.00883422,
        "time_percent": 3.4419457313897404,
        "time_per_call": 0.00441711
      },
      {
        "rank": 5,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.00285125,
        "cumulative_time": 0.008482341000000001,
        "time_percent": 3.3048483507476814,
        "time_per_call": 0.0028274470000000003
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 28,
        "primitive_calls": 4508,
        "total_time": 0.0028412090000000004,
        "cumulative_time": 0.0037257590000000004,
        "time_percent": 1.4516120592691721,
        "time_per_call": 0.00013306282142857144
      },
      {
        "rank": 7,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.002617152,
        "cumulative_time": 0.002617152,
        "time_percent": 1.019682004160879,
        "time_per_call": 0.00010468608000000001
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.002123026,
        "cumulative_time": 0.002171526,
        "time_percent": 0.8460593743762139,
        "time_per_call": 0.0005428815
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 915,
        "function_name": "_get_quantum_phases",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0016458050000000002,
        "cumulative_time": 0.002892795,
        "time_percent": 1.127076686117799,
        "time_per_call": 0.0014463975
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 450,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00155757,
        "cumulative_time": 0.001588348,
        "time_percent": 0.6188444048893316,
        "time_per_call": 0.000794174
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 974,
        "function_name": "batch_action_to_child",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.001105508,
        "cumulative_time": 0.0012204610000000002,
        "time_percent": 0.4755100653229888,
        "time_per_call": 0.0006102305000000001
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0010213820000000001,
        "cumulative_time": 0.0010213820000000001,
        "time_percent": 0.3979458758122749,
        "time_per_call": 0.0005106910000000001
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 699,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0009140900000000001,
        "cumulative_time": 0.0009878250000000001,
        "time_percent": 0.38487156105576614,
        "time_per_call": 0.0004939125000000001
      },
      {
        "rank": 14,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00069006,
        "cumulative_time": 0.00069006,
        "time_percent": 0.26885781329905795,
        "time_per_call": 0.00034503
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.000585517,
        "cumulative_time": 0.005330232000000001,
        "time_percent": 2.076739008052437,
        "time_per_call": 0.0001903654285714286
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.000416901,
        "cumulative_time": 0.000416901,
        "time_percent": 0.1624309353131475,
        "time_per_call": 1.488932142857143e-05
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 5008,
        "primitive_calls": 5008,
        "total_time": 0.00039068,
        "cumulative_time": 0.00039068,
        "time_percent": 0.15221483711514355,
        "time_per_call": 7.80111821086262e-08
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 3437,
        "primitive_calls": 3437,
        "total_time": 0.000360162,
        "cumulative_time": 0.000360162,
        "time_percent": 0.14032456272413313,
        "time_per_call": 1.0478964212976433e-07
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.000348255,
        "cumulative_time": 0.000348255,
        "time_percent": 0.13568541542831555,
        "time_per_call": 1.2437678571428571e-05
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.00031306600000000003,
        "cumulative_time": 0.00031306600000000003,
        "time_percent": 0.12197524878747193,
        "time_per_call": 2.6088833333333337e-05
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 214,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00030557100000000003,
        "cumulative_time": 0.040718511000000006,
        "time_percent": 15.864547761431815,
        "time_per_call": 0.040718511000000006
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1100,
        "function_name": "remove_virtual_loss",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000247622,
        "cumulative_time": 0.000307502,
        "time_percent": 0.11980743023083054,
        "time_per_call": 0.000153751
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.000236678,
        "cumulative_time": 0.037668798,
        "time_percent": 14.676333449097076,
        "time_per_call": 0.00470859975
      },
      {
        "rank": 24,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'to' of 'torch._C.TensorBase' objects>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.000233736,
        "cumulative_time": 0.000233736,
        "time_percent": 0.09106708090494828,
        "time_per_call": 4.6747200000000005e-05
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000208358,
        "cumulative_time": 0.000358282,
        "time_percent": 0.1395920862887475,
        "time_per_call": 8.95705e-05
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 126,
        "function_name": "batch_ucb_selection",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000204338,
        "cumulative_time": 0.001581673,
        "time_percent": 0.6162437239285872,
        "time_per_call": 0.0007908365
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.00019985600000000002,
        "cumulative_time": 0.00019985600000000002,
        "time_percent": 0.0778669204629982,
        "time_per_call": 1.4275428571428573e-05
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.00019667,
        "cumulative_time": 0.00019667,
        "time_percent": 0.07662560667409461,
        "time_per_call": 3.9334e-05
      },
      {
        "rank": 29,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 791,
        "function_name": "_add_dirichlet_noise_to_root",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00017080600000000002,
        "cumulative_time": 0.0012418190000000001,
        "time_percent": 0.4838314651671201,
        "time_per_call": 0.0012418190000000001
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000165768,
        "cumulative_time": 0.000165768,
        "time_percent": 0.06458572007500542,
        "time_per_call": 4.1442e-05
      },
      {
        "rank": 31,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1095,
        "function_name": "apply_virtual_loss",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00014360300000000001,
        "cumulative_time": 0.00014360300000000001,
        "time_percent": 0.055949900824833525,
        "time_per_call": 7.180150000000001e-05
      },
      {
        "rank": 32,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 75,
        "primitive_calls": 75,
        "total_time": 0.0001178,
        "cumulative_time": 0.000894859,
        "time_percent": 0.34865060132594516,
        "time_per_call": 1.1931453333333334e-05
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 1093,
        "primitive_calls": 1093,
        "total_time": 0.000116261,
        "cumulative_time": 0.000116261,
        "time_percent": 0.045297044071474626,
        "time_per_call": 1.0636870997255261e-07
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x71c7179d2700>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.000111539,
        "cumulative_time": 0.000111539,
        "time_percent": 0.04345728145025596,
        "time_per_call": 6.1966111111111115e-06
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 1121,
        "primitive_calls": 1121,
        "total_time": 0.000109327,
        "cumulative_time": 0.00026505500000000004,
        "time_percent": 0.10326943701124804,
        "time_per_call": 2.3644513826940237e-07
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.000102169,
        "cumulative_time": 0.000102169,
        "time_percent": 0.03980658772708381,
        "time_per_call": 1.7028166666666667e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 9.863600000000001e-05,
        "cumulative_time": 9.863600000000001e-05,
        "time_percent": 0.03843007748973406,
        "time_per_call": 7.045428571428572e-06
      },
      {
        "rank": 38,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 59,
        "primitive_calls": 59,
        "total_time": 9.753000000000001e-05,
        "cumulative_time": 0.000155885,
        "time_percent": 0.06073515379260303,
        "time_per_call": 2.6421186440677965e-06
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 845,
        "function_name": "_extract_policy",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 9.3466e-05,
        "cumulative_time": 0.0014665980000000002,
        "time_percent": 0.5714087633956059,
        "time_per_call": 0.0014665980000000002
      },
      {
        "rank": 40,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 20,
        "primitive_calls": 20,
        "total_time": 9.193100000000001e-05,
        "cumulative_time": 0.004134479,
        "time_percent": 1.6108555532430162,
        "time_per_call": 0.00020672395
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 8.8478e-05,
        "cumulative_time": 8.8478e-05,
        "time_percent": 0.03447236704790026,
        "time_per_call": 8.8478e-06
      },
      {
        "rank": 42,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 8.6415e-05,
        "cumulative_time": 0.000155728,
        "time_percent": 0.06067398421794582,
        "time_per_call": 5.767703703703703e-06
      },
      {
        "rank": 43,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 8.2309e-05,
        "cumulative_time": 0.003226623,
        "time_percent": 1.25714112413478,
        "time_per_call": 0.00012906492
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 8.121800000000001e-05,
        "cumulative_time": 8.121800000000001e-05,
        "time_percent": 0.03164376123891095,
        "time_per_call": 1.3536333333333335e-05
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 8.096500000000001e-05,
        "cumulative_time": 8.096500000000001e-05,
        "time_percent": 0.03154518861223405,
        "time_per_call": 2.0241250000000002e-05
      },
      {
        "rank": 46,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 812,
        "function_name": "_get_device_index",
        "total_calls": 59,
        "primitive_calls": 59,
        "total_time": 7.7815e-05,
        "cumulative_time": 0.000739397,
        "time_percent": 0.2880802547313039,
        "time_per_call": 1.2532152542372883e-05
      },
      {
        "rank": 47,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py",
        "line_number": 179,
        "function_name": "record",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 7.669400000000001e-05,
        "cumulative_time": 0.00059006,
        "time_percent": 0.2298963007785441,
        "time_per_call": 3.278111111111111e-05
      },
      {
        "rank": 48,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 770,
        "function_name": "_get_device_attr",
        "total_calls": 59,
        "primitive_calls": 59,
        "total_time": 7.2673e-05,
        "cumulative_time": 0.000601982,
        "time_percent": 0.23454129230123977,
        "time_per_call": 1.0203084745762713e-05
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method __new__ of type object at 0xa43b40>",
        "total_calls": 50,
        "primitive_calls": 50,
        "total_time": 6.9324e-05,
        "cumulative_time": 6.9324e-05,
        "time_percent": 0.02700967893972103,
        "time_per_call": 1.38648e-06
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'split' of 'bytes' objects>",
        "total_calls": 221,
        "primitive_calls": 221,
        "total_time": 6.3581e-05,
        "cumulative_time": 6.3581e-05,
        "time_percent": 0.024772119275667918,
        "time_per_call": 2.876968325791855e-07
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -3.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "classical",
    "num_simulations": 10000,
    "wave_size": 3072,
    "total_time_ms": 70.99468300293665,
    "simulations_per_second": 140855.6187170574,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 6.2478718757629395,
        "cpu_time_ms": 6.706660002237186,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.9946879744529724,
        "cpu_time_ms": 1.7904189953696914,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.971776008605957,
        "cpu_time_ms": 1.2601670023286715,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.034560203552246,
        "cpu_time_ms": 4.3297340016579255,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 6.607840061187744,
        "cpu_time_ms": 7.06502899993211,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7468799948692322,
        "cpu_time_ms": 0.9873700037132949,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9992319941520691,
        "cpu_time_ms": 1.244635001057759,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 5.249023914337158,
        "cpu_time_ms": 7.301602003281005,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 6.290143966674805,
        "cpu_time_ms": 6.87577100325143,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8094080090522766,
        "cpu_time_ms": 1.3073890004307032,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9539520144462585,
        "cpu_time_ms": 1.213408999319654,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 3.9434239864349365,
        "cpu_time_ms": 4.225239994411822,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 6.609983921051025,
        "cpu_time_ms": 7.040900003630668,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7766079902648926,
        "cpu_time_ms": 1.046848003170453,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9485440254211426,
        "cpu_time_ms": 1.2022110022371635,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.696256160736084,
        "cpu_time_ms": 4.963570994732436,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      }
    ],
    "peak_gpu_memory_mb": 2849.4150390625,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 92.7,
    "avg_ram_usage_mb": 1218.78515625,
    "final_tree_nodes": 9,
    "final_tree_edges": 8,
    "tree_memory_mb": 50.92288589477539,
    "efficiency_score": 50619.566328155066,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 42,
    "total_kernel_calls": 78,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         34532 function calls (26041 primitive calls) in 0.070 seconds\n\n   Ordered by: cumulative time\n   List reduced from 167 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.068    0.068 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:214(search)\n       16    0.000    0.000    0.065    0.004 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:394(_profile_phase)\n        4    0.000    0.000    0.065    0.016 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:296(_run_search_wave_vectorized)\n        4    0.011    0.003    0.026    0.007 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:320(_select_batch_vectorized)\n        4    0.000    0.000    0.023    0.006 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:369(instrumented_select)\n        4    0.000    0.000    0.022    0.006 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:378(instrumented_backup)\n        4    0.000    0.000    0.014    0.004 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:372(instrumented_expand)\n        6    0.009    0.002    0.011    0.002 {built-in method time.sleep}\n        4    0.007    0.002    0.011    0.003 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:747(_backup_batch_vectorized)\n       53    0.001    0.000    0.009    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       39    0.000    0.000    0.007    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        4    0.000    0.000    0.007    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:375(instrumented_evaluate)\n  8533/53    0.005    0.000    0.006    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       49    0.000    0.000    0.006    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n       34    0.000    0.000    0.005    0.000 {built-in method builtins.next}\n       34    0.000    0.000    0.005    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:196(timer)\n       17    0.000    0.000    0.004    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       12    0.004    0.000    0.004    0.000 {built-in method torch.where}\n       49    0.004    0.000    0.004    0.000 {built-in method torch._C._cuda_synchronize}\n       17    0.000    0.000    0.004    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:178(end_timer)\n        6    0.004    0.001    0.004    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n        4    0.003    0.001    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n        4    0.003    0.001    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:699(_evaluate_batch_vectorized)\n        4    0.000    0.000    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n        4    0.000    0.000    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:126(batch_ucb_selection)\n        4    0.002    0.001    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:974(batch_action_to_child)\n       14    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        4    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n      8/4    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        4    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        4    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n        4    0.002    0.000    0.002    0.000 {built-in method torch._unique2}\n        4    0.002    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:450(_expand_batch_vectorized)\n    21/14    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n        7    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n       14    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:845(_extract_policy)\n      143    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n        7    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n      115    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:791(_add_dirichlet_noise_to_root)\n       53    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n      115    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n        7    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n      115    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n       34    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n     9505    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}\n        7    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:812(bcat)\n        2    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n       49    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:490(__init__)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 320,
        "function_name": "_select_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.010589181000000001,
        "cumulative_time": 0.026404838,
        "time_percent": 6.068999205111371,
        "time_per_call": 0.0066012095
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.009320774,
        "cumulative_time": 0.010747079000000001,
        "time_percent": 2.470153913016589,
        "time_per_call": 0.0017911798333333335
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 747,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.007413744000000001,
        "cumulative_time": 0.010696868,
        "time_percent": 2.4586132052459955,
        "time_per_call": 0.002674217
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 53,
        "primitive_calls": 8533,
        "total_time": 0.004866073,
        "cumulative_time": 0.006431189,
        "time_percent": 1.4781715732897507,
        "time_per_call": 0.00012134318867924529
      },
      {
        "rank": 5,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.004239793,
        "cumulative_time": 0.004239793,
        "time_percent": 0.9744918846628318,
        "time_per_call": 0.00035331608333333335
      },
      {
        "rank": 6,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 49,
        "primitive_calls": 49,
        "total_time": 0.00419145,
        "cumulative_time": 0.00419145,
        "time_percent": 0.9633805258818122,
        "time_per_call": 8.553979591836736e-05
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.003623504,
        "cumulative_time": 0.0036740630000000004,
        "time_percent": 0.8444621181364227,
        "time_per_call": 0.0006123438333333334
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0032904040000000002,
        "cumulative_time": 0.0033426750000000002,
        "time_percent": 0.7682945041338884,
        "time_per_call": 0.0008356687500000001
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 699,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.003047171,
        "cumulative_time": 0.0031735030000000003,
        "time_percent": 0.7294112989603857,
        "time_per_call": 0.0007933757500000001
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 974,
        "function_name": "batch_action_to_child",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0020862520000000002,
        "cumulative_time": 0.002248444,
        "time_percent": 0.5167918412806559,
        "time_per_call": 0.000562111
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0019251090000000002,
        "cumulative_time": 0.0019251090000000002,
        "time_percent": 0.4424751627240715,
        "time_per_call": 0.00048127725000000004
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 450,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0017597670000000002,
        "cumulative_time": 0.0017869910000000001,
        "time_percent": 0.41072953973590653,
        "time_per_call": 0.00044674775000000004
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 53,
        "primitive_calls": 53,
        "total_time": 0.0008831770000000001,
        "cumulative_time": 0.009076682,
        "time_percent": 2.0862228294318146,
        "time_per_call": 0.00017125815094339624
      },
      {
        "rank": 14,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 9505,
        "primitive_calls": 9505,
        "total_time": 0.0007122420000000001,
        "cumulative_time": 0.0007122420000000001,
        "time_percent": 0.16370470183710023,
        "time_per_call": 7.493340347185693e-08
      },
      {
        "rank": 15,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000658653,
        "cumulative_time": 0.000658653,
        "time_percent": 0.15138758031555505,
        "time_per_call": 0.0003293265
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 53,
        "primitive_calls": 53,
        "total_time": 0.0006398780000000001,
        "cumulative_time": 0.0006398780000000001,
        "time_percent": 0.14707225521960235,
        "time_per_call": 1.2073169811320756e-05
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 53,
        "primitive_calls": 53,
        "total_time": 0.0006323440000000001,
        "cumulative_time": 0.0006323440000000001,
        "time_percent": 0.14534060892011325,
        "time_per_call": 1.193101886792453e-05
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 6506,
        "primitive_calls": 6506,
        "total_time": 0.0005999390000000001,
        "cumulative_time": 0.0005999390000000001,
        "time_percent": 0.1378925072032372,
        "time_per_call": 9.22131878266216e-08
      },
      {
        "rank": 19,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 214,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000495656,
        "cumulative_time": 0.068316183,
        "time_percent": 15.702079305438001,
        "time_per_call": 0.068316183
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 21,
        "primitive_calls": 21,
        "total_time": 0.000390483,
        "cumulative_time": 0.000390483,
        "time_percent": 0.0897502577599417,
        "time_per_call": 1.859442857142857e-05
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1100,
        "function_name": "remove_virtual_loss",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00037572800000000003,
        "cumulative_time": 0.00047809200000000006,
        "time_percent": 0.10988667940208935,
        "time_per_call": 0.00011952300000000001
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 126,
        "function_name": "batch_ucb_selection",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00032874200000000003,
        "cumulative_time": 0.003043089,
        "time_percent": 0.6994363957878915,
        "time_per_call": 0.00076077225
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.00032191900000000005,
        "cumulative_time": 0.00035578700000000004,
        "time_percent": 0.08177558295146366,
        "time_per_call": 1.2706678571428573e-05
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.000294487,
        "cumulative_time": 0.000523722,
        "time_percent": 0.12037447083369107,
        "time_per_call": 7.481742857142857e-05
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.00028161,
        "cumulative_time": 0.06539182,
        "time_percent": 15.029931393663007,
        "time_per_call": 0.00408698875
      },
      {
        "rank": 26,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x71c7179d2700>",
        "total_calls": 34,
        "primitive_calls": 34,
        "total_time": 0.00024756800000000004,
        "cumulative_time": 0.00024756800000000004,
        "time_percent": 0.05690207208281346,
        "time_per_call": 7.2814117647058836e-06
      },
      {
        "rank": 27,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1095,
        "function_name": "apply_virtual_loss",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000231069,
        "cumulative_time": 0.000231069,
        "time_percent": 0.053109872415270244,
        "time_per_call": 5.776725e-05
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'to' of 'torch._C.TensorBase' objects>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000228468,
        "cumulative_time": 0.000228468,
        "time_percent": 0.05251204761768978,
        "time_per_call": 0.000228468
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 2068,
        "primitive_calls": 2068,
        "total_time": 0.00022555100000000002,
        "cumulative_time": 0.00022555100000000002,
        "time_percent": 0.051841592048853885,
        "time_per_call": 1.0906721470019343e-07
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.000193462,
        "cumulative_time": 0.000193462,
        "time_percent": 0.04446612110323328,
        "time_per_call": 2.7637428571428573e-05
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 2120,
        "primitive_calls": 2120,
        "total_time": 0.000182869,
        "cumulative_time": 0.000393379,
        "time_percent": 0.09041588660030811,
        "time_per_call": 1.855561320754717e-07
      },
      {
        "rank": 32,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 143,
        "primitive_calls": 143,
        "total_time": 0.000179824,
        "cumulative_time": 0.00145779,
        "time_percent": 0.3350645950268396,
        "time_per_call": 1.0194335664335664e-05
      },
      {
        "rank": 33,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 791,
        "function_name": "_add_dirichlet_noise_to_root",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00016025000000000002,
        "cumulative_time": 0.0011546870000000002,
        "time_percent": 0.26539812458430667,
        "time_per_call": 0.0011546870000000002
      },
      {
        "rank": 34,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 39,
        "primitive_calls": 39,
        "total_time": 0.00015622000000000002,
        "cumulative_time": 0.0071017070000000005,
        "time_percent": 1.632286255190578,
        "time_per_call": 0.0001820950512820513
      },
      {
        "rank": 35,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 115,
        "primitive_calls": 115,
        "total_time": 0.00014853200000000002,
        "cumulative_time": 0.000243758,
        "time_percent": 0.05602636563191706,
        "time_per_call": 2.119634782608696e-06
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.00014495100000000002,
        "cumulative_time": 0.00014495100000000002,
        "time_percent": 0.033316148494457666,
        "time_per_call": 1.2079250000000001e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 20,
        "primitive_calls": 20,
        "total_time": 0.00014217,
        "cumulative_time": 0.00014217,
        "time_percent": 0.03267695173856714,
        "time_per_call": 7.1085e-06
      },
      {
        "rank": 38,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 49,
        "primitive_calls": 49,
        "total_time": 0.00014138,
        "cumulative_time": 0.0059916710000000005,
        "time_percent": 1.3771509045535086,
        "time_per_call": 0.000122279
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.000135186,
        "cumulative_time": 0.000135186,
        "time_percent": 0.031071719756136578,
        "time_per_call": 1.9312285714285714e-05
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.000127953,
        "cumulative_time": 0.000127953,
        "time_percent": 0.029409256564710426,
        "time_per_call": 1.066275e-05
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_getDevice>",
        "total_calls": 115,
        "primitive_calls": 115,
        "total_time": 0.000115118,
        "cumulative_time": 0.000115118,
        "time_percent": 0.026459206092989886,
        "time_per_call": 1.0010260869565217e-06
      },
      {
        "rank": 42,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 812,
        "function_name": "_get_device_index",
        "total_calls": 115,
        "primitive_calls": 115,
        "total_time": 0.00011105300000000001,
        "cumulative_time": 0.001210813,
        "time_percent": 0.2782983608738109,
        "time_per_call": 1.0528808695652174e-05
      },
      {
        "rank": 43,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 49,
        "primitive_calls": 49,
        "total_time": 0.00011105,
        "cumulative_time": 0.00021051000000000002,
        "time_percent": 0.0483845052436222,
        "time_per_call": 4.296122448979592e-06
      },
      {
        "rank": 44,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 770,
        "function_name": "_get_device_attr",
        "total_calls": 115,
        "primitive_calls": 115,
        "total_time": 0.000102745,
        "cumulative_time": 0.001001799,
        "time_percent": 0.2302577025725879,
        "time_per_call": 8.711295652173913e-06
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 22,
        "primitive_calls": 22,
        "total_time": 9.937300000000001e-05,
        "cumulative_time": 9.937300000000001e-05,
        "time_percent": 0.022840308961923277,
        "time_per_call": 4.516954545454546e-06
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method __new__ of type object at 0xa43b40>",
        "total_calls": 93,
        "primitive_calls": 93,
        "total_time": 9.6032e-05,
        "cumulative_time": 9.6032e-05,
        "time_percent": 0.022072399446845886,
        "time_per_call": 1.0326021505376345e-06
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 9.3033e-05,
        "cumulative_time": 9.3033e-05,
        "time_percent": 0.02138309665255762,
        "time_per_call": 1.1629125e-05
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'split' of 'bytes' objects>",
        "total_calls": 386,
        "primitive_calls": 386,
        "total_time": 8.817900000000001e-05,
        "cumulative_time": 8.817900000000001e-05,
        "time_percent": 0.020267432843462843,
        "time_per_call": 2.2844300518134718e-07
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'scatter_add_' of 'torch._C.TensorBase' objects>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 8.769000000000001e-05,
        "cumulative_time": 8.769000000000001e-05,
        "time_percent": 0.02015503902338716,
        "time_per_call": 1.0961250000000001e-05
      },
      {
        "rank": 50,
        "filename": "<frozen _collections_abc>",
        "line_number": 804,
        "function_name": "get",
        "total_calls": 115,
        "primitive_calls": 115,
        "total_time": 8.7633e-05,
        "cumulative_time": 0.000331391,
        "time_percent": 0.07616830353517269,
        "time_per_call": 2.8816608695652176e-06
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": true,
      "quantum_config": "QuantumConfig(quantum_level='tree_level', min_wave_size=3072, optimal_wave_size=3072, hbar_eff=0.1, temperature=1.0, coupling_strength=0.1, decoherence_rate=0.01, measurement_noise=0.0, path_integral_steps=10, path_integral_beta=1.0, use_wick_rotation=True, interference_alpha=0.05, interference_method='minhash', minhash_size=64, phase_kick_strength=0.1, use_mixed_precision=True, cache_corrections=True, fast_mode=True, enable_quantum=True, uncertainty_decay=0.99, phase_temperature=1.0, device='cuda')",
      "enable_virtual_loss": true,
      "virtual_loss_value": -3.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "tree_level",
    "num_simulations": 10000,
    "wave_size": 3072,
    "total_time_ms": 78.5838869996951,
    "simulations_per_second": 127252.54987754424,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 9.433759689331055,
        "cpu_time_ms": 9.55288700060919,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.859391987323761,
        "cpu_time_ms": 1.1456510037533008,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.32697594165802,
        "cpu_time_ms": 1.6240670011029579,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.3672637939453125,
        "cpu_time_ms": 4.5201940010883845,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.306048393249512,
        "cpu_time_ms": 9.338216994365212,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8850560188293457,
        "cpu_time_ms": 1.1259769962634891,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0622400045394897,
        "cpu_time_ms": 1.4718809979967773,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.297728061676025,
        "cpu_time_ms": 4.415497998706996,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 9.052384376525879,
        "cpu_time_ms": 9.101737996388692,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8143360018730164,
        "cpu_time_ms": 1.063952993717976,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9784960150718689,
        "cpu_time_ms": 1.1819240025943145,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.687871932983398,
        "cpu_time_ms": 4.8217739968094975,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.196736335754395,
        "cpu_time_ms": 8.798597002169117,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.83651202917099,
        "cpu_time_ms": 1.118002001021523,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1391040086746216,
        "cpu_time_ms": 1.4187569977366365,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.40831995010376,
        "cpu_time_ms": 4.527033997874241,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      }
    ],
    "peak_gpu_memory_mb": 2850.12255859375,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 186.8,
    "avg_ram_usage_mb": 1218.78515625,
    "final_tree_nodes": 9,
    "final_tree_edges": 8,
    "tree_memory_mb": 50.92288589477539,
    "efficiency_score": 45719.651838024314,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Consider using classical selection for hot paths",
      "Tree-level quantum may be excessive - consider one-loop for balance",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 65,
    "total_kernel_calls": 109,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         36366 function calls (27394 primitive calls) in 0.077 seconds\n\n   Ordered by: cumulative time\n   List reduced from 175 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.075    0.075 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:214(search)\n        4    0.000    0.000    0.072    0.018 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:296(_run_search_wave_vectorized)\n       16    0.000    0.000    0.072    0.004 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:394(_profile_phase)\n        4    0.000    0.000    0.039    0.010 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:369(instrumented_select)\n        4    0.000    0.000    0.020    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:378(instrumented_backup)\n        4    0.007    0.002    0.019    0.005 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:320(_select_batch_vectorized)\n        7    0.007    0.001    0.018    0.003 {built-in method time.sleep}\n        4    0.009    0.002    0.013    0.003 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:747(_backup_batch_vectorized)\n       56    0.001    0.000    0.009    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        4    0.007    0.002    0.007    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n       49    0.000    0.000    0.007    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        4    0.000    0.000    0.007    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:375(instrumented_evaluate)\n       40    0.000    0.000    0.007    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n  9016/56    0.005    0.000    0.007    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       16    0.006    0.000    0.006    0.000 {built-in method torch.where}\n       34    0.000    0.000    0.006    0.000 {built-in method builtins.next}\n       34    0.000    0.000    0.006    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:196(timer)\n        4    0.000    0.000    0.006    0.001 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:372(instrumented_expand)\n       17    0.000    0.000    0.005    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       17    0.000    0.000    0.005    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:178(end_timer)\n        4    0.003    0.001    0.005    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:915(_get_quantum_phases)\n       49    0.005    0.000    0.005    0.000 {built-in method torch._C._cuda_synchronize}\n        6    0.004    0.001    0.004    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n        4    0.003    0.001    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:450(_expand_batch_vectorized)\n        4    0.003    0.001    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:699(_evaluate_batch_vectorized)\n        4    0.000    0.000    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n        4    0.000    0.000    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:126(batch_ucb_selection)\n        4    0.002    0.001    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:974(batch_action_to_child)\n       16    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        4    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n      8/4    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        4    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        4    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n        4    0.002    0.000    0.002    0.000 {built-in method torch._unique2}\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:791(_add_dirichlet_noise_to_root)\n      147    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:845(_extract_policy)\n    24/16    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n      115    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n        8    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n       56    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n       16    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n      115    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n      115    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n       34    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n        8    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n        8    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n        8    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n     9992    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}\n        8    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 747,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.009104206,
        "cumulative_time": 0.013354049000000002,
        "time_percent": 2.768857899053696,
        "time_per_call": 0.0033385122500000004
      },
      {
        "rank": 2,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.007191974,
        "cumulative_time": 0.007334803000000001,
        "time_percent": 1.5208141908534818,
        "time_per_call": 0.0018337007500000002
      },
      {
        "rank": 3,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.0068125040000000005,
        "cumulative_time": 0.018081510000000002,
        "time_percent": 3.749060063379908,
        "time_per_call": 0.0025830728571428576
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 320,
        "function_name": "_select_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0066707070000000005,
        "cumulative_time": 0.018552213,
        "time_percent": 3.8466566589636346,
        "time_per_call": 0.00463805325
      },
      {
        "rank": 5,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.006473367000000001,
        "cumulative_time": 0.006473367000000001,
        "time_percent": 1.342202155422938,
        "time_per_call": 0.00040458543750000004
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 56,
        "primitive_calls": 9016,
        "total_time": 0.004942337000000001,
        "cumulative_time": 0.006531835000000001,
        "time_percent": 1.3543250391746653,
        "time_per_call": 0.00011663991071428573
      },
      {
        "rank": 7,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 49,
        "primitive_calls": 49,
        "total_time": 0.00469812,
        "cumulative_time": 0.00469812,
        "time_percent": 0.9741185368349442,
        "time_per_call": 9.588e-05
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.003919726,
        "cumulative_time": 0.00396987,
        "time_percent": 0.8231215796584463,
        "time_per_call": 0.0006616450000000001
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 450,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00323294,
        "cumulative_time": 0.003279254,
        "time_percent": 0.6799277388381179,
        "time_per_call": 0.0008198135
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 699,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0028931200000000003,
        "cumulative_time": 0.0030077850000000002,
        "time_percent": 0.6236407591364403,
        "time_per_call": 0.0007519462500000001
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 915,
        "function_name": "_get_quantum_phases",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00257311,
        "cumulative_time": 0.005105514,
        "time_percent": 1.0585885050765675,
        "time_per_call": 0.0012763785
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 974,
        "function_name": "batch_action_to_child",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.002272819,
        "cumulative_time": 0.0024392850000000002,
        "time_percent": 0.505766718415755,
        "time_per_call": 0.0006098212500000001
      },
      {
        "rank": 13,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0019390120000000002,
        "cumulative_time": 0.0019390120000000002,
        "time_percent": 0.4020390139769523,
        "time_per_call": 0.00048475300000000004
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 56,
        "primitive_calls": 56,
        "total_time": 0.000944948,
        "cumulative_time": 0.009246018,
        "time_percent": 1.9170897136960223,
        "time_per_call": 0.0001651074642857143
      },
      {
        "rank": 15,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 9992,
        "primitive_calls": 9992,
        "total_time": 0.0007047300000000001,
        "cumulative_time": 0.0007047300000000001,
        "time_percent": 0.14612026863164207,
        "time_per_call": 7.052942353883107e-08
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 56,
        "primitive_calls": 56,
        "total_time": 0.0006799270000000001,
        "cumulative_time": 0.0006799270000000001,
        "time_percent": 0.1409775600441396,
        "time_per_call": 1.2141553571428573e-05
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0006705120000000001,
        "cumulative_time": 0.0006705120000000001,
        "time_percent": 0.13902543323079702,
        "time_per_call": 0.00033525600000000003
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 56,
        "primitive_calls": 56,
        "total_time": 0.000637683,
        "cumulative_time": 0.000637683,
        "time_percent": 0.13221859614580253,
        "time_per_call": 1.1387196428571428e-05
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 6873,
        "primitive_calls": 6873,
        "total_time": 0.000598241,
        "cumulative_time": 0.000598241,
        "time_percent": 0.12404060509196739,
        "time_per_call": 8.704219409282701e-08
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 214,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00045747,
        "cumulative_time": 0.075173032,
        "time_percent": 15.58654183828562,
        "time_per_call": 0.075173032
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.00044931900000000005,
        "cumulative_time": 0.0006921280000000001,
        "time_percent": 0.14350734222678355,
        "time_per_call": 8.651600000000001e-05
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1100,
        "function_name": "remove_virtual_loss",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000387339,
        "cumulative_time": 0.000490216,
        "time_percent": 0.10164246393303683,
        "time_per_call": 0.000122554
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 24,
        "primitive_calls": 24,
        "total_time": 0.000379163,
        "cumulative_time": 0.000379163,
        "time_percent": 0.0786164905923961,
        "time_per_call": 1.5798458333333333e-05
      },
      {
        "rank": 24,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'to' of 'torch._C.TensorBase' objects>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.00035573800000000003,
        "cumulative_time": 0.00035573800000000003,
        "time_percent": 0.07375949955654376,
        "time_per_call": 3.952644444444445e-05
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 126,
        "function_name": "batch_ucb_selection",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000317293,
        "cumulative_time": 0.0029351620000000003,
        "time_percent": 0.6085829465431979,
        "time_per_call": 0.0007337905000000001
      },
      {
        "rank": 26,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.000314438,
        "cumulative_time": 0.000314438,
        "time_percent": 0.06519626669504103,
        "time_per_call": 1.1229928571428571e-05
      },
      {
        "rank": 27,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.000287828,
        "cumulative_time": 0.071627383,
        "time_percent": 14.85137917406881,
        "time_per_call": 0.0044767114375
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x71c7179d2700>",
        "total_calls": 34,
        "primitive_calls": 34,
        "total_time": 0.000273498,
        "cumulative_time": 0.000273498,
        "time_percent": 0.0567076770255514,
        "time_per_call": 8.044058823529413e-06
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 2185,
        "primitive_calls": 2185,
        "total_time": 0.000261482,
        "cumulative_time": 0.000261482,
        "time_percent": 0.05421625314991419,
        "time_per_call": 1.1967139588100687e-07
      },
      {
        "rank": 30,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1095,
        "function_name": "apply_virtual_loss",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00024433500000000004,
        "cumulative_time": 0.00024433500000000004,
        "time_percent": 0.0506609564458903,
        "time_per_call": 6.108375000000001e-05
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.000191389,
        "cumulative_time": 0.000191389,
        "time_percent": 0.03968301632276382,
        "time_per_call": 2.3923625e-05
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 2237,
        "primitive_calls": 2237,
        "total_time": 0.000178366,
        "cumulative_time": 0.000385457,
        "time_percent": 0.07992150239942511,
        "time_per_call": 1.7230978989718374e-07
      },
      {
        "rank": 33,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 147,
        "primitive_calls": 147,
        "total_time": 0.000177331,
        "cumulative_time": 0.001445419,
        "time_percent": 0.29969635543439255,
        "time_per_call": 9.832782312925171e-06
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 20,
        "primitive_calls": 20,
        "total_time": 0.000168061,
        "cumulative_time": 0.000168061,
        "time_percent": 0.03484613748031501,
        "time_per_call": 8.40305e-06
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.00016771100000000002,
        "cumulative_time": 0.000228657,
        "time_percent": 0.047410245433719835,
        "time_per_call": 2.8582125e-05
      },
      {
        "rank": 36,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 49,
        "primitive_calls": 49,
        "total_time": 0.000163704,
        "cumulative_time": 0.007276308,
        "time_percent": 1.5086857088623533,
        "time_per_call": 0.00014849608163265308
      },
      {
        "rank": 37,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 791,
        "function_name": "_add_dirichlet_noise_to_root",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000160586,
        "cumulative_time": 0.00164893,
        "time_percent": 0.3418927739059974,
        "time_per_call": 0.00164893
      },
      {
        "rank": 38,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 40,
        "primitive_calls": 40,
        "total_time": 0.00015962000000000002,
        "cumulative_time": 0.007097497,
        "time_percent": 1.471610642731647,
        "time_per_call": 0.000177437425
      },
      {
        "rank": 39,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 115,
        "primitive_calls": 115,
        "total_time": 0.00015262400000000002,
        "cumulative_time": 0.000248943,
        "time_percent": 0.05161638930365795,
        "time_per_call": 2.164721739130435e-06
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 26,
        "primitive_calls": 26,
        "total_time": 0.000149185,
        "cumulative_time": 0.000149185,
        "time_percent": 0.030932346112428195,
        "time_per_call": 5.737884615384615e-06
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.00014138400000000001,
        "cumulative_time": 0.00014138400000000001,
        "time_percent": 0.029314869609944352,
        "time_per_call": 1.7673000000000002e-05
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.00013641100000000002,
        "cumulative_time": 0.00013641100000000002,
        "time_percent": 0.028283756849163406,
        "time_per_call": 1.1367583333333334e-05
      },
      {
        "rank": 43,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 770,
        "function_name": "_get_device_attr",
        "total_calls": 115,
        "primitive_calls": 115,
        "total_time": 0.00013275300000000002,
        "cumulative_time": 0.0009893970000000001,
        "time_percent": 0.20514375068939988,
        "time_per_call": 8.603452173913046e-06
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.000127009,
        "cumulative_time": 0.000127009,
        "time_percent": 0.026334325484421307,
        "time_per_call": 5.08036e-06
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00011914,
        "cumulative_time": 0.00011914,
        "time_percent": 0.02470274971233499,
        "time_per_call": 2.9785e-05
      },
      {
        "rank": 46,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 812,
        "function_name": "_get_device_index",
        "total_calls": 115,
        "primitive_calls": 115,
        "total_time": 0.00011750800000000001,
        "cumulative_time": 0.001201432,
        "time_percent": 0.24910755407411492,
        "time_per_call": 1.0447234782608697e-05
      },
      {
        "rank": 47,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 49,
        "primitive_calls": 49,
        "total_time": 0.000108442,
        "cumulative_time": 0.000207091,
        "time_percent": 0.042938703547735144,
        "time_per_call": 4.226346938775511e-06
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.000107829,
        "cumulative_time": 0.000107829,
        "time_percent": 0.02235750208772343,
        "time_per_call": 8.98575e-06
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'split' of 'bytes' objects>",
        "total_calls": 441,
        "primitive_calls": 441,
        "total_time": 0.000100814,
        "cumulative_time": 0.000100814,
        "time_percent": 0.020902996554468183,
        "time_per_call": 2.286031746031746e-07
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method __new__ of type object at 0xa43b40>",
        "total_calls": 96,
        "primitive_calls": 96,
        "total_time": 9.7726e-05,
        "cumulative_time": 9.7726e-05,
        "time_percent": 0.020262723840755826,
        "time_per_call": 1.0179791666666667e-06
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": true,
      "quantum_config": "QuantumConfig(quantum_level='one_loop', min_wave_size=3072, optimal_wave_size=3072, hbar_eff=0.1, temperature=1.0, coupling_strength=0.1, decoherence_rate=0.01, measurement_noise=0.0, path_integral_steps=10, path_integral_beta=1.0, use_wick_rotation=True, interference_alpha=0.05, interference_method='minhash', minhash_size=64, phase_kick_strength=0.1, use_mixed_precision=True, cache_corrections=True, fast_mode=True, enable_quantum=True, uncertainty_decay=0.99, phase_temperature=1.0, device='cuda')",
      "enable_virtual_loss": true,
      "virtual_loss_value": -3.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "one_loop",
    "num_simulations": 10000,
    "wave_size": 3072,
    "total_time_ms": 79.28020800318336,
    "simulations_per_second": 126134.88601844318,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 8.125856399536133,
        "cpu_time_ms": 8.617405001132283,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7466239929199219,
        "cpu_time_ms": 0.992398003290873,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9721279740333557,
        "cpu_time_ms": 1.1689860039041378,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 5.611519813537598,
        "cpu_time_ms": 5.712174002837855,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.088576316833496,
        "cpu_time_ms": 8.146919004502706,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8484479784965515,
        "cpu_time_ms": 1.0597170039545745,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9768639802932739,
        "cpu_time_ms": 1.1823810054920614,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.546239852905273,
        "cpu_time_ms": 4.659867998270784,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.34716796875,
        "cpu_time_ms": 8.39858700055629,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8030080199241638,
        "cpu_time_ms": 1.076102998922579,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9827520251274109,
        "cpu_time_ms": 1.174082004581578,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.36246395111084,
        "cpu_time_ms": 4.491888001211919,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 7.9456000328063965,
        "cpu_time_ms": 8.425056999840308,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8267520070075989,
        "cpu_time_ms": 1.0513309971429408,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.6881920099258423,
        "cpu_time_ms": 1.9165100020472892,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "backup",
        "gpu_time_ms": 7.83135986328125,
        "cpu_time_ms": 7.825008993677329,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      }
    ],
    "peak_gpu_memory_mb": 2850.1552734375,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 187.3,
    "avg_ram_usage_mb": 1218.78515625,
    "final_tree_nodes": 9,
    "final_tree_edges": 8,
    "tree_memory_mb": 50.92288589477539,
    "efficiency_score": 45317.57426924557,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Consider using classical selection for hot paths",
      "One-loop quantum is a good balance - monitor overhead",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 80,
    "total_kernel_calls": 124,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         36360 function calls (27304 primitive calls) in 0.078 seconds\n\n   Ordered by: cumulative time\n   List reduced from 175 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.001    0.001    0.076    0.076 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:214(search)\n        4    0.000    0.000    0.072    0.018 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:296(_run_search_wave_vectorized)\n       16    0.000    0.000    0.072    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:394(_profile_phase)\n        4    0.000    0.000    0.035    0.009 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:369(instrumented_select)\n        4    0.000    0.000    0.024    0.006 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:378(instrumented_backup)\n        4    0.008    0.002    0.023    0.006 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:320(_select_batch_vectorized)\n        4    0.014    0.004    0.020    0.005 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:747(_backup_batch_vectorized)\n       56    0.001    0.000    0.009    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        7    0.004    0.001    0.009    0.001 {built-in method time.sleep}\n       40    0.000    0.000    0.007    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        4    0.000    0.000    0.007    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:375(instrumented_evaluate)\n       49    0.000    0.000    0.007    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n  9016/56    0.005    0.000    0.007    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        4    0.007    0.002    0.007    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n       16    0.006    0.000    0.006    0.000 {built-in method torch.where}\n        4    0.000    0.000    0.006    0.001 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:372(instrumented_expand)\n       34    0.000    0.000    0.005    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:196(timer)\n        4    0.003    0.001    0.005    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:915(_get_quantum_phases)\n       49    0.005    0.000    0.005    0.000 {built-in method torch._C._cuda_synchronize}\n       17    0.000    0.000    0.005    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       17    0.000    0.000    0.004    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:178(end_timer)\n        4    0.003    0.001    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:699(_evaluate_batch_vectorized)\n        4    0.003    0.001    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:450(_expand_batch_vectorized)\n        4    0.000    0.000    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n        4    0.000    0.000    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:126(batch_ucb_selection)\n       16    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        6    0.002    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n        4    0.000    0.000    0.002    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n      8/4    0.000    0.000    0.002    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        4    0.000    0.000    0.002    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        4    0.000    0.000    0.002    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n        4    0.002    0.001    0.002    0.001 {built-in method torch._unique2}\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:845(_extract_policy)\n        4    0.002    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:974(batch_action_to_child)\n      147    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n    24/16    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n       16    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n      115    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:791(_add_dirichlet_noise_to_root)\n        8    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n       56    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n      115    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n      115    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n       34    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n        8    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n       24    0.001    0.000    0.001    0.000 {built-in method _io.open}\n     9992    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}\n        8    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n       56    0.001    0.000    0.001    0.000 {method 'sort' of 'list' objects}\n       49    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:490(__init__)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 747,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.014458765,
        "cumulative_time": 0.019643153,
        "time_percent": 4.156767422505898,
        "time_per_call": 0.00491078825
      },
      {
        "rank": 2,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 320,
        "function_name": "_select_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.007596579000000001,
        "cumulative_time": 0.022565693,
        "time_percent": 4.775217987085342,
        "time_per_call": 0.00564142325
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.006518302,
        "cumulative_time": 0.006616185,
        "time_percent": 1.4000777914458125,
        "time_per_call": 0.00165404625
      },
      {
        "rank": 4,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.006049507,
        "cumulative_time": 0.006049507,
        "time_percent": 1.280160757278701,
        "time_per_call": 0.0003780941875
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 56,
        "primitive_calls": 9016,
        "total_time": 0.005119904000000001,
        "cumulative_time": 0.006757975,
        "time_percent": 1.430082549482219,
        "time_per_call": 0.000120678125
      },
      {
        "rank": 6,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 49,
        "primitive_calls": 49,
        "total_time": 0.00467545,
        "cumulative_time": 0.00467545,
        "time_percent": 0.9893909722922386,
        "time_per_call": 9.541734693877552e-05
      },
      {
        "rank": 7,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.004227102,
        "cumulative_time": 0.009158053000000001,
        "time_percent": 1.9379728073177667,
        "time_per_call": 0.0013082932857142859
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 450,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0029285580000000004,
        "cumulative_time": 0.003007399,
        "time_percent": 0.6364079223776761,
        "time_per_call": 0.00075184975
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 699,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.002870451,
        "cumulative_time": 0.0030284250000000004,
        "time_percent": 0.640857319672785,
        "time_per_call": 0.0007571062500000001
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 915,
        "function_name": "_get_quantum_phases",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.002724648,
        "cumulative_time": 0.0048381480000000004,
        "time_percent": 1.0238201571642835,
        "time_per_call": 0.0012095370000000001
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.00243675,
        "cumulative_time": 0.002478961,
        "time_percent": 0.5245830099914532,
        "time_per_call": 0.00041316016666666667
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.002265712,
        "cumulative_time": 0.002265712,
        "time_percent": 0.47945652260513794,
        "time_per_call": 0.000566428
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 974,
        "function_name": "batch_action_to_child",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0016810150000000001,
        "cumulative_time": 0.0018042590000000001,
        "time_percent": 0.38180657824958497,
        "time_per_call": 0.00045106475000000003
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 214,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0009982460000000002,
        "cumulative_time": 0.076455249,
        "time_percent": 16.179005902096097,
        "time_per_call": 0.076455249
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 56,
        "primitive_calls": 56,
        "total_time": 0.000944114,
        "cumulative_time": 0.009400139,
        "time_percent": 1.9892016094476876,
        "time_per_call": 0.000167859625
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 9992,
        "primitive_calls": 9992,
        "total_time": 0.000731208,
        "cumulative_time": 0.000731208,
        "time_percent": 0.1547338960031362,
        "time_per_call": 7.317934347477983e-08
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 56,
        "primitive_calls": 56,
        "total_time": 0.000646196,
        "cumulative_time": 0.000646196,
        "time_percent": 0.13674416125321742,
        "time_per_call": 1.1539214285714286e-05
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 24,
        "primitive_calls": 24,
        "total_time": 0.0006398490000000001,
        "cumulative_time": 0.000737441,
        "time_percent": 0.15605288645973342,
        "time_per_call": 3.072670833333334e-05
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 56,
        "primitive_calls": 56,
        "total_time": 0.000620036,
        "cumulative_time": 0.000620036,
        "time_percent": 0.1312083373570866,
        "time_per_call": 1.1072071428571428e-05
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 6873,
        "primitive_calls": 6873,
        "total_time": 0.000611112,
        "cumulative_time": 0.000611112,
        "time_percent": 0.12931989345612818,
        "time_per_call": 8.891488432998691e-08
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1100,
        "function_name": "remove_virtual_loss",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00036470700000000003,
        "cumulative_time": 0.000445946,
        "time_percent": 0.09436844507583968,
        "time_per_call": 0.0001114865
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.00036339600000000004,
        "cumulative_time": 0.00036339600000000004,
        "time_percent": 0.07689970414978459,
        "time_per_call": 1.2978428571428573e-05
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 0,
        "primitive_calls": 7,
        "total_time": 0.000333341,
        "cumulative_time": 0.0,
        "time_percent": 0.0,
        "time_per_call": 0
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 126,
        "function_name": "batch_ucb_selection",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000318168,
        "cumulative_time": 0.002797005,
        "time_percent": 0.5918855931421045,
        "time_per_call": 0.00069925125
      },
      {
        "rank": 25,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'to' of 'torch._C.TensorBase' objects>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.000268371,
        "cumulative_time": 0.000268371,
        "time_percent": 0.05679107778396525,
        "time_per_call": 2.9819e-05
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.000267844,
        "cumulative_time": 0.07217685700000001,
        "time_percent": 15.27363798655271,
        "time_per_call": 0.004511053562500001
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 2185,
        "primitive_calls": 2185,
        "total_time": 0.000259441,
        "cumulative_time": 0.000259441,
        "time_percent": 0.05490136419862701,
        "time_per_call": 1.1873729977116705e-07
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 24,
        "primitive_calls": 24,
        "total_time": 0.00021548200000000002,
        "cumulative_time": 0.00021548200000000002,
        "time_percent": 0.04559902158968145,
        "time_per_call": 8.978416666666667e-06
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.00021515100000000001,
        "cumulative_time": 0.00021515100000000001,
        "time_percent": 0.04552897733472659,
        "time_per_call": 2.6893875000000002e-05
      },
      {
        "rank": 30,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1095,
        "function_name": "apply_virtual_loss",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000201196,
        "cumulative_time": 0.000201196,
        "time_percent": 0.04257590308126688,
        "time_per_call": 5.0299e-05
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x71c7179d2700>",
        "total_calls": 34,
        "primitive_calls": 34,
        "total_time": 0.00019674900000000002,
        "cumulative_time": 0.00019674900000000002,
        "time_percent": 0.0416348553417373,
        "time_per_call": 5.786735294117648e-06
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 2237,
        "primitive_calls": 2237,
        "total_time": 0.00018946000000000002,
        "cumulative_time": 0.00043092900000000003,
        "time_percent": 0.09119063668714714,
        "time_per_call": 1.9263701385784535e-07
      },
      {
        "rank": 33,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 147,
        "primitive_calls": 147,
        "total_time": 0.000173859,
        "cumulative_time": 0.001378122,
        "time_percent": 0.2916299961538086,
        "time_per_call": 9.374979591836735e-06
      },
      {
        "rank": 34,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 40,
        "primitive_calls": 40,
        "total_time": 0.000172148,
        "cumulative_time": 0.007127237000000001,
        "time_percent": 1.508223581727367,
        "time_per_call": 0.00017818092500000002
      },
      {
        "rank": 35,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 791,
        "function_name": "_add_dirichlet_noise_to_root",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000169941,
        "cumulative_time": 0.0011286010000000001,
        "time_percent": 0.23882784346319452,
        "time_per_call": 0.0011286010000000001
      },
      {
        "rank": 36,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 49,
        "primitive_calls": 49,
        "total_time": 0.00015405800000000002,
        "cumulative_time": 0.0068372220000000004,
        "time_percent": 1.4468523291571687,
        "time_per_call": 0.00013953514285714287
      },
      {
        "rank": 37,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 115,
        "primitive_calls": 115,
        "total_time": 0.00014903100000000002,
        "cumulative_time": 0.000244828,
        "time_percent": 0.0518090478915108,
        "time_per_call": 2.1289391304347824e-06
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.000148691,
        "cumulative_time": 0.000148691,
        "time_percent": 0.03146510668729326,
        "time_per_call": 1.8586375e-05
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 26,
        "primitive_calls": 26,
        "total_time": 0.00014452100000000002,
        "cumulative_time": 0.00014452100000000002,
        "time_percent": 0.030582676043299922,
        "time_per_call": 5.558500000000001e-06
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.000136515,
        "cumulative_time": 0.000136515,
        "time_percent": 0.028888493852458043,
        "time_per_call": 1.137625e-05
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.000136185,
        "cumulative_time": 0.000136185,
        "time_percent": 0.028818661211566482,
        "time_per_call": 1.7023125e-05
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 20,
        "primitive_calls": 20,
        "total_time": 0.00012688,
        "cumulative_time": 0.00012688,
        "time_percent": 0.026849592352487833,
        "time_per_call": 6.344000000000001e-06
      },
      {
        "rank": 43,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 812,
        "function_name": "_get_device_index",
        "total_calls": 115,
        "primitive_calls": 115,
        "total_time": 0.00011038700000000001,
        "cumulative_time": 0.001138757,
        "time_percent": 0.24097699589014804,
        "time_per_call": 9.902234782608697e-06
      },
      {
        "rank": 44,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 49,
        "primitive_calls": 49,
        "total_time": 0.000108645,
        "cumulative_time": 0.00024146900000000002,
        "time_percent": 0.05109823625286006,
        "time_per_call": 4.927938775510205e-06
      },
      {
        "rank": 45,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 770,
        "function_name": "_get_device_attr",
        "total_calls": 115,
        "primitive_calls": 115,
        "total_time": 0.00010725,
        "cumulative_time": 0.0009333750000000001,
        "time_percent": 0.19751527633987492,
        "time_per_call": 8.116304347826087e-06
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.000102767,
        "cumulative_time": 0.000102767,
        "time_percent": 0.021746942443947957,
        "time_per_call": 8.563916666666666e-06
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method __new__ of type object at 0xa43b40>",
        "total_calls": 96,
        "primitive_calls": 96,
        "total_time": 9.9295e-05,
        "cumulative_time": 9.9295e-05,
        "time_percent": 0.021012218416143435,
        "time_per_call": 1.0343229166666667e-06
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'split' of 'bytes' objects>",
        "total_calls": 441,
        "primitive_calls": 441,
        "total_time": 9.7792e-05,
        "cumulative_time": 9.7792e-05,
        "time_percent": 0.020694162478991883,
        "time_per_call": 2.2175056689342404e-07
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._get_tracing_state>",
        "total_calls": 49,
        "primitive_calls": 49,
        "total_time": 9.623900000000001e-05,
        "cumulative_time": 9.623900000000001e-05,
        "time_percent": 0.02036552583867494,
        "time_per_call": 1.9640612244897963e-06
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method mcts.gpu.unified_cuda_kernels.batched_ucb_selection_quantum>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 9.4813e-05,
        "cumulative_time": 9.4813e-05,
        "time_percent": 0.02006376418439808,
        "time_per_call": 2.370325e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -3.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "classical",
    "num_simulations": 25000,
    "wave_size": 3072,
    "total_time_ms": 149.78769200388342,
    "simulations_per_second": 166902.8987999351,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 5.965856075286865,
        "cpu_time_ms": 6.508420003228821,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8451840281486511,
        "cpu_time_ms": 1.805485000659246,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9739840030670166,
        "cpu_time_ms": 1.2537700022221543,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.333631992340088,
        "cpu_time_ms": 4.5873060007579625,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 6.430943965911865,
        "cpu_time_ms": 6.8165260017849505,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.1080000400543213,
        "cpu_time_ms": 1.4418140053749084,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1862399578094482,
        "cpu_time_ms": 1.5324029955081642,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.503647804260254,
        "cpu_time_ms": 4.7780250024516135,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 5.898975849151611,
        "cpu_time_ms": 6.270158002735116,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7655680179595947,
        "cpu_time_ms": 1.0246249948977493,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9519360065460205,
        "cpu_time_ms": 1.8380620022071525,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.343808174133301,
        "cpu_time_ms": 4.592785997374449,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 6.322495937347412,
        "cpu_time_ms": 6.718646996887401,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7357119917869568,
        "cpu_time_ms": 0.967013998888433,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9392639994621277,
        "cpu_time_ms": 1.1891820031451061,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.064576148986816,
        "cpu_time_ms": 4.365571003290825,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 6.569952011108398,
        "cpu_time_ms": 7.916414993815124,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7387840151786804,
        "cpu_time_ms": 0.973490001342725,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9269760251045227,
        "cpu_time_ms": 1.1910019966308028,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.59878396987915,
        "cpu_time_ms": 5.051398002251517,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 6.795072078704834,
        "cpu_time_ms": 7.2244449984282255,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7483839988708496,
        "cpu_time_ms": 0.9828399997786619,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.251744031906128,
        "cpu_time_ms": 1.546548999613151,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.836575984954834,
        "cpu_time_ms": 5.157037994649727,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 6.108543872833252,
        "cpu_time_ms": 6.830631995399017,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7519999742507935,
        "cpu_time_ms": 0.9976799992728047,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.101151943206787,
        "cpu_time_ms": 1.4355910025187768,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.773888111114502,
        "cpu_time_ms": 5.040809999627527,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 6.516992092132568,
        "cpu_time_ms": 6.911630000104196,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.929535984992981,
        "cpu_time_ms": 1.2091899989172816,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0323200225830078,
        "cpu_time_ms": 1.2827969985664822,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.154463768005371,
        "cpu_time_ms": 4.428356995049398,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 6.685535907745361,
        "cpu_time_ms": 7.047300998237915,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7522240281105042,
        "cpu_time_ms": 0.9844980013440363,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9272000193595886,
        "cpu_time_ms": 1.1574509990168735,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.990975856781006,
        "cpu_time_ms": 5.2575000008801,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      }
    ],
    "peak_gpu_memory_mb": 2849.39111328125,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 185.0,
    "avg_ram_usage_mb": 1218.97265625,
    "final_tree_nodes": 9,
    "final_tree_edges": 8,
    "tree_memory_mb": 50.92288589477539,
    "efficiency_score": 59980.73327824826,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 88,
    "total_kernel_calls": 162,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         74450 function calls (56187 primitive calls) in 0.148 seconds\n\n   Ordered by: cumulative time\n   List reduced from 167 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.002    0.002    0.147    0.147 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:214(search)\n       36    0.001    0.000    0.143    0.004 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:394(_profile_phase)\n        9    0.000    0.000    0.143    0.016 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:296(_run_search_wave_vectorized)\n        9    0.000    0.000    0.064    0.007 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:369(instrumented_select)\n        9    0.018    0.002    0.045    0.005 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:320(_select_batch_vectorized)\n        9    0.000    0.000    0.042    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:378(instrumented_backup)\n        9    0.022    0.002    0.032    0.004 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:747(_backup_batch_vectorized)\n        9    0.000    0.000    0.020    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:372(instrumented_expand)\n      114    0.002    0.000    0.019    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       13    0.008    0.001    0.017    0.001 {built-in method time.sleep}\n        9    0.000    0.000    0.017    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:375(instrumented_evaluate)\n       86    0.000    0.000    0.015    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        9    0.014    0.002    0.014    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n18354/114    0.011    0.000    0.014    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n      109    0.000    0.000    0.012    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n      109    0.010    0.000    0.010    0.000 {built-in method torch._C._cuda_synchronize}\n       27    0.009    0.000    0.009    0.000 {built-in method torch.where}\n       74    0.000    0.000    0.009    0.000 {built-in method builtins.next}\n       74    0.000    0.000    0.009    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:196(timer)\n        9    0.007    0.001    0.009    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:699(_evaluate_batch_vectorized)\n       37    0.000    0.000    0.008    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n        9    0.007    0.001    0.008    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:450(_expand_batch_vectorized)\n       37    0.000    0.000    0.008    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:178(end_timer)\n        9    0.000    0.000    0.007    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n        9    0.001    0.000    0.007    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:126(batch_ucb_selection)\n       11    0.006    0.001    0.006    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n        9    0.000    0.000    0.005    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n     18/9    0.000    0.000    0.005    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        9    0.000    0.000    0.005    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        9    0.000    0.000    0.005    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n        9    0.004    0.000    0.005    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:974(batch_action_to_child)\n       28    0.000    0.000    0.005    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        9    0.005    0.001    0.005    0.001 {built-in method torch._unique2}\n      311    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n      255    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n       28    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n    42/28    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n      114    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n      255    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n      255    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n       14    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n       14    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n       74    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n       14    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n    20504    0.002    0.000    0.002    0.000 {built-in method builtins.isinstance}\n      109    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:490(__init__)\n       14    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1113(memory_info)\n      114    0.001    0.000    0.001    0.000 {method 'sort' of 'list' objects}\n      255    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:753(_get_available_device_type)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:845(_extract_policy)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 747,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.021675531,
        "cumulative_time": 0.032425253,
        "time_percent": 3.4636020521856685,
        "time_per_call": 0.003602805888888889
      },
      {
        "rank": 2,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 320,
        "function_name": "_select_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.017729835000000003,
        "cumulative_time": 0.045190244000000004,
        "time_percent": 4.827133403004477,
        "time_per_call": 0.005021138222222223
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.014082553000000001,
        "cumulative_time": 0.014268004,
        "time_percent": 1.52408025729185,
        "time_per_call": 0.001585333777777778
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 114,
        "primitive_calls": 18354,
        "total_time": 0.010520408,
        "cumulative_time": 0.013913729000000001,
        "time_percent": 1.4862372952943574,
        "time_per_call": 0.00012205025438596493
      },
      {
        "rank": 5,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 109,
        "primitive_calls": 109,
        "total_time": 0.009622093,
        "cumulative_time": 0.009622093,
        "time_percent": 1.027813138763215,
        "time_per_call": 8.827608256880733e-05
      },
      {
        "rank": 6,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 0.009225968000000001,
        "cumulative_time": 0.009225968000000001,
        "time_percent": 0.9854998416881838,
        "time_per_call": 0.0003417025185185186
      },
      {
        "rank": 7,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.008468287,
        "cumulative_time": 0.017446713000000003,
        "time_percent": 1.8636237302664802,
        "time_per_call": 0.0013420548461538463
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 699,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0072534340000000004,
        "cumulative_time": 0.008814329000000001,
        "time_percent": 0.9415293695022102,
        "time_per_call": 0.000979369888888889
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 450,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.007074475,
        "cumulative_time": 0.007771544000000001,
        "time_percent": 0.8301411170809129,
        "time_per_call": 0.000863504888888889
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.005957148000000001,
        "cumulative_time": 0.006041014000000001,
        "time_percent": 0.645289290038303,
        "time_per_call": 0.000549183090909091
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.004514071000000001,
        "cumulative_time": 0.004514071000000001,
        "time_percent": 0.48218422780885667,
        "time_per_call": 0.0005015634444444445
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 974,
        "function_name": "batch_action_to_child",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.004411087,
        "cumulative_time": 0.0047572510000000005,
        "time_percent": 0.508160239377695,
        "time_per_call": 0.0005285834444444445
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 214,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.002020862,
        "cumulative_time": 0.147048552,
        "time_percent": 15.707438473282876,
        "time_per_call": 0.147048552
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 114,
        "primitive_calls": 114,
        "total_time": 0.001876604,
        "cumulative_time": 0.019417203,
        "time_percent": 2.074107614781162,
        "time_per_call": 0.00017032634210526317
      },
      {
        "rank": 15,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 20504,
        "primitive_calls": 20504,
        "total_time": 0.001587234,
        "cumulative_time": 0.001587234,
        "time_percent": 0.169545228828249,
        "time_per_call": 7.741094420600859e-08
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 114,
        "primitive_calls": 114,
        "total_time": 0.0013831540000000002,
        "cumulative_time": 0.0013831540000000002,
        "time_percent": 0.1477458027201458,
        "time_per_call": 1.2132929824561405e-05
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 13995,
        "primitive_calls": 13995,
        "total_time": 0.001277513,
        "cumulative_time": 0.001277513,
        "time_percent": 0.13646143789514517,
        "time_per_call": 9.128352983208289e-08
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 114,
        "primitive_calls": 114,
        "total_time": 0.001265826,
        "cumulative_time": 0.001265826,
        "time_percent": 0.135213055432751,
        "time_per_call": 1.1103736842105264e-05
      },
      {
        "rank": 19,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1100,
        "function_name": "remove_virtual_loss",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.000839096,
        "cumulative_time": 0.0010108130000000002,
        "time_percent": 0.10797306596731727,
        "time_per_call": 0.00011231255555555557
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.000775243,
        "cumulative_time": 0.001223106,
        "time_percent": 0.1306497886582598,
        "time_per_call": 8.736471428571429e-05
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 63,
        "primitive_calls": 63,
        "total_time": 0.0007524960000000001,
        "cumulative_time": 0.0007524960000000001,
        "time_percent": 0.08038014968954928,
        "time_per_call": 1.1944380952380953e-05
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 42,
        "primitive_calls": 42,
        "total_time": 0.000729013,
        "cumulative_time": 0.000729013,
        "time_percent": 0.07787174159813127,
        "time_per_call": 1.7357452380952383e-05
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 126,
        "function_name": "batch_ucb_selection",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.000682821,
        "cumulative_time": 0.006792698000000001,
        "time_percent": 0.7255827034773634,
        "time_per_call": 0.0007547442222222223
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 36,
        "primitive_calls": 36,
        "total_time": 0.000648144,
        "cumulative_time": 0.14349277900000001,
        "time_percent": 15.327617761940813,
        "time_per_call": 0.003985910527777779
      },
      {
        "rank": 25,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000632864,
        "cumulative_time": 0.000632864,
        "time_percent": 0.06760129363229427,
        "time_per_call": 0.000316432
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1095,
        "function_name": "apply_virtual_loss",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0005131350000000001,
        "cumulative_time": 0.0005131350000000001,
        "time_percent": 0.05481207622491929,
        "time_per_call": 5.701500000000001e-05
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 4447,
        "primitive_calls": 4447,
        "total_time": 0.00045581,
        "cumulative_time": 0.00045581,
        "time_percent": 0.04868873194009464,
        "time_per_call": 1.024983134697549e-07
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x71c7179d2700>",
        "total_calls": 74,
        "primitive_calls": 74,
        "total_time": 0.000443449,
        "cumulative_time": 0.000443449,
        "time_percent": 0.047368354117072964,
        "time_per_call": 5.992554054054054e-06
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 4559,
        "primitive_calls": 4559,
        "total_time": 0.000415459,
        "cumulative_time": 0.0008548150000000001,
        "time_percent": 0.09130966497745113,
        "time_per_call": 1.8750054836586972e-07
      },
      {
        "rank": 30,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 311,
        "primitive_calls": 311,
        "total_time": 0.00040114400000000003,
        "cumulative_time": 0.003073058,
        "time_percent": 0.32825803996920505,
        "time_per_call": 9.881215434083602e-06
      },
      {
        "rank": 31,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 86,
        "primitive_calls": 86,
        "total_time": 0.000350804,
        "cumulative_time": 0.015334232000000001,
        "time_percent": 1.6379726450828662,
        "time_per_call": 0.00017830502325581396
      },
      {
        "rank": 32,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 255,
        "primitive_calls": 255,
        "total_time": 0.00034129200000000004,
        "cumulative_time": 0.0005488860000000001,
        "time_percent": 0.0586309280614089,
        "time_per_call": 2.152494117647059e-06
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 45,
        "primitive_calls": 45,
        "total_time": 0.00033943,
        "cumulative_time": 0.000451031,
        "time_percent": 0.048178248515111176,
        "time_per_call": 1.002291111111111e-05
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 0.00033292500000000003,
        "cumulative_time": 0.00033292500000000003,
        "time_percent": 0.03556239679067157,
        "time_per_call": 1.2330555555555556e-05
      },
      {
        "rank": 35,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 109,
        "primitive_calls": 109,
        "total_time": 0.000301782,
        "cumulative_time": 0.011705032,
        "time_percent": 1.2503086053360608,
        "time_per_call": 0.00010738561467889909
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 43,
        "primitive_calls": 43,
        "total_time": 0.00030111300000000004,
        "cumulative_time": 0.00030111300000000004,
        "time_percent": 0.03216430122348724,
        "time_per_call": 7.002627906976745e-06
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.00028911700000000003,
        "cumulative_time": 0.00028911700000000003,
        "time_percent": 0.03088291198596859,
        "time_per_call": 2.0651214285714287e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 0.00024788,
        "cumulative_time": 0.00024788,
        "time_percent": 0.02647805636846638,
        "time_per_call": 9.180740740740742e-06
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 812,
        "function_name": "_get_device_index",
        "total_calls": 255,
        "primitive_calls": 255,
        "total_time": 0.00024537100000000003,
        "cumulative_time": 0.002524524,
        "time_percent": 0.2696647118587471,
        "time_per_call": 9.90009411764706e-06
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.000240718,
        "cumulative_time": 0.000240718,
        "time_percent": 0.025713025548267262,
        "time_per_call": 1.7194142857142858e-05
      },
      {
        "rank": 41,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 770,
        "function_name": "_get_device_attr",
        "total_calls": 255,
        "primitive_calls": 255,
        "total_time": 0.00024042300000000003,
        "cumulative_time": 0.002070829,
        "time_percent": 0.221201900078485,
        "time_per_call": 8.120898039215687e-06
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method __new__ of type object at 0xa43b40>",
        "total_calls": 199,
        "primitive_calls": 199,
        "total_time": 0.000238253,
        "cumulative_time": 0.000238253,
        "time_percent": 0.02544971907356874,
        "time_per_call": 1.1972512562814072e-06
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'to' of 'torch._C.TensorBase' objects>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00023011100000000002,
        "cumulative_time": 0.00023011100000000002,
        "time_percent": 0.024580006571745066,
        "time_per_call": 0.00023011100000000002
      },
      {
        "rank": 44,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 104,
        "primitive_calls": 104,
        "total_time": 0.000229404,
        "cumulative_time": 0.000439356,
        "time_percent": 0.0469311478692267,
        "time_per_call": 4.224576923076923e-06
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.00020280300000000002,
        "cumulative_time": 0.00020280300000000002,
        "time_percent": 0.021663019467863833,
        "time_per_call": 1.1266833333333334e-05
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'split' of 'bytes' objects>",
        "total_calls": 771,
        "primitive_calls": 771,
        "total_time": 0.000197239,
        "cumulative_time": 0.000197239,
        "time_percent": 0.021068683879538242,
        "time_per_call": 2.55822308690013e-07
      },
      {
        "rank": 47,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1056,
        "function_name": "current_stream",
        "total_calls": 74,
        "primitive_calls": 74,
        "total_time": 0.00019326800000000002,
        "cumulative_time": 0.00130948,
        "time_percent": 0.13987609025891298,
        "time_per_call": 1.7695675675675677e-05
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.00018695700000000002,
        "cumulative_time": 0.00018695700000000002,
        "time_percent": 0.01997038076682011,
        "time_per_call": 2.0773000000000003e-05
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'scatter_add_' of 'torch._C.TensorBase' objects>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.00017959100000000002,
        "cumulative_time": 0.00017959100000000002,
        "time_percent": 0.019183559065956292,
        "time_per_call": 9.977277777777779e-06
      },
      {
        "rank": 50,
        "filename": "<frozen _collections_abc>",
        "line_number": 804,
        "function_name": "get",
        "total_calls": 255,
        "primitive_calls": 255,
        "total_time": 0.000177249,
        "cumulative_time": 0.000726135,
        "time_percent": 0.07756431927189096,
        "time_per_call": 2.8475882352941176e-06
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": true,
      "quantum_config": "QuantumConfig(quantum_level='tree_level', min_wave_size=3072, optimal_wave_size=3072, hbar_eff=0.1, temperature=1.0, coupling_strength=0.1, decoherence_rate=0.01, measurement_noise=0.0, path_integral_steps=10, path_integral_beta=1.0, use_wick_rotation=True, interference_alpha=0.05, interference_method='minhash', minhash_size=64, phase_kick_strength=0.1, use_mixed_precision=True, cache_corrections=True, fast_mode=True, enable_quantum=True, uncertainty_decay=0.99, phase_temperature=1.0, device='cuda')",
      "enable_virtual_loss": true,
      "virtual_loss_value": -3.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "tree_level",
    "num_simulations": 25000,
    "wave_size": 3072,
    "total_time_ms": 160.475177995977,
    "simulations_per_second": 155787.33304553016,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 8.457216262817383,
        "cpu_time_ms": 8.970426999439951,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7728000283241272,
        "cpu_time_ms": 1.061577997461427,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9431040287017822,
        "cpu_time_ms": 1.2057269996148534,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.035615921020508,
        "cpu_time_ms": 4.30919999780599,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.379167556762695,
        "cpu_time_ms": 8.752050001930911,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7256640195846558,
        "cpu_time_ms": 0.9927430000971071,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9795519709587097,
        "cpu_time_ms": 1.2786389997927472,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 5.007391929626465,
        "cpu_time_ms": 5.287486994348001,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 9.000639915466309,
        "cpu_time_ms": 9.42212100198958,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7863680124282837,
        "cpu_time_ms": 1.083839000784792,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9547200202941895,
        "cpu_time_ms": 1.2300480011617765,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.915552139282227,
        "cpu_time_ms": 5.171146003704052,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 7.452000141143799,
        "cpu_time_ms": 7.934736997412983,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.159551978111267,
        "cpu_time_ms": 1.4377460029209033,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9487680196762085,
        "cpu_time_ms": 1.2156320008216426,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 3.9771199226379395,
        "cpu_time_ms": 4.2263709983672015,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 7.739871978759766,
        "cpu_time_ms": 8.134149000397883,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7564160227775574,
        "cpu_time_ms": 1.0666210000636056,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9609919786453247,
        "cpu_time_ms": 1.2205239981994964,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.9200639724731445,
        "cpu_time_ms": 5.183834000490606,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 7.146751880645752,
        "cpu_time_ms": 7.595065006171353,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7808640003204346,
        "cpu_time_ms": 1.23695900401799,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9559360146522522,
        "cpu_time_ms": 1.2225829996168613,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.056191921234131,
        "cpu_time_ms": 4.368570997030474,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 7.827360153198242,
        "cpu_time_ms": 8.26575900282478,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7737280130386353,
        "cpu_time_ms": 1.052608000463806,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9510719776153564,
        "cpu_time_ms": 1.2048729986418039,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.753407955169678,
        "cpu_time_ms": 5.03073500294704,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 7.643104076385498,
        "cpu_time_ms": 8.575945998018142,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7752000093460083,
        "cpu_time_ms": 1.0519040006329305,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.951583981513977,
        "cpu_time_ms": 1.2313529950915836,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.129055976867676,
        "cpu_time_ms": 4.387989996757824,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.358240127563477,
        "cpu_time_ms": 8.804569995845668,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7348480224609375,
        "cpu_time_ms": 0.9697990026324987,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.936959981918335,
        "cpu_time_ms": 1.2097950020688586,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.417888164520264,
        "cpu_time_ms": 4.739464005979244,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      }
    ],
    "peak_gpu_memory_mb": 2853.2294921875,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 181.1,
    "avg_ram_usage_mb": 1218.97265625,
    "final_tree_nodes": 9,
    "final_tree_edges": 8,
    "tree_memory_mb": 50.92288589477539,
    "efficiency_score": 55910.75988644646,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Consider using classical selection for hot paths",
      "Tree-level quantum may be excessive - consider one-loop for balance",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 118,
    "total_kernel_calls": 210,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         76435 function calls (57691 primitive calls) in 0.159 seconds\n\n   Ordered by: cumulative time\n   List reduced from 175 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.158    0.158 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:214(search)\n        9    0.000    0.000    0.154    0.017 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:296(_run_search_wave_vectorized)\n       36    0.001    0.000    0.154    0.004 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:394(_profile_phase)\n        9    0.000    0.000    0.081    0.009 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:369(instrumented_select)\n        9    0.019    0.002    0.059    0.007 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:320(_select_batch_vectorized)\n        9    0.000    0.000    0.046    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:378(instrumented_backup)\n        9    0.017    0.002    0.026    0.003 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:747(_backup_batch_vectorized)\n       14    0.013    0.001    0.023    0.002 {built-in method time.sleep}\n      117    0.002    0.000    0.020    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       87    0.000    0.000    0.015    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        9    0.014    0.002    0.015    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n        9    0.000    0.000    0.014    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:375(instrumented_evaluate)\n18837/117    0.011    0.000    0.014    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       36    0.014    0.000    0.014    0.000 {built-in method torch.where}\n        9    0.000    0.000    0.013    0.001 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:372(instrumented_expand)\n      109    0.000    0.000    0.013    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        9    0.005    0.001    0.010    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:915(_get_quantum_phases)\n       74    0.000    0.000    0.010    0.000 {built-in method builtins.next}\n       74    0.000    0.000    0.010    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:196(timer)\n      109    0.010    0.000    0.010    0.000 {built-in method torch._C._cuda_synchronize}\n       37    0.000    0.000    0.009    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       37    0.000    0.000    0.009    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:178(end_timer)\n       11    0.007    0.001    0.007    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n        9    0.007    0.001    0.007    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:699(_evaluate_batch_vectorized)\n        9    0.000    0.000    0.007    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n        9    0.001    0.000    0.006    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:126(batch_ucb_selection)\n        9    0.006    0.001    0.006    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:450(_expand_batch_vectorized)\n        9    0.005    0.001    0.005    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:974(batch_action_to_child)\n       30    0.000    0.000    0.005    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        9    0.000    0.000    0.005    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n     18/9    0.000    0.000    0.005    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        9    0.000    0.000    0.005    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        9    0.000    0.000    0.005    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n        9    0.004    0.000    0.004    0.000 {built-in method torch._unique2}\n      315    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n       15    0.001    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n      255    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n      255    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n      117    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n      255    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n       30    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n    45/30    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n       74    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n       15    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n    20991    0.002    0.000    0.002    0.000 {built-in method builtins.isinstance}\n      109    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:490(__init__)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:845(_extract_policy)\n      117    0.001    0.000    0.001    0.000 {method 'sort' of 'list' objects}\n      255    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:753(_get_available_device_type)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:791(_add_dirichlet_noise_to_root)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 320,
        "function_name": "_select_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.019430849,
        "cumulative_time": 0.059139993,
        "time_percent": 5.869789868217237,
        "time_per_call": 0.006571110333333334
      },
      {
        "rank": 2,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 747,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.017058272000000003,
        "cumulative_time": 0.025996215000000003,
        "time_percent": 2.580188323982334,
        "time_per_call": 0.0028884683333333335
      },
      {
        "rank": 3,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 36,
        "primitive_calls": 36,
        "total_time": 0.014025231,
        "cumulative_time": 0.014025231,
        "time_percent": 1.3920386974548051,
        "time_per_call": 0.00038958975
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.013531922,
        "cumulative_time": 0.014570825,
        "time_percent": 1.4461902448410235,
        "time_per_call": 0.0016189805555555557
      },
      {
        "rank": 5,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.012745664,
        "cumulative_time": 0.022810247000000002,
        "time_percent": 2.263973158267581,
        "time_per_call": 0.0016293033571428573
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 117,
        "primitive_calls": 18837,
        "total_time": 0.010832263,
        "cumulative_time": 0.014205944000000002,
        "time_percent": 1.4099749074989143,
        "time_per_call": 0.0001214183247863248
      },
      {
        "rank": 7,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 109,
        "primitive_calls": 109,
        "total_time": 0.009910069,
        "cumulative_time": 0.009910069,
        "time_percent": 0.9835987401881112,
        "time_per_call": 9.091806422018349e-05
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.0072013170000000005,
        "cumulative_time": 0.007287069,
        "time_percent": 0.7232595341227028,
        "time_per_call": 0.0006624608181818182
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 699,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.006854969000000001,
        "cumulative_time": 0.007137287000000001,
        "time_percent": 0.7083933019599545,
        "time_per_call": 0.000793031888888889
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 450,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.005502487,
        "cumulative_time": 0.005595089,
        "time_percent": 0.5553263546036217,
        "time_per_call": 0.0006216765555555556
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 915,
        "function_name": "_get_quantum_phases",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.005315656,
        "cumulative_time": 0.010466318,
        "time_percent": 1.0388078225497877,
        "time_per_call": 0.0011629242222222223
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 974,
        "function_name": "batch_action_to_child",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.004672005,
        "cumulative_time": 0.005027229,
        "time_percent": 0.4989648519134568,
        "time_per_call": 0.000558581
      },
      {
        "rank": 13,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.003927796,
        "cumulative_time": 0.003927796,
        "time_percent": 0.38984342059736443,
        "time_per_call": 0.00043642177777777777
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 117,
        "primitive_calls": 117,
        "total_time": 0.0019197370000000001,
        "cumulative_time": 0.019757948,
        "time_percent": 1.961024969806185,
        "time_per_call": 0.00016887135042735043
      },
      {
        "rank": 15,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 20991,
        "primitive_calls": 20991,
        "total_time": 0.0016021980000000002,
        "cumulative_time": 0.0016021980000000002,
        "time_percent": 0.15902209503605996,
        "time_per_call": 7.632785479491212e-08
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 117,
        "primitive_calls": 117,
        "total_time": 0.001410875,
        "cumulative_time": 0.001410875,
        "time_percent": 0.1400328163772524,
        "time_per_call": 1.2058760683760683e-05
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 14362,
        "primitive_calls": 14362,
        "total_time": 0.001281257,
        "cumulative_time": 0.001281257,
        "time_percent": 0.1271679108447377,
        "time_per_call": 8.921160005570255e-08
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 117,
        "primitive_calls": 117,
        "total_time": 0.001250706,
        "cumulative_time": 0.001250706,
        "time_percent": 0.12413564889868192,
        "time_per_call": 1.0689794871794872e-05
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 45,
        "primitive_calls": 45,
        "total_time": 0.0009571200000000001,
        "cumulative_time": 0.001032425,
        "time_percent": 0.10247072238737295,
        "time_per_call": 2.294277777777778e-05
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1100,
        "function_name": "remove_virtual_loss",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0008488580000000001,
        "cumulative_time": 0.0010136700000000002,
        "time_percent": 0.10060924247515157,
        "time_per_call": 0.00011263000000000001
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 63,
        "primitive_calls": 63,
        "total_time": 0.000745909,
        "cumulative_time": 0.000745909,
        "time_percent": 0.07403330417729422,
        "time_per_call": 1.1839825396825396e-05
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 15,
        "primitive_calls": 15,
        "total_time": 0.000728673,
        "cumulative_time": 0.0012862630000000002,
        "time_percent": 0.12766476866614962,
        "time_per_call": 8.575086666666668e-05
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 126,
        "function_name": "batch_ucb_selection",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0007111180000000001,
        "cumulative_time": 0.006460517000000001,
        "time_percent": 0.6412222137064714,
        "time_per_call": 0.0007178352222222223
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 15,
        "primitive_calls": 15,
        "total_time": 0.000688874,
        "cumulative_time": 0.002800561,
        "time_percent": 0.27796257235140914,
        "time_per_call": 0.00018670406666666667
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 36,
        "primitive_calls": 36,
        "total_time": 0.0006755680000000001,
        "cumulative_time": 0.154193338,
        "time_percent": 15.30406831700159,
        "time_per_call": 0.004283148277777778
      },
      {
        "rank": 26,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000665089,
        "cumulative_time": 0.000665089,
        "time_percent": 0.06601172025270165,
        "time_per_call": 0.0003325445
      },
      {
        "rank": 27,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1095,
        "function_name": "apply_virtual_loss",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.000516941,
        "cumulative_time": 0.000516941,
        "time_percent": 0.0513076666117645,
        "time_per_call": 5.743788888888889e-05
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 4564,
        "primitive_calls": 4564,
        "total_time": 0.00045273400000000005,
        "cumulative_time": 0.00045273400000000005,
        "time_percent": 0.04493496382722707,
        "time_per_call": 9.919675723049957e-08
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x71c7179d2700>",
        "total_calls": 74,
        "primitive_calls": 74,
        "total_time": 0.00041272600000000003,
        "cumulative_time": 0.00041272600000000003,
        "time_percent": 0.040964071354384964,
        "time_per_call": 5.577378378378379e-06
      },
      {
        "rank": 30,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 214,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000398719,
        "cumulative_time": 0.15752406800000002,
        "time_percent": 15.634651467523222,
        "time_per_call": 0.15752406800000002
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 4676,
        "primitive_calls": 4676,
        "total_time": 0.000392983,
        "cumulative_time": 0.000837561,
        "time_percent": 0.0831299907630002,
        "time_per_call": 1.7911911890504706e-07
      },
      {
        "rank": 32,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 315,
        "primitive_calls": 315,
        "total_time": 0.00038691400000000003,
        "cumulative_time": 0.0031520000000000003,
        "time_percent": 0.31284375810833676,
        "time_per_call": 1.0006349206349206e-05
      },
      {
        "rank": 33,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 87,
        "primitive_calls": 87,
        "total_time": 0.00036067600000000004,
        "cumulative_time": 0.015267355000000002,
        "time_percent": 1.5153225617303636,
        "time_per_call": 0.0001754868390804598
      },
      {
        "rank": 34,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 255,
        "primitive_calls": 255,
        "total_time": 0.00034082400000000004,
        "cumulative_time": 0.000548417,
        "time_percent": 0.05443173708454941,
        "time_per_call": 2.1506549019607846e-06
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 56,
        "primitive_calls": 56,
        "total_time": 0.000331075,
        "cumulative_time": 0.00038404700000000005,
        "time_percent": 0.03811761001593668,
        "time_per_call": 6.857982142857144e-06
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.000318836,
        "cumulative_time": 0.000318836,
        "time_percent": 0.03164525776022514,
        "time_per_call": 1.7713111111111114e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 15,
        "primitive_calls": 15,
        "total_time": 0.00031622400000000004,
        "cumulative_time": 0.00031622400000000004,
        "time_percent": 0.03138601033123436,
        "time_per_call": 2.10816e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'to' of 'torch._C.TensorBase' objects>",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.000309795,
        "cumulative_time": 0.000309795,
        "time_percent": 0.030747916257351585,
        "time_per_call": 1.6305e-05
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 0.000308872,
        "cumulative_time": 0.000308872,
        "time_percent": 0.030656306235545112,
        "time_per_call": 1.1439703703703705e-05
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.000302877,
        "cumulative_time": 0.00035417,
        "time_percent": 0.03515224422881651,
        "time_per_call": 2.2135625e-05
      },
      {
        "rank": 41,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 109,
        "primitive_calls": 109,
        "total_time": 0.00029701900000000004,
        "cumulative_time": 0.012617889,
        "time_percent": 1.2523565400234273,
        "time_per_call": 0.00011576044954128441
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 45,
        "primitive_calls": 45,
        "total_time": 0.00029095900000000003,
        "cumulative_time": 0.00029095900000000003,
        "time_percent": 0.028878396895762548,
        "time_per_call": 6.465755555555556e-06
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 46,
        "primitive_calls": 46,
        "total_time": 0.000264484,
        "cumulative_time": 0.000264484,
        "time_percent": 0.026250687982082913,
        "time_per_call": 5.749652173913043e-06
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 0.000259234,
        "cumulative_time": 0.000259234,
        "time_percent": 0.02572961256010678,
        "time_per_call": 9.60125925925926e-06
      },
      {
        "rank": 45,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 812,
        "function_name": "_get_device_index",
        "total_calls": 255,
        "primitive_calls": 255,
        "total_time": 0.00025153700000000003,
        "cumulative_time": 0.002618164,
        "time_percent": 0.2598592211624224,
        "time_per_call": 1.026730980392157e-05
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'scatter_add_' of 'torch._C.TensorBase' objects>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.000245981,
        "cumulative_time": 0.000245981,
        "time_percent": 0.024414219690116364,
        "time_per_call": 1.366561111111111e-05
      },
      {
        "rank": 47,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 104,
        "primitive_calls": 104,
        "total_time": 0.000232312,
        "cumulative_time": 0.00044457800000000005,
        "time_percent": 0.044125460752629485,
        "time_per_call": 4.274788461538462e-06
      },
      {
        "rank": 48,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 770,
        "function_name": "_get_device_attr",
        "total_calls": 255,
        "primitive_calls": 255,
        "total_time": 0.00022765300000000002,
        "cumulative_time": 0.0021409040000000003,
        "time_percent": 0.2124899914686455,
        "time_per_call": 8.395701960784315e-06
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method __new__ of type object at 0xa43b40>",
        "total_calls": 202,
        "primitive_calls": 202,
        "total_time": 0.00021893700000000002,
        "cumulative_time": 0.00021893700000000002,
        "time_percent": 0.02173003612594065,
        "time_per_call": 1.0838465346534655e-06
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method mcts.gpu.unified_cuda_kernels.batched_ucb_selection_quantum>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.000193615,
        "cumulative_time": 0.000193615,
        "time_percent": 0.019216765300173102,
        "time_per_call": 2.1512777777777777e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": true,
      "quantum_config": "QuantumConfig(quantum_level='one_loop', min_wave_size=3072, optimal_wave_size=3072, hbar_eff=0.1, temperature=1.0, coupling_strength=0.1, decoherence_rate=0.01, measurement_noise=0.0, path_integral_steps=10, path_integral_beta=1.0, use_wick_rotation=True, interference_alpha=0.05, interference_method='minhash', minhash_size=64, phase_kick_strength=0.1, use_mixed_precision=True, cache_corrections=True, fast_mode=True, enable_quantum=True, uncertainty_decay=0.99, phase_temperature=1.0, device='cuda')",
      "enable_virtual_loss": true,
      "virtual_loss_value": -3.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "one_loop",
    "num_simulations": 25000,
    "wave_size": 3072,
    "total_time_ms": 158.9308719994733,
    "simulations_per_second": 157301.09377417152,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 7.856544017791748,
        "cpu_time_ms": 8.924661997298244,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8307520151138306,
        "cpu_time_ms": 1.1406580015318468,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1801600456237793,
        "cpu_time_ms": 1.4714189965161495,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.0417280197143555,
        "cpu_time_ms": 4.3540289989323355,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.02899169921875,
        "cpu_time_ms": 8.48282299557468,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.734495997428894,
        "cpu_time_ms": 0.9681490046204999,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9479359984397888,
        "cpu_time_ms": 1.1836270059575327,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.618239879608154,
        "cpu_time_ms": 4.889424999419134,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 7.589375972747803,
        "cpu_time_ms": 7.9847540037008,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.720736026763916,
        "cpu_time_ms": 0.9511319949524477,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9119359850883484,
        "cpu_time_ms": 1.2267359998077154,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.037343978881836,
        "cpu_time_ms": 4.349552000348922,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 7.6465277671813965,
        "cpu_time_ms": 8.05244900402613,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7309120297431946,
        "cpu_time_ms": 0.9764019996509887,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9462400078773499,
        "cpu_time_ms": 1.236695003171917,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.05401611328125,
        "cpu_time_ms": 4.4998730008956045,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 7.6887359619140625,
        "cpu_time_ms": 8.16619700344745,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7979199886322021,
        "cpu_time_ms": 1.0315079998690635,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9183679819107056,
        "cpu_time_ms": 1.1869989975821227,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 5.202847957611084,
        "cpu_time_ms": 5.509415997948963,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 7.238495826721191,
        "cpu_time_ms": 8.77579499501735,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7103679776191711,
        "cpu_time_ms": 0.9521860047243536,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.5105600357055664,
        "cpu_time_ms": 1.7436299967812374,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.585472106933594,
        "cpu_time_ms": 4.846978998102713,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 7.627232074737549,
        "cpu_time_ms": 8.036074999836273,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7263360023498535,
        "cpu_time_ms": 0.9560110047459602,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0491199493408203,
        "cpu_time_ms": 1.3083469966659322,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 5.292960166931152,
        "cpu_time_ms": 5.5812670034356415,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 7.489503860473633,
        "cpu_time_ms": 7.88773299427703,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.2290879487991333,
        "cpu_time_ms": 1.4683269982924685,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0053759813308716,
        "cpu_time_ms": 1.2725970009341836,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.046847820281982,
        "cpu_time_ms": 4.318690000218339,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 7.266111850738525,
        "cpu_time_ms": 7.637176000571344,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7989439964294434,
        "cpu_time_ms": 1.0667370006558485,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9728000164031982,
        "cpu_time_ms": 1.2246879996382631,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.878335952758789,
        "cpu_time_ms": 5.131197001901455,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      }
    ],
    "peak_gpu_memory_mb": 2851.73876953125,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 183.9,
    "avg_ram_usage_mb": 1218.97265625,
    "final_tree_nodes": 9,
    "final_tree_edges": 8,
    "tree_memory_mb": 50.92288589477539,
    "efficiency_score": 56483.54672094608,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Consider using classical selection for hot paths",
      "One-loop quantum is a good balance - monitor overhead",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 175,
    "total_kernel_calls": 267,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         76435 function calls (57691 primitive calls) in 0.157 seconds\n\n   Ordered by: cumulative time\n   List reduced from 175 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.156    0.156 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:214(search)\n        9    0.000    0.000    0.153    0.017 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:296(_run_search_wave_vectorized)\n       36    0.001    0.000    0.153    0.004 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:394(_profile_phase)\n        9    0.000    0.000    0.084    0.009 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:369(instrumented_select)\n        9    0.019    0.002    0.055    0.006 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:320(_select_batch_vectorized)\n        9    0.000    0.000    0.041    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:378(instrumented_backup)\n        9    0.020    0.002    0.030    0.003 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:747(_backup_batch_vectorized)\n      117    0.002    0.000    0.020    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        9    0.000    0.000    0.016    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:375(instrumented_evaluate)\n       87    0.000    0.000    0.015    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       15    0.003    0.000    0.015    0.001 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n18837/117    0.011    0.000    0.014    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        9    0.014    0.002    0.014    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n       36    0.013    0.000    0.013    0.000 {built-in method torch.where}\n      109    0.000    0.000    0.013    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        9    0.000    0.000    0.013    0.001 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:372(instrumented_expand)\n       14    0.009    0.001    0.011    0.001 {built-in method time.sleep}\n       74    0.000    0.000    0.010    0.000 {built-in method builtins.next}\n       74    0.000    0.000    0.010    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:196(timer)\n        9    0.005    0.001    0.010    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:915(_get_quantum_phases)\n      109    0.009    0.000    0.009    0.000 {built-in method torch._C._cuda_synchronize}\n       37    0.000    0.000    0.009    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       37    0.000    0.000    0.008    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:178(end_timer)\n        9    0.007    0.001    0.007    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:699(_evaluate_batch_vectorized)\n       11    0.007    0.001    0.007    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n        9    0.000    0.000    0.006    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n        9    0.001    0.000    0.006    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:126(batch_ucb_selection)\n        9    0.006    0.001    0.006    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:450(_expand_batch_vectorized)\n       30    0.000    0.000    0.005    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        9    0.000    0.000    0.005    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n     18/9    0.000    0.000    0.005    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        9    0.000    0.000    0.005    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        9    0.000    0.000    0.005    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n        9    0.005    0.001    0.005    0.001 {built-in method torch._unique2}\n        9    0.004    0.000    0.004    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:974(batch_action_to_child)\n      315    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n       15    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n      255    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n    45/30    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n      117    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n      255    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n      255    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n       74    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n       30    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n       15    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n    20991    0.002    0.000    0.002    0.000 {built-in method builtins.isinstance}\n      109    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:490(__init__)\n       15    0.001    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:845(_extract_policy)\n      117    0.001    0.000    0.001    0.000 {method 'sort' of 'list' objects}\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 747,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.019507948,
        "cumulative_time": 0.030180934000000003,
        "time_percent": 3.0174169433999607,
        "time_per_call": 0.0033534371111111115
      },
      {
        "rank": 2,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 320,
        "function_name": "_select_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.01884639,
        "cumulative_time": 0.05484743500000001,
        "time_percent": 5.483514183856206,
        "time_per_call": 0.006094159444444445
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.013655592000000001,
        "cumulative_time": 0.013861031000000001,
        "time_percent": 1.385792427510431,
        "time_per_call": 0.0015401145555555557
      },
      {
        "rank": 4,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 36,
        "primitive_calls": 36,
        "total_time": 0.013171891000000002,
        "cumulative_time": 0.013189258,
        "time_percent": 1.3186301842107828,
        "time_per_call": 0.0003663682777777778
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 117,
        "primitive_calls": 18837,
        "total_time": 0.010714008,
        "cumulative_time": 0.014100341,
        "time_percent": 1.4097180637655926,
        "time_per_call": 0.00012051573504273505
      },
      {
        "rank": 6,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 109,
        "primitive_calls": 109,
        "total_time": 0.00948614,
        "cumulative_time": 0.00948614,
        "time_percent": 0.9484013835842224,
        "time_per_call": 8.702880733944955e-05
      },
      {
        "rank": 7,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.009022526000000001,
        "cumulative_time": 0.011429050000000001,
        "time_percent": 1.1426488364132574,
        "time_per_call": 0.0008163607142857144
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 699,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.006793996,
        "cumulative_time": 0.007085485000000001,
        "time_percent": 0.708389690365655,
        "time_per_call": 0.0007872761111111111
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.006581186,
        "cumulative_time": 0.006667645000000001,
        "time_percent": 0.666615055570382,
        "time_per_call": 0.0006061495454545455
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 450,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0057776500000000005,
        "cumulative_time": 0.005872482,
        "time_percent": 0.5871165778571096,
        "time_per_call": 0.000652498
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 915,
        "function_name": "_get_quantum_phases",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.005230185,
        "cumulative_time": 0.009724503,
        "time_percent": 0.9722323410648506,
        "time_per_call": 0.0010805003333333335
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.004682985000000001,
        "cumulative_time": 0.004682985000000001,
        "time_percent": 0.46819353849976497,
        "time_per_call": 0.0005203316666666667
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 974,
        "function_name": "batch_action_to_child",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.003601865,
        "cumulative_time": 0.003911404,
        "time_percent": 0.3910527322342767,
        "time_per_call": 0.00043460044444444446
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 15,
        "primitive_calls": 15,
        "total_time": 0.002822783,
        "cumulative_time": 0.014621100000000001,
        "time_percent": 1.4617822917986953,
        "time_per_call": 0.0009747400000000001
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 117,
        "primitive_calls": 117,
        "total_time": 0.0019102890000000001,
        "cumulative_time": 0.019691008000000003,
        "time_percent": 1.9686594580480572,
        "time_per_call": 0.0001682992136752137
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 20991,
        "primitive_calls": 20991,
        "total_time": 0.001590044,
        "cumulative_time": 0.001590044,
        "time_percent": 0.15896876174711647,
        "time_per_call": 7.574884474298509e-08
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 117,
        "primitive_calls": 117,
        "total_time": 0.001392028,
        "cumulative_time": 0.001392028,
        "time_percent": 0.13917159995403589,
        "time_per_call": 1.1897675213675214e-05
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 14362,
        "primitive_calls": 14362,
        "total_time": 0.001297631,
        "cumulative_time": 0.001297631,
        "time_percent": 0.1297340157094222,
        "time_per_call": 9.03516919649074e-08
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 117,
        "primitive_calls": 117,
        "total_time": 0.0012679570000000001,
        "cumulative_time": 0.0012679570000000001,
        "time_percent": 0.12676728080392025,
        "time_per_call": 1.0837239316239317e-05
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1100,
        "function_name": "remove_virtual_loss",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.00093134,
        "cumulative_time": 0.0011382170000000002,
        "time_percent": 0.11379618871522906,
        "time_per_call": 0.00012646855555555558
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 15,
        "primitive_calls": 15,
        "total_time": 0.0007707,
        "cumulative_time": 0.001451856,
        "time_percent": 0.14515305900661965,
        "time_per_call": 9.67904e-05
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 126,
        "function_name": "batch_ucb_selection",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0007235210000000001,
        "cumulative_time": 0.006097179,
        "time_percent": 0.6095812416389244,
        "time_per_call": 0.0006774643333333334
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 45,
        "primitive_calls": 45,
        "total_time": 0.0007167170000000001,
        "cumulative_time": 0.0007167170000000001,
        "time_percent": 0.07165563595290954,
        "time_per_call": 1.5927044444444448e-05
      },
      {
        "rank": 24,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 63,
        "primitive_calls": 63,
        "total_time": 0.0007091350000000001,
        "cumulative_time": 0.0007091350000000001,
        "time_percent": 0.0708976058911209,
        "time_per_call": 1.1256111111111113e-05
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 36,
        "primitive_calls": 36,
        "total_time": 0.0006612,
        "cumulative_time": 0.153133358,
        "time_percent": 15.309903564579278,
        "time_per_call": 0.004253704388888889
      },
      {
        "rank": 26,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000644465,
        "cumulative_time": 0.000644465,
        "time_percent": 0.06443205536410025,
        "time_per_call": 0.0003222325
      },
      {
        "rank": 27,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1095,
        "function_name": "apply_virtual_loss",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.000528138,
        "cumulative_time": 0.000528138,
        "time_percent": 0.05280196264480643,
        "time_per_call": 5.8682000000000005e-05
      },
      {
        "rank": 28,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 214,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000485691,
        "cumulative_time": 0.15596863600000002,
        "time_percent": 15.593367816429444,
        "time_per_call": 0.15596863600000002
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 4564,
        "primitive_calls": 4564,
        "total_time": 0.00045315700000000004,
        "cumulative_time": 0.00045315700000000004,
        "time_percent": 0.045305543222098295,
        "time_per_call": 9.928943908851885e-08
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 4676,
        "primitive_calls": 4676,
        "total_time": 0.00042144100000000005,
        "cumulative_time": 0.0009424300000000001,
        "time_percent": 0.09422187696273499,
        "time_per_call": 2.0154619332763047e-07
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x71c7179d2700>",
        "total_calls": 74,
        "primitive_calls": 74,
        "total_time": 0.000399921,
        "cumulative_time": 0.000399921,
        "time_percent": 0.0399831364205447,
        "time_per_call": 5.404337837837838e-06
      },
      {
        "rank": 32,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 315,
        "primitive_calls": 315,
        "total_time": 0.000384327,
        "cumulative_time": 0.003103137,
        "time_percent": 0.31024414822587415,
        "time_per_call": 9.851228571428572e-06
      },
      {
        "rank": 33,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 87,
        "primitive_calls": 87,
        "total_time": 0.00036270400000000004,
        "cumulative_time": 0.015329268000000002,
        "time_percent": 1.53258321936355,
        "time_per_call": 0.0001761984827586207
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 46,
        "primitive_calls": 46,
        "total_time": 0.00035300800000000003,
        "cumulative_time": 0.00035780500000000005,
        "time_percent": 0.035772480382257985,
        "time_per_call": 7.778369565217393e-06
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.00034316200000000005,
        "cumulative_time": 0.000389372,
        "time_percent": 0.03892847285924052,
        "time_per_call": 2.433575e-05
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 45,
        "primitive_calls": 45,
        "total_time": 0.000339451,
        "cumulative_time": 0.00040662500000000003,
        "time_percent": 0.04065338616127682,
        "time_per_call": 9.036111111111112e-06
      },
      {
        "rank": 37,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 255,
        "primitive_calls": 255,
        "total_time": 0.00031904700000000004,
        "cumulative_time": 0.000537391,
        "time_percent": 0.05372705525384496,
        "time_per_call": 2.1074156862745097e-06
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 0.000318652,
        "cumulative_time": 0.000445943,
        "time_percent": 0.04458430491218757,
        "time_per_call": 1.6516407407407407e-05
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.000315381,
        "cumulative_time": 0.000315381,
        "time_percent": 0.03153103124729085,
        "time_per_call": 1.7521166666666668e-05
      },
      {
        "rank": 40,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 109,
        "primitive_calls": 109,
        "total_time": 0.000308417,
        "cumulative_time": 0.012939498,
        "time_percent": 1.2936597821753926,
        "time_per_call": 0.00011871099082568808
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 56,
        "primitive_calls": 56,
        "total_time": 0.000304165,
        "cumulative_time": 0.000304165,
        "time_percent": 0.030409682635707994,
        "time_per_call": 5.4315178571428575e-06
      },
      {
        "rank": 42,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 104,
        "primitive_calls": 104,
        "total_time": 0.000302988,
        "cumulative_time": 0.000520989,
        "time_percent": 0.05208722287802631,
        "time_per_call": 5.0095096153846155e-06
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 15,
        "primitive_calls": 15,
        "total_time": 0.000302398,
        "cumulative_time": 0.000302398,
        "time_percent": 0.030233022240142113,
        "time_per_call": 2.0159866666666666e-05
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 0.000265845,
        "cumulative_time": 0.000265845,
        "time_percent": 0.026578541516248718,
        "time_per_call": 9.846111111111111e-06
      },
      {
        "rank": 45,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 812,
        "function_name": "_get_device_index",
        "total_calls": 255,
        "primitive_calls": 255,
        "total_time": 0.000252215,
        "cumulative_time": 0.0025743320000000004,
        "time_percent": 0.257375500530789,
        "time_per_call": 1.0095419607843139e-05
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'to' of 'torch._C.TensorBase' objects>",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.000244976,
        "cumulative_time": 0.000244976,
        "time_percent": 0.024492109260977432,
        "time_per_call": 1.2893473684210527e-05
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method __new__ of type object at 0xa43b40>",
        "total_calls": 202,
        "primitive_calls": 202,
        "total_time": 0.00023559700000000001,
        "cumulative_time": 0.00023559700000000001,
        "time_percent": 0.023554419476024185,
        "time_per_call": 1.1663217821782178e-06
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'scatter_add_' of 'torch._C.TensorBase' objects>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.00022734100000000002,
        "cumulative_time": 0.00022734100000000002,
        "time_percent": 0.022729004520850495,
        "time_per_call": 1.2630055555555557e-05
      },
      {
        "rank": 49,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 770,
        "function_name": "_get_device_attr",
        "total_calls": 255,
        "primitive_calls": 255,
        "total_time": 0.00022516500000000002,
        "cumulative_time": 0.002082117,
        "time_percent": 0.20816503273030237,
        "time_per_call": 8.165164705882353e-06
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'split' of 'bytes' objects>",
        "total_calls": 826,
        "primitive_calls": 826,
        "total_time": 0.000224984,
        "cumulative_time": 0.000224984,
        "time_percent": 0.02249335734917603,
        "time_per_call": 2.7237772397094434e-07
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -3.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "classical",
    "num_simulations": 50000,
    "wave_size": 3072,
    "total_time_ms": 280.42622999782907,
    "simulations_per_second": 178300.01138048703,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 6.109280109405518,
        "cpu_time_ms": 7.3866469974746,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7546560168266296,
        "cpu_time_ms": 0.9821009953157045,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.059008002281189,
        "cpu_time_ms": 1.292599001317285,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 5.11078405380249,
        "cpu_time_ms": 5.283311998937279,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 6.501791954040527,
        "cpu_time_ms": 6.7263529999763705,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7421759963035583,
        "cpu_time_ms": 0.9619839984225109,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0286400318145752,
        "cpu_time_ms": 1.301833995967172,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.255743980407715,
        "cpu_time_ms": 4.4148879969725385,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 6.497727870941162,
        "cpu_time_ms": 6.6694220004137605,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.0730559825897217,
        "cpu_time_ms": 1.3675040027010255,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1500799655914307,
        "cpu_time_ms": 1.4417440033867024,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.3427839279174805,
        "cpu_time_ms": 4.512792002060451,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 6.33081579208374,
        "cpu_time_ms": 6.528099002025556,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8638399839401245,
        "cpu_time_ms": 1.5679320058552548,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1617599725723267,
        "cpu_time_ms": 1.4286619989434257,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.438784122467041,
        "cpu_time_ms": 4.606019996572286,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 7.54204797744751,
        "cpu_time_ms": 7.748190000711475,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7483519911766052,
        "cpu_time_ms": 1.0203370038652793,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0674240589141846,
        "cpu_time_ms": 1.2618050022865646,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 5.420032024383545,
        "cpu_time_ms": 5.551764996198472,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 7.001152038574219,
        "cpu_time_ms": 7.196926999313291,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.2935359477996826,
        "cpu_time_ms": 1.5650259956601076,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0439679622650146,
        "cpu_time_ms": 1.2787859959644265,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.017151832580566,
        "cpu_time_ms": 4.1519779988448136,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 6.572959899902344,
        "cpu_time_ms": 6.7233049994683824,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7162560224533081,
        "cpu_time_ms": 0.9272649986087345,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0253440141677856,
        "cpu_time_ms": 1.2194579976494424,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 3.9536960124969482,
        "cpu_time_ms": 4.557760003081057,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 6.561823844909668,
        "cpu_time_ms": 6.758568997611292,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7621440291404724,
        "cpu_time_ms": 1.018175003991928,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9248960018157959,
        "cpu_time_ms": 1.124105998314917,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.118591785430908,
        "cpu_time_ms": 4.437781004526187,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 11.750656127929688,
        "cpu_time_ms": 11.819888000900391,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7715520262718201,
        "cpu_time_ms": 1.0016529995482415,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9492160081863403,
        "cpu_time_ms": 1.1578999983612448,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.183040142059326,
        "cpu_time_ms": 4.338181999628432,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 6.051455974578857,
        "cpu_time_ms": 6.274113002291415,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.0169919729232788,
        "cpu_time_ms": 1.607354002771899,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9433280229568481,
        "cpu_time_ms": 1.1917330048163421,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.042751789093018,
        "cpu_time_ms": 4.201904994260985,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 6.642047882080078,
        "cpu_time_ms": 6.813248997787014,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7648959755897522,
        "cpu_time_ms": 1.0232309941784479,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0638079643249512,
        "cpu_time_ms": 1.3039100012974814,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 5.847040176391602,
        "cpu_time_ms": 6.0033330009900965,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 6.27129602432251,
        "cpu_time_ms": 6.541981994814705,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7554879784584045,
        "cpu_time_ms": 0.9788960014702752,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.518847942352295,
        "cpu_time_ms": 1.7617019984754734,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.337600231170654,
        "cpu_time_ms": 4.47377599630272,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 6.403456211090088,
        "cpu_time_ms": 6.6197790001751855,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.756767988204956,
        "cpu_time_ms": 1.0406880028313026,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0383679866790771,
        "cpu_time_ms": 1.26845900376793,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.176959991455078,
        "cpu_time_ms": 4.37223900371464,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 6.305920124053955,
        "cpu_time_ms": 6.52002400602214,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7645760178565979,
        "cpu_time_ms": 1.0028800024883822,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9490240216255188,
        "cpu_time_ms": 1.154033001512289,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.292672157287598,
        "cpu_time_ms": 4.4505019977805205,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 6.237599849700928,
        "cpu_time_ms": 6.49028299812926,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.2441279888153076,
        "cpu_time_ms": 1.4607400007662363,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9796479940414429,
        "cpu_time_ms": 1.2129980023019016,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.091904163360596,
        "cpu_time_ms": 4.230120001011528,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 6.713119983673096,
        "cpu_time_ms": 6.874717000755481,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7944639921188354,
        "cpu_time_ms": 1.0082459994009696,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.945855975151062,
        "cpu_time_ms": 1.220498001202941,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 5.122432231903076,
        "cpu_time_ms": 5.219842001679353,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 6.175487995147705,
        "cpu_time_ms": 6.370135997713078,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7594879865646362,
        "cpu_time_ms": 0.9944650009856559,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.5321919918060303,
        "cpu_time_ms": 1.7517640008009039,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.058080196380615,
        "cpu_time_ms": 4.207261001283769,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      }
    ],
    "peak_gpu_memory_mb": 3212.22314453125,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 187.6,
    "avg_ram_usage_mb": 1218.97265625,
    "final_tree_nodes": 9,
    "final_tree_edges": 8,
    "tree_memory_mb": 50.92288589477539,
    "efficiency_score": 56838.894260648245,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 184,
    "total_kernel_calls": 296,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         138148 function calls (104345 primitive calls) in 0.279 seconds\n\n   Ordered by: cumulative time\n   List reduced from 205 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.001    0.001    0.269    0.269 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:214(search)\n       17    0.000    0.000    0.267    0.016 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:296(_run_search_wave_vectorized)\n       68    0.001    0.000    0.267    0.004 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:394(_profile_phase)\n       17    0.000    0.000    0.127    0.007 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:369(instrumented_select)\n       17    0.043    0.003    0.104    0.006 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:320(_select_batch_vectorized)\n       17    0.000    0.000    0.085    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:378(instrumented_backup)\n       17    0.033    0.002    0.049    0.003 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:747(_backup_batch_vectorized)\n      211    0.003    0.000    0.035    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       24    0.019    0.001    0.030    0.001 {built-in method time.sleep}\n       17    0.000    0.000    0.029    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:375(instrumented_evaluate)\n      161    0.001    0.000    0.028    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       17    0.000    0.000    0.026    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:372(instrumented_expand)\n33971/211    0.020    0.000    0.026    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n      205    0.001    0.000    0.025    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n       17    0.024    0.001    0.024    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n      138    0.000    0.000    0.019    0.000 {built-in method builtins.next}\n      138    0.000    0.000    0.019    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:196(timer)\n      205    0.018    0.000    0.018    0.000 {built-in method torch._C._cuda_synchronize}\n       54    0.017    0.000    0.017    0.000 {built-in method torch.where}\n       69    0.000    0.000    0.017    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       69    0.000    0.000    0.017    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:178(end_timer)\n       17    0.000    0.000    0.014    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n       17    0.013    0.001    0.013    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:699(_evaluate_batch_vectorized)\n       17    0.001    0.000    0.013    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:126(batch_ucb_selection)\n       17    0.010    0.001    0.011    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:450(_expand_batch_vectorized)\n       19    0.010    0.001    0.011    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n       17    0.009    0.001    0.010    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:974(batch_action_to_child)\n       17    0.000    0.000    0.008    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n    34/17    0.000    0.000    0.008    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n       50    0.000    0.000    0.008    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n       17    0.000    0.000    0.008    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n       17    0.000    0.000    0.008    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n       17    0.008    0.000    0.008    0.000 {built-in method torch._unique2}\n        1    0.001    0.001    0.008    0.008 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:260(_initialize_root)\n       25    0.003    0.000    0.007    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n      579    0.001    0.000    0.006    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n        1    0.001    0.001    0.005    0.005 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:474(_expand_node_batch)\n      479    0.000    0.000    0.005    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n      211    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n      479    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n      479    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n    75/50    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n       50    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n      138    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n    38007    0.003    0.000    0.003    0.000 {built-in method builtins.isinstance}\n      205    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:490(__init__)\n      479    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:753(_get_available_device_type)\n      211    0.002    0.000    0.002    0.000 {method 'sort' of 'list' objects}\n    25904    0.002    0.000    0.002    0.000 {method 'append' of 'list' objects}\n      480    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:161(is_available)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 320,
        "function_name": "_select_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.042705245,
        "cumulative_time": 0.104057829,
        "time_percent": 5.9544307656889535,
        "time_per_call": 0.006121048764705882
      },
      {
        "rank": 2,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 747,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.032755226000000005,
        "cumulative_time": 0.048593824,
        "time_percent": 2.7806515226074366,
        "time_per_call": 0.0028584602352941177
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.023547224000000002,
        "cumulative_time": 0.023846939,
        "time_percent": 1.3645772606798068,
        "time_per_call": 0.001402761117647059
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 211,
        "primitive_calls": 33971,
        "total_time": 0.019527103,
        "cumulative_time": 0.025543175,
        "time_percent": 1.461639825998839,
        "time_per_call": 0.00012105770142180095
      },
      {
        "rank": 5,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 24,
        "primitive_calls": 24,
        "total_time": 0.019164618,
        "cumulative_time": 0.029932330000000004,
        "time_percent": 1.7127974738042482,
        "time_per_call": 0.0012471804166666667
      },
      {
        "rank": 6,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 205,
        "primitive_calls": 205,
        "total_time": 0.017896002,
        "cumulative_time": 0.017896002,
        "time_percent": 1.0240508178546666,
        "time_per_call": 8.729757073170732e-05
      },
      {
        "rank": 7,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 54,
        "primitive_calls": 54,
        "total_time": 0.017223465,
        "cumulative_time": 0.017223465,
        "time_percent": 0.9855666879977564,
        "time_per_call": 0.00031895305555555557
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 699,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.012810833,
        "cumulative_time": 0.013366161000000001,
        "time_percent": 0.7648427902291891,
        "time_per_call": 0.0007862447647058825
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.010415928000000001,
        "cumulative_time": 0.010563013000000001,
        "time_percent": 0.6044401482330789,
        "time_per_call": 0.000555948052631579
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 450,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.010398901,
        "cumulative_time": 0.010585470000000001,
        "time_percent": 0.6057251899544959,
        "time_per_call": 0.000622674705882353
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 974,
        "function_name": "batch_action_to_child",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.009055621,
        "cumulative_time": 0.009699327,
        "time_percent": 0.555018028439528,
        "time_per_call": 0.0005705486470588236
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.008186093,
        "cumulative_time": 0.008186093,
        "time_percent": 0.46842726278664704,
        "time_per_call": 0.0004815348823529412
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 211,
        "primitive_calls": 211,
        "total_time": 0.0033173400000000002,
        "cumulative_time": 0.035361878,
        "time_percent": 2.023488826542204,
        "time_per_call": 0.00016759183886255925
      },
      {
        "rank": 14,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 38007,
        "primitive_calls": 38007,
        "total_time": 0.0028009930000000003,
        "cumulative_time": 0.0028009930000000003,
        "time_percent": 0.16027932788872043,
        "time_per_call": 7.36967663851396e-08
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.002718177,
        "cumulative_time": 0.006952024,
        "time_percent": 0.39781096710568487,
        "time_per_call": 0.00027808096
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 211,
        "primitive_calls": 211,
        "total_time": 0.002439441,
        "cumulative_time": 0.002439441,
        "time_percent": 0.13959048234115115,
        "time_per_call": 1.1561331753554503e-05
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 25904,
        "primitive_calls": 25904,
        "total_time": 0.0023369330000000002,
        "cumulative_time": 0.0023369330000000002,
        "time_percent": 0.13372473639204777,
        "time_per_call": 9.02151405188388e-08
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 211,
        "primitive_calls": 211,
        "total_time": 0.00229071,
        "cumulative_time": 0.00229071,
        "time_percent": 0.13107974892760202,
        "time_per_call": 1.0856445497630332e-05
      },
      {
        "rank": 19,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1100,
        "function_name": "remove_virtual_loss",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.001648373,
        "cumulative_time": 0.0020219120000000003,
        "time_percent": 0.11569850278459763,
        "time_per_call": 0.00011893600000000001
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0013815020000000002,
        "cumulative_time": 0.0022628550000000002,
        "time_percent": 0.12948582110331244,
        "time_per_call": 0.0022628550000000002
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 120,
        "primitive_calls": 120,
        "total_time": 0.001326261,
        "cumulative_time": 0.001326261,
        "time_percent": 0.07589173613965555,
        "time_per_call": 1.1052175e-05
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0013084980000000002,
        "cumulative_time": 0.0013084980000000002,
        "time_percent": 0.07487529600528631,
        "time_per_call": 0.00043616600000000004
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 75,
        "primitive_calls": 75,
        "total_time": 0.001296531,
        "cumulative_time": 0.0013518410000000001,
        "time_percent": 0.0773554831777215,
        "time_per_call": 1.802454666666667e-05
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 68,
        "primitive_calls": 68,
        "total_time": 0.0012339710000000002,
        "cumulative_time": 0.26685575100000003,
        "time_percent": 15.270106142185908,
        "time_per_call": 0.003924349279411765
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 126,
        "function_name": "batch_ucb_selection",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.001209313,
        "cumulative_time": 0.013293271,
        "time_percent": 0.7606718550609081,
        "time_per_call": 0.0007819571176470589
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.001200612,
        "cumulative_time": 0.0019021280000000001,
        "time_percent": 0.10884418397272538,
        "time_per_call": 7.608512000000001e-05
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0011761270000000001,
        "cumulative_time": 0.0011761270000000001,
        "time_percent": 0.06730071980607488,
        "time_per_call": 0.00029403175000000003
      },
      {
        "rank": 28,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 214,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 2,
        "total_time": 0.0010213280000000002,
        "cumulative_time": 0.26855597800000003,
        "time_percent": 15.367397081798487,
        "time_per_call": 0.26855597800000003
      },
      {
        "rank": 29,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 260,
        "function_name": "_initialize_root",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000991707,
        "cumulative_time": 0.007868141,
        "time_percent": 0.45023331054868204,
        "time_per_call": 0.007868141
      },
      {
        "rank": 30,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1095,
        "function_name": "apply_virtual_loss",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.0009307,
        "cumulative_time": 0.0009307,
        "time_percent": 0.0532568165882714,
        "time_per_call": 5.474705882352941e-05
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 8230,
        "primitive_calls": 8230,
        "total_time": 0.000818991,
        "cumulative_time": 0.000818991,
        "time_percent": 0.04686456803958847,
        "time_per_call": 9.951287970838396e-08
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 8448,
        "primitive_calls": 8448,
        "total_time": 0.000741041,
        "cumulative_time": 0.0015851930000000001,
        "time_percent": 0.09070842683787657,
        "time_per_call": 1.8764121685606062e-07
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x71c7179d2700>",
        "total_calls": 138,
        "primitive_calls": 138,
        "total_time": 0.0007384020000000001,
        "cumulative_time": 0.0007384020000000001,
        "time_percent": 0.04225307820179734,
        "time_per_call": 5.350739130434783e-06
      },
      {
        "rank": 34,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 579,
        "primitive_calls": 579,
        "total_time": 0.0007063060000000001,
        "cumulative_time": 0.005626247,
        "time_percent": 0.3219469265706589,
        "time_per_call": 9.717179620034543e-06
      },
      {
        "rank": 35,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 474,
        "function_name": "_expand_node_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0006665960000000001,
        "cumulative_time": 0.005377633000000001,
        "time_percent": 0.30772065580749514,
        "time_per_call": 0.005377633000000001
      },
      {
        "rank": 36,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 161,
        "primitive_calls": 161,
        "total_time": 0.0006464340000000001,
        "cumulative_time": 0.027959246,
        "time_percent": 1.5998930226371129,
        "time_per_call": 0.00017365991304347825
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.000606422,
        "cumulative_time": 0.000606422,
        "time_percent": 0.034700875931119285,
        "time_per_call": 0.00020214066666666668
      },
      {
        "rank": 38,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 480,
        "primitive_calls": 480,
        "total_time": 0.000601849,
        "cumulative_time": 0.000992749,
        "time_percent": 0.0568074045462446,
        "time_per_call": 2.0682270833333333e-06
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 85,
        "primitive_calls": 85,
        "total_time": 0.0005937350000000001,
        "cumulative_time": 0.000677162,
        "time_percent": 0.0387487831036285,
        "time_per_call": 7.966611764705883e-06
      },
      {
        "rank": 40,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 205,
        "primitive_calls": 205,
        "total_time": 0.000588987,
        "cumulative_time": 0.024792010000000003,
        "time_percent": 1.4186564192807463,
        "time_per_call": 0.00012093663414634149
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 51,
        "primitive_calls": 51,
        "total_time": 0.0005754190000000001,
        "cumulative_time": 0.0005754190000000001,
        "time_percent": 0.032926812232090416,
        "time_per_call": 1.128272549019608e-05
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.000515458,
        "cumulative_time": 0.000515458,
        "time_percent": 0.02949570448582486,
        "time_per_call": 2.061832e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 51,
        "primitive_calls": 51,
        "total_time": 0.00048129600000000003,
        "cumulative_time": 0.000512665,
        "time_percent": 0.0293358825359688,
        "time_per_call": 1.0052254901960785e-05
      },
      {
        "rank": 44,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 812,
        "function_name": "_get_device_index",
        "total_calls": 479,
        "primitive_calls": 479,
        "total_time": 0.00045344700000000005,
        "cumulative_time": 0.004619750000000001,
        "time_percent": 0.26435282951935835,
        "time_per_call": 9.644572025052193e-06
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.00044926400000000005,
        "cumulative_time": 0.00044926400000000005,
        "time_percent": 0.02570792999646843,
        "time_per_call": 1.797056e-05
      },
      {
        "rank": 46,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 201,
        "primitive_calls": 201,
        "total_time": 0.00043587300000000003,
        "cumulative_time": 0.000844152,
        "time_percent": 0.04830433892405983,
        "time_per_call": 4.199761194029851e-06
      },
      {
        "rank": 47,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 770,
        "function_name": "_get_device_attr",
        "total_calls": 479,
        "primitive_calls": 479,
        "total_time": 0.00041083900000000003,
        "cumulative_time": 0.003778252,
        "time_percent": 0.21620035864217216,
        "time_per_call": 7.887791231732778e-06
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros>",
        "total_calls": 20,
        "primitive_calls": 20,
        "total_time": 0.000406665,
        "cumulative_time": 0.000406665,
        "time_percent": 0.02327031623280261,
        "time_per_call": 2.033325e-05
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 75,
        "primitive_calls": 75,
        "total_time": 0.000387409,
        "cumulative_time": 0.000501673,
        "time_percent": 0.028706894754795185,
        "time_per_call": 6.688973333333333e-06
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 34,
        "primitive_calls": 34,
        "total_time": 0.000376626,
        "cumulative_time": 0.000376626,
        "time_percent": 0.021551414853738377,
        "time_per_call": 1.1077235294117648e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": true,
      "quantum_config": "QuantumConfig(quantum_level='tree_level', min_wave_size=3072, optimal_wave_size=3072, hbar_eff=0.1, temperature=1.0, coupling_strength=0.1, decoherence_rate=0.01, measurement_noise=0.0, path_integral_steps=10, path_integral_beta=1.0, use_wick_rotation=True, interference_alpha=0.05, interference_method='minhash', minhash_size=64, phase_kick_strength=0.1, use_mixed_precision=True, cache_corrections=True, fast_mode=True, enable_quantum=True, uncertainty_decay=0.99, phase_temperature=1.0, device='cuda')",
      "enable_virtual_loss": true,
      "virtual_loss_value": -3.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "tree_level",
    "num_simulations": 50000,
    "wave_size": 3072,
    "total_time_ms": 319.8842040001182,
    "simulations_per_second": 156306.56148304694,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 9.612383842468262,
        "cpu_time_ms": 10.04970799840521,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7313600182533264,
        "cpu_time_ms": 0.9828350011957809,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9462400078773499,
        "cpu_time_ms": 1.1966730016865768,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.110335826873779,
        "cpu_time_ms": 4.41043300088495,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 7.990623950958252,
        "cpu_time_ms": 8.34605500131147,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.761247992515564,
        "cpu_time_ms": 1.0363490000599995,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9693440198898315,
        "cpu_time_ms": 1.2160219994257204,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.619040012359619,
        "cpu_time_ms": 4.917062004096806,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.219200134277344,
        "cpu_time_ms": 9.653208995587192,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7670400142669678,
        "cpu_time_ms": 1.0220149997621775,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1015360355377197,
        "cpu_time_ms": 1.3992160020279698,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.662399768829346,
        "cpu_time_ms": 4.933361997245811,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 7.515456199645996,
        "cpu_time_ms": 7.937399001093581,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.5858880281448364,
        "cpu_time_ms": 1.879924995591864,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0155839920043945,
        "cpu_time_ms": 1.2763370032189414,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.393983840942383,
        "cpu_time_ms": 4.711338995548431,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 9.058591842651367,
        "cpu_time_ms": 9.713845000078436,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8240320086479187,
        "cpu_time_ms": 1.1231059979763813,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9489920139312744,
        "cpu_time_ms": 1.227166001626756,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 8.721471786499023,
        "cpu_time_ms": 8.986575994640589,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.62019157409668,
        "cpu_time_ms": 9.036730996740516,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7786239981651306,
        "cpu_time_ms": 1.0255160013912246,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9513279795646667,
        "cpu_time_ms": 1.1999519992968999,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.162496089935303,
        "cpu_time_ms": 4.466496000532061,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 9.314240455627441,
        "cpu_time_ms": 9.674834000179544,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8686400055885315,
        "cpu_time_ms": 1.1979660048382357,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0388480424880981,
        "cpu_time_ms": 1.3318190030986443,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 5.302271842956543,
        "cpu_time_ms": 5.619536001177039,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.105855941772461,
        "cpu_time_ms": 9.052318004250992,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8554239869117737,
        "cpu_time_ms": 1.1529479961609468,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0469759702682495,
        "cpu_time_ms": 1.322078998782672,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.870528221130371,
        "cpu_time_ms": 5.161556000530254,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.549504280090332,
        "cpu_time_ms": 8.963665000919718,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8547840118408203,
        "cpu_time_ms": 1.1311809939797968,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.2899199724197388,
        "cpu_time_ms": 1.8453489974490367,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.657951831817627,
        "cpu_time_ms": 4.992615999071859,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.198431968688965,
        "cpu_time_ms": 8.623678993899375,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7682560086250305,
        "cpu_time_ms": 1.1163559975102544,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9715200066566467,
        "cpu_time_ms": 1.2071050005033612,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 5.135359764099121,
        "cpu_time_ms": 5.4104810042190365,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.871295928955078,
        "cpu_time_ms": 9.255192999262363,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7797759771347046,
        "cpu_time_ms": 1.0150240050279535,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9556159973144531,
        "cpu_time_ms": 1.2255119945621118,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.087808132171631,
        "cpu_time_ms": 4.329403003794141,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 9.383968353271484,
        "cpu_time_ms": 9.778512998309452,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.877344012260437,
        "cpu_time_ms": 1.1893710034200922,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.9339519739151,
        "cpu_time_ms": 2.5633089971961454,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.6684160232543945,
        "cpu_time_ms": 5.007842002669349,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.22316837310791,
        "cpu_time_ms": 8.675579003465828,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.9016640186309814,
        "cpu_time_ms": 1.2004349991912022,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.055616021156311,
        "cpu_time_ms": 1.3054570008534938,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 5.089280128479004,
        "cpu_time_ms": 5.349678998754825,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 12.57862377166748,
        "cpu_time_ms": 13.073622998490464,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7666239738464355,
        "cpu_time_ms": 1.0112480013049208,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0170880556106567,
        "cpu_time_ms": 1.2486420018831268,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.7770562171936035,
        "cpu_time_ms": 5.023924000852276,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.12611198425293,
        "cpu_time_ms": 8.548300000256859,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.804639995098114,
        "cpu_time_ms": 1.0642229972290806,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0128639936447144,
        "cpu_time_ms": 1.2844880038755946,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.078591823577881,
        "cpu_time_ms": 4.418066004291177,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 7.683008193969727,
        "cpu_time_ms": 8.12165100069251,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7937920093536377,
        "cpu_time_ms": 1.0424499996588565,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9610559940338135,
        "cpu_time_ms": 1.2443309969967231,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.2282562255859375,
        "cpu_time_ms": 4.480909003177658,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.17903995513916,
        "cpu_time_ms": 8.554848995117936,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8474239706993103,
        "cpu_time_ms": 1.1329950066283345,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0579520463943481,
        "cpu_time_ms": 1.3843709966749884,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.112256050109863,
        "cpu_time_ms": 4.386653999972623,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      }
    ],
    "peak_gpu_memory_mb": 2855.20947265625,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 186.5,
    "avg_ram_usage_mb": 1219.16015625,
    "final_tree_nodes": 9,
    "final_tree_edges": 8,
    "tree_memory_mb": 50.92288589477539,
    "efficiency_score": 56058.20535812928,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Consider using classical selection for hot paths",
      "Tree-level quantum may be excessive - consider one-loop for balance",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 221,
    "total_kernel_calls": 401,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         147051 function calls (110669 primitive calls) in 0.318 seconds\n\n   Ordered by: cumulative time\n   List reduced from 175 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.317    0.317 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:214(search)\n       17    0.000    0.000    0.314    0.018 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:296(_run_search_wave_vectorized)\n       68    0.001    0.000    0.314    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:394(_profile_phase)\n       17    0.000    0.000    0.165    0.010 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:369(instrumented_select)\n       17    0.034    0.002    0.109    0.006 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:320(_select_batch_vectorized)\n       17    0.000    0.000    0.093    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:378(instrumented_backup)\n       17    0.040    0.002    0.063    0.004 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:747(_backup_batch_vectorized)\n       29    0.031    0.001    0.057    0.002 {built-in method time.sleep}\n      226    0.004    0.000    0.039    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n      166    0.001    0.000    0.031    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       17    0.000    0.000    0.030    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:375(instrumented_evaluate)\n       68    0.029    0.000    0.029    0.000 {built-in method torch.where}\n36386/226    0.022    0.000    0.028    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       17    0.000    0.000    0.026    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:372(instrumented_expand)\n       17    0.025    0.001    0.026    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n      205    0.001    0.000    0.024    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n       17    0.011    0.001    0.021    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:915(_get_quantum_phases)\n      205    0.019    0.000    0.019    0.000 {built-in method torch._C._cuda_synchronize}\n      138    0.000    0.000    0.019    0.000 {built-in method builtins.next}\n      138    0.000    0.000    0.018    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:196(timer)\n       69    0.000    0.000    0.016    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       69    0.000    0.000    0.016    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:178(end_timer)\n       17    0.000    0.000    0.013    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n       17    0.013    0.001    0.013    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:450(_expand_batch_vectorized)\n       17    0.012    0.001    0.013    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:699(_evaluate_batch_vectorized)\n       17    0.001    0.000    0.012    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:126(batch_ucb_selection)\n       19    0.012    0.001    0.012    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n       60    0.000    0.000    0.010    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n       17    0.009    0.001    0.010    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:974(batch_action_to_child)\n       17    0.000    0.000    0.010    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n    34/17    0.000    0.000    0.010    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n       17    0.000    0.000    0.010    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n       17    0.000    0.000    0.009    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n       17    0.008    0.000    0.008    0.000 {built-in method torch._unique2}\n      599    0.001    0.000    0.006    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n      479    0.000    0.000    0.005    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n      479    0.000    0.000    0.005    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n      226    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n      479    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n       30    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n      138    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n    40440    0.003    0.000    0.003    0.000 {built-in method builtins.isinstance}\n      479    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:753(_get_available_device_type)\n      205    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:490(__init__)\n      479    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:161(is_available)\n      226    0.003    0.000    0.003    0.000 {method 'sort' of 'list' objects}\n      138    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1056(current_stream)\n    27739    0.003    0.000    0.003    0.000 {method 'append' of 'list' objects}\n      226    0.003    0.000    0.003    0.000 {built-in method torch._C._cuda_memoryStats}\n       30    0.001    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 747,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.039928157000000006,
        "cumulative_time": 0.062907594,
        "time_percent": 3.1207082853018067,
        "time_per_call": 0.0037004467058823526
      },
      {
        "rank": 2,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 320,
        "function_name": "_select_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.033748891,
        "cumulative_time": 0.10874534500000001,
        "time_percent": 5.3946189569657275,
        "time_per_call": 0.006396785
      },
      {
        "rank": 3,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 29,
        "primitive_calls": 29,
        "total_time": 0.031074308000000002,
        "cumulative_time": 0.057396142000000004,
        "time_percent": 2.847297194099635,
        "time_per_call": 0.001979177310344828
      },
      {
        "rank": 4,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 68,
        "primitive_calls": 68,
        "total_time": 0.028816791,
        "cumulative_time": 0.028816791,
        "time_percent": 1.4295380368467205,
        "time_per_call": 0.00042377633823529416
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.025278703000000003,
        "cumulative_time": 0.025596323,
        "time_percent": 1.2697776560865004,
        "time_per_call": 0.0015056660588235295
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 226,
        "primitive_calls": 36386,
        "total_time": 0.021549082,
        "cumulative_time": 0.028345609,
        "time_percent": 1.4061637273589809,
        "time_per_call": 0.00012542304867256638
      },
      {
        "rank": 7,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 205,
        "primitive_calls": 205,
        "total_time": 0.019244753,
        "cumulative_time": 0.019244753,
        "time_percent": 0.9546901465614278,
        "time_per_call": 9.387684390243903e-05
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 450,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.01267325,
        "cumulative_time": 0.012942122,
        "time_percent": 0.6420303938946829,
        "time_per_call": 0.000761301294117647
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.012057919,
        "cumulative_time": 0.012213249,
        "time_percent": 0.6058725969515542,
        "time_per_call": 0.0006428025789473685
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 699,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.011988246000000001,
        "cumulative_time": 0.012514108000000001,
        "time_percent": 0.6207975545649008,
        "time_per_call": 0.0007361240000000001
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 915,
        "function_name": "_get_quantum_phases",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.011383362000000001,
        "cumulative_time": 0.021305052,
        "time_percent": 1.0568970781999043,
        "time_per_call": 0.0012532383529411766
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 974,
        "function_name": "batch_action_to_child",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.008934351,
        "cumulative_time": 0.009674466000000001,
        "time_percent": 0.4799291195602018,
        "time_per_call": 0.0005690862352941177
      },
      {
        "rank": 13,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.008126876,
        "cumulative_time": 0.008126876,
        "time_percent": 0.40315656114300613,
        "time_per_call": 0.0004780515294117647
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 226,
        "primitive_calls": 226,
        "total_time": 0.0038945620000000003,
        "cumulative_time": 0.039457561,
        "time_percent": 1.9574033864735225,
        "time_per_call": 0.0001745909778761062
      },
      {
        "rank": 15,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 40440,
        "primitive_calls": 40440,
        "total_time": 0.003089745,
        "cumulative_time": 0.003089745,
        "time_percent": 0.15327549835986148,
        "time_per_call": 7.640318991097923e-08
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 226,
        "primitive_calls": 226,
        "total_time": 0.0028004120000000004,
        "cumulative_time": 0.0028004120000000004,
        "time_percent": 0.13892232042221492,
        "time_per_call": 1.239120353982301e-05
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 27739,
        "primitive_calls": 27739,
        "total_time": 0.002626995,
        "cumulative_time": 0.002626995,
        "time_percent": 0.1303194819682091,
        "time_per_call": 9.470402682144273e-08
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 226,
        "primitive_calls": 226,
        "total_time": 0.0025271630000000002,
        "cumulative_time": 0.0025271630000000002,
        "time_percent": 0.1253670345810423,
        "time_per_call": 1.1182137168141594e-05
      },
      {
        "rank": 19,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1100,
        "function_name": "remove_virtual_loss",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.001719334,
        "cumulative_time": 0.002056609,
        "time_percent": 0.10202387880112317,
        "time_per_call": 0.000120977
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 90,
        "primitive_calls": 90,
        "total_time": 0.0015746100000000002,
        "cumulative_time": 0.001643645,
        "time_percent": 0.08153763708710411,
        "time_per_call": 1.826272222222222e-05
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 119,
        "primitive_calls": 119,
        "total_time": 0.0015230390000000001,
        "cumulative_time": 0.0015230390000000001,
        "time_percent": 0.07555463695110926,
        "time_per_call": 1.2798647058823531e-05
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 30,
        "primitive_calls": 30,
        "total_time": 0.001476282,
        "cumulative_time": 0.0024857150000000003,
        "time_percent": 0.1233108898648863,
        "time_per_call": 8.285716666666668e-05
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 126,
        "function_name": "batch_ucb_selection",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.001400779,
        "cumulative_time": 0.01235633,
        "time_percent": 0.6129705327296936,
        "time_per_call": 0.0007268429411764706
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 68,
        "primitive_calls": 68,
        "total_time": 0.0013741010000000002,
        "cumulative_time": 0.31350938300000003,
        "time_percent": 15.552515472900735,
        "time_per_call": 0.004610432102941177
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1095,
        "function_name": "apply_virtual_loss",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.0010076940000000002,
        "cumulative_time": 0.0010076940000000002,
        "time_percent": 0.04998949752948618,
        "time_per_call": 5.9276117647058836e-05
      },
      {
        "rank": 26,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 479,
        "primitive_calls": 479,
        "total_time": 0.0009576920000000001,
        "cumulative_time": 0.001359917,
        "time_percent": 0.06746251095253743,
        "time_per_call": 2.8390751565762002e-06
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 8815,
        "primitive_calls": 8815,
        "total_time": 0.0009267230000000001,
        "cumulative_time": 0.0009267230000000001,
        "time_percent": 0.04597270314105077,
        "time_per_call": 1.0513023255813955e-07
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 9023,
        "primitive_calls": 9023,
        "total_time": 0.0008264450000000001,
        "cumulative_time": 0.0016912890000000001,
        "time_percent": 0.08390115182500554,
        "time_per_call": 1.8744198160257122e-07
      },
      {
        "rank": 29,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 0,
        "primitive_calls": 29,
        "total_time": 0.000806539,
        "cumulative_time": 0.0,
        "time_percent": 0.0,
        "time_per_call": 0
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x71c7179d2700>",
        "total_calls": 138,
        "primitive_calls": 138,
        "total_time": 0.00075341,
        "cumulative_time": 0.00075341,
        "time_percent": 0.03737502389980507,
        "time_per_call": 5.459492753623189e-06
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 34,
        "primitive_calls": 34,
        "total_time": 0.000751694,
        "cumulative_time": 0.000751694,
        "time_percent": 0.03728989688926358,
        "time_per_call": 2.210864705882353e-05
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000744217,
        "cumulative_time": 0.000744217,
        "time_percent": 0.03691897925650209,
        "time_per_call": 0.0003721085
      },
      {
        "rank": 33,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 599,
        "primitive_calls": 599,
        "total_time": 0.0007357510000000001,
        "cumulative_time": 0.0062561100000000005,
        "time_percent": 0.31035194750508954,
        "time_per_call": 1.0444257095158598e-05
      },
      {
        "rank": 34,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 166,
        "primitive_calls": 166,
        "total_time": 0.000703171,
        "cumulative_time": 0.030541761,
        "time_percent": 1.5151100294887703,
        "time_per_call": 0.00018398651204819277
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 30,
        "primitive_calls": 30,
        "total_time": 0.000678592,
        "cumulative_time": 0.000678592,
        "time_percent": 0.03366346639707002,
        "time_per_call": 2.2619733333333333e-05
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 30,
        "primitive_calls": 30,
        "total_time": 0.000641194,
        "cumulative_time": 0.00081749,
        "time_percent": 0.040553892685060794,
        "time_per_call": 2.7249666666666668e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 104,
        "primitive_calls": 104,
        "total_time": 0.0006238950000000001,
        "cumulative_time": 0.0006755540000000001,
        "time_percent": 0.033512757855097386,
        "time_per_call": 6.495711538461539e-06
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 51,
        "primitive_calls": 51,
        "total_time": 0.00059854,
        "cumulative_time": 0.00059854,
        "time_percent": 0.02969226159062042,
        "time_per_call": 1.1736078431372551e-05
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 205,
        "primitive_calls": 205,
        "total_time": 0.0005651860000000001,
        "cumulative_time": 0.023879602,
        "time_percent": 1.1846148783103927,
        "time_per_call": 0.00011648586341463415
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 85,
        "primitive_calls": 85,
        "total_time": 0.000559233,
        "cumulative_time": 0.000559233,
        "time_percent": 0.02774232720638124,
        "time_per_call": 6.579211764705883e-06
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 91,
        "primitive_calls": 91,
        "total_time": 0.0005154630000000001,
        "cumulative_time": 0.000536397,
        "time_percent": 0.026609483143021383,
        "time_per_call": 5.8944725274725275e-06
      },
      {
        "rank": 42,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 812,
        "function_name": "_get_device_index",
        "total_calls": 479,
        "primitive_calls": 479,
        "total_time": 0.000473296,
        "cumulative_time": 0.005238998,
        "time_percent": 0.2598952435739252,
        "time_per_call": 1.0937365344467641e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 51,
        "primitive_calls": 51,
        "total_time": 0.00047070900000000004,
        "cumulative_time": 0.00047070900000000004,
        "time_percent": 0.023350844991244273,
        "time_per_call": 9.229588235294119e-06
      },
      {
        "rank": 44,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 192,
        "primitive_calls": 192,
        "total_time": 0.00044446400000000005,
        "cumulative_time": 0.000864844,
        "time_percent": 0.042903021156611966,
        "time_per_call": 4.504395833333334e-06
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method mcts.gpu.unified_cuda_kernels.batched_ucb_selection_quantum>",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.000437366,
        "cumulative_time": 0.000437366,
        "time_percent": 0.02169677161567028,
        "time_per_call": 2.5727411764705882e-05
      },
      {
        "rank": 46,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 770,
        "function_name": "_get_device_attr",
        "total_calls": 479,
        "primitive_calls": 479,
        "total_time": 0.000430996,
        "cumulative_time": 0.0043614330000000005,
        "time_percent": 0.2163611614026872,
        "time_per_call": 9.10528810020877e-06
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'scatter_add_' of 'torch._C.TensorBase' objects>",
        "total_calls": 34,
        "primitive_calls": 34,
        "total_time": 0.000396719,
        "cumulative_time": 0.000396719,
        "time_percent": 0.01968036275932994,
        "time_per_call": 1.1668205882352942e-05
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method __new__ of type object at 0xa43b40>",
        "total_calls": 383,
        "primitive_calls": 383,
        "total_time": 0.00039142900000000005,
        "cumulative_time": 0.00039142900000000005,
        "time_percent": 0.01941793741797534,
        "time_per_call": 1.0220078328981725e-06
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'split' of 'bytes' objects>",
        "total_calls": 1651,
        "primitive_calls": 1651,
        "total_time": 0.00037836500000000003,
        "cumulative_time": 0.00037836500000000003,
        "time_percent": 0.018769860922803982,
        "time_per_call": 2.2917322834645671e-07
      },
      {
        "rank": 50,
        "filename": "<frozen _collections_abc>",
        "line_number": 804,
        "function_name": "get",
        "total_calls": 479,
        "primitive_calls": 479,
        "total_time": 0.00037094900000000003,
        "cumulative_time": 0.0017308660000000002,
        "time_percent": 0.08586448031929496,
        "time_per_call": 3.6134989561586643e-06
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": true,
      "quantum_config": "QuantumConfig(quantum_level='one_loop', min_wave_size=3072, optimal_wave_size=3072, hbar_eff=0.1, temperature=1.0, coupling_strength=0.1, decoherence_rate=0.01, measurement_noise=0.0, path_integral_steps=10, path_integral_beta=1.0, use_wick_rotation=True, interference_alpha=0.05, interference_method='minhash', minhash_size=64, phase_kick_strength=0.1, use_mixed_precision=True, cache_corrections=True, fast_mode=True, enable_quantum=True, uncertainty_decay=0.99, phase_temperature=1.0, device='cuda')",
      "enable_virtual_loss": true,
      "virtual_loss_value": -3.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "one_loop",
    "num_simulations": 50000,
    "wave_size": 3072,
    "total_time_ms": 317.8823999987799,
    "simulations_per_second": 157290.87234836502,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 14.333632469177246,
        "cpu_time_ms": 14.8486110047088,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.9474239945411682,
        "cpu_time_ms": 1.2714330005110241,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.997439980506897,
        "cpu_time_ms": 1.283293000597041,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 5.009119987487793,
        "cpu_time_ms": 5.302732999552973,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.69372844696045,
        "cpu_time_ms": 9.211076001520269,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7937600016593933,
        "cpu_time_ms": 1.0500330026843585,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9778879880905151,
        "cpu_time_ms": 1.2255859983270057,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 5.4323201179504395,
        "cpu_time_ms": 5.775470002845395,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.516544342041016,
        "cpu_time_ms": 8.949210998252966,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8891839981079102,
        "cpu_time_ms": 1.3573449978139251,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.2951040267944336,
        "cpu_time_ms": 1.6761349979788065,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.534592151641846,
        "cpu_time_ms": 4.890019998128992,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.563455581665039,
        "cpu_time_ms": 8.943416003603488,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.0160640478134155,
        "cpu_time_ms": 1.3065439998172224,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.3784960508346558,
        "cpu_time_ms": 2.1541160022024997,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.416672229766846,
        "cpu_time_ms": 4.710439003247302,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.617728233337402,
        "cpu_time_ms": 9.04340299894102,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7611839771270752,
        "cpu_time_ms": 1.0021400012192316,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.3325120210647583,
        "cpu_time_ms": 1.6094140009954572,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 5.241856098175049,
        "cpu_time_ms": 5.610274005448446,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.597375869750977,
        "cpu_time_ms": 9.020054996653926,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7673599720001221,
        "cpu_time_ms": 1.034804001392331,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9402880072593689,
        "cpu_time_ms": 1.19713199819671,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.237311840057373,
        "cpu_time_ms": 4.47984499623999,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.225664138793945,
        "cpu_time_ms": 8.60021300468361,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7510079741477966,
        "cpu_time_ms": 0.9857480035861954,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9450240135192871,
        "cpu_time_ms": 1.2564450007630512,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.588768005371094,
        "cpu_time_ms": 4.908337999950163,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.636992454528809,
        "cpu_time_ms": 9.084941004402936,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7900480031967163,
        "cpu_time_ms": 1.0570309968898073,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9539840221405029,
        "cpu_time_ms": 1.222366998263169,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.985184192657471,
        "cpu_time_ms": 5.253074996289797,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 7.444416046142578,
        "cpu_time_ms": 7.820575003279373,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7924799919128418,
        "cpu_time_ms": 1.1145499956910498,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.087391972541809,
        "cpu_time_ms": 1.9614600023487583,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 7.940095901489258,
        "cpu_time_ms": 8.29258199519245,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.114080429077148,
        "cpu_time_ms": 9.534767996228766,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7717120051383972,
        "cpu_time_ms": 1.0651630000211298,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0618239641189575,
        "cpu_time_ms": 1.7099030010285787,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.111584186553955,
        "cpu_time_ms": 4.4239999988349155,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 7.666240215301514,
        "cpu_time_ms": 8.021353001822717,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7652480006217957,
        "cpu_time_ms": 1.0266940007568337,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9604799747467041,
        "cpu_time_ms": 1.2006010001641698,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.946944236755371,
        "cpu_time_ms": 5.187945003854111,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 7.583807945251465,
        "cpu_time_ms": 8.027539006434381,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.949504017829895,
        "cpu_time_ms": 1.2633029982680455,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9513919949531555,
        "cpu_time_ms": 1.2064660040778108,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.181951999664307,
        "cpu_time_ms": 4.470679006772116,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.2041597366333,
        "cpu_time_ms": 8.58373200026108,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7749760150909424,
        "cpu_time_ms": 1.0246689998893999,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9442880153656006,
        "cpu_time_ms": 1.1967509999522008,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.811903953552246,
        "cpu_time_ms": 5.1447250007186085,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 7.603968143463135,
        "cpu_time_ms": 8.715368996490724,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7688639760017395,
        "cpu_time_ms": 1.0595279964036308,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1150399446487427,
        "cpu_time_ms": 1.382138994813431,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.06009578704834,
        "cpu_time_ms": 4.337439997470938,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 7.904319763183594,
        "cpu_time_ms": 8.272512000985444,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7676799893379211,
        "cpu_time_ms": 1.008886996714864,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9826560020446777,
        "cpu_time_ms": 1.2293960025999695,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 5.121024131774902,
        "cpu_time_ms": 5.448192998301238,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.214655876159668,
        "cpu_time_ms": 8.618731997557916,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8088639974594116,
        "cpu_time_ms": 1.0742100057541393,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.114240050315857,
        "cpu_time_ms": 1.4366309987963177,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.264095783233643,
        "cpu_time_ms": 4.534211002464872,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 7.410943984985352,
        "cpu_time_ms": 8.874879000359215,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.86735999584198,
        "cpu_time_ms": 1.1115929955849424,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1013760566711426,
        "cpu_time_ms": 1.7253390033147298,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.36732816696167,
        "cpu_time_ms": 4.678117998992093,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      }
    ],
    "peak_gpu_memory_mb": 2852.7392578125,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 186.0,
    "avg_ram_usage_mb": 1219.16015625,
    "final_tree_nodes": 9,
    "final_tree_edges": 8,
    "tree_memory_mb": 50.92288589477539,
    "efficiency_score": 56460.06828126037,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Consider using classical selection for hot paths",
      "One-loop quantum is a good balance - monitor overhead",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 360,
    "total_kernel_calls": 540,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         145342 function calls (109616 primitive calls) in 0.316 seconds\n\n   Ordered by: cumulative time\n   List reduced from 175 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.001    0.001    0.315    0.315 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:214(search)\n       17    0.000    0.000    0.312    0.018 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:296(_run_search_wave_vectorized)\n       68    0.001    0.000    0.311    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:394(_profile_phase)\n       17    0.000    0.000    0.161    0.009 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:369(instrumented_select)\n       17    0.042    0.002    0.129    0.008 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:320(_select_batch_vectorized)\n       17    0.000    0.000    0.094    0.006 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:378(instrumented_backup)\n       17    0.042    0.002    0.062    0.004 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:747(_backup_batch_vectorized)\n      223    0.004    0.000    0.039    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       17    0.000    0.000    0.033    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:375(instrumented_evaluate)\n       28    0.018    0.001    0.032    0.001 {built-in method time.sleep}\n      165    0.001    0.000    0.030    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       17    0.027    0.002    0.028    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n35903/223    0.021    0.000    0.028    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       68    0.025    0.000    0.026    0.000 {built-in method torch.where}\n       17    0.000    0.000    0.025    0.001 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:372(instrumented_expand)\n      205    0.001    0.000    0.025    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n       17    0.012    0.001    0.023    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:915(_get_quantum_phases)\n      138    0.000    0.000    0.019    0.000 {built-in method builtins.next}\n      138    0.000    0.000    0.019    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:196(timer)\n      205    0.019    0.000    0.019    0.000 {built-in method torch._C._cuda_synchronize}\n       69    0.000    0.000    0.017    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       69    0.000    0.000    0.017    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:178(end_timer)\n       17    0.000    0.000    0.016    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n       17    0.001    0.000    0.016    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:126(batch_ucb_selection)\n       17    0.013    0.001    0.014    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:699(_evaluate_batch_vectorized)\n       17    0.012    0.001    0.012    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:450(_expand_batch_vectorized)\n       19    0.012    0.001    0.012    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n       17    0.000    0.000    0.011    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n    34/17    0.000    0.000    0.011    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n       17    0.000    0.000    0.011    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n       17    0.000    0.000    0.011    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n       17    0.010    0.001    0.010    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:974(batch_action_to_child)\n       58    0.000    0.000    0.010    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n       17    0.008    0.000    0.008    0.000 {built-in method torch._unique2}\n       29    0.003    0.000    0.008    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n      595    0.001    0.000    0.006    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n      479    0.000    0.000    0.005    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n      223    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n    87/58    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n      479    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n      479    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n       29    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n       58    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n      138    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n    39953    0.003    0.000    0.003    0.000 {built-in method builtins.isinstance}\n      205    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:490(__init__)\n      223    0.003    0.000    0.003    0.000 {method 'sort' of 'list' objects}\n       29    0.002    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n      479    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:753(_get_available_device_type)\n    27372    0.003    0.000    0.003    0.000 {method 'append' of 'list' objects}\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 747,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.042293699000000004,
        "cumulative_time": 0.061618507,
        "time_percent": 3.036627564571116,
        "time_per_call": 0.0036246180588235294
      },
      {
        "rank": 2,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 320,
        "function_name": "_select_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.042142843,
        "cumulative_time": 0.128871128,
        "time_percent": 6.3509104425748655,
        "time_per_call": 0.007580654588235294
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.027203527,
        "cumulative_time": 0.028207660000000002,
        "time_percent": 1.3901044030172636,
        "time_per_call": 0.001659274117647059
      },
      {
        "rank": 4,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 68,
        "primitive_calls": 68,
        "total_time": 0.025496143000000002,
        "cumulative_time": 0.025537078,
        "time_percent": 1.258495194851161,
        "time_per_call": 0.00037554526470588235
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 223,
        "primitive_calls": 35903,
        "total_time": 0.021469326,
        "cumulative_time": 0.028110934,
        "time_percent": 1.3853376397165769,
        "time_per_call": 0.000126058
      },
      {
        "rank": 6,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 205,
        "primitive_calls": 205,
        "total_time": 0.01882789,
        "cumulative_time": 0.018847270000000003,
        "time_percent": 0.9288141239597748,
        "time_per_call": 9.19379024390244e-05
      },
      {
        "rank": 7,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.017751161,
        "cumulative_time": 0.032085333,
        "time_percent": 1.5812003787473012,
        "time_per_call": 0.00114590475
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 699,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.013275435,
        "cumulative_time": 0.013810166,
        "time_percent": 0.6805801177055916,
        "time_per_call": 0.000812362705882353
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 915,
        "function_name": "_get_quantum_phases",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.012198269000000001,
        "cumulative_time": 0.023099676000000003,
        "time_percent": 1.1383773526720122,
        "time_per_call": 0.0013588044705882354
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 450,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.011826231000000001,
        "cumulative_time": 0.012003564000000001,
        "time_percent": 0.591548790941876,
        "time_per_call": 0.0007060920000000001
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.011522963,
        "cumulative_time": 0.011665637000000001,
        "time_percent": 0.5748953779824736,
        "time_per_call": 0.0006139808947368422
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 974,
        "function_name": "batch_action_to_child",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.009502232000000001,
        "cumulative_time": 0.010188395000000001,
        "time_percent": 0.5020952730279319,
        "time_per_call": 0.0005993173529411765
      },
      {
        "rank": 13,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.008282638,
        "cumulative_time": 0.008282638,
        "time_percent": 0.40817747918111963,
        "time_per_call": 0.00048721400000000003
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 223,
        "primitive_calls": 223,
        "total_time": 0.0037491210000000002,
        "cumulative_time": 0.039041598000000004,
        "time_percent": 1.9240127426603266,
        "time_per_call": 0.00017507443049327357
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 29,
        "primitive_calls": 29,
        "total_time": 0.003037465,
        "cumulative_time": 0.0076697810000000005,
        "time_percent": 0.37797521447288257,
        "time_per_call": 0.0002644752068965517
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 39953,
        "primitive_calls": 39953,
        "total_time": 0.00303263,
        "cumulative_time": 0.00303263,
        "time_percent": 0.14945133044436312,
        "time_per_call": 7.590493830250545e-08
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 223,
        "primitive_calls": 223,
        "total_time": 0.0027317860000000004,
        "cumulative_time": 0.0027317860000000004,
        "time_percent": 0.13462540837137568,
        "time_per_call": 1.225016143497758e-05
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 27372,
        "primitive_calls": 27372,
        "total_time": 0.0025876040000000003,
        "cumulative_time": 0.0025876040000000003,
        "time_percent": 0.12751996137450192,
        "time_per_call": 9.453470699985388e-08
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 223,
        "primitive_calls": 223,
        "total_time": 0.0024896510000000003,
        "cumulative_time": 0.0024896510000000003,
        "time_percent": 0.12269273016890919,
        "time_per_call": 1.1164354260089688e-05
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1100,
        "function_name": "remove_virtual_loss",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.0017120240000000001,
        "cumulative_time": 0.002066601,
        "time_percent": 0.10184436246678666,
        "time_per_call": 0.00012156476470588235
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 29,
        "primitive_calls": 29,
        "total_time": 0.0016435240000000002,
        "cumulative_time": 0.002716745,
        "time_percent": 0.13388417140504158,
        "time_per_call": 9.368086206896551e-05
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 87,
        "primitive_calls": 87,
        "total_time": 0.001633677,
        "cumulative_time": 0.001672342,
        "time_percent": 0.08241484680227627,
        "time_per_call": 1.922232183908046e-05
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 119,
        "primitive_calls": 119,
        "total_time": 0.001390949,
        "cumulative_time": 0.0014255180000000002,
        "time_percent": 0.07025108954022997,
        "time_per_call": 1.1979142857142858e-05
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 126,
        "function_name": "batch_ucb_selection",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.0013663310000000001,
        "cumulative_time": 0.015844329,
        "time_percent": 0.7808258999773152,
        "time_per_call": 0.0009320193529411765
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 68,
        "primitive_calls": 68,
        "total_time": 0.001275548,
        "cumulative_time": 0.310924223,
        "time_percent": 15.322686511288829,
        "time_per_call": 0.004572415044117647
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1095,
        "function_name": "apply_virtual_loss",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.001099628,
        "cumulative_time": 0.001099628,
        "time_percent": 0.05419087313449848,
        "time_per_call": 6.4684e-05
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 8698,
        "primitive_calls": 8698,
        "total_time": 0.0009100110000000001,
        "cumulative_time": 0.0009100110000000001,
        "time_percent": 0.04484633953664157,
        "time_per_call": 1.0462301678546793e-07
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x71c7179d2700>",
        "total_calls": 138,
        "primitive_calls": 138,
        "total_time": 0.000839705,
        "cumulative_time": 0.000839705,
        "time_percent": 0.04138158279473062,
        "time_per_call": 6.0848188405797105e-06
      },
      {
        "rank": 29,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 595,
        "primitive_calls": 595,
        "total_time": 0.0007789050000000001,
        "cumulative_time": 0.005891307,
        "time_percent": 0.2903300663800693,
        "time_per_call": 9.901356302521008e-06
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 8906,
        "primitive_calls": 8906,
        "total_time": 0.000776242,
        "cumulative_time": 0.0016110030000000002,
        "time_percent": 0.07939199364903082,
        "time_per_call": 1.8088962497192905e-07
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 29,
        "primitive_calls": 29,
        "total_time": 0.000689674,
        "cumulative_time": 0.000689674,
        "time_percent": 0.03398789066680923,
        "time_per_call": 2.3781862068965517e-05
      },
      {
        "rank": 32,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 165,
        "primitive_calls": 165,
        "total_time": 0.0006772330000000001,
        "cumulative_time": 0.030014674,
        "time_percent": 1.4791560335925695,
        "time_per_call": 0.00018190711515151517
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 51,
        "primitive_calls": 51,
        "total_time": 0.0006719460000000001,
        "cumulative_time": 0.0006719460000000001,
        "time_percent": 0.03311423539527342,
        "time_per_call": 1.3175411764705884e-05
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0006699150000000001,
        "cumulative_time": 0.0006699150000000001,
        "time_percent": 0.03301414548910864,
        "time_per_call": 0.00033495750000000005
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 88,
        "primitive_calls": 88,
        "total_time": 0.000636093,
        "cumulative_time": 0.000796124,
        "time_percent": 0.039233863345903765,
        "time_per_call": 9.046863636363638e-06
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 34,
        "primitive_calls": 34,
        "total_time": 0.000630475,
        "cumulative_time": 0.000630475,
        "time_percent": 0.031070499059202682,
        "time_per_call": 1.8543382352941177e-05
      },
      {
        "rank": 37,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 479,
        "primitive_calls": 479,
        "total_time": 0.000625956,
        "cumulative_time": 0.0010305470000000001,
        "time_percent": 0.0507864857353014,
        "time_per_call": 2.1514551148225474e-06
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 85,
        "primitive_calls": 85,
        "total_time": 0.000606594,
        "cumulative_time": 0.000662393,
        "time_percent": 0.03264345308429747,
        "time_per_call": 7.792858823529412e-06
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 205,
        "primitive_calls": 205,
        "total_time": 0.000580525,
        "cumulative_time": 0.024959031000000003,
        "time_percent": 1.2300084050979194,
        "time_per_call": 0.00012175137073170733
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 104,
        "primitive_calls": 104,
        "total_time": 0.0005619780000000001,
        "cumulative_time": 0.0005619780000000001,
        "time_percent": 0.027694891820123888,
        "time_per_call": 5.403634615384617e-06
      },
      {
        "rank": 41,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 214,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0005378290000000001,
        "cumulative_time": 0.315208084,
        "time_percent": 15.533799876878671,
        "time_per_call": 0.315208084
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 29,
        "primitive_calls": 29,
        "total_time": 0.000505518,
        "cumulative_time": 0.0006083890000000001,
        "time_percent": 0.029982076770893793,
        "time_per_call": 2.097893103448276e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 51,
        "primitive_calls": 51,
        "total_time": 0.000463567,
        "cumulative_time": 0.000463567,
        "time_percent": 0.022845089872520576,
        "time_per_call": 9.089549019607843e-06
      },
      {
        "rank": 44,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 812,
        "function_name": "_get_device_index",
        "total_calls": 479,
        "primitive_calls": 479,
        "total_time": 0.00045914100000000004,
        "cumulative_time": 0.004821182,
        "time_percent": 0.2375931334236011,
        "time_per_call": 1.0065098121085595e-05
      },
      {
        "rank": 45,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 770,
        "function_name": "_get_device_attr",
        "total_calls": 479,
        "primitive_calls": 479,
        "total_time": 0.00043899700000000005,
        "cumulative_time": 0.003969561,
        "time_percent": 0.19562431708782688,
        "time_per_call": 8.287183716075156e-06
      },
      {
        "rank": 46,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 192,
        "primitive_calls": 192,
        "total_time": 0.000431998,
        "cumulative_time": 0.000834761,
        "time_percent": 0.04113793705564708,
        "time_per_call": 4.347713541666667e-06
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method mcts.gpu.unified_cuda_kernels.batched_ucb_selection_quantum>",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.000390597,
        "cumulative_time": 0.000390597,
        "time_percent": 0.019249048290618014,
        "time_per_call": 2.2976294117647058e-05
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method __new__ of type object at 0xa43b40>",
        "total_calls": 380,
        "primitive_calls": 380,
        "total_time": 0.000386242,
        "cumulative_time": 0.000386242,
        "time_percent": 0.019034429117133215,
        "time_per_call": 1.0164263157894736e-06
      },
      {
        "rank": 49,
        "filename": "<frozen _collections_abc>",
        "line_number": 804,
        "function_name": "get",
        "total_calls": 479,
        "primitive_calls": 479,
        "total_time": 0.00036167400000000003,
        "cumulative_time": 0.0013922210000000001,
        "time_percent": 0.06861017688362302,
        "time_per_call": 2.906515657620042e-06
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'split' of 'bytes' objects>",
        "total_calls": 1596,
        "primitive_calls": 1596,
        "total_time": 0.000360047,
        "cumulative_time": 0.000360047,
        "time_percent": 0.017743510804978387,
        "time_per_call": 2.2559335839598997e-07
      }
    ]
  }
]