[
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": null,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": false,
      "quantum_config": null,
      "quantum_version": "v2",
      "quantum_branching_factor": null,
      "quantum_avg_game_length": null,
      "enable_phase_adaptation": true,
      "envariance_threshold": 0.001,
      "envariance_check_interval": 1000,
      "enable_virtual_loss": true,
      "virtual_loss": 1.0,
      "virtual_loss_value": -1.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "compile_mode": "reduce-overhead",
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "target_sims_per_second": 100000,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "tree_batch_size": 1024,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "classical",
    "num_simulations": 1000,
    "wave_size": 3072,
    "total_time_ms": 8.986528031527996,
    "simulations_per_second": 111277.6810456316,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 2.965087890625,
        "cpu_time_ms": 3.026875085197389,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.2096640020608902,
        "cpu_time_ms": 0.2593790413811803,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1948479413986206,
        "cpu_time_ms": 1.240949030034244,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7650880217552185,
        "cpu_time_ms": 0.811169040389359,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      }
    ],
    "peak_gpu_memory_mb": 2823.37890625,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 0.0,
    "avg_ram_usage_mb": 1270.515625,
    "final_tree_nodes": 17,
    "final_tree_edges": 16,
    "tree_memory_mb": 47.73538589477539,
    "efficiency_score": 40358.856949197965,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 0,
    "total_kernel_calls": 14,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         6011 function calls (4730 primitive calls) in 0.008 seconds\n\n   Ordered by: cumulative time\n   List reduced from 166 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.008    0.008 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:421(search)\n        1    0.000    0.000    0.008    0.008 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:461(_search_optimized)\n        1    0.000    0.000    0.007    0.007 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:637(_run_search_wave_vectorized)\n        4    0.000    0.000    0.007    0.002 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:394(_profile_phase)\n        1    0.000    0.000    0.004    0.004 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:369(instrumented_select)\n        1    0.001    0.001    0.003    0.003 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:661(_select_batch_vectorized)\n        1    0.000    0.000    0.002    0.002 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:375(instrumented_evaluate)\n        8    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        8    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        1    0.000    0.000    0.001    0.001 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:378(instrumented_backup)\n        1    0.000    0.000    0.001    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1029(_evaluate_batch_vectorized)\n   1288/8    0.001    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        1    0.001    0.001    0.001    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:391(get_nn_features)\n        1    0.000    0.000    0.001    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1098(_backup_batch_vectorized)\n        2    0.000    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:964(batch_select_ucb_optimized)\n        2    0.000    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:208(batch_ucb_selection)\n        2    0.000    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1162(batch_action_to_child)\n        1    0.000    0.000    0.001    0.001 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:372(instrumented_expand)\n        2    0.001    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:920(batch_get_children)\n       10    0.000    0.000    0.000    0.000 {built-in method builtins.next}\n       10    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:196(timer)\n        1    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1142(_add_dirichlet_noise_to_root)\n       31    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n        3    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:814(get_children)\n       31    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n       31    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n       10    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n       13    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        5    0.000    0.000    0.000    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       31    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n        1    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1196(_extract_policy)\n        9    0.000    0.000    0.000    0.000 {built-in method torch.where}\n        5    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:178(end_timer)\n       10    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1056(current_stream)\n        5    0.000    0.000    0.000    0.000 /usr/lib/python3.12/contextlib.py:132(__enter__)\n        8    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n        5    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:169(start_timer)\n       13    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:490(__init__)\n        1    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:873(_expand_batch_vectorized)\n       31    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:753(_get_available_device_type)\n       32    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:161(is_available)\n       10    0.000    0.000    0.000    0.000 {method 'float' of 'torch._C.TensorBase' objects}\n      340    0.000    0.000    0.000    0.000 {built-in method builtins.len}\n       13    0.000    0.000    0.000    0.000 {method 'any' of 'torch._C.TensorBase' objects}\n     1546    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}\n       32    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:157(_nvml_based_avail)\n        2    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1239(apply_virtual_loss)\n       32    0.000    0.000    0.000    0.000 <frozen os>:779(getenv)\n        8    0.000    0.000    0.000    0.000 {method 'sort' of 'list' objects}\n      985    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 8,
        "primitive_calls": 1288,
        "total_time": 0.0007108170000000001,
        "cumulative_time": 0.0009436690000000001,
        "time_percent": 1.6761713815693886,
        "time_per_call": 0.00011795862500000001
      },
      {
        "rank": 2,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 661,
        "function_name": "_select_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000666362,
        "cumulative_time": 0.0029021510000000004,
        "time_percent": 5.1548821156496425,
        "time_per_call": 0.0029021510000000004
      },
      {
        "rank": 3,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 391,
        "function_name": "get_nn_features",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0005588850000000001,
        "cumulative_time": 0.0007799500000000001,
        "time_percent": 1.3853690955780518,
        "time_per_call": 0.0007799500000000001
      },
      {
        "rank": 4,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 920,
        "function_name": "batch_get_children",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000502206,
        "cumulative_time": 0.000552663,
        "time_percent": 0.9816555426238256,
        "time_per_call": 0.0002763315
      },
      {
        "rank": 5,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1162,
        "function_name": "batch_action_to_child",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000489044,
        "cumulative_time": 0.000652248,
        "time_percent": 1.1585412165556677,
        "time_per_call": 0.000326124
      },
      {
        "rank": 6,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1098,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000435972,
        "cumulative_time": 0.00071122,
        "time_percent": 1.2632889392358766,
        "time_per_call": 0.00071122
      },
      {
        "rank": 7,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 814,
        "function_name": "get_children",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.00033204400000000003,
        "cumulative_time": 0.00035580000000000003,
        "time_percent": 0.6319819529542545,
        "time_per_call": 0.00011860000000000001
      },
      {
        "rank": 8,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 208,
        "function_name": "batch_ucb_selection",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00031916400000000004,
        "cumulative_time": 0.000684369,
        "time_percent": 1.2155954389020522,
        "time_per_call": 0.0003421845
      },
      {
        "rank": 9,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1029,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00025419,
        "cumulative_time": 0.0011412920000000001,
        "time_percent": 2.0271949045842246,
        "time_per_call": 0.0011412920000000001
      },
      {
        "rank": 10,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.000228368,
        "cumulative_time": 0.000228368,
        "time_percent": 0.40563365551505676,
        "time_per_call": 2.5374222222222223e-05
      },
      {
        "rank": 11,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 461,
        "function_name": "_search_optimized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00014865,
        "cumulative_time": 0.007610174000000001,
        "time_percent": 13.517404797194185,
        "time_per_call": 0.007610174000000001
      },
      {
        "rank": 12,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1142,
        "function_name": "_add_dirichlet_noise_to_root",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00013387000000000002,
        "cumulative_time": 0.000367332,
        "time_percent": 0.6524654152405627,
        "time_per_call": 0.000367332
      },
      {
        "rank": 13,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 0.00013309000000000001,
        "cumulative_time": 0.00013309000000000001,
        "time_percent": 0.2363981959490774,
        "time_per_call": 1.3309e-05
      },
      {
        "rank": 14,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.000127631,
        "cumulative_time": 0.001341509,
        "time_percent": 2.38282596325382,
        "time_per_call": 0.000167688625
      },
      {
        "rank": 15,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.00012417300000000002,
        "cumulative_time": 0.00012417300000000002,
        "time_percent": 0.22055957010733182,
        "time_per_call": 9.551769230769231e-06
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 1546,
        "primitive_calls": 1546,
        "total_time": 0.00011592300000000001,
        "cumulative_time": 0.00011592300000000001,
        "time_percent": 0.20590568839886467,
        "time_per_call": 7.498253557567918e-08
      },
      {
        "rank": 17,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 873,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00010989700000000001,
        "cumulative_time": 0.00015845800000000002,
        "time_percent": 0.2814575500315494,
        "time_per_call": 0.00015845800000000002
      },
      {
        "rank": 18,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1239,
        "function_name": "apply_virtual_loss",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000107973,
        "cumulative_time": 0.000107973,
        "time_percent": 0.19178467511615999,
        "time_per_call": 5.39865e-05
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 9.289400000000001e-05,
        "cumulative_time": 9.289400000000001e-05,
        "time_percent": 0.16500093180925388,
        "time_per_call": 1.1611750000000001e-05
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 985,
        "primitive_calls": 985,
        "total_time": 9.249900000000001e-05,
        "cumulative_time": 9.249900000000001e-05,
        "time_percent": 0.1642993217153333,
        "time_per_call": 9.390761421319798e-08
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 9.1655e-05,
        "cumulative_time": 9.1655e-05,
        "time_percent": 0.162800185210855,
        "time_per_call": 1.1456875e-05
      },
      {
        "rank": 22,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1244,
        "function_name": "remove_virtual_loss",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 6.6795e-05,
        "cumulative_time": 8.3367e-05,
        "time_percent": 0.14807880683512462,
        "time_per_call": 8.3367e-05
      },
      {
        "rank": 23,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 6.4102e-05,
        "cumulative_time": 0.006840532000000001,
        "time_percent": 12.150345060725332,
        "time_per_call": 0.0017101330000000002
      },
      {
        "rank": 24,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1196,
        "function_name": "_extract_policy",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 6.1116e-05,
        "cumulative_time": 0.00024194600000000002,
        "time_percent": 0.42975128046506483,
        "time_per_call": 0.00024194600000000002
      },
      {
        "rank": 25,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x746c91bdbba0>",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 5.7107e-05,
        "cumulative_time": 5.7107e-05,
        "time_percent": 0.10143505730005231,
        "time_per_call": 5.7107e-06
      },
      {
        "rank": 26,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 5.2578000000000004e-05,
        "cumulative_time": 5.2578000000000004e-05,
        "time_percent": 0.09339052029912533,
        "time_per_call": 1.0515600000000001e-05
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 5.0858e-05,
        "cumulative_time": 5.0858e-05,
        "time_percent": 0.09033540799142067,
        "time_per_call": 8.476333333333334e-06
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'long' of 'torch._C.TensorBase' objects>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 5.0696000000000004e-05,
        "cumulative_time": 5.0696000000000004e-05,
        "time_percent": 0.09004765904150897,
        "time_per_call": 5.632888888888889e-06
      },
      {
        "rank": 29,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 26,
        "primitive_calls": 26,
        "total_time": 4.5089e-05,
        "cumulative_time": 8.557000000000001e-05,
        "time_percent": 0.1519918373083068,
        "time_per_call": 3.2911538461538466e-06
      },
      {
        "rank": 30,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 4.3305e-05,
        "cumulative_time": 0.000358084,
        "time_percent": 0.6360388579023925,
        "time_per_call": 1.1551096774193548e-05
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 4.1598000000000004e-05,
        "cumulative_time": 4.1598000000000004e-05,
        "time_percent": 0.07388753591622002,
        "time_per_call": 1.0399500000000001e-05
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method mcts_cuda_kernels.batched_ucb_selection>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 4.0826000000000005e-05,
        "cumulative_time": 4.0826000000000005e-05,
        "time_percent": 0.07251628783392468,
        "time_per_call": 2.0413000000000003e-05
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 4.0616000000000006e-05,
        "cumulative_time": 4.0616000000000006e-05,
        "time_percent": 0.07214327993589097,
        "time_per_call": 4.0616000000000006e-05
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 340,
        "primitive_calls": 340,
        "total_time": 4.0586e-05,
        "cumulative_time": 0.00012615600000000002,
        "time_percent": 0.22408183040162152,
        "time_per_call": 3.710470588235295e-07
      },
      {
        "rank": 35,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 32,
        "primitive_calls": 32,
        "total_time": 3.9791000000000006e-05,
        "cumulative_time": 6.6411e-05,
        "time_percent": 0.11796108341103147,
        "time_per_call": 2.07534375e-06
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 3.7449e-05,
        "cumulative_time": 3.7449e-05,
        "time_percent": 0.06651796558792546,
        "time_per_call": 9.36225e-06
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 3.6839000000000004e-05,
        "cumulative_time": 3.6839000000000004e-05,
        "time_percent": 0.06543446645554184,
        "time_per_call": 1.2279666666666669e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'scatter_add_' of 'torch._C.TensorBase' objects>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 3.5978e-05,
        "cumulative_time": 3.5978e-05,
        "time_percent": 0.06390513407360363,
        "time_per_call": 8.9945e-06
      },
      {
        "rank": 39,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 3.1342e-05,
        "cumulative_time": 0.000248118,
        "time_percent": 0.4407141602110841,
        "time_per_call": 1.9086000000000003e-05
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.ones_like>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 3.0798e-05,
        "cumulative_time": 3.0798e-05,
        "time_percent": 0.05470427258877214,
        "time_per_call": 7.6995e-06
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 3.0729000000000003e-05,
        "cumulative_time": 3.0729000000000003e-05,
        "time_percent": 0.05458171285084679,
        "time_per_call": 2.363769230769231e-06
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.maximum>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 3.0558e-05,
        "cumulative_time": 3.0558e-05,
        "time_percent": 0.0542779778481622,
        "time_per_call": 1.0186e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 313,
        "primitive_calls": 313,
        "total_time": 3.051e-05,
        "cumulative_time": 3.051e-05,
        "time_percent": 0.0541927189000402,
        "time_per_call": 9.747603833865816e-08
      },
      {
        "rank": 44,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 812,
        "function_name": "_get_device_index",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 2.9834000000000003e-05,
        "cumulative_time": 0.000299053,
        "time_percent": 0.5311863377651171,
        "time_per_call": 9.646870967741936e-06
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 2.8693e-05,
        "cumulative_time": 2.8693e-05,
        "time_percent": 0.05096531246800569,
        "time_per_call": 5.7386e-06
      },
      {
        "rank": 46,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 2.8322e-05,
        "cumulative_time": 0.001371543,
        "time_percent": 2.436173197584983,
        "time_per_call": 0.000171442875
      },
      {
        "rank": 47,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 770,
        "function_name": "_get_device_attr",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 2.8298000000000002e-05,
        "cumulative_time": 0.00024487,
        "time_percent": 0.43494497138816274,
        "time_per_call": 7.899032258064516e-06
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 2.7503e-05,
        "cumulative_time": 2.7503e-05,
        "time_percent": 0.04885160104581467,
        "time_per_call": 1.37515e-05
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 2.7492e-05,
        "cumulative_time": 2.7492e-05,
        "time_percent": 0.04883206253687005,
        "time_per_call": 9.164e-06
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full_like>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 2.6831e-05,
        "cumulative_time": 2.6831e-05,
        "time_percent": 0.04765797577210681,
        "time_per_call": 1.34155e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": null,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": true,
      "quantum_config": "QuantumConfig(quantum_level='tree_level', min_wave_size=3072, optimal_wave_size=3072, hbar_eff=0.1, temperature=1.0, coupling_strength=0.1, decoherence_rate=0.01, measurement_noise=0.0, path_integral_steps=10, path_integral_beta=1.0, use_wick_rotation=True, interference_alpha=0.05, interference_method='minhash', minhash_size=64, phase_kick_strength=0.1, use_mixed_precision=True, cache_corrections=True, fast_mode=True, enable_quantum=True, uncertainty_decay=0.99, phase_temperature=1.0, device='cuda')",
      "quantum_version": "v2",
      "quantum_branching_factor": null,
      "quantum_avg_game_length": null,
      "enable_phase_adaptation": true,
      "envariance_threshold": 0.001,
      "envariance_check_interval": 1000,
      "enable_virtual_loss": true,
      "virtual_loss": 1.0,
      "virtual_loss_value": -1.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "compile_mode": "reduce-overhead",
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "target_sims_per_second": 100000,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "tree_batch_size": 1024,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "tree_level",
    "num_simulations": 1000,
    "wave_size": 3072,
    "total_time_ms": 29.35509802773595,
    "simulations_per_second": 34065.633133132695,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 19.044160842895508,
        "cpu_time_ms": 19.110077992081642,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "expansion",
        "gpu_time_ms": 3.973695993423462,
        "cpu_time_ms": 4.024846013635397,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.18339204788208,
        "cpu_time_ms": 1.230248948559165,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7345280051231384,
        "cpu_time_ms": 0.7812120020389557,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      }
    ],
    "peak_gpu_memory_mb": 2838.546875,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 182.1,
    "avg_ram_usage_mb": 1337.59765625,
    "final_tree_nodes": 49,
    "final_tree_edges": 48,
    "tree_memory_mb": 47.73538589477539,
    "efficiency_score": 12289.107724644455,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Consider using classical selection for hot paths",
      "Tree-level quantum may be excessive - consider one-loop for balance",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 12,
    "total_kernel_calls": 28,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         9798 function calls (7554 primitive calls) in 0.028 seconds\n\n   Ordered by: cumulative time\n   List reduced from 234 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    0.028    0.028 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:421(search)\n        1    0.000    0.000    0.027    0.027 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:461(_search_optimized)\n        1    0.000    0.000    0.027    0.027 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:637(_run_search_wave_vectorized)\n        4    0.000    0.000    0.026    0.007 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:394(_profile_phase)\n        1    0.000    0.000    0.020    0.020 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:369(instrumented_select)\n        1    0.001    0.001    0.018    0.018 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:661(_select_batch_vectorized)\n        2    0.000    0.000    0.011    0.006 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:964(batch_select_ucb_optimized)\n        2    0.000    0.000    0.011    0.006 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:208(batch_ucb_selection)\n        2    0.003    0.001    0.010    0.005 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py:1124(__format__)\n        7    0.007    0.001    0.007    0.001 {method 'item' of 'torch._C.TensorBase' objects}\n        1    0.000    0.000    0.006    0.006 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1389(ensure_consistent)\n        1    0.001    0.001    0.006    0.006 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1351(_rebuild_row_pointers)\n        4    0.005    0.001    0.005    0.001 {method 'sum' of 'torch._C.TensorBase' objects}\n        1    0.000    0.000    0.004    0.004 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:372(instrumented_expand)\n        1    0.000    0.000    0.004    0.004 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:873(_expand_batch_vectorized)\n       14    0.000    0.000    0.003    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        1    0.000    0.000    0.003    0.003 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:897(_expand_node_batch)\n       10    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n  2254/14    0.001    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        1    0.000    0.000    0.002    0.002 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:375(instrumented_evaluate)\n        2    0.001    0.001    0.002    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:391(get_nn_features)\n        1    0.000    0.000    0.001    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1029(_evaluate_batch_vectorized)\n        1    0.000    0.000    0.001    0.001 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:378(instrumented_backup)\n        4    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        1    0.000    0.000    0.001    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1098(_backup_batch_vectorized)\n        2    0.001    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1162(batch_action_to_child)\n        2    0.000    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:512(add_children_batch)\n       10    0.000    0.000    0.000    0.000 {built-in method builtins.next}\n       10    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:196(timer)\n        2    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:920(batch_get_children)\n       16    0.000    0.000    0.000    0.000 {built-in method torch.where}\n       39    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n        1    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1142(_add_dirichlet_noise_to_root)\n        3    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:814(get_children)\n       14    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n       31    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n        1    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:318(apply_moves)\n        4    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_common.py:452(wrapper)\n       31    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n       10    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n       31    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n       13    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        5    0.000    0.000    0.000    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n        1    0.000    0.000    0.000    0.000 {built-in method time.sleep}\n     1719    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}\n        5    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:178(end_timer)\n       14    0.000    0.000    0.000    0.000 {built-in method torch._C._cuda_memoryStats}\n        1    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1196(_extract_policy)\n      594    0.000    0.000    0.000    0.000 {built-in method builtins.len}\n      6/4    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py:1642(wrapper)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.007064393,
        "cumulative_time": 0.007064393,
        "time_percent": 2.926038714847432,
        "time_per_call": 0.0010091990000000001
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.004896929,
        "cumulative_time": 0.004896929,
        "time_percent": 2.028285209763829,
        "time_per_call": 0.00122423225
      },
      {
        "rank": 3,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1124,
        "function_name": "__format__",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0025773690000000004,
        "cumulative_time": 0.010492947,
        "time_percent": 4.346129830948281,
        "time_per_call": 0.0052464735
      },
      {
        "rank": 4,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 14,
        "primitive_calls": 2254,
        "total_time": 0.0013951970000000001,
        "cumulative_time": 0.0019000640000000001,
        "time_percent": 0.786997669111539,
        "time_per_call": 0.00013571885714285716
      },
      {
        "rank": 5,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 391,
        "function_name": "get_nn_features",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.001148554,
        "cumulative_time": 0.0015416050000000001,
        "time_percent": 0.6385256189742524,
        "time_per_call": 0.0007708025000000001
      },
      {
        "rank": 6,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1351,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0006920040000000001,
        "cumulative_time": 0.005611516,
        "time_percent": 2.3242638206829382,
        "time_per_call": 0.005611516
      },
      {
        "rank": 7,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 661,
        "function_name": "_select_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000570135,
        "cumulative_time": 0.018328125,
        "time_percent": 7.591424106864254,
        "time_per_call": 0.018328125
      },
      {
        "rank": 8,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1162,
        "function_name": "batch_action_to_child",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0005004160000000001,
        "cumulative_time": 0.0006578010000000001,
        "time_percent": 0.27245811390523655,
        "time_per_call": 0.00032890050000000003
      },
      {
        "rank": 9,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 512,
        "function_name": "add_children_batch",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000451468,
        "cumulative_time": 0.000636499,
        "time_percent": 0.26363492460876337,
        "time_per_call": 0.0003182495
      },
      {
        "rank": 10,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1098,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000418709,
        "cumulative_time": 0.0006827570000000001,
        "time_percent": 0.2827947730021657,
        "time_per_call": 0.0006827570000000001
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.0004135,
        "cumulative_time": 0.0004135,
        "time_percent": 0.17126977626944215,
        "time_per_call": 2.584375e-05
      },
      {
        "rank": 12,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 920,
        "function_name": "batch_get_children",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00038199800000000004,
        "cumulative_time": 0.000428958,
        "time_percent": 0.17767240795402023,
        "time_per_call": 0.000214479
      },
      {
        "rank": 13,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 814,
        "function_name": "get_children",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.000341775,
        "cumulative_time": 0.00036969700000000005,
        "time_percent": 0.15312677745461659,
        "time_per_call": 0.00012323233333333335
      },
      {
        "rank": 14,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 897,
        "function_name": "_expand_node_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000305576,
        "cumulative_time": 0.002590432,
        "time_percent": 1.0729448829049664,
        "time_per_call": 0.002590432
      },
      {
        "rank": 15,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.000269084,
        "cumulative_time": 0.0026848420000000002,
        "time_percent": 1.112049065680294,
        "time_per_call": 0.0001917744285714286
      },
      {
        "rank": 16,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 208,
        "function_name": "batch_ucb_selection",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00026217600000000003,
        "cumulative_time": 0.011017607,
        "time_percent": 4.563441562066843,
        "time_per_call": 0.0055088035
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 1719,
        "primitive_calls": 1719,
        "total_time": 0.00023984900000000001,
        "cumulative_time": 0.00023984900000000001,
        "time_percent": 0.09934433994788254,
        "time_per_call": 1.395282140779523e-07
      },
      {
        "rank": 18,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00023318000000000001,
        "cumulative_time": 0.026420637,
        "time_percent": 10.943304928382455,
        "time_per_call": 0.00660515925
      },
      {
        "rank": 19,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1029,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00023083600000000002,
        "cumulative_time": 0.001129959,
        "time_percent": 0.4680237608794258,
        "time_per_call": 0.001129959
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.000226385,
        "cumulative_time": 0.000226385,
        "time_percent": 0.09376761378659652,
        "time_per_call": 1.6170357142857144e-05
      },
      {
        "rank": 21,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 421,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 2,
        "total_time": 0.00020595000000000002,
        "cumulative_time": 0.027606803000000003,
        "time_percent": 11.434609367169443,
        "time_per_call": 0.027606803000000003
      },
      {
        "rank": 22,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 318,
        "function_name": "apply_moves",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000201587,
        "cumulative_time": 0.000310074,
        "time_percent": 0.12843120823934948,
        "time_per_call": 0.000310074
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 2523,
        "primitive_calls": 2523,
        "total_time": 0.000195491,
        "cumulative_time": 0.000195491,
        "time_percent": 0.08097146271508951,
        "time_per_call": 7.748355132778438e-08
      },
      {
        "rank": 24,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.000178516,
        "cumulative_time": 0.000178516,
        "time_percent": 0.07394049668806707,
        "time_per_call": 1.2751142857142859e-05
      },
      {
        "rank": 25,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 873,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00016826700000000002,
        "cumulative_time": 0.003914708,
        "time_percent": 1.6214538411612947,
        "time_per_call": 0.003914708
      },
      {
        "rank": 26,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.00014976,
        "cumulative_time": 0.00014976,
        "time_percent": 0.062029895269919366,
        "time_per_call": 8.809411764705882e-06
      },
      {
        "rank": 27,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1142,
        "function_name": "_add_dirichlet_noise_to_root",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00013680000000000002,
        "cumulative_time": 0.00038285200000000004,
        "time_percent": 0.1585755172534667,
        "time_per_call": 0.00038285200000000004
      },
      {
        "rank": 28,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1014,
        "function_name": "_clone_states_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000132921,
        "cumulative_time": 0.000132921,
        "time_percent": 0.05505525981018264,
        "time_per_call": 0.000132921
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.000126408,
        "cumulative_time": 0.000126408,
        "time_percent": 0.05235760551068353,
        "time_per_call": 9.723692307692307e-06
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000117193,
        "cumulative_time": 0.000245353,
        "time_percent": 0.10162407114156335,
        "time_per_call": 0.000245353
      },
      {
        "rank": 31,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00010160800000000001,
        "cumulative_time": 0.000172706,
        "time_percent": 0.07153402171799342,
        "time_per_call": 8.6353e-05
      },
      {
        "rank": 32,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1239,
        "function_name": "apply_virtual_loss",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00010135000000000001,
        "cumulative_time": 0.00010135000000000001,
        "time_percent": 0.04197869848829012,
        "time_per_call": 5.0675000000000005e-05
      },
      {
        "rank": 33,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 964,
        "function_name": "batch_select_ucb_optimized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 8.9177e-05,
        "cumulative_time": 0.011179060000000001,
        "time_percent": 4.630314643537291,
        "time_per_call": 0.0055895300000000005
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 8.1542e-05,
        "cumulative_time": 8.1542e-05,
        "time_percent": 0.033774317041264455,
        "time_per_call": 6.272461538461539e-06
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'long' of 'torch._C.TensorBase' objects>",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 8.074200000000001e-05,
        "cumulative_time": 8.074200000000001e-05,
        "time_percent": 0.03344296076311318,
        "time_per_call": 5.0463750000000005e-06
      },
      {
        "rank": 36,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 44,
        "primitive_calls": 44,
        "total_time": 7.7032e-05,
        "cumulative_time": 0.000147123,
        "time_percent": 0.06093766213806321,
        "time_per_call": 3.3437045454545455e-06
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 7.511e-05,
        "cumulative_time": 7.511e-05,
        "time_percent": 0.031110212564928172,
        "time_per_call": 1.2518333333333333e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 7.380900000000001e-05,
        "cumulative_time": 7.380900000000001e-05,
        "time_percent": 0.030571344417584658,
        "time_per_call": 1.054414285714286e-05
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 7.2196e-05,
        "cumulative_time": 7.2196e-05,
        "time_percent": 0.029903247321762142,
        "time_per_call": 1.2032666666666666e-05
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 594,
        "primitive_calls": 594,
        "total_time": 7.077300000000001e-05,
        "cumulative_time": 0.000217896,
        "time_percent": 0.09025150948006376,
        "time_per_call": 3.6682828282828284e-07
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 7.017300000000001e-05,
        "cumulative_time": 7.017300000000001e-05,
        "time_percent": 0.029065330133387097,
        "time_per_call": 1.7543250000000002e-05
      },
      {
        "rank": 42,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1344,
        "function_name": "set_expanded",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 6.7759e-05,
        "cumulative_time": 6.7759e-05,
        "time_percent": 0.028065462564065613,
        "time_per_call": 3.38795e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 6.625500000000001e-05,
        "cumulative_time": 6.625500000000001e-05,
        "time_percent": 0.02744251276114121,
        "time_per_call": 8.281875000000001e-06
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method mcts_cuda_kernels.batched_ucb_selection_quantum>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 6.5294e-05,
        "cumulative_time": 6.5294e-05,
        "time_percent": 0.027044471032011984,
        "time_per_call": 3.2647e-05
      },
      {
        "rank": 45,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1244,
        "function_name": "remove_virtual_loss",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 6.4943e-05,
        "cumulative_time": 7.956e-05,
        "time_percent": 0.032953381862144665,
        "time_per_call": 7.956e-05
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 547,
        "primitive_calls": 547,
        "total_time": 6.0561000000000005e-05,
        "cumulative_time": 6.0561000000000005e-05,
        "time_percent": 0.025084084451399483,
        "time_per_call": 1.107148080438757e-07
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x746c91bdbba0>",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 5.835e-05,
        "cumulative_time": 5.835e-05,
        "time_percent": 0.024168298537658887,
        "time_per_call": 5.835e-06
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'to' of 'torch._C.TensorBase' objects>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 5.7086e-05,
        "cumulative_time": 5.7086e-05,
        "time_percent": 0.023644755618179865,
        "time_per_call": 6.342888888888889e-06
      },
      {
        "rank": 49,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1196,
        "function_name": "_extract_policy",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 5.4411000000000005e-05,
        "cumulative_time": 0.00022019500000000002,
        "time_percent": 0.091203744584401,
        "time_per_call": 0.00022019500000000002
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 5.2899e-05,
        "cumulative_time": 5.2899e-05,
        "time_percent": 0.021910519697405612,
        "time_per_call": 1.05798e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": null,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": true,
      "quantum_config": "QuantumConfig(quantum_level='one_loop', min_wave_size=3072, optimal_wave_size=3072, hbar_eff=0.1, temperature=1.0, coupling_strength=0.1, decoherence_rate=0.01, measurement_noise=0.0, path_integral_steps=10, path_integral_beta=1.0, use_wick_rotation=True, interference_alpha=0.05, interference_method='minhash', minhash_size=64, phase_kick_strength=0.1, use_mixed_precision=True, cache_corrections=True, fast_mode=True, enable_quantum=True, uncertainty_decay=0.99, phase_temperature=1.0, device='cuda')",
      "quantum_version": "v2",
      "quantum_branching_factor": null,
      "quantum_avg_game_length": null,
      "enable_phase_adaptation": true,
      "envariance_threshold": 0.001,
      "envariance_check_interval": 1000,
      "enable_virtual_loss": true,
      "virtual_loss": 1.0,
      "virtual_loss_value": -1.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "compile_mode": "reduce-overhead",
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "target_sims_per_second": 100000,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "tree_batch_size": 1024,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "one_loop",
    "num_simulations": 1000,
    "wave_size": 3072,
    "total_time_ms": 29.00315506849438,
    "simulations_per_second": 34479.00746102904,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 18.659807205200195,
        "cpu_time_ms": 18.7335389200598,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "expansion",
        "gpu_time_ms": 3.9576640129089355,
        "cpu_time_ms": 4.008535062894225,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.185439944267273,
        "cpu_time_ms": 1.234406023286283,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7590720057487488,
        "cpu_time_ms": 0.8068210445344448,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      }
    ],
    "peak_gpu_memory_mb": 2838.546875,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 110.3,
    "avg_ram_usage_mb": 1337.78515625,
    "final_tree_nodes": 33,
    "final_tree_edges": 32,
    "tree_memory_mb": 47.73538589477539,
    "efficiency_score": 12438.231670947387,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Consider using classical selection for hot paths",
      "One-loop quantum is a good balance - monitor overhead",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 29,
    "total_kernel_calls": 45,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         9798 function calls (7554 primitive calls) in 0.027 seconds\n\n   Ordered by: cumulative time\n   List reduced from 234 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    0.027    0.027 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:421(search)\n        1    0.000    0.000    0.027    0.027 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:461(_search_optimized)\n        1    0.000    0.000    0.026    0.026 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:637(_run_search_wave_vectorized)\n        4    0.000    0.000    0.026    0.006 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:394(_profile_phase)\n        1    0.000    0.000    0.019    0.019 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:369(instrumented_select)\n        1    0.001    0.001    0.018    0.018 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:661(_select_batch_vectorized)\n        2    0.000    0.000    0.011    0.006 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:964(batch_select_ucb_optimized)\n        2    0.000    0.000    0.011    0.005 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:208(batch_ucb_selection)\n        2    0.003    0.001    0.010    0.005 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py:1124(__format__)\n        7    0.007    0.001    0.007    0.001 {method 'item' of 'torch._C.TensorBase' objects}\n        1    0.000    0.000    0.005    0.005 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1389(ensure_consistent)\n        1    0.001    0.001    0.005    0.005 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1351(_rebuild_row_pointers)\n        4    0.005    0.001    0.005    0.001 {method 'sum' of 'torch._C.TensorBase' objects}\n        1    0.000    0.000    0.004    0.004 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:372(instrumented_expand)\n        1    0.000    0.000    0.004    0.004 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:873(_expand_batch_vectorized)\n        1    0.000    0.000    0.004    0.004 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:897(_expand_node_batch)\n       14    0.000    0.000    0.003    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       10    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n  2254/14    0.001    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        1    0.000    0.000    0.002    0.002 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:375(instrumented_evaluate)\n        2    0.001    0.001    0.002    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:391(get_nn_features)\n        1    0.000    0.000    0.001    0.001 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:378(instrumented_backup)\n        1    0.000    0.000    0.001    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1029(_evaluate_batch_vectorized)\n        4    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        1    0.000    0.000    0.001    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1098(_backup_batch_vectorized)\n        2    0.000    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:512(add_children_batch)\n        2    0.000    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1162(batch_action_to_child)\n       10    0.000    0.000    0.000    0.000 {built-in method builtins.next}\n       10    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:196(timer)\n       16    0.000    0.000    0.000    0.000 {built-in method torch.where}\n       39    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n        4    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_common.py:452(wrapper)\n      6/4    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py:1642(wrapper)\n        1    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1142(_add_dirichlet_noise_to_root)\n        3    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:814(get_children)\n       31    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n        2    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:920(batch_get_children)\n       14    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n       31    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n       10    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n       13    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        5    0.000    0.000    0.000    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       31    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n        5    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:178(end_timer)\n     1719    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}\n        2    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py:1009(cpu_percent)\n        1    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1196(_extract_policy)\n      594    0.000    0.000    0.000    0.000 {built-in method builtins.len}\n       10    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1056(current_stream)\n        5    0.000    0.000    0.000    0.000 /usr/lib/python3.12/contextlib.py:132(__enter__)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.006712073000000001,
        "cumulative_time": 0.006712073000000001,
        "time_percent": 2.8061839142148206,
        "time_per_call": 0.0009588675714285715
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.004771353,
        "cumulative_time": 0.004771353,
        "time_percent": 1.9948075710202535,
        "time_per_call": 0.00119283825
      },
      {
        "rank": 3,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1124,
        "function_name": "__format__",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.002768097,
        "cumulative_time": 0.010420621000000001,
        "time_percent": 4.356653902055172,
        "time_per_call": 0.005210310500000001
      },
      {
        "rank": 4,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 14,
        "primitive_calls": 2254,
        "total_time": 0.00138192,
        "cumulative_time": 0.001889512,
        "time_percent": 0.7899672992406181,
        "time_per_call": 0.00013496514285714286
      },
      {
        "rank": 5,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 391,
        "function_name": "get_nn_features",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.001135481,
        "cumulative_time": 0.001538228,
        "time_percent": 0.6431024617871163,
        "time_per_call": 0.000769114
      },
      {
        "rank": 6,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1351,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000647409,
        "cumulative_time": 0.005441175,
        "time_percent": 2.274846796128085,
        "time_per_call": 0.005441175
      },
      {
        "rank": 7,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 661,
        "function_name": "_select_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000581124,
        "cumulative_time": 0.017966253,
        "time_percent": 7.511332216934137,
        "time_per_call": 0.017966253
      },
      {
        "rank": 8,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1162,
        "function_name": "batch_action_to_child",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000493499,
        "cumulative_time": 0.0006490840000000001,
        "time_percent": 0.27136908072576277,
        "time_per_call": 0.00032454200000000004
      },
      {
        "rank": 9,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 897,
        "function_name": "_expand_node_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0004929380000000001,
        "cumulative_time": 0.003697278,
        "time_percent": 1.5457582255110072,
        "time_per_call": 0.003697278
      },
      {
        "rank": 10,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 512,
        "function_name": "add_children_batch",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000458313,
        "cumulative_time": 0.00066839,
        "time_percent": 0.27944053445515926,
        "time_per_call": 0.000334195
      },
      {
        "rank": 11,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1098,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000430173,
        "cumulative_time": 0.000705911,
        "time_percent": 0.2951273165633476,
        "time_per_call": 0.000705911
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.000430081,
        "cumulative_time": 0.000430081,
        "time_percent": 0.1798082923128852,
        "time_per_call": 2.68800625e-05
      },
      {
        "rank": 13,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 814,
        "function_name": "get_children",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.00033520200000000005,
        "cumulative_time": 0.000363215,
        "time_percent": 0.15185295070562196,
        "time_per_call": 0.00012107166666666667
      },
      {
        "rank": 14,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.00029180600000000003,
        "cumulative_time": 0.002659681,
        "time_percent": 1.1119596046024511,
        "time_per_call": 0.00018997721428571428
      },
      {
        "rank": 15,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 920,
        "function_name": "batch_get_children",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000270207,
        "cumulative_time": 0.000316576,
        "time_percent": 0.1323541145673581,
        "time_per_call": 0.000158288
      },
      {
        "rank": 16,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 208,
        "function_name": "batch_ucb_selection",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000263181,
        "cumulative_time": 0.010942544,
        "time_percent": 4.574859503671652,
        "time_per_call": 0.005471272
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 1719,
        "primitive_calls": 1719,
        "total_time": 0.00024239900000000002,
        "cumulative_time": 0.00024239900000000002,
        "time_percent": 0.10134218960696022,
        "time_per_call": 1.4101163467132056e-07
      },
      {
        "rank": 18,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1029,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000236273,
        "cumulative_time": 0.0011233670000000001,
        "time_percent": 0.4696573480592003,
        "time_per_call": 0.0011233670000000001
      },
      {
        "rank": 19,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00021415100000000002,
        "cumulative_time": 0.025994916000000003,
        "time_percent": 10.867956163552671,
        "time_per_call": 0.006498729000000001
      },
      {
        "rank": 20,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 421,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 2,
        "total_time": 0.00020611000000000002,
        "cumulative_time": 0.027193804000000002,
        "time_percent": 11.369187336179246,
        "time_per_call": 0.027193804000000002
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 2523,
        "primitive_calls": 2523,
        "total_time": 0.000196114,
        "cumulative_time": 0.000196114,
        "time_percent": 0.08199135381160565,
        "time_per_call": 7.77304795877923e-08
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.000189497,
        "cumulative_time": 0.000189497,
        "time_percent": 0.07922491802338351,
        "time_per_call": 1.3535500000000001e-05
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.000180452,
        "cumulative_time": 0.000180452,
        "time_percent": 0.07544338383803226,
        "time_per_call": 1.2889428571428571e-05
      },
      {
        "rank": 24,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 873,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000156687,
        "cumulative_time": 0.003902917,
        "time_percent": 1.6317317919390273,
        "time_per_call": 0.003902917
      },
      {
        "rank": 25,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.00015383900000000002,
        "cumulative_time": 0.00015383900000000002,
        "time_percent": 0.06431701907576003,
        "time_per_call": 9.049352941176472e-06
      },
      {
        "rank": 26,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1142,
        "function_name": "_add_dirichlet_noise_to_root",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00013956300000000002,
        "cumulative_time": 0.000381349,
        "time_percent": 0.1594344145991719,
        "time_per_call": 0.000381349
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.000136556,
        "cumulative_time": 0.000136556,
        "time_percent": 0.0570913413172829,
        "time_per_call": 1.0504307692307691e-05
      },
      {
        "rank": 28,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1014,
        "function_name": "_clone_states_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000129694,
        "cumulative_time": 0.000129694,
        "time_percent": 0.05422247591320548,
        "time_per_call": 0.000129694
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000124174,
        "cumulative_time": 0.000181482,
        "time_percent": 0.07587400630468918,
        "time_per_call": 0.000181482
      },
      {
        "rank": 30,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000105728,
        "cumulative_time": 0.000173155,
        "time_percent": 0.07239265360580363,
        "time_per_call": 8.65775e-05
      },
      {
        "rank": 31,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1239,
        "function_name": "apply_virtual_loss",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000101632,
        "cumulative_time": 0.000101632,
        "time_percent": 0.04249031313716055,
        "time_per_call": 5.0816e-05
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'long' of 'torch._C.TensorBase' objects>",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 8.865400000000001e-05,
        "cumulative_time": 8.865400000000001e-05,
        "time_percent": 0.03706447005728345,
        "time_per_call": 5.5408750000000005e-06
      },
      {
        "rank": 33,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 964,
        "function_name": "batch_select_ucb_optimized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 8.808600000000001e-05,
        "cumulative_time": 0.011095732,
        "time_percent": 4.638904352625282,
        "time_per_call": 0.005547866
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 8.174400000000001e-05,
        "cumulative_time": 8.174400000000001e-05,
        "time_percent": 0.034175536810099695,
        "time_per_call": 2.0436000000000002e-05
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 8.158400000000001e-05,
        "cumulative_time": 8.158400000000001e-05,
        "time_percent": 0.034108643999745225,
        "time_per_call": 1.1654857142857145e-05
      },
      {
        "rank": 36,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 44,
        "primitive_calls": 44,
        "total_time": 7.5406e-05,
        "cumulative_time": 0.00014461400000000002,
        "time_percent": 0.06046023047876,
        "time_per_call": 3.2866818181818187e-06
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 7.448e-05,
        "cumulative_time": 7.448e-05,
        "time_percent": 0.03113860322000667,
        "time_per_call": 5.729230769230769e-06
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 7.3509e-05,
        "cumulative_time": 7.3509e-05,
        "time_percent": 0.030732647477167967,
        "time_per_call": 1.2251500000000001e-05
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 594,
        "primitive_calls": 594,
        "total_time": 7.1592e-05,
        "cumulative_time": 0.000216206,
        "time_percent": 0.09039141847186845,
        "time_per_call": 3.63983164983165e-07
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method mcts_cuda_kernels.batched_ucb_selection_quantum>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 6.9601e-05,
        "cumulative_time": 6.9601e-05,
        "time_percent": 0.02909879058425999,
        "time_per_call": 3.48005e-05
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 6.593400000000001e-05,
        "cumulative_time": 6.593400000000001e-05,
        "time_percent": 0.027565690986948443,
        "time_per_call": 8.241750000000001e-06
      },
      {
        "rank": 42,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1244,
        "function_name": "remove_virtual_loss",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 6.506300000000001e-05,
        "cumulative_time": 8.034100000000001e-05,
        "time_percent": 0.03358897047930392,
        "time_per_call": 8.034100000000001e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 547,
        "primitive_calls": 547,
        "total_time": 6.0785e-05,
        "cumulative_time": 6.0785e-05,
        "time_percent": 0.025412996733728592,
        "time_per_call": 1.1112431444241317e-07
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x746c91bdbba0>",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 6.0115e-05,
        "cumulative_time": 6.0115e-05,
        "time_percent": 0.02513288309036924,
        "time_per_call": 6.0115e-06
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'to' of 'torch._C.TensorBase' objects>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 6.009200000000001e-05,
        "cumulative_time": 6.009200000000001e-05,
        "time_percent": 0.025123267248880785,
        "time_per_call": 6.67688888888889e-06
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 5.6346000000000006e-05,
        "cumulative_time": 5.6346000000000006e-05,
        "time_percent": 0.02355713932645671,
        "time_per_call": 1.12692e-05
      },
      {
        "rank": 47,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 39,
        "primitive_calls": 39,
        "total_time": 5.5301000000000005e-05,
        "cumulative_time": 0.000399355,
        "time_percent": 0.16696236424443828,
        "time_per_call": 1.0239871794871795e-05
      },
      {
        "rank": 48,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1196,
        "function_name": "_extract_policy",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 5.4232000000000005e-05,
        "cumulative_time": 0.000222038,
        "time_percent": 0.09282966140928894,
        "time_per_call": 0.000222038
      },
      {
        "rank": 49,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 33,
        "primitive_calls": 33,
        "total_time": 5.229e-05,
        "cumulative_time": 8.1134e-05,
        "time_percent": 0.03392050797062327,
        "time_per_call": 2.4586060606060606e-06
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 5.2130000000000004e-05,
        "cumulative_time": 6.4112e-05,
        "time_percent": 0.026803949109036888,
        "time_per_call": 1.0685333333333333e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": null,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": false,
      "quantum_config": null,
      "quantum_version": "v2",
      "quantum_branching_factor": null,
      "quantum_avg_game_length": null,
      "enable_phase_adaptation": true,
      "envariance_threshold": 0.001,
      "envariance_check_interval": 1000,
      "enable_virtual_loss": true,
      "virtual_loss": 1.0,
      "virtual_loss_value": -1.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "compile_mode": "reduce-overhead",
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "target_sims_per_second": 100000,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "tree_batch_size": 1024,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "classical",
    "num_simulations": 5000,
    "wave_size": 3072,
    "total_time_ms": 16.726966947317123,
    "simulations_per_second": 298918.5078052636,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 2.7867519855499268,
        "cpu_time_ms": 2.855562954209745,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.20892800390720367,
        "cpu_time_ms": 0.26555091608315706,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.3725759983062744,
        "cpu_time_ms": 1.4195559779182076,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7733759880065918,
        "cpu_time_ms": 0.821709050796926,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 3.5842559337615967,
        "cpu_time_ms": 3.6346600390970707,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.19948799908161163,
        "cpu_time_ms": 0.2474569482728839,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0637760162353516,
        "cpu_time_ms": 1.1086890008300543,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7178239822387695,
        "cpu_time_ms": 0.7629180327057838,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      }
    ],
    "peak_gpu_memory_mb": 2823.3935546875,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 181.3,
    "avg_ram_usage_mb": 1337.78515625,
    "final_tree_nodes": 17,
    "final_tree_edges": 16,
    "tree_memory_mb": 47.73538589477539,
    "efficiency_score": 108412.99523561072,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 38,
    "total_kernel_calls": 72,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         13538 function calls (10494 primitive calls) in 0.015 seconds\n\n   Ordered by: cumulative time\n   List reduced from 200 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    0.015    0.015 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:421(search)\n        2    0.000    0.000    0.014    0.007 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:637(_run_search_wave_vectorized)\n        8    0.001    0.000    0.014    0.002 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:394(_profile_phase)\n        1    0.000    0.000    0.007    0.007 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:461(_search_optimized)\n        2    0.000    0.000    0.007    0.004 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:369(instrumented_select)\n       19    0.000    0.000    0.004    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        2    0.000    0.000    0.003    0.002 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:375(instrumented_evaluate)\n       17    0.000    0.000    0.003    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        2    0.001    0.000    0.003    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:661(_select_batch_vectorized)\n  3059/19    0.002    0.000    0.003    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        2    0.000    0.000    0.002    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1029(_evaluate_batch_vectorized)\n        2    0.000    0.000    0.002    0.001 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:378(instrumented_backup)\n        2    0.001    0.001    0.002    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:391(get_nn_features)\n        2    0.001    0.000    0.001    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1098(_backup_batch_vectorized)\n        2    0.000    0.000    0.001    0.001 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:372(instrumented_expand)\n        4    0.000    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:964(batch_select_ucb_optimized)\n        4    0.001    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:208(batch_ucb_selection)\n        4    0.001    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1162(batch_action_to_child)\n        4    0.001    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:920(batch_get_children)\n       18    0.000    0.000    0.001    0.000 {built-in method builtins.next}\n       18    0.000    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:196(timer)\n       63    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n       59    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n        2    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        2    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_common.py:452(wrapper)\n       59    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n       25    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n       59    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n       19    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n        9    0.000    0.000    0.000    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       18    0.000    0.000    0.000    0.000 {built-in method torch.where}\n        4    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:814(get_children)\n       18    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n        9    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:178(end_timer)\n        1    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1142(_add_dirichlet_noise_to_root)\n       25    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:490(__init__)\n       18    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1056(current_stream)\n        2    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:873(_expand_batch_vectorized)\n       59    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:753(_get_available_device_type)\n       61    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:161(is_available)\n        9    0.000    0.000    0.000    0.000 /usr/lib/python3.12/contextlib.py:132(__enter__)\n        9    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:169(start_timer)\n       19    0.000    0.000    0.000    0.000 {built-in method torch._C._cuda_memoryStats}\n     3555    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}\n     2336    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}\n        6    0.000    0.000    0.000    0.000 {built-in method torch.zeros}\n        1    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1196(_extract_policy)\n      792    0.000    0.000    0.000    0.000 {built-in method builtins.len}\n       26    0.000    0.000    0.000    0.000 {method 'any' of 'torch._C.TensorBase' objects}\n       19    0.000    0.000    0.000    0.000 {method 'sort' of 'list' objects}\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 19,
        "primitive_calls": 3059,
        "total_time": 0.002016684,
        "cumulative_time": 0.002607064,
        "time_percent": 2.4910215782241787,
        "time_per_call": 0.00013721389473684211
      },
      {
        "rank": 2,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 391,
        "function_name": "get_nn_features",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.001053263,
        "cumulative_time": 0.0016543480000000001,
        "time_percent": 1.5807116994028585,
        "time_per_call": 0.0008271740000000001
      },
      {
        "rank": 3,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 661,
        "function_name": "_select_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0008793140000000001,
        "cumulative_time": 0.0029111970000000004,
        "time_percent": 2.7816173847137984,
        "time_per_call": 0.0014555985000000002
      },
      {
        "rank": 4,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1098,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000856154,
        "cumulative_time": 0.0013866330000000002,
        "time_percent": 1.3249128997514936,
        "time_per_call": 0.0006933165000000001
      },
      {
        "rank": 5,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 920,
        "function_name": "batch_get_children",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0007704420000000001,
        "cumulative_time": 0.000850853,
        "time_percent": 0.8129808792176859,
        "time_per_call": 0.00021271325
      },
      {
        "rank": 6,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1162,
        "function_name": "batch_action_to_child",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0007623650000000001,
        "cumulative_time": 0.0009973900000000001,
        "time_percent": 0.9529954047560834,
        "time_per_call": 0.00024934750000000003
      },
      {
        "rank": 7,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 208,
        "function_name": "batch_ucb_selection",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00056751,
        "cumulative_time": 0.001072971,
        "time_percent": 1.0252122363734741,
        "time_per_call": 0.00026824275
      },
      {
        "rank": 8,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.000535227,
        "cumulative_time": 0.01403392,
        "time_percent": 13.409259437847274,
        "time_per_call": 0.00175424
      },
      {
        "rank": 9,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1029,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00047379100000000005,
        "cumulative_time": 0.0023290190000000003,
        "time_percent": 2.225352574809862,
        "time_per_call": 0.0011645095000000002
      },
      {
        "rank": 10,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.000432536,
        "cumulative_time": 0.000432536,
        "time_percent": 0.41328349030126355,
        "time_per_call": 2.402977777777778e-05
      },
      {
        "rank": 11,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 814,
        "function_name": "get_children",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000402228,
        "cumulative_time": 0.000431875,
        "time_percent": 0.41265191191914247,
        "time_per_call": 0.00010796875
      },
      {
        "rank": 12,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.000345061,
        "cumulative_time": 0.003635493,
        "time_percent": 3.4736744132414676,
        "time_per_call": 0.00019134173684210527
      },
      {
        "rank": 13,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.00026396700000000004,
        "cumulative_time": 0.00026396700000000004,
        "time_percent": 0.2522176260111381,
        "time_per_call": 1.3893000000000002e-05
      },
      {
        "rank": 14,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 3555,
        "primitive_calls": 3555,
        "total_time": 0.000262163,
        "cumulative_time": 0.000262163,
        "time_percent": 0.25049392343724025,
        "time_per_call": 7.374486638537271e-08
      },
      {
        "rank": 15,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 2336,
        "primitive_calls": 2336,
        "total_time": 0.00025106900000000003,
        "cumulative_time": 0.00025106900000000003,
        "time_percent": 0.23989372590130753,
        "time_per_call": 1.0747816780821919e-07
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.000239411,
        "cumulative_time": 0.000239411,
        "time_percent": 0.22875463243872374,
        "time_per_call": 3.990183333333333e-05
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 26,
        "primitive_calls": 26,
        "total_time": 0.00023333900000000002,
        "cumulative_time": 0.00023333900000000002,
        "time_percent": 0.2229529018241407,
        "time_per_call": 8.974576923076924e-06
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.000224352,
        "cumulative_time": 0.000224352,
        "time_percent": 0.21436592009929598,
        "time_per_call": 1.1808000000000001e-05
      },
      {
        "rank": 19,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 873,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00021583000000000003,
        "cumulative_time": 0.000308062,
        "time_percent": 0.29434992368077534,
        "time_per_call": 0.000154031
      },
      {
        "rank": 20,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 421,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 2,
        "total_time": 0.000207831,
        "cumulative_time": 0.01508952,
        "time_percent": 14.417873870777742,
        "time_per_call": 0.01508952
      },
      {
        "rank": 21,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000207752,
        "cumulative_time": 0.000502757,
        "time_percent": 0.4803788996370068,
        "time_per_call": 0.0002513785
      },
      {
        "rank": 22,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1239,
        "function_name": "apply_virtual_loss",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000183375,
        "cumulative_time": 0.000183375,
        "time_percent": 0.17521283785394556,
        "time_per_call": 4.584375e-05
      },
      {
        "rank": 23,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1142,
        "function_name": "_add_dirichlet_noise_to_root",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00014264800000000002,
        "cumulative_time": 0.000377641,
        "time_percent": 0.36083190892979883,
        "time_per_call": 0.000377641
      },
      {
        "rank": 24,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1244,
        "function_name": "remove_virtual_loss",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000128242,
        "cumulative_time": 0.000156545,
        "time_percent": 0.1495770617687575,
        "time_per_call": 7.82725e-05
      },
      {
        "rank": 25,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 0.000100939,
        "cumulative_time": 0.000100939,
        "time_percent": 0.09644612755358915,
        "time_per_call": 1.00939e-05
      },
      {
        "rank": 26,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'long' of 'torch._C.TensorBase' objects>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 9.8516e-05,
        "cumulative_time": 9.8516e-05,
        "time_percent": 0.09413097714529953,
        "time_per_call": 5.473111111111112e-06
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x746c91bdbba0>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 9.1506e-05,
        "cumulative_time": 9.1506e-05,
        "time_percent": 0.08743299763142817,
        "time_per_call": 5.083666666666667e-06
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 9.0271e-05,
        "cumulative_time": 9.0271e-05,
        "time_percent": 0.08625296843033957,
        "time_per_call": 7.522583333333334e-06
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 792,
        "primitive_calls": 792,
        "total_time": 8.550800000000001e-05,
        "cumulative_time": 0.00023642900000000002,
        "time_percent": 0.22590536354994134,
        "time_per_call": 2.9852146464646467e-07
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 8.2846e-05,
        "cumulative_time": 8.2846e-05,
        "time_percent": 0.0791584608853332,
        "time_per_call": 4.602555555555556e-06
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 8.0321e-05,
        "cumulative_time": 8.0321e-05,
        "time_percent": 0.0767458505754152,
        "time_per_call": 4.01605e-05
      },
      {
        "rank": 32,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 63,
        "primitive_calls": 63,
        "total_time": 7.8964e-05,
        "cumulative_time": 0.0006799730000000001,
        "time_percent": 0.6497068793132157,
        "time_per_call": 1.0793222222222223e-05
      },
      {
        "rank": 33,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 47,
        "primitive_calls": 47,
        "total_time": 7.823400000000001e-05,
        "cumulative_time": 0.00015092100000000001,
        "time_percent": 0.14420339032995402,
        "time_per_call": 3.211085106382979e-06
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 7.7957e-05,
        "cumulative_time": 7.7957e-05,
        "time_percent": 0.07448707403179296,
        "time_per_call": 9.744625e-06
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 742,
        "primitive_calls": 742,
        "total_time": 7.6613e-05,
        "cumulative_time": 7.6613e-05,
        "time_percent": 0.07320289650445444,
        "time_per_call": 1.0325202156334233e-07
      },
      {
        "rank": 36,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 61,
        "primitive_calls": 61,
        "total_time": 7.4454e-05,
        "cumulative_time": 0.00012242400000000002,
        "time_percent": 0.11697481369560428,
        "time_per_call": 2.0069508196721317e-06
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method mcts_cuda_kernels.batched_ucb_selection>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 6.701600000000001e-05,
        "cumulative_time": 6.701600000000001e-05,
        "time_percent": 0.06403306634830276,
        "time_per_call": 1.6754000000000003e-05
      },
      {
        "rank": 38,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 6.5343e-05,
        "cumulative_time": 0.003146639,
        "time_percent": 3.0065796803921003,
        "time_per_call": 0.0001850964117647059
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 6.3868e-05,
        "cumulative_time": 0.000103263,
        "time_percent": 0.09866668452794536,
        "time_per_call": 1.2907875e-05
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 6.2476e-05,
        "cumulative_time": 6.2476e-05,
        "time_percent": 0.059695145236608606,
        "time_per_call": 2.49904e-06
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'scatter_add_' of 'torch._C.TensorBase' objects>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 6.2377e-05,
        "cumulative_time": 6.2377e-05,
        "time_percent": 0.059600551802675185,
        "time_per_call": 7.797125e-06
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 5.9991e-05,
        "cumulative_time": 5.9991e-05,
        "time_percent": 0.05732075449595664,
        "time_per_call": 9.998500000000001e-06
      },
      {
        "rank": 43,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1196,
        "function_name": "_extract_policy",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 5.911e-05,
        "cumulative_time": 0.000237287,
        "time_percent": 0.22672517331069766,
        "time_per_call": 0.000237287
      },
      {
        "rank": 44,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 5.7623e-05,
        "cumulative_time": 0.000481471,
        "time_percent": 0.4600403558520901,
        "time_per_call": 1.9258840000000002e-05
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.ones_like>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 5.7520000000000005e-05,
        "cumulative_time": 5.7520000000000005e-05,
        "time_percent": 0.05495974060454778,
        "time_per_call": 7.190000000000001e-06
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 5.4763000000000004e-05,
        "cumulative_time": 5.4763000000000004e-05,
        "time_percent": 0.052325456792886825,
        "time_per_call": 5.4763e-06
      },
      {
        "rank": 47,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 812,
        "function_name": "_get_device_index",
        "total_calls": 59,
        "primitive_calls": 59,
        "total_time": 5.4652000000000005e-05,
        "cumulative_time": 0.000569777,
        "time_percent": 0.5444157879422361,
        "time_per_call": 9.657237288135593e-06
      },
      {
        "rank": 48,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 5.3079000000000005e-05,
        "cumulative_time": 0.00013770900000000002,
        "time_percent": 0.1315794666013851,
        "time_per_call": 0.00013770900000000002
      },
      {
        "rank": 49,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 770,
        "function_name": "_get_device_attr",
        "total_calls": 59,
        "primitive_calls": 59,
        "total_time": 4.8985000000000006e-05,
        "cumulative_time": 0.00046808900000000004,
        "time_percent": 0.4472539989541406,
        "time_per_call": 7.93371186440678e-06
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._get_tracing_state>",
        "total_calls": 47,
        "primitive_calls": 47,
        "total_time": 4.7918000000000004e-05,
        "cumulative_time": 4.7918000000000004e-05,
        "time_percent": 0.04578513300223784,
        "time_per_call": 1.019531914893617e-06
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": null,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": true,
      "quantum_config": "QuantumConfig(quantum_level='tree_level', min_wave_size=3072, optimal_wave_size=3072, hbar_eff=0.1, temperature=1.0, coupling_strength=0.1, decoherence_rate=0.01, measurement_noise=0.0, path_integral_steps=10, path_integral_beta=1.0, use_wick_rotation=True, interference_alpha=0.05, interference_method='minhash', minhash_size=64, phase_kick_strength=0.1, use_mixed_precision=True, cache_corrections=True, fast_mode=True, enable_quantum=True, uncertainty_decay=0.99, phase_temperature=1.0, device='cuda')",
      "quantum_version": "v2",
      "quantum_branching_factor": null,
      "quantum_avg_game_length": null,
      "enable_phase_adaptation": true,
      "envariance_threshold": 0.001,
      "envariance_check_interval": 1000,
      "enable_virtual_loss": true,
      "virtual_loss": 1.0,
      "virtual_loss_value": -1.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "compile_mode": "reduce-overhead",
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "target_sims_per_second": 100000,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "tree_batch_size": 1024,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "tree_level",
    "num_simulations": 5000,
    "wave_size": 3072,
    "total_time_ms": 53.72837604954839,
    "simulations_per_second": 93060.69469490372,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 19.7511043548584,
        "cpu_time_ms": 19.82643804512918,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 2.5478720664978027,
        "cpu_time_ms": 2.6171229546889663,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0782400369644165,
        "cpu_time_ms": 1.1280870530754328,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7639039754867554,
        "cpu_time_ms": 0.8110490161925554,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 16.825408935546875,
        "cpu_time_ms": 16.876988927833736,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "expansion",
        "gpu_time_ms": 2.814336061477661,
        "cpu_time_ms": 2.863006084226072,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0400320291519165,
        "cpu_time_ms": 1.0853649582713842,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7318400144577026,
        "cpu_time_ms": 0.7775960257276893,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      }
    ],
    "peak_gpu_memory_mb": 4236.19580078125,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 183.0,
    "avg_ram_usage_mb": 1337.78515625,
    "final_tree_nodes": 33,
    "final_tree_edges": 32,
    "tree_memory_mb": 47.73538589477539,
    "efficiency_score": 22495.218788047292,
    "bottleneck_phase": "selection",
    "recommendations": [
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Consider using classical selection for hot paths",
      "Tree-level quantum may be excessive - consider one-loop for balance",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 48,
    "total_kernel_calls": 90,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         19532 function calls (15046 primitive calls) in 0.052 seconds\n\n   Ordered by: cumulative time\n   List reduced from 233 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.050    0.050 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:461(_search_optimized)\n        2    0.000    0.000    0.049    0.025 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:637(_run_search_wave_vectorized)\n        8    0.000    0.000    0.049    0.006 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:394(_profile_phase)\n        2    0.000    0.000    0.038    0.019 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:369(instrumented_select)\n        2    0.001    0.001    0.036    0.018 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:661(_select_batch_vectorized)\n        4    0.000    0.000    0.026    0.007 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:964(batch_select_ucb_optimized)\n        4    0.001    0.000    0.026    0.007 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:208(batch_ucb_selection)\n        4    0.001    0.000    0.025    0.006 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py:1124(__format__)\n        3    0.012    0.004    0.012    0.004 {built-in method time.sleep}\n       15    0.009    0.001    0.009    0.001 {method 'item' of 'torch._C.TensorBase' objects}\n        2    0.000    0.000    0.006    0.003 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:372(instrumented_expand)\n        3    0.001    0.000    0.006    0.002 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:897(_expand_node_batch)\n        2    0.000    0.000    0.006    0.003 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1389(ensure_consistent)\n        2    0.001    0.000    0.005    0.003 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1351(_rebuild_row_pointers)\n       28    0.001    0.000    0.005    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        2    0.000    0.000    0.005    0.003 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:873(_expand_batch_vectorized)\n        8    0.005    0.001    0.005    0.001 {method 'sum' of 'torch._C.TensorBase' objects}\n       20    0.000    0.000    0.004    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n  4508/28    0.003    0.000    0.004    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        5    0.002    0.000    0.003    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:391(get_nn_features)\n        2    0.000    0.000    0.003    0.001 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:375(instrumented_evaluate)\n        2    0.000    0.000    0.002    0.001 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:378(instrumented_backup)\n        2    0.000    0.000    0.002    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1029(_evaluate_batch_vectorized)\n        4    0.001    0.000    0.002    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1162(batch_action_to_child)\n        8    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        2    0.001    0.000    0.001    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1098(_backup_batch_vectorized)\n        4    0.001    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:512(add_children_batch)\n       33    0.001    0.000    0.001    0.000 {built-in method torch.where}\n       18    0.000    0.000    0.001    0.000 {built-in method builtins.next}\n       18    0.000    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:196(timer)\n       75    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n        4    0.001    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:920(batch_get_children)\n       28    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n       59    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n        2    0.000    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:318(apply_moves)\n       59    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n       25    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        4    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py:1009(cpu_percent)\n       59    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n        9    0.000    0.000    0.000    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       18    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n        9    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:178(end_timer)\n     1190    0.000    0.000    0.000    0.000 {built-in method builtins.len}\n     12/8    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py:1642(wrapper)\n     5025    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}\n       28    0.000    0.000    0.000    0.000 {built-in method torch._C._cuda_memoryStats}\n       28    0.000    0.000    0.000    0.000 {method 'sort' of 'list' objects}\n     3437    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}\n        8    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_common.py:452(wrapper)\n        4    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py:1964(virtual_memory)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.012459715000000001,
        "cumulative_time": 0.012459715000000001,
        "time_percent": 3.05862941477841,
        "time_per_call": 0.004153238333333334
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 15,
        "primitive_calls": 15,
        "total_time": 0.008735807,
        "cumulative_time": 0.008735807,
        "time_percent": 2.1444789268476154,
        "time_per_call": 0.0005823871333333334
      },
      {
        "rank": 3,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.004772365000000001,
        "cumulative_time": 0.004772365000000001,
        "time_percent": 1.1715272754680959,
        "time_per_call": 0.0005965456250000001
      },
      {
        "rank": 4,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 28,
        "primitive_calls": 4508,
        "total_time": 0.002990141,
        "cumulative_time": 0.0038941320000000002,
        "time_percent": 0.955937329243075,
        "time_per_call": 0.00013907614285714286
      },
      {
        "rank": 5,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 391,
        "function_name": "get_nn_features",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.002257948,
        "cumulative_time": 0.003140438,
        "time_percent": 0.7709194024171404,
        "time_per_call": 0.0006280876
      },
      {
        "rank": 6,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 661,
        "function_name": "_select_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0013122820000000001,
        "cumulative_time": 0.035809764,
        "time_percent": 8.79063425661606,
        "time_per_call": 0.017904882
      },
      {
        "rank": 7,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1124,
        "function_name": "__format__",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.001286365,
        "cumulative_time": 0.024937492000000002,
        "time_percent": 6.12169271624602,
        "time_per_call": 0.0062343730000000005
      },
      {
        "rank": 8,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 897,
        "function_name": "_expand_node_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.001005727,
        "cumulative_time": 0.006158418000000001,
        "time_percent": 1.5117776324178223,
        "time_per_call": 0.0020528060000000003
      },
      {
        "rank": 9,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 512,
        "function_name": "add_children_batch",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00088657,
        "cumulative_time": 0.001249405,
        "time_percent": 0.3067058021769534,
        "time_per_call": 0.00031235125
      },
      {
        "rank": 10,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1098,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000856672,
        "cumulative_time": 0.001387294,
        "time_percent": 0.340554999479972,
        "time_per_call": 0.000693647
      },
      {
        "rank": 11,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1162,
        "function_name": "batch_action_to_child",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000847457,
        "cumulative_time": 0.0017559210000000001,
        "time_percent": 0.4310461050374845,
        "time_per_call": 0.00043898025000000003
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 33,
        "primitive_calls": 33,
        "total_time": 0.000828223,
        "cumulative_time": 0.000828223,
        "time_percent": 0.20331341686354934,
        "time_per_call": 2.5097666666666665e-05
      },
      {
        "rank": 13,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1351,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0007174410000000001,
        "cumulative_time": 0.005499696,
        "time_percent": 1.35007357374861,
        "time_per_call": 0.002749848
      },
      {
        "rank": 14,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 920,
        "function_name": "batch_get_children",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000564413,
        "cumulative_time": 0.000644225,
        "time_percent": 0.15814531349518196,
        "time_per_call": 0.00016105625
      },
      {
        "rank": 15,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 208,
        "function_name": "batch_ucb_selection",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0005560550000000001,
        "cumulative_time": 0.026017268000000003,
        "time_percent": 6.386757738597798,
        "time_per_call": 0.006504317000000001
      },
      {
        "rank": 16,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.0005359010000000001,
        "cumulative_time": 0.005383959000000001,
        "time_percent": 1.3216622824327005,
        "time_per_call": 0.00019228425000000004
      },
      {
        "rank": 17,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1029,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000473503,
        "cumulative_time": 0.0019991690000000003,
        "time_percent": 0.4907589867435282,
        "time_per_call": 0.0009995845000000001
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 5025,
        "primitive_calls": 5025,
        "total_time": 0.000400437,
        "cumulative_time": 0.000400437,
        "time_percent": 0.09829987178403538,
        "time_per_call": 7.96889552238806e-08
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.000385784,
        "cumulative_time": 0.000385784,
        "time_percent": 0.09470283149741981,
        "time_per_call": 1.3778000000000001e-05
      },
      {
        "rank": 20,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 318,
        "function_name": "apply_moves",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000384313,
        "cumulative_time": 0.000560065,
        "time_percent": 0.1374855912184083,
        "time_per_call": 0.0002800325
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.00036194300000000004,
        "cumulative_time": 0.00036194300000000004,
        "time_percent": 0.08885030727212799,
        "time_per_call": 1.2926535714285716e-05
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 3437,
        "primitive_calls": 3437,
        "total_time": 0.000355906,
        "cumulative_time": 0.000355906,
        "time_percent": 0.08736833551137604,
        "time_per_call": 1.0355135292406169e-07
      },
      {
        "rank": 23,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 814,
        "function_name": "get_children",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00032446300000000004,
        "cumulative_time": 0.00034391900000000004,
        "time_percent": 0.08442574887958319,
        "time_per_call": 8.597975000000001e-05
      },
      {
        "rank": 24,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 35,
        "primitive_calls": 35,
        "total_time": 0.00031733900000000003,
        "cumulative_time": 0.00031733900000000003,
        "time_percent": 0.07790085085063068,
        "time_per_call": 9.066828571428573e-06
      },
      {
        "rank": 25,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 873,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00031374100000000003,
        "cumulative_time": 0.0052576590000000005,
        "time_percent": 1.290657970128084,
        "time_per_call": 0.0026288295000000002
      },
      {
        "rank": 26,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.000281342,
        "cumulative_time": 0.048993984000000004,
        "time_percent": 12.027116238981613,
        "time_per_call": 0.0061242480000000005
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 29,
        "primitive_calls": 29,
        "total_time": 0.000275199,
        "cumulative_time": 0.000275199,
        "time_percent": 0.06755626082278797,
        "time_per_call": 9.489620689655172e-06
      },
      {
        "rank": 28,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1014,
        "function_name": "_clone_states_batch",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00025883700000000004,
        "cumulative_time": 0.00025883700000000004,
        "time_percent": 0.06353969266817093,
        "time_per_call": 0.00012941850000000002
      },
      {
        "rank": 29,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00020395800000000001,
        "cumulative_time": 0.00030357100000000004,
        "time_percent": 0.07452106168348929,
        "time_per_call": 7.589275000000001e-05
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 0.00018845300000000002,
        "cumulative_time": 0.00018845300000000002,
        "time_percent": 0.04626172341046611,
        "time_per_call": 1.88453e-05
      },
      {
        "rank": 31,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1239,
        "function_name": "apply_virtual_loss",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000186932,
        "cumulative_time": 0.000186932,
        "time_percent": 0.045888346062759676,
        "time_per_call": 4.6733e-05
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'long' of 'torch._C.TensorBase' objects>",
        "total_calls": 32,
        "primitive_calls": 32,
        "total_time": 0.000165973,
        "cumulative_time": 0.000165973,
        "time_percent": 0.04074329949433169,
        "time_per_call": 5.18665625e-06
      },
      {
        "rank": 33,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1001,
        "function_name": "_allocate_states",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.000152929,
        "cumulative_time": 0.00033034300000000003,
        "time_percent": 0.0810930921587006,
        "time_per_call": 0.00011011433333333334
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 0.000150023,
        "cumulative_time": 0.000150023,
        "time_percent": 0.03682786971397832,
        "time_per_call": 5.556407407407407e-06
      },
      {
        "rank": 35,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 89,
        "primitive_calls": 89,
        "total_time": 0.000143967,
        "cumulative_time": 0.000275289,
        "time_percent": 0.06757835415697178,
        "time_per_call": 3.0931348314606744e-06
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 1190,
        "primitive_calls": 1190,
        "total_time": 0.000143502,
        "cumulative_time": 0.000418791,
        "time_percent": 0.10280543906858745,
        "time_per_call": 3.519252100840336e-07
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.00013916200000000002,
        "cumulative_time": 0.00013916200000000002,
        "time_percent": 0.03416169524097406,
        "time_per_call": 1.1596833333333336e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.000139135,
        "cumulative_time": 0.000139135,
        "time_percent": 0.03415506724071891,
        "time_per_call": 9.938214285714285e-06
      },
      {
        "rank": 39,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1244,
        "function_name": "remove_virtual_loss",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000129726,
        "cumulative_time": 0.00016055300000000002,
        "time_percent": 0.039412789813484346,
        "time_per_call": 8.027650000000001e-05
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 0.000125596,
        "cumulative_time": 0.000125596,
        "time_percent": 0.030831493335000775,
        "time_per_call": 1.25596e-05
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 1093,
        "primitive_calls": 1093,
        "total_time": 0.000124404,
        "cumulative_time": 0.000124404,
        "time_percent": 0.030538879397810723,
        "time_per_call": 1.1381884720951509e-07
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.000123002,
        "cumulative_time": 0.000123002,
        "time_percent": 0.03019471434752512,
        "time_per_call": 1.0250166666666667e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.00012254,
        "cumulative_time": 0.00012254,
        "time_percent": 0.030081301898714885,
        "time_per_call": 7.65875e-06
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method mcts_cuda_kernels.batched_ucb_selection_quantum>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00012185900000000001,
        "cumulative_time": 0.00012185900000000001,
        "time_percent": 0.02991412900339071,
        "time_per_call": 3.0464750000000003e-05
      },
      {
        "rank": 45,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 269,
        "function_name": "get_legal_moves_mask",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.000107745,
        "cumulative_time": 0.000171614,
        "time_percent": 0.04212806058467485,
        "time_per_call": 5.7204666666666665e-05
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.topk>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000103134,
        "cumulative_time": 0.000103134,
        "time_percent": 0.025317488085703124,
        "time_per_call": 2.57835e-05
      },
      {
        "rank": 47,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1142,
        "function_name": "_add_dirichlet_noise_to_root",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00010047,
        "cumulative_time": 0.00023952200000000002,
        "time_percent": 0.05879821767083391,
        "time_per_call": 0.00023952200000000002
      },
      {
        "rank": 48,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 964,
        "function_name": "batch_select_ucb_optimized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 9.338300000000001e-05,
        "cumulative_time": 0.026276755000000002,
        "time_percent": 6.450456994235074,
        "time_per_call": 0.006569188750000001
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x746c91bdbba0>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 9.283900000000001e-05,
        "cumulative_time": 9.283900000000001e-05,
        "time_percent": 0.022790256136565948,
        "time_per_call": 5.157722222222223e-06
      },
      {
        "rank": 50,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 9.2613e-05,
        "cumulative_time": 0.0004934200000000001,
        "time_percent": 0.1211254772552954,
        "time_per_call": 0.00012335500000000001
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": null,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": true,
      "quantum_config": "QuantumConfig(quantum_level='one_loop', min_wave_size=3072, optimal_wave_size=3072, hbar_eff=0.1, temperature=1.0, coupling_strength=0.1, decoherence_rate=0.01, measurement_noise=0.0, path_integral_steps=10, path_integral_beta=1.0, use_wick_rotation=True, interference_alpha=0.05, interference_method='minhash', minhash_size=64, phase_kick_strength=0.1, use_mixed_precision=True, cache_corrections=True, fast_mode=True, enable_quantum=True, uncertainty_decay=0.99, phase_temperature=1.0, device='cuda')",
      "quantum_version": "v2",
      "quantum_branching_factor": null,
      "quantum_avg_game_length": null,
      "enable_phase_adaptation": true,
      "envariance_threshold": 0.001,
      "envariance_check_interval": 1000,
      "enable_virtual_loss": true,
      "virtual_loss": 1.0,
      "virtual_loss_value": -1.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "compile_mode": "reduce-overhead",
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "target_sims_per_second": 100000,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "tree_batch_size": 1024,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "one_loop",
    "num_simulations": 5000,
    "wave_size": 3072,
    "total_time_ms": 53.17981191910803,
    "simulations_per_second": 94020.64090797302,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 19.45452880859375,
        "cpu_time_ms": 19.52033198904246,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 2.4885120391845703,
        "cpu_time_ms": 2.538154018111527,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0554560422897339,
        "cpu_time_ms": 1.1031599715352058,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7505919933319092,
        "cpu_time_ms": 0.7966510020196438,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 16.93529510498047,
        "cpu_time_ms": 16.984501970000565,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "expansion",
        "gpu_time_ms": 2.793247938156128,
        "cpu_time_ms": 2.8398620197549462,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0424319505691528,
        "cpu_time_ms": 1.0890329722315073,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7188479900360107,
        "cpu_time_ms": 0.7662250427529216,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      }
    ],
    "peak_gpu_memory_mb": 4238.9150390625,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 121.6,
    "avg_ram_usage_mb": 1337.97265625,
    "final_tree_nodes": 33,
    "final_tree_edges": 32,
    "tree_memory_mb": 47.73538589477539,
    "efficiency_score": 22712.683647242317,
    "bottleneck_phase": "selection",
    "recommendations": [
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Consider using classical selection for hot paths",
      "One-loop quantum is a good balance - monitor overhead",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 87,
    "total_kernel_calls": 129,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         19532 function calls (15046 primitive calls) in 0.051 seconds\n\n   Ordered by: cumulative time\n   List reduced from 233 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.049    0.049 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:461(_search_optimized)\n        2    0.000    0.000    0.049    0.024 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:637(_run_search_wave_vectorized)\n        8    0.000    0.000    0.048    0.006 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:394(_profile_phase)\n        2    0.000    0.000    0.037    0.019 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:369(instrumented_select)\n        8    0.000    0.000    0.033    0.004 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_common.py:452(wrapper)\n        4    0.001    0.000    0.024    0.006 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py:1124(__format__)\n       15    0.018    0.001    0.018    0.001 {method 'item' of 'torch._C.TensorBase' objects}\n        3    0.003    0.001    0.017    0.006 {built-in method time.sleep}\n        4    0.000    0.000    0.014    0.004 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py:1113(memory_info)\n        4    0.000    0.000    0.011    0.003 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:964(batch_select_ucb_optimized)\n        4    0.000    0.000    0.011    0.003 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:208(batch_ucb_selection)\n        3    0.001    0.000    0.006    0.002 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:897(_expand_node_batch)\n        2    0.000    0.000    0.006    0.003 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:372(instrumented_expand)\n        2    0.000    0.000    0.006    0.003 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1389(ensure_consistent)\n        2    0.001    0.000    0.006    0.003 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1351(_rebuild_row_pointers)\n        2    0.000    0.000    0.005    0.003 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:873(_expand_batch_vectorized)\n       28    0.000    0.000    0.005    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        8    0.005    0.001    0.005    0.001 {method 'sum' of 'torch._C.TensorBase' objects}\n       20    0.000    0.000    0.004    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n  4508/28    0.003    0.000    0.004    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        5    0.002    0.000    0.003    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:391(get_nn_features)\n        2    0.000    0.000    0.003    0.001 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:375(instrumented_evaluate)\n        2    0.001    0.000    0.003    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:661(_select_batch_vectorized)\n        2    0.000    0.000    0.002    0.001 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:378(instrumented_backup)\n        2    0.000    0.000    0.002    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1029(_evaluate_batch_vectorized)\n        2    0.001    0.000    0.001    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1098(_backup_batch_vectorized)\n        8    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        4    0.001    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:512(add_children_batch)\n        4    0.001    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1162(batch_action_to_child)\n       33    0.001    0.000    0.001    0.000 {built-in method torch.where}\n       18    0.000    0.000    0.001    0.000 {built-in method builtins.next}\n       18    0.000    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:196(timer)\n       75    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n        4    0.001    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:920(batch_get_children)\n       59    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n        2    0.000    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:318(apply_moves)\n       28    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n       59    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n       25    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n       59    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n     12/8    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py:1642(wrapper)\n       18    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n        9    0.000    0.000    0.000    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n        4    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py:1009(cpu_percent)\n     1190    0.000    0.000    0.000    0.000 {built-in method builtins.len}\n        9    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:178(end_timer)\n     5025    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}\n        4    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py:1964(virtual_memory)\n        4    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py:352(virtual_memory)\n     3437    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 15,
        "primitive_calls": 15,
        "total_time": 0.018448638,
        "cumulative_time": 0.018448638,
        "time_percent": 4.612712864098741,
        "time_per_call": 0.0012299092
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.00483406,
        "cumulative_time": 0.00483406,
        "time_percent": 1.2086599968965277,
        "time_per_call": 0.0006042575
      },
      {
        "rank": 3,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.00324281,
        "cumulative_time": 0.016987588,
        "time_percent": 4.247406540125586,
        "time_per_call": 0.0056625293333333335
      },
      {
        "rank": 4,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 28,
        "primitive_calls": 4508,
        "total_time": 0.002780079,
        "cumulative_time": 0.003667983,
        "time_percent": 0.9171057705937692,
        "time_per_call": 0.00013099939285714286
      },
      {
        "rank": 5,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 391,
        "function_name": "get_nn_features",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.002275056,
        "cumulative_time": 0.0031485130000000004,
        "time_percent": 0.7872226891699063,
        "time_per_call": 0.0006297026000000001
      },
      {
        "rank": 6,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1124,
        "function_name": "__format__",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.001117418,
        "cumulative_time": 0.023994375000000002,
        "time_percent": 5.999313457638946,
        "time_per_call": 0.0059985937500000005
      },
      {
        "rank": 7,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 897,
        "function_name": "_expand_node_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.001000386,
        "cumulative_time": 0.006107471000000001,
        "time_percent": 1.527050942666337,
        "time_per_call": 0.0020358236666666667
      },
      {
        "rank": 8,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 512,
        "function_name": "add_children_batch",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0008885760000000001,
        "cumulative_time": 0.001256388,
        "time_percent": 0.3141346851675061,
        "time_per_call": 0.000314097
      },
      {
        "rank": 9,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 33,
        "primitive_calls": 33,
        "total_time": 0.0008565430000000001,
        "cumulative_time": 0.0008565430000000001,
        "time_percent": 0.21416144187737485,
        "time_per_call": 2.5955848484848487e-05
      },
      {
        "rank": 10,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1098,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000832548,
        "cumulative_time": 0.001363099,
        "time_percent": 0.3408156359477664,
        "time_per_call": 0.0006815495
      },
      {
        "rank": 11,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 661,
        "function_name": "_select_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000769433,
        "cumulative_time": 0.002530409,
        "time_percent": 0.6326781492341729,
        "time_per_call": 0.0012652045
      },
      {
        "rank": 12,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1162,
        "function_name": "batch_action_to_child",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000711563,
        "cumulative_time": 0.0009260160000000001,
        "time_percent": 0.231531775709473,
        "time_per_call": 0.00023150400000000003
      },
      {
        "rank": 13,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1351,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000705152,
        "cumulative_time": 0.0055544800000000005,
        "time_percent": 1.388786605785163,
        "time_per_call": 0.0027772400000000003
      },
      {
        "rank": 14,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 920,
        "function_name": "batch_get_children",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0005603660000000001,
        "cumulative_time": 0.000639063,
        "time_percent": 0.1597849185977596,
        "time_per_call": 0.00015976575
      },
      {
        "rank": 15,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.000498346,
        "cumulative_time": 0.032751421,
        "time_percent": 8.188837623905552,
        "time_per_call": 0.004093927625
      },
      {
        "rank": 16,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1029,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000457903,
        "cumulative_time": 0.001987276,
        "time_percent": 0.4968786080422138,
        "time_per_call": 0.000993638
      },
      {
        "rank": 17,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.00045168100000000006,
        "cumulative_time": 0.004987673000000001,
        "time_percent": 1.2470678544951646,
        "time_per_call": 0.0001781311785714286
      },
      {
        "rank": 18,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 208,
        "function_name": "batch_ucb_selection",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000401896,
        "cumulative_time": 0.01122704,
        "time_percent": 2.8070967533620172,
        "time_per_call": 0.00280676
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 5025,
        "primitive_calls": 5025,
        "total_time": 0.00039624800000000003,
        "cumulative_time": 0.00039624800000000003,
        "time_percent": 0.09907388539866185,
        "time_per_call": 7.885532338308458e-08
      },
      {
        "rank": 20,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 318,
        "function_name": "apply_moves",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00038041500000000005,
        "cumulative_time": 0.000550176,
        "time_percent": 0.1375605024456759,
        "time_per_call": 0.000275088
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 3437,
        "primitive_calls": 3437,
        "total_time": 0.00035080500000000004,
        "cumulative_time": 0.00035080500000000004,
        "time_percent": 0.08771177234276911,
        "time_per_call": 1.0206720977596743e-07
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.00033527300000000003,
        "cumulative_time": 0.00033527300000000003,
        "time_percent": 0.08382830646278482,
        "time_per_call": 1.1974035714285715e-05
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.00033335,
        "cumulative_time": 0.00033335,
        "time_percent": 0.08334749878269146,
        "time_per_call": 1.1905357142857143e-05
      },
      {
        "rank": 24,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 814,
        "function_name": "get_children",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000325524,
        "cumulative_time": 0.00034549200000000003,
        "time_percent": 0.08638336298013992,
        "time_per_call": 8.637300000000001e-05
      },
      {
        "rank": 25,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 35,
        "primitive_calls": 35,
        "total_time": 0.000324905,
        "cumulative_time": 0.000324905,
        "time_percent": 0.0812359954761973,
        "time_per_call": 9.283e-06
      },
      {
        "rank": 26,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 873,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000294593,
        "cumulative_time": 0.005165806,
        "time_percent": 1.2916064475674824,
        "time_per_call": 0.002582903
      },
      {
        "rank": 27,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.00028039600000000003,
        "cumulative_time": 0.048406088,
        "time_percent": 12.102973933267904,
        "time_per_call": 0.006050761
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 29,
        "primitive_calls": 29,
        "total_time": 0.00026873200000000004,
        "cumulative_time": 0.00026873200000000004,
        "time_percent": 0.06719106057558195,
        "time_per_call": 9.266620689655174e-06
      },
      {
        "rank": 29,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1014,
        "function_name": "_clone_states_batch",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00025554200000000004,
        "cumulative_time": 0.00025554200000000004,
        "time_percent": 0.06389316494353245,
        "time_per_call": 0.00012777100000000002
      },
      {
        "rank": 30,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1239,
        "function_name": "apply_virtual_loss",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00019131200000000001,
        "cumulative_time": 0.00019131200000000001,
        "time_percent": 0.04783373837442409,
        "time_per_call": 4.7828000000000004e-05
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 0.00018950300000000002,
        "cumulative_time": 0.00018950300000000002,
        "time_percent": 0.04738143411374346,
        "time_per_call": 1.89503e-05
      },
      {
        "rank": 32,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000160524,
        "cumulative_time": 0.000354047,
        "time_percent": 0.08852236958606739,
        "time_per_call": 8.851175e-05
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'long' of 'torch._C.TensorBase' objects>",
        "total_calls": 32,
        "primitive_calls": 32,
        "total_time": 0.000158312,
        "cumulative_time": 0.000158312,
        "time_percent": 0.03958274854442913,
        "time_per_call": 4.94725e-06
      },
      {
        "rank": 34,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1001,
        "function_name": "_allocate_states",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.000154511,
        "cumulative_time": 0.00033602400000000003,
        "time_percent": 0.08401607898891592,
        "time_per_call": 0.00011200800000000002
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 0.000149375,
        "cumulative_time": 0.000149375,
        "time_percent": 0.03734823048046959,
        "time_per_call": 5.532407407407408e-06
      },
      {
        "rank": 36,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 89,
        "primitive_calls": 89,
        "total_time": 0.00014220000000000001,
        "cumulative_time": 0.00027439,
        "time_percent": 0.06860573028643381,
        "time_per_call": 3.0830337078651687e-06
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 1190,
        "primitive_calls": 1190,
        "total_time": 0.00014121,
        "cumulative_time": 0.0004156,
        "time_percent": 0.10391246585896675,
        "time_per_call": 3.492436974789916e-07
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.000139732,
        "cumulative_time": 0.000139732,
        "time_percent": 0.034937191240147124,
        "time_per_call": 1.1644333333333333e-05
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.000136677,
        "cumulative_time": 0.000136677,
        "time_percent": 0.034173349605885465,
        "time_per_call": 9.762642857142858e-06
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.000133382,
        "cumulative_time": 0.000167395,
        "time_percent": 0.04185377098763653,
        "time_per_call": 1.3949583333333334e-05
      },
      {
        "rank": 41,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1244,
        "function_name": "remove_virtual_loss",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00012999500000000002,
        "cumulative_time": 0.000158478,
        "time_percent": 0.03962425352357395,
        "time_per_call": 7.9239e-05
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.000122864,
        "cumulative_time": 0.000122864,
        "time_percent": 0.030719685287045464,
        "time_per_call": 7.679e-06
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 0.00011973600000000001,
        "cumulative_time": 0.00011973600000000001,
        "time_percent": 0.029937591463159875,
        "time_per_call": 1.19736e-05
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 1093,
        "primitive_calls": 1093,
        "total_time": 0.00011766700000000001,
        "cumulative_time": 0.00011766700000000001,
        "time_percent": 0.02942027940381868,
        "time_per_call": 1.0765507776761209e-07
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method mcts_cuda_kernels.batched_ucb_selection_quantum>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00011593800000000001,
        "cumulative_time": 0.00011593800000000001,
        "time_percent": 0.02898797754272591,
        "time_per_call": 2.8984500000000003e-05
      },
      {
        "rank": 46,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 269,
        "function_name": "get_legal_moves_mask",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.000106323,
        "cumulative_time": 0.00016975100000000002,
        "time_percent": 0.042442841655499206,
        "time_per_call": 5.658366666666667e-05
      },
      {
        "rank": 47,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1142,
        "function_name": "_add_dirichlet_noise_to_root",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000104165,
        "cumulative_time": 0.00024215600000000002,
        "time_percent": 0.06054626343249268,
        "time_per_call": 0.00024215600000000002
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.000102504,
        "cumulative_time": 0.00012071,
        "time_percent": 0.03018112067814215,
        "time_per_call": 1.0059166666666667e-05
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x746c91bdbba0>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.000100259,
        "cumulative_time": 0.000100259,
        "time_percent": 0.025067757253498912,
        "time_per_call": 5.569944444444445e-06
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.topk>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 9.316700000000001e-05,
        "cumulative_time": 9.316700000000001e-05,
        "time_percent": 0.023294544530034548,
        "time_per_call": 2.3291750000000003e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": null,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": false,
      "quantum_config": null,
      "quantum_version": "v2",
      "quantum_branching_factor": null,
      "quantum_avg_game_length": null,
      "enable_phase_adaptation": true,
      "envariance_threshold": 0.001,
      "envariance_check_interval": 1000,
      "enable_virtual_loss": true,
      "virtual_loss": 1.0,
      "virtual_loss_value": -1.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "compile_mode": "reduce-overhead",
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "target_sims_per_second": 100000,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "tree_batch_size": 1024,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "classical",
    "num_simulations": 10000,
    "wave_size": 3072,
    "total_time_ms": 29.553381958976388,
    "simulations_per_second": 338370.7493741728,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 2.7083520889282227,
        "cpu_time_ms": 2.77239503338933,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.20367999374866486,
        "cpu_time_ms": 0.24974101688712835,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.3791359663009644,
        "cpu_time_ms": 1.4246449572965503,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7426559925079346,
        "cpu_time_ms": 0.7904790109023452,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 3.5331199169158936,
        "cpu_time_ms": 3.582371980883181,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.19497600197792053,
        "cpu_time_ms": 0.24083408061414957,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0619839429855347,
        "cpu_time_ms": 1.1065260041505098,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7157760262489319,
        "cpu_time_ms": 0.7617559749633074,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 2.4443199634552,
        "cpu_time_ms": 2.489752951078117,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.1857600063085556,
        "cpu_time_ms": 0.22988300770521164,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0260800123214722,
        "cpu_time_ms": 1.0700260754674673,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7146559953689575,
        "cpu_time_ms": 0.7616649381816387,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 3.2943038940429688,
        "cpu_time_ms": 3.3411680487915874,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.18755200505256653,
        "cpu_time_ms": 0.23311900440603495,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.024832010269165,
        "cpu_time_ms": 1.0679729748517275,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7004160284996033,
        "cpu_time_ms": 0.746366917155683,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      }
    ],
    "peak_gpu_memory_mb": 2825.29736328125,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 110.3,
    "avg_ram_usage_mb": 1337.97265625,
    "final_tree_nodes": 17,
    "final_tree_edges": 16,
    "tree_memory_mb": 47.73538589477539,
    "efficiency_score": 122639.00142417,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 116,
    "total_kernel_calls": 180,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         26877 function calls (20790 primitive calls) in 0.028 seconds\n\n   Ordered by: cumulative time\n   List reduced from 201 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    0.028    0.028 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:421(search)\n        4    0.000    0.000    0.027    0.007 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:637(_run_search_wave_vectorized)\n       16    0.001    0.000    0.027    0.002 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:394(_profile_phase)\n        1    0.000    0.000    0.020    0.020 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:461(_search_optimized)\n        4    0.000    0.000    0.014    0.003 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:369(instrumented_select)\n        4    0.002    0.000    0.008    0.002 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:661(_select_batch_vectorized)\n       38    0.001    0.000    0.007    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       34    0.000    0.000    0.006    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        4    0.000    0.000    0.006    0.002 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:375(instrumented_evaluate)\n  6118/38    0.004    0.000    0.005    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        4    0.000    0.000    0.005    0.001 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:378(instrumented_backup)\n        4    0.001    0.000    0.004    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1029(_evaluate_batch_vectorized)\n        4    0.002    0.001    0.003    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:391(get_nn_features)\n        4    0.002    0.000    0.003    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1098(_backup_batch_vectorized)\n        8    0.002    0.000    0.002    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1162(batch_action_to_child)\n        4    0.000    0.000    0.002    0.001 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:372(instrumented_expand)\n        8    0.000    0.000    0.002    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:964(batch_select_ucb_optimized)\n        8    0.001    0.000    0.002    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:208(batch_ucb_selection)\n        8    0.002    0.000    0.002    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:920(batch_get_children)\n      123    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n       34    0.000    0.000    0.001    0.000 {built-in method builtins.next}\n       34    0.000    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:196(timer)\n      115    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n        4    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n      115    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n       49    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n       36    0.001    0.000    0.001    0.000 {built-in method torch.where}\n      115    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n       38    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n       17    0.000    0.000    0.001    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       34    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n       17    0.000    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:178(end_timer)\n        4    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_common.py:452(wrapper)\n       49    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:490(__init__)\n        4    0.000    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:873(_expand_batch_vectorized)\n     4671    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}\n      115    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:753(_get_available_device_type)\n       34    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1056(current_stream)\n      119    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:161(is_available)\n     7086    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}\n        6    0.000    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:814(get_children)\n       17    0.000    0.000    0.000    0.000 /usr/lib/python3.12/contextlib.py:132(__enter__)\n     1579    0.000    0.000    0.000    0.000 {built-in method builtins.len}\n       38    0.000    0.000    0.000    0.000 {built-in method torch._C._cuda_memoryStats}\n       17    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:169(start_timer)\n       38    0.000    0.000    0.000    0.000 {method 'sort' of 'list' objects}\n       52    0.000    0.000    0.000    0.000 {method 'any' of 'torch._C.TensorBase' objects}\n        1    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1142(_add_dirichlet_noise_to_root)\n      119    0.000    0.000    0.000    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:157(_nvml_based_avail)\n        8    0.000    0.000    0.000    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1239(apply_virtual_loss)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 38,
        "primitive_calls": 6118,
        "total_time": 0.0037629810000000003,
        "cumulative_time": 0.005012927,
        "time_percent": 2.4513425980827974,
        "time_per_call": 0.00013191913157894737
      },
      {
        "rank": 2,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 391,
        "function_name": "get_nn_features",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.002023724,
        "cumulative_time": 0.003013159,
        "time_percent": 1.4734475510009548,
        "time_per_call": 0.00075328975
      },
      {
        "rank": 3,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 661,
        "function_name": "_select_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0018772250000000002,
        "cumulative_time": 0.008030647,
        "time_percent": 3.9270204974590337,
        "time_per_call": 0.00200766175
      },
      {
        "rank": 4,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1162,
        "function_name": "batch_action_to_child",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.001841633,
        "cumulative_time": 0.002410264,
        "time_percent": 1.1786293348826813,
        "time_per_call": 0.000301283
      },
      {
        "rank": 5,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1098,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.001648871,
        "cumulative_time": 0.00265796,
        "time_percent": 1.299753731103635,
        "time_per_call": 0.00066449
      },
      {
        "rank": 6,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 920,
        "function_name": "batch_get_children",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.001569386,
        "cumulative_time": 0.00172488,
        "time_percent": 0.8434736473483565,
        "time_per_call": 0.00021561
      },
      {
        "rank": 7,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 208,
        "function_name": "batch_ucb_selection",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.001073933,
        "cumulative_time": 0.0020537610000000003,
        "time_percent": 1.0042978534459257,
        "time_per_call": 0.00025672012500000004
      },
      {
        "rank": 8,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1029,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000919255,
        "cumulative_time": 0.004282091,
        "time_percent": 2.093960689466845,
        "time_per_call": 0.00107052275
      },
      {
        "rank": 9,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 36,
        "primitive_calls": 36,
        "total_time": 0.0008403870000000001,
        "cumulative_time": 0.0008403870000000001,
        "time_percent": 0.4109528129922913,
        "time_per_call": 2.3344083333333336e-05
      },
      {
        "rank": 10,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.000667205,
        "cumulative_time": 0.026749075,
        "time_percent": 13.08041130597186,
        "time_per_call": 0.0016718171875
      },
      {
        "rank": 11,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 38,
        "primitive_calls": 38,
        "total_time": 0.000629958,
        "cumulative_time": 0.006910376,
        "time_percent": 3.3792032195100803,
        "time_per_call": 0.000181852
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 4671,
        "primitive_calls": 4671,
        "total_time": 0.000557135,
        "cumulative_time": 0.000557135,
        "time_percent": 0.2724413817282516,
        "time_per_call": 1.1927531577820595e-07
      },
      {
        "rank": 13,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 7086,
        "primitive_calls": 7086,
        "total_time": 0.000532937,
        "cumulative_time": 0.000532937,
        "time_percent": 0.2606084569343323,
        "time_per_call": 7.52098504092577e-08
      },
      {
        "rank": 14,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 814,
        "function_name": "get_children",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.000488758,
        "cumulative_time": 0.000526162,
        "time_percent": 0.257295453153904,
        "time_per_call": 8.769366666666667e-05
      },
      {
        "rank": 15,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 38,
        "primitive_calls": 38,
        "total_time": 0.00045537800000000004,
        "cumulative_time": 0.00045537800000000004,
        "time_percent": 0.2226817764610871,
        "time_per_call": 1.198363157894737e-05
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 38,
        "primitive_calls": 38,
        "total_time": 0.00044787300000000005,
        "cumulative_time": 0.00044787300000000005,
        "time_percent": 0.21901179957959424,
        "time_per_call": 1.178613157894737e-05
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 52,
        "primitive_calls": 52,
        "total_time": 0.00044168,
        "cumulative_time": 0.00044168,
        "time_percent": 0.21598339627152155,
        "time_per_call": 8.493846153846154e-06
      },
      {
        "rank": 18,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 873,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000409272,
        "cumulative_time": 0.000579402,
        "time_percent": 0.28333003931921785,
        "time_per_call": 0.0001448505
      },
      {
        "rank": 19,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1239,
        "function_name": "apply_virtual_loss",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.00035967000000000003,
        "cumulative_time": 0.00035967000000000003,
        "time_percent": 0.17588015789027842,
        "time_per_call": 4.4958750000000004e-05
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.00031980400000000003,
        "cumulative_time": 0.00031980400000000003,
        "time_percent": 0.1563855145381672,
        "time_per_call": 2.6650333333333335e-05
      },
      {
        "rank": 21,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1244,
        "function_name": "remove_virtual_loss",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00025336900000000003,
        "cumulative_time": 0.00030765,
        "time_percent": 0.15044215690756568,
        "time_per_call": 7.69125e-05
      },
      {
        "rank": 22,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 421,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 2,
        "total_time": 0.000209435,
        "cumulative_time": 0.02783311,
        "time_percent": 13.610509025989066,
        "time_per_call": 0.02783311
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'long' of 'torch._C.TensorBase' objects>",
        "total_calls": 36,
        "primitive_calls": 36,
        "total_time": 0.000194405,
        "cumulative_time": 0.000194405,
        "time_percent": 0.09506487083899011,
        "time_per_call": 5.400138888888889e-06
      },
      {
        "rank": 24,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 24,
        "primitive_calls": 24,
        "total_time": 0.00017652300000000002,
        "cumulative_time": 0.00017652300000000002,
        "time_percent": 0.0863204968756516,
        "time_per_call": 7.355125000000001e-06
      },
      {
        "rank": 25,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 20,
        "primitive_calls": 20,
        "total_time": 0.0001706,
        "cumulative_time": 0.0001706,
        "time_percent": 0.08342412471454803,
        "time_per_call": 8.53e-06
      },
      {
        "rank": 26,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 1579,
        "primitive_calls": 1579,
        "total_time": 0.000168041,
        "cumulative_time": 0.000456926,
        "time_percent": 0.22343875503704327,
        "time_per_call": 2.893768207726409e-07
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 1483,
        "primitive_calls": 1483,
        "total_time": 0.000155995,
        "cumulative_time": 0.000155995,
        "time_percent": 0.07628221767201596,
        "time_per_call": 1.051888064733648e-07
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00015548300000000002,
        "cumulative_time": 0.00015548300000000002,
        "time_percent": 0.0760318474970227,
        "time_per_call": 3.8870750000000004e-05
      },
      {
        "rank": 29,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 123,
        "primitive_calls": 123,
        "total_time": 0.000154145,
        "cumulative_time": 0.001235659,
        "time_percent": 0.6042425001210652,
        "time_per_call": 1.0046008130081301e-05
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x746c91bdbba0>",
        "total_calls": 34,
        "primitive_calls": 34,
        "total_time": 0.000151409,
        "cumulative_time": 0.000151409,
        "time_percent": 0.07403964419053344,
        "time_per_call": 4.453205882352941e-06
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.000150796,
        "cumulative_time": 0.000150796,
        "time_percent": 0.07373988458648878,
        "time_per_call": 9.42475e-06
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 34,
        "primitive_calls": 34,
        "total_time": 0.000150423,
        "cumulative_time": 0.000150423,
        "time_percent": 0.07355748600197222,
        "time_per_call": 4.4242058823529416e-06
      },
      {
        "rank": 33,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 89,
        "primitive_calls": 89,
        "total_time": 0.00014500600000000001,
        "cumulative_time": 0.000288885,
        "time_percent": 0.14126599219321342,
        "time_per_call": 3.2458988764044945e-06
      },
      {
        "rank": 34,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1142,
        "function_name": "_add_dirichlet_noise_to_root",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000139763,
        "cumulative_time": 0.00038572700000000004,
        "time_percent": 0.18862214158129237,
        "time_per_call": 0.00038572700000000004
      },
      {
        "rank": 35,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 34,
        "primitive_calls": 34,
        "total_time": 0.000132969,
        "cumulative_time": 0.006111348,
        "time_percent": 2.9884751332122144,
        "time_per_call": 0.0001797455294117647
      },
      {
        "rank": 36,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 119,
        "primitive_calls": 119,
        "total_time": 0.0001327,
        "cumulative_time": 0.000221572,
        "time_percent": 0.10834964924532145,
        "time_per_call": 1.861949579831933e-06
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.000127109,
        "cumulative_time": 0.000127109,
        "time_percent": 0.062156840963314704,
        "time_per_call": 7.9443125e-06
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.000125446,
        "cumulative_time": 0.000150633,
        "time_percent": 0.07366017689405929,
        "time_per_call": 2.5105500000000002e-05
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method mcts_cuda_kernels.batched_ucb_selection>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.000123962,
        "cumulative_time": 0.000123962,
        "time_percent": 0.060617944594752664,
        "time_per_call": 1.549525e-05
      },
      {
        "rank": 40,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000117515,
        "cumulative_time": 0.00021665800000000003,
        "time_percent": 0.1059466823704839,
        "time_per_call": 0.00010832900000000001
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.ones_like>",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.00011462700000000001,
        "cumulative_time": 0.00011462700000000001,
        "time_percent": 0.05605308993935815,
        "time_per_call": 7.164187500000001e-06
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'scatter_add_' of 'torch._C.TensorBase' objects>",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.000111933,
        "cumulative_time": 0.000111933,
        "time_percent": 0.054735712495155374,
        "time_per_call": 6.9958125e-06
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.00011149300000000001,
        "cumulative_time": 0.00011149300000000001,
        "time_percent": 0.05452055062602055,
        "time_per_call": 9.291083333333335e-06
      },
      {
        "rank": 44,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 49,
        "primitive_calls": 49,
        "total_time": 0.00010472400000000001,
        "cumulative_time": 0.000876755,
        "time_percent": 0.42873691948478054,
        "time_per_call": 1.789295918367347e-05
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 20,
        "primitive_calls": 20,
        "total_time": 0.000104487,
        "cumulative_time": 0.000104487,
        "time_percent": 0.05109458686429649,
        "time_per_call": 5.22435e-06
      },
      {
        "rank": 46,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 812,
        "function_name": "_get_device_index",
        "total_calls": 115,
        "primitive_calls": 115,
        "total_time": 0.000104134,
        "cumulative_time": 0.001023739,
        "time_percent": 0.500612719877765,
        "time_per_call": 8.902078260869565e-06
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 49,
        "primitive_calls": 49,
        "total_time": 9.662800000000001e-05,
        "cumulative_time": 9.662800000000001e-05,
        "time_percent": 0.0472515024789997,
        "time_per_call": 1.9720000000000003e-06
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._get_tracing_state>",
        "total_calls": 89,
        "primitive_calls": 89,
        "total_time": 9.652300000000001e-05,
        "cumulative_time": 9.652300000000001e-05,
        "time_percent": 0.047200157032956165,
        "time_per_call": 1.0845280898876406e-06
      },
      {
        "rank": 49,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 770,
        "function_name": "_get_device_attr",
        "total_calls": 115,
        "primitive_calls": 115,
        "total_time": 9.254900000000001e-05,
        "cumulative_time": 0.000833907,
        "time_percent": 0.407784065465033,
        "time_per_call": 7.251365217391305e-06
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.maximum>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 9.253500000000001e-05,
        "cumulative_time": 9.253500000000001e-05,
        "time_percent": 0.04525000809179779,
        "time_per_call": 7.71125e-06
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": null,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": true,
      "quantum_config": "QuantumConfig(quantum_level='tree_level', min_wave_size=3072, optimal_wave_size=3072, hbar_eff=0.1, temperature=1.0, coupling_strength=0.1, decoherence_rate=0.01, measurement_noise=0.0, path_integral_steps=10, path_integral_beta=1.0, use_wick_rotation=True, interference_alpha=0.05, interference_method='minhash', minhash_size=64, phase_kick_strength=0.1, use_mixed_precision=True, cache_corrections=True, fast_mode=True, enable_quantum=True, uncertainty_decay=0.99, phase_temperature=1.0, device='cuda')",
      "quantum_version": "v2",
      "quantum_branching_factor": null,
      "quantum_avg_game_length": null,
      "enable_phase_adaptation": true,
      "envariance_threshold": 0.001,
      "envariance_check_interval": 1000,
      "enable_virtual_loss": true,
      "virtual_loss": 1.0,
      "virtual_loss_value": -1.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "compile_mode": "reduce-overhead",
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "target_sims_per_second": 100000,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "tree_batch_size": 1024,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "tree_level",
    "num_simulations": 10000,
    "wave_size": 3072,
    "total_time_ms": 102.69560990855098,
    "simulations_per_second": 97375.145918164,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 19.58403205871582,
        "cpu_time_ms": 19.659123965539038,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 2.531968116760254,
        "cpu_time_ms": 2.5838599540293217,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.056928038597107,
        "cpu_time_ms": 1.1038599768653512,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7503679990768433,
        "cpu_time_ms": 0.7964910473674536,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 17.06947135925293,
        "cpu_time_ms": 17.121350043453276,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 2.7789440155029297,
        "cpu_time_ms": 2.8267980087548494,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1008319854736328,
        "cpu_time_ms": 1.148003968410194,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7249919772148132,
        "cpu_time_ms": 0.7723160088062286,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 16.345535278320312,
        "cpu_time_ms": 16.39400899875909,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 2.761888027191162,
        "cpu_time_ms": 2.8093450237065554,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0361920595169067,
        "cpu_time_ms": 1.0819489834830165,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7262719869613647,
        "cpu_time_ms": 0.7719950517639518,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 18.138111114501953,
        "cpu_time_ms": 18.186648027040064,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "expansion",
        "gpu_time_ms": 3.661184072494507,
        "cpu_time_ms": 3.707207040861249,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.866752028465271,
        "cpu_time_ms": 1.9167129648849368,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.8826879858970642,
        "cpu_time_ms": 0.9287309367209673,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      }
    ],
    "peak_gpu_memory_mb": 4236.19580078125,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 178.5,
    "avg_ram_usage_mb": 1337.97265625,
    "final_tree_nodes": 81,
    "final_tree_edges": 80,
    "tree_memory_mb": 47.73538589477539,
    "efficiency_score": 23538.135182941915,
    "bottleneck_phase": "selection",
    "recommendations": [
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Consider using classical selection for hot paths",
      "Tree-level quantum may be excessive - consider one-loop for balance",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 131,
    "total_kernel_calls": 219,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         40629 function calls (31176 primitive calls) in 0.101 seconds\n\n   Ordered by: cumulative time\n   List reduced from 233 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.099    0.099 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:461(_search_optimized)\n        4    0.000    0.000    0.098    0.025 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:637(_run_search_wave_vectorized)\n       16    0.000    0.000    0.098    0.006 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:394(_profile_phase)\n        4    0.000    0.000    0.073    0.018 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:369(instrumented_select)\n        4    0.003    0.001    0.052    0.013 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:661(_select_batch_vectorized)\n        9    0.001    0.000    0.051    0.006 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py:1124(__format__)\n        9    0.000    0.000    0.040    0.004 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:964(batch_select_ucb_optimized)\n        9    0.001    0.000    0.040    0.004 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:208(batch_ucb_selection)\n        8    0.025    0.003    0.039    0.005 {built-in method time.sleep}\n        9    0.000    0.000    0.033    0.004 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py:1964(virtual_memory)\n       34    0.020    0.001    0.020    0.001 {method 'item' of 'torch._C.TensorBase' objects}\n        4    0.000    0.000    0.013    0.003 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:372(instrumented_expand)\n        5    0.002    0.000    0.012    0.002 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:897(_expand_node_batch)\n        4    0.001    0.000    0.012    0.003 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:873(_expand_batch_vectorized)\n       59    0.001    0.000    0.011    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n  9499/59    0.007    0.000    0.008    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       41    0.000    0.000    0.008    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        4    0.000    0.000    0.007    0.002 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:375(instrumented_evaluate)\n        4    0.000    0.000    0.006    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1389(ensure_consistent)\n        4    0.001    0.000    0.006    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1351(_rebuild_row_pointers)\n        9    0.004    0.000    0.006    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:391(get_nn_features)\n       14    0.005    0.000    0.005    0.000 {method 'sum' of 'torch._C.TensorBase' objects}\n        4    0.001    0.000    0.005    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1029(_evaluate_batch_vectorized)\n        4    0.000    0.000    0.005    0.001 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:378(instrumented_backup)\n       18    0.000    0.000    0.004    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        9    0.002    0.000    0.003    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1162(batch_action_to_child)\n       10    0.002    0.000    0.003    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:512(add_children_batch)\n        4    0.002    0.000    0.003    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1098(_backup_batch_vectorized)\n       72    0.002    0.000    0.002    0.000 {built-in method torch.where}\n        9    0.001    0.000    0.002    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:920(batch_get_children)\n       34    0.000    0.000    0.001    0.000 {built-in method builtins.next}\n      151    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n       34    0.000    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:196(timer)\n       59    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n      115    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n        4    0.001    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:318(apply_moves)\n        9    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py:1009(cpu_percent)\n      115    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n       49    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n    27/18    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py:1642(wrapper)\n      115    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n        9    0.001    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py:352(virtual_memory)\n     2504    0.000    0.000    0.001    0.000 {built-in method builtins.len}\n       17    0.000    0.000    0.001    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n    10511    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}\n       18    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_common.py:452(wrapper)\n       59    0.001    0.000    0.001    0.000 {built-in method torch._C._cuda_memoryStats}\n       17    0.000    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:178(end_timer)\n       34    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n     7240    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.025492666,
        "cumulative_time": 0.039242984,
        "time_percent": 4.872979624298495,
        "time_per_call": 0.004905373
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 34,
        "primitive_calls": 34,
        "total_time": 0.019687410000000002,
        "cumulative_time": 0.019687410000000002,
        "time_percent": 2.444675149708555,
        "time_per_call": 0.0005790414705882353
      },
      {
        "rank": 3,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 59,
        "primitive_calls": 9499,
        "total_time": 0.006530911,
        "cumulative_time": 0.008413107000000001,
        "time_percent": 1.0446937212532827,
        "time_per_call": 0.00014259503389830511
      },
      {
        "rank": 4,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.004914955,
        "cumulative_time": 0.004914955,
        "time_percent": 0.610312293513256,
        "time_per_call": 0.0003510682142857143
      },
      {
        "rank": 5,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 391,
        "function_name": "get_nn_features",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0040031220000000005,
        "cumulative_time": 0.005541076000000001,
        "time_percent": 0.6880605828723271,
        "time_per_call": 0.0006156751111111112
      },
      {
        "rank": 6,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 661,
        "function_name": "_select_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.002745094,
        "cumulative_time": 0.051561864000000006,
        "time_percent": 6.4026709248932265,
        "time_per_call": 0.012890466000000001
      },
      {
        "rank": 7,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1162,
        "function_name": "batch_action_to_child",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.002401241,
        "cumulative_time": 0.00313043,
        "time_percent": 0.38871971625024065,
        "time_per_call": 0.00034782555555555556
      },
      {
        "rank": 8,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 512,
        "function_name": "add_children_batch",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 0.0021665540000000002,
        "cumulative_time": 0.0030457220000000003,
        "time_percent": 0.3782011390183188,
        "time_per_call": 0.00030457220000000004
      },
      {
        "rank": 9,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 72,
        "primitive_calls": 72,
        "total_time": 0.001958863,
        "cumulative_time": 0.001958863,
        "time_percent": 0.2432409188300314,
        "time_per_call": 2.7206430555555554e-05
      },
      {
        "rank": 10,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 897,
        "function_name": "_expand_node_batch",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.00189733,
        "cumulative_time": 0.012045815000000001,
        "time_percent": 1.495783578870281,
        "time_per_call": 0.002409163
      },
      {
        "rank": 11,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1098,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.001795223,
        "cumulative_time": 0.0028728250000000003,
        "time_percent": 0.35673173296850524,
        "time_per_call": 0.0007182062500000001
      },
      {
        "rank": 12,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 920,
        "function_name": "batch_get_children",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.00141766,
        "cumulative_time": 0.001586231,
        "time_percent": 0.19696951033159518,
        "time_per_call": 0.00017624788888888888
      },
      {
        "rank": 13,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1124,
        "function_name": "__format__",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0013038980000000002,
        "cumulative_time": 0.051154898000000004,
        "time_percent": 6.352136107617805,
        "time_per_call": 0.005683877555555556
      },
      {
        "rank": 14,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 208,
        "function_name": "batch_ucb_selection",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.001152038,
        "cumulative_time": 0.039858655,
        "time_percent": 4.949430289677852,
        "time_per_call": 0.004428739444444444
      },
      {
        "rank": 15,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 59,
        "primitive_calls": 59,
        "total_time": 0.001063877,
        "cumulative_time": 0.011414314,
        "time_percent": 1.417367230467108,
        "time_per_call": 0.00019346294915254238
      },
      {
        "rank": 16,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1029,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.001004026,
        "cumulative_time": 0.004830143,
        "time_percent": 0.5997808021288086,
        "time_per_call": 0.00120753575
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 10511,
        "primitive_calls": 10511,
        "total_time": 0.000813198,
        "cumulative_time": 0.000813198,
        "time_percent": 0.1009784904359028,
        "time_per_call": 7.736637808010655e-08
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 59,
        "primitive_calls": 59,
        "total_time": 0.000782262,
        "cumulative_time": 0.000782262,
        "time_percent": 0.09713702675777634,
        "time_per_call": 1.3258677966101696e-05
      },
      {
        "rank": 19,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1351,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000774632,
        "cumulative_time": 0.005735971,
        "time_percent": 0.7122615805303455,
        "time_per_call": 0.00143399275
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 7240,
        "primitive_calls": 7240,
        "total_time": 0.000750887,
        "cumulative_time": 0.000750887,
        "time_percent": 0.09324105045504755,
        "time_per_call": 1.0371367403314917e-07
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 59,
        "primitive_calls": 59,
        "total_time": 0.000741938,
        "cumulative_time": 0.000741938,
        "time_percent": 0.0921298124651473,
        "time_per_call": 1.2575220338983052e-05
      },
      {
        "rank": 22,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 318,
        "function_name": "apply_moves",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0007292760000000001,
        "cumulative_time": 0.001042014,
        "time_percent": 0.1293916127844348,
        "time_per_call": 0.0002605035
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 72,
        "primitive_calls": 72,
        "total_time": 0.000620131,
        "cumulative_time": 0.000620131,
        "time_percent": 0.07700448384342662,
        "time_per_call": 8.612930555555556e-06
      },
      {
        "rank": 24,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 873,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0005910230000000001,
        "cumulative_time": 0.011513972,
        "time_percent": 1.4297422171245535,
        "time_per_call": 0.002878493
      },
      {
        "rank": 25,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 60,
        "primitive_calls": 60,
        "total_time": 0.000548807,
        "cumulative_time": 0.000548807,
        "time_percent": 0.06814785870188626,
        "time_per_call": 9.146783333333334e-06
      },
      {
        "rank": 26,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1014,
        "function_name": "_clone_states_batch",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000508669,
        "cumulative_time": 0.000508669,
        "time_percent": 0.0631637408743507,
        "time_per_call": 0.00012716725
      },
      {
        "rank": 27,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.000503601,
        "cumulative_time": 0.0008621950000000001,
        "time_percent": 0.10706267054442242,
        "time_per_call": 9.579944444444445e-05
      },
      {
        "rank": 28,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 814,
        "function_name": "get_children",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.00047651700000000003,
        "cumulative_time": 0.000505813,
        "time_percent": 0.06280909837807681,
        "time_per_call": 8.430216666666667e-05
      },
      {
        "rank": 29,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.000419188,
        "cumulative_time": 0.032924614000000005,
        "time_percent": 4.088398913800565,
        "time_per_call": 0.003658290444444445
      },
      {
        "rank": 30,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1239,
        "function_name": "apply_virtual_loss",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.00040988200000000003,
        "cumulative_time": 0.00040988200000000003,
        "time_percent": 0.05089691024430547,
        "time_per_call": 4.554244444444445e-05
      },
      {
        "rank": 31,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.00040139600000000004,
        "cumulative_time": 0.09800478800000001,
        "time_percent": 12.169699812014642,
        "time_per_call": 0.006125299250000001
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 22,
        "primitive_calls": 22,
        "total_time": 0.00037524000000000005,
        "cumulative_time": 0.00037524000000000005,
        "time_percent": 0.04659525570791883,
        "time_per_call": 1.705636363636364e-05
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'long' of 'torch._C.TensorBase' objects>",
        "total_calls": 66,
        "primitive_calls": 66,
        "total_time": 0.000332749,
        "cumulative_time": 0.000332749,
        "time_percent": 0.04131895517949653,
        "time_per_call": 5.0416515151515155e-06
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 0.000295478,
        "cumulative_time": 0.00029797300000000004,
        "time_percent": 0.03700066125427912,
        "time_per_call": 1.103603703703704e-05
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 2504,
        "primitive_calls": 2504,
        "total_time": 0.00029405,
        "cumulative_time": 0.0008483280000000001,
        "time_percent": 0.10534074214952392,
        "time_per_call": 3.387891373801917e-07
      },
      {
        "rank": 36,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 183,
        "primitive_calls": 183,
        "total_time": 0.000287442,
        "cumulative_time": 0.0005542780000000001,
        "time_percent": 0.06882721762944737,
        "time_per_call": 3.0288415300546453e-06
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.000272503,
        "cumulative_time": 0.000272503,
        "time_percent": 0.03383793563099617,
        "time_per_call": 9.73225e-06
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method mcts_cuda_kernels.batched_ucb_selection_quantum>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.00027160300000000004,
        "cumulative_time": 0.00027160300000000004,
        "time_percent": 0.03372617854183423,
        "time_per_call": 3.0178111111111114e-05
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 35,
        "primitive_calls": 35,
        "total_time": 0.00026669000000000004,
        "cumulative_time": 0.00026669000000000004,
        "time_percent": 0.03311610900955354,
        "time_per_call": 7.619714285714287e-06
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 52,
        "primitive_calls": 52,
        "total_time": 0.0002662,
        "cumulative_time": 0.0002662,
        "time_percent": 0.03305526348323204,
        "time_per_call": 5.119230769230769e-06
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 2302,
        "primitive_calls": 2302,
        "total_time": 0.00025969000000000003,
        "cumulative_time": 0.00025969000000000003,
        "time_percent": 0.03224688720496066,
        "time_per_call": 1.1281059947871417e-07
      },
      {
        "rank": 42,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1244,
        "function_name": "remove_virtual_loss",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000257165,
        "cumulative_time": 0.00031352100000000004,
        "time_percent": 0.03893132705682341,
        "time_per_call": 7.838025000000001e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 22,
        "primitive_calls": 22,
        "total_time": 0.000250383,
        "cumulative_time": 0.000250383,
        "time_percent": 0.031091194728482673,
        "time_per_call": 1.1381045454545455e-05
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros>",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.000246312,
        "cumulative_time": 0.000246312,
        "time_percent": 0.030585680161840156,
        "time_per_call": 1.0709217391304348e-05
      },
      {
        "rank": 45,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1001,
        "function_name": "_allocate_states",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.00023090300000000002,
        "cumulative_time": 0.0004988600000000001,
        "time_percent": 0.061945712777029066,
        "time_per_call": 9.9772e-05
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.topk>",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 0.000202091,
        "cumulative_time": 0.000202091,
        "time_percent": 0.025094557673139915,
        "time_per_call": 2.02091e-05
      },
      {
        "rank": 47,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.000194388,
        "cumulative_time": 0.001041734,
        "time_percent": 0.1293568439122511,
        "time_per_call": 0.00011574822222222224
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._get_tracing_state>",
        "total_calls": 203,
        "primitive_calls": 203,
        "total_time": 0.000185751,
        "cumulative_time": 0.000185751,
        "time_percent": 0.02306554563213311,
        "time_per_call": 9.150295566502463e-07
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.000181623,
        "cumulative_time": 0.000181623,
        "time_percent": 0.02255295311651034,
        "time_per_call": 1.0090166666666667e-05
      },
      {
        "rank": 50,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 269,
        "function_name": "get_legal_moves_mask",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.00017368,
        "cumulative_time": 0.00027549000000000003,
        "time_percent": 0.03420884499247031,
        "time_per_call": 5.509800000000001e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": null,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": true,
      "quantum_config": "QuantumConfig(quantum_level='one_loop', min_wave_size=3072, optimal_wave_size=3072, hbar_eff=0.1, temperature=1.0, coupling_strength=0.1, decoherence_rate=0.01, measurement_noise=0.0, path_integral_steps=10, path_integral_beta=1.0, use_wick_rotation=True, interference_alpha=0.05, interference_method='minhash', minhash_size=64, phase_kick_strength=0.1, use_mixed_precision=True, cache_corrections=True, fast_mode=True, enable_quantum=True, uncertainty_decay=0.99, phase_temperature=1.0, device='cuda')",
      "quantum_version": "v2",
      "quantum_branching_factor": null,
      "quantum_avg_game_length": null,
      "enable_phase_adaptation": true,
      "envariance_threshold": 0.001,
      "envariance_check_interval": 1000,
      "enable_virtual_loss": true,
      "virtual_loss": 1.0,
      "virtual_loss_value": -1.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "compile_mode": "reduce-overhead",
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "target_sims_per_second": 100000,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "tree_batch_size": 1024,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "one_loop",
    "num_simulations": 10000,
    "wave_size": 3072,
    "total_time_ms": 100.83834896795452,
    "simulations_per_second": 99168.620890232,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 20.198495864868164,
        "cpu_time_ms": 20.262300968170166,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 2.496256113052368,
        "cpu_time_ms": 2.5469210231676698,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1386879682540894,
        "cpu_time_ms": 1.18695804849267,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.754688024520874,
        "cpu_time_ms": 0.801039976067841,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 16.202592849731445,
        "cpu_time_ms": 16.25216193497181,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 2.8104960918426514,
        "cpu_time_ms": 2.856304054148495,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.041152000427246,
        "cpu_time_ms": 1.0866479715332389,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7239360213279724,
        "cpu_time_ms": 0.7696610409766436,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 16.297056198120117,
        "cpu_time_ms": 16.343964030966163,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 2.7739200592041016,
        "cpu_time_ms": 2.820245921611786,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0360959768295288,
        "cpu_time_ms": 1.0830409592017531,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7741439938545227,
        "cpu_time_ms": 0.8197149727493525,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 17.3986873626709,
        "cpu_time_ms": 17.452083993703127,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "expansion",
        "gpu_time_ms": 3.6733438968658447,
        "cpu_time_ms": 3.719259984791279,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.7080320119857788,
        "cpu_time_ms": 1.755128032527864,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.857312023639679,
        "cpu_time_ms": 0.9030330693349242,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      }
    ],
    "peak_gpu_memory_mb": 4238.9150390625,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 186.4,
    "avg_ram_usage_mb": 1337.97265625,
    "final_tree_nodes": 81,
    "final_tree_edges": 80,
    "tree_memory_mb": 47.73538589477539,
    "efficiency_score": 23956.28760090851,
    "bottleneck_phase": "selection",
    "recommendations": [
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Consider using classical selection for hot paths",
      "One-loop quantum is a good balance - monitor overhead",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 216,
    "total_kernel_calls": 304,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         40629 function calls (31176 primitive calls) in 0.099 seconds\n\n   Ordered by: cumulative time\n   List reduced from 233 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.097    0.097 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:461(_search_optimized)\n        4    0.000    0.000    0.097    0.024 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:637(_run_search_wave_vectorized)\n       16    0.000    0.000    0.096    0.006 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:394(_profile_phase)\n        4    0.000    0.000    0.072    0.018 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:369(instrumented_select)\n        9    0.000    0.000    0.055    0.006 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:964(batch_select_ucb_optimized)\n        9    0.001    0.000    0.055    0.006 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:208(batch_ucb_selection)\n        9    0.001    0.000    0.052    0.006 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py:1124(__format__)\n        4    0.003    0.001    0.052    0.013 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:661(_select_batch_vectorized)\n        8    0.033    0.004    0.051    0.006 {built-in method time.sleep}\n        4    0.000    0.000    0.013    0.003 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:372(instrumented_expand)\n       34    0.013    0.000    0.013    0.000 {method 'item' of 'torch._C.TensorBase' objects}\n        5    0.002    0.000    0.012    0.002 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:897(_expand_node_batch)\n        4    0.001    0.000    0.012    0.003 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:873(_expand_batch_vectorized)\n       59    0.001    0.000    0.010    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n  9499/59    0.006    0.000    0.007    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       41    0.000    0.000    0.007    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        4    0.000    0.000    0.007    0.002 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:375(instrumented_evaluate)\n        4    0.000    0.000    0.006    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1389(ensure_consistent)\n        4    0.001    0.000    0.006    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1351(_rebuild_row_pointers)\n        9    0.004    0.000    0.006    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:391(get_nn_features)\n       14    0.005    0.000    0.005    0.000 {method 'sum' of 'torch._C.TensorBase' objects}\n        4    0.001    0.000    0.005    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1029(_evaluate_batch_vectorized)\n        4    0.000    0.000    0.005    0.001 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:378(instrumented_backup)\n       18    0.000    0.000    0.003    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n       10    0.002    0.000    0.003    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:512(add_children_batch)\n        4    0.002    0.000    0.003    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1098(_backup_batch_vectorized)\n        9    0.002    0.000    0.003    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1162(batch_action_to_child)\n       72    0.002    0.000    0.002    0.000 {built-in method torch.where}\n        9    0.001    0.000    0.002    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:920(batch_get_children)\n       34    0.000    0.000    0.001    0.000 {built-in method builtins.next}\n      151    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n       34    0.000    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:196(timer)\n        4    0.001    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:318(apply_moves)\n      115    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n       59    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n      115    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n       49    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n     2504    0.000    0.000    0.001    0.000 {built-in method builtins.len}\n      115    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n       17    0.000    0.000    0.001    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n    10511    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}\n       34    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n       17    0.000    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:178(end_timer)\n    27/18    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py:1642(wrapper)\n       59    0.001    0.000    0.001    0.000 {method 'sort' of 'list' objects}\n     7240    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}\n        9    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py:1964(virtual_memory)\n        9    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py:1009(cpu_percent)\n       18    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_common.py:452(wrapper)\n        9    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py:352(virtual_memory)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.033465924,
        "cumulative_time": 0.05102973,
        "time_percent": 6.426310307425583,
        "time_per_call": 0.00637871625
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 34,
        "primitive_calls": 34,
        "total_time": 0.012816026000000001,
        "cumulative_time": 0.012816026000000001,
        "time_percent": 1.6139564129387762,
        "time_per_call": 0.00037694194117647063
      },
      {
        "rank": 3,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 59,
        "primitive_calls": 9499,
        "total_time": 0.005609331,
        "cumulative_time": 0.0073765340000000006,
        "time_percent": 0.9289466449709858,
        "time_per_call": 0.000125026
      },
      {
        "rank": 4,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.004854238,
        "cumulative_time": 0.004854238,
        "time_percent": 0.6113071672943781,
        "time_per_call": 0.00034673128571428575
      },
      {
        "rank": 5,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 391,
        "function_name": "get_nn_features",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.003996314,
        "cumulative_time": 0.005513453000000001,
        "time_percent": 0.6943238744043227,
        "time_per_call": 0.0006126058888888889
      },
      {
        "rank": 6,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 661,
        "function_name": "_select_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0028093560000000003,
        "cumulative_time": 0.05156592,
        "time_percent": 6.4938341474250985,
        "time_per_call": 0.01289148
      },
      {
        "rank": 7,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 512,
        "function_name": "add_children_batch",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 0.002188715,
        "cumulative_time": 0.0030755080000000002,
        "time_percent": 0.3873069436379506,
        "time_per_call": 0.0003075508
      },
      {
        "rank": 8,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1162,
        "function_name": "batch_action_to_child",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.002102641,
        "cumulative_time": 0.002753279,
        "time_percent": 0.34672778431158463,
        "time_per_call": 0.0003059198888888889
      },
      {
        "rank": 9,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 897,
        "function_name": "_expand_node_batch",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.0018991110000000002,
        "cumulative_time": 0.012094384000000001,
        "time_percent": 1.5230781068440506,
        "time_per_call": 0.0024188768
      },
      {
        "rank": 10,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1098,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0018134820000000002,
        "cumulative_time": 0.0028999250000000002,
        "time_percent": 0.3651953070937497,
        "time_per_call": 0.0007249812500000001
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 72,
        "primitive_calls": 72,
        "total_time": 0.001792203,
        "cumulative_time": 0.001792203,
        "time_percent": 0.2256969145613557,
        "time_per_call": 2.4891708333333333e-05
      },
      {
        "rank": 12,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 920,
        "function_name": "batch_get_children",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.001442705,
        "cumulative_time": 0.0016123370000000001,
        "time_percent": 0.20304590837818742,
        "time_per_call": 0.00017914855555555557
      },
      {
        "rank": 13,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1124,
        "function_name": "__format__",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.001386508,
        "cumulative_time": 0.052179867000000005,
        "time_percent": 6.571150134288306,
        "time_per_call": 0.005797763000000001
      },
      {
        "rank": 14,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 208,
        "function_name": "batch_ucb_selection",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0012490390000000002,
        "cumulative_time": 0.054625958,
        "time_percent": 6.879192912609904,
        "time_per_call": 0.0060695508888888895
      },
      {
        "rank": 15,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1029,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00094937,
        "cumulative_time": 0.004707753,
        "time_percent": 0.5928599196725851,
        "time_per_call": 0.00117693825
      },
      {
        "rank": 16,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 59,
        "primitive_calls": 59,
        "total_time": 0.0009119660000000001,
        "cumulative_time": 0.009971062000000001,
        "time_percent": 1.2556824914923035,
        "time_per_call": 0.00016900105084745765
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 10511,
        "primitive_calls": 10511,
        "total_time": 0.000781696,
        "cumulative_time": 0.000781696,
        "time_percent": 0.09844106684619629,
        "time_per_call": 7.436932737132529e-08
      },
      {
        "rank": 18,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 318,
        "function_name": "apply_moves",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0007385800000000001,
        "cumulative_time": 0.001059166,
        "time_percent": 0.13338360565644233,
        "time_per_call": 0.0002647915
      },
      {
        "rank": 19,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1351,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0007261910000000001,
        "cumulative_time": 0.005626545,
        "time_percent": 0.7085658522726629,
        "time_per_call": 0.00140663625
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 59,
        "primitive_calls": 59,
        "total_time": 0.0006935130000000001,
        "cumulative_time": 0.0006935130000000001,
        "time_percent": 0.08733594593256987,
        "time_per_call": 1.1754457627118645e-05
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 7240,
        "primitive_calls": 7240,
        "total_time": 0.0006793400000000001,
        "cumulative_time": 0.0006793400000000001,
        "time_percent": 0.0855511021564585,
        "time_per_call": 9.383149171270719e-08
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 72,
        "primitive_calls": 72,
        "total_time": 0.0006161700000000001,
        "cumulative_time": 0.0006161700000000001,
        "time_percent": 0.07759593519555015,
        "time_per_call": 8.557916666666668e-06
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 59,
        "primitive_calls": 59,
        "total_time": 0.0005990090000000001,
        "cumulative_time": 0.0005990090000000001,
        "time_percent": 0.07543480459216012,
        "time_per_call": 1.0152694915254238e-05
      },
      {
        "rank": 24,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 873,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0005943810000000001,
        "cumulative_time": 0.011544178,
        "time_percent": 1.4537891944981023,
        "time_per_call": 0.0028860445
      },
      {
        "rank": 25,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 60,
        "primitive_calls": 60,
        "total_time": 0.000553926,
        "cumulative_time": 0.000553926,
        "time_percent": 0.0697573818899497,
        "time_per_call": 9.232100000000001e-06
      },
      {
        "rank": 26,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1014,
        "function_name": "_clone_states_batch",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000499362,
        "cumulative_time": 0.000499362,
        "time_percent": 0.0628859915139009,
        "time_per_call": 0.0001248405
      },
      {
        "rank": 27,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 814,
        "function_name": "get_children",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.000490331,
        "cumulative_time": 0.00051968,
        "time_percent": 0.06544469156632667,
        "time_per_call": 8.661333333333334e-05
      },
      {
        "rank": 28,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1239,
        "function_name": "apply_virtual_loss",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.000389123,
        "cumulative_time": 0.000389123,
        "time_percent": 0.04900329956196839,
        "time_per_call": 4.323588888888889e-05
      },
      {
        "rank": 29,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.000387212,
        "cumulative_time": 0.000649494,
        "time_percent": 0.08179251559455775,
        "time_per_call": 7.2166e-05
      },
      {
        "rank": 30,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.00038068700000000005,
        "cumulative_time": 0.09627877400000001,
        "time_percent": 12.124643374411313,
        "time_per_call": 0.006017423375000001
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 22,
        "primitive_calls": 22,
        "total_time": 0.000373092,
        "cumulative_time": 0.000373092,
        "time_percent": 0.04698447287920248,
        "time_per_call": 1.6958727272727273e-05
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'long' of 'torch._C.TensorBase' objects>",
        "total_calls": 66,
        "primitive_calls": 66,
        "total_time": 0.00033971,
        "cumulative_time": 0.00033971,
        "time_percent": 0.042780588385154,
        "time_per_call": 5.147121212121213e-06
      },
      {
        "rank": 33,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 183,
        "primitive_calls": 183,
        "total_time": 0.000298321,
        "cumulative_time": 0.000571702,
        "time_percent": 0.07199596108730773,
        "time_per_call": 3.1240546448087433e-06
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 2504,
        "primitive_calls": 2504,
        "total_time": 0.000282143,
        "cumulative_time": 0.0008538450000000001,
        "time_percent": 0.10752698327903747,
        "time_per_call": 3.409924121405751e-07
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 52,
        "primitive_calls": 52,
        "total_time": 0.000275128,
        "cumulative_time": 0.000275128,
        "time_percent": 0.03464760448980204,
        "time_per_call": 5.290923076923078e-06
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method mcts_cuda_kernels.batched_ucb_selection_quantum>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.00026737500000000003,
        "cumulative_time": 0.00026737500000000003,
        "time_percent": 0.03367124847511274,
        "time_per_call": 2.9708333333333338e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.000262494,
        "cumulative_time": 0.00027420600000000004,
        "time_percent": 0.034531494565186595,
        "time_per_call": 9.79307142857143e-06
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 35,
        "primitive_calls": 35,
        "total_time": 0.000261744,
        "cumulative_time": 0.000261744,
        "time_percent": 0.032962121592781335,
        "time_per_call": 7.4784e-06
      },
      {
        "rank": 39,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1244,
        "function_name": "remove_virtual_loss",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00026140200000000004,
        "cumulative_time": 0.00031927100000000004,
        "time_percent": 0.04020665047928086,
        "time_per_call": 7.981775000000001e-05
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 2302,
        "primitive_calls": 2302,
        "total_time": 0.00025348600000000003,
        "cumulative_time": 0.00025348600000000003,
        "time_percent": 0.031922169578167105,
        "time_per_call": 1.1011555169417899e-07
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 22,
        "primitive_calls": 22,
        "total_time": 0.00025120300000000003,
        "cumulative_time": 0.00025120300000000003,
        "time_percent": 0.03163466528543711,
        "time_per_call": 1.1418318181818183e-05
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros>",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.00025011,
        "cumulative_time": 0.00025011,
        "time_percent": 0.03149702087371836,
        "time_per_call": 1.0874347826086956e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 0.00023891800000000002,
        "cumulative_time": 0.00023891800000000002,
        "time_percent": 0.030087582396173866,
        "time_per_call": 8.848814814814815e-06
      },
      {
        "rank": 44,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1001,
        "function_name": "_allocate_states",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.00021808000000000003,
        "cumulative_time": 0.00048061400000000003,
        "time_percent": 0.06052500575827149,
        "time_per_call": 9.61228e-05
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.topk>",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 0.000193465,
        "cumulative_time": 0.000193465,
        "time_percent": 0.024363564604909533,
        "time_per_call": 1.9346500000000002e-05
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._get_tracing_state>",
        "total_calls": 203,
        "primitive_calls": 203,
        "total_time": 0.00019099700000000001,
        "cumulative_time": 0.00019099700000000001,
        "time_percent": 0.024052762767652582,
        "time_per_call": 9.408719211822661e-07
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.000181535,
        "cumulative_time": 0.000181535,
        "time_percent": 0.022861187814603428,
        "time_per_call": 1.0085277777777779e-05
      },
      {
        "rank": 48,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 269,
        "function_name": "get_legal_moves_mask",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.00017338500000000002,
        "cumulative_time": 0.000283975,
        "time_percent": 0.035761730848883184,
        "time_per_call": 5.6795e-05
      },
      {
        "rank": 49,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1344,
        "function_name": "set_expanded",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 0.00016155800000000001,
        "cumulative_time": 0.00016155800000000001,
        "time_percent": 0.020345430803711137,
        "time_per_call": 1.6155800000000002e-05
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00015939,
        "cumulative_time": 0.00015939,
        "time_percent": 0.02007240876838979,
        "time_per_call": 3.98475e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": null,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": false,
      "quantum_config": null,
      "quantum_version": "v2",
      "quantum_branching_factor": null,
      "quantum_avg_game_length": null,
      "enable_phase_adaptation": true,
      "envariance_threshold": 0.001,
      "envariance_check_interval": 1000,
      "enable_virtual_loss": true,
      "virtual_loss": 1.0,
      "virtual_loss_value": -1.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "compile_mode": "reduce-overhead",
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "target_sims_per_second": 100000,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "tree_batch_size": 1024,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "classical",
    "num_simulations": 25000,
    "wave_size": 3072,
    "total_time_ms": 61.80621206294745,
    "simulations_per_second": 404490.0854713177,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 2.681920051574707,
        "cpu_time_ms": 2.7462650323286653,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.20585599541664124,
        "cpu_time_ms": 0.25417900178581476,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.3891520500183105,
        "cpu_time_ms": 1.4335920568555593,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7505919933319092,
        "cpu_time_ms": 0.7972930325195193,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 3.631743907928467,
        "cpu_time_ms": 3.6802570102736354,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.1974720060825348,
        "cpu_time_ms": 0.24405005387961864,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0717439651489258,
        "cpu_time_ms": 1.1162940645590425,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7084800004959106,
        "cpu_time_ms": 0.753429951146245,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 2.435647964477539,
        "cpu_time_ms": 2.4900840362533927,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.18848000466823578,
        "cpu_time_ms": 0.23319898173213005,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.031167984008789,
        "cpu_time_ms": 1.0763289174064994,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7076159715652466,
        "cpu_time_ms": 0.7610139437019825,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 3.094304084777832,
        "cpu_time_ms": 3.140849992632866,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.18198400735855103,
        "cpu_time_ms": 0.22604595869779587,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0257920026779175,
        "cpu_time_ms": 1.0709479684010148,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.707584023475647,
        "cpu_time_ms": 0.7523680105805397,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 2.4476161003112793,
        "cpu_time_ms": 2.493479987606406,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.1908479928970337,
        "cpu_time_ms": 0.23557397071272135,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 2.3775999546051025,
        "cpu_time_ms": 2.4239589693024755,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7280640006065369,
        "cpu_time_ms": 0.7738979766145349,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 2.668191909790039,
        "cpu_time_ms": 2.7093570679426193,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.1955520063638687,
        "cpu_time_ms": 0.24173606652766466,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.036255955696106,
        "cpu_time_ms": 1.0793450055643916,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7135679721832275,
        "cpu_time_ms": 0.7579389493912458,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 3.152895927429199,
        "cpu_time_ms": 3.2062940299510956,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.1844799965620041,
        "cpu_time_ms": 0.22910197731107473,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0398080348968506,
        "cpu_time_ms": 1.0874189902096987,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7137280106544495,
        "cpu_time_ms": 0.7584800478070974,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 2.44979190826416,
        "cpu_time_ms": 2.4961450835689902,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.18572799861431122,
        "cpu_time_ms": 0.22966205142438412,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0236799716949463,
        "cpu_time_ms": 1.0675820522010326,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.711679995059967,
        "cpu_time_ms": 0.7560849189758301,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 3.0356481075286865,
        "cpu_time_ms": 3.081177012063563,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.18681600689888,
        "cpu_time_ms": 0.23386103566735983,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0192639827728271,
        "cpu_time_ms": 1.0646861046552658,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7113919854164124,
        "cpu_time_ms": 0.7582799298688769,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      }
    ],
    "peak_gpu_memory_mb": 2874.03271484375,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 183.0,
    "avg_ram_usage_mb": 1337.97265625,
    "final_tree_nodes": 17,
    "final_tree_edges": 16,
    "tree_memory_mb": 47.73538589477539,
    "efficiency_score": 144117.3043658787,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 286,
    "total_kernel_calls": 434,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         61082 function calls (47147 primitive calls) in 0.060 seconds\n\n   Ordered by: cumulative time\n   List reduced from 201 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    0.060    0.060 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:421(search)\n        9    0.000    0.000    0.059    0.007 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:637(_run_search_wave_vectorized)\n       36    0.001    0.000    0.059    0.002 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:394(_profile_phase)\n        1    0.000    0.000    0.053    0.053 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:461(_search_optimized)\n        9    0.000    0.000    0.029    0.003 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:369(instrumented_select)\n        9    0.005    0.001    0.020    0.002 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:661(_select_batch_vectorized)\n        9    0.000    0.000    0.015    0.002 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:375(instrumented_evaluate)\n       87    0.001    0.000    0.015    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       77    0.000    0.000    0.013    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n 14007/87    0.008    0.000    0.011    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        9    0.002    0.000    0.011    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1029(_evaluate_batch_vectorized)\n        9    0.000    0.000    0.010    0.001 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:378(instrumented_backup)\n        9    0.004    0.000    0.007    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:391(get_nn_features)\n        9    0.004    0.000    0.006    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1098(_backup_batch_vectorized)\n       18    0.004    0.000    0.005    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1162(batch_action_to_child)\n        9    0.000    0.000    0.005    0.001 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:372(instrumented_expand)\n       18    0.000    0.000    0.005    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:964(batch_select_ucb_optimized)\n       18    0.002    0.000    0.005    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:208(batch_ucb_selection)\n       18    0.003    0.000    0.004    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:920(batch_get_children)\n        5    0.000    0.000    0.003    0.001 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py:1009(cpu_percent)\n      275    0.000    0.000    0.003    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n       74    0.000    0.000    0.003    0.000 {built-in method builtins.next}\n       74    0.000    0.000    0.003    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:196(timer)\n      255    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n       81    0.002    0.000    0.002    0.000 {built-in method torch.where}\n      255    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n      109    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n       10    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n      255    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n       37    0.000    0.000    0.002    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       87    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n       37    0.000    0.000    0.002    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:178(end_timer)\n       74    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n        9    0.001    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:873(_expand_batch_vectorized)\n      109    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:490(__init__)\n    16157    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}\n      255    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:753(_get_available_device_type)\n      264    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:161(is_available)\n       74    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1056(current_stream)\n       28    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py:33(wrapped)\n       11    0.001    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:814(get_children)\n       87    0.001    0.000    0.001    0.000 {method 'sort' of 'list' objects}\n    10692    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}\n      117    0.001    0.000    0.001    0.000 {method 'any' of 'torch._C.TensorBase' objects}\n       27    0.000    0.000    0.001    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py:1135(__floordiv__)\n       37    0.000    0.000    0.001    0.000 /usr/lib/python3.12/contextlib.py:132(__enter__)\n     3605    0.000    0.000    0.001    0.000 {built-in method builtins.len}\n       37    0.000    0.000    0.001    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:169(start_timer)\n       87    0.001    0.000    0.001    0.000 {built-in method torch._C._cuda_memoryStats}\n        4    0.001    0.000    0.001    0.000 {built-in method time.sleep}\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 87,
        "primitive_calls": 14007,
        "total_time": 0.008105231000000001,
        "cumulative_time": 0.010589108,
        "time_percent": 2.3073876438427106,
        "time_per_call": 0.00012171388505747126
      },
      {
        "rank": 2,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 661,
        "function_name": "_select_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0045394910000000005,
        "cumulative_time": 0.019624607000000002,
        "time_percent": 4.27624080395338,
        "time_per_call": 0.002180511888888889
      },
      {
        "rank": 3,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1162,
        "function_name": "batch_action_to_child",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.004185416,
        "cumulative_time": 0.005439993000000001,
        "time_percent": 1.1853852685977744,
        "time_per_call": 0.00030222183333333336
      },
      {
        "rank": 4,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 391,
        "function_name": "get_nn_features",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0040572970000000005,
        "cumulative_time": 0.006565192,
        "time_percent": 1.4305683632894302,
        "time_per_call": 0.0007294657777777778
      },
      {
        "rank": 5,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1098,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0037006,
        "cumulative_time": 0.005977409,
        "time_percent": 1.3024892813251328,
        "time_per_call": 0.0006641565555555556
      },
      {
        "rank": 6,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 920,
        "function_name": "batch_get_children",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.0032388770000000002,
        "cumulative_time": 0.003529822,
        "time_percent": 0.7691552175843485,
        "time_per_call": 0.00019610122222222224
      },
      {
        "rank": 7,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 208,
        "function_name": "batch_ucb_selection",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.002337117,
        "cumulative_time": 0.004535956000000001,
        "time_percent": 0.9883938125302157,
        "time_per_call": 0.0002519975555555556
      },
      {
        "rank": 8,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1029,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0022476930000000003,
        "cumulative_time": 0.010538652,
        "time_percent": 2.2963931813291802,
        "time_per_call": 0.0011709613333333335
      },
      {
        "rank": 9,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 81,
        "primitive_calls": 81,
        "total_time": 0.001974819,
        "cumulative_time": 0.001974819,
        "time_percent": 0.43031697848636713,
        "time_per_call": 2.4380481481481482e-05
      },
      {
        "rank": 10,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 87,
        "primitive_calls": 87,
        "total_time": 0.001311822,
        "cumulative_time": 0.014525320000000001,
        "time_percent": 3.1650960487759123,
        "time_per_call": 0.0001669577011494253
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 16157,
        "primitive_calls": 16157,
        "total_time": 0.001158531,
        "cumulative_time": 0.001158531,
        "time_percent": 0.2524462036281752,
        "time_per_call": 7.170458624744692e-08
      },
      {
        "rank": 12,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 36,
        "primitive_calls": 36,
        "total_time": 0.001074806,
        "cumulative_time": 0.059175633000000005,
        "time_percent": 12.894487845507946,
        "time_per_call": 0.0016437675833333334
      },
      {
        "rank": 13,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 87,
        "primitive_calls": 87,
        "total_time": 0.001001537,
        "cumulative_time": 0.001001537,
        "time_percent": 0.218236899524615,
        "time_per_call": 1.1511919540229885e-05
      },
      {
        "rank": 14,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 10692,
        "primitive_calls": 10692,
        "total_time": 0.000989923,
        "cumulative_time": 0.000989923,
        "time_percent": 0.21570618588040727,
        "time_per_call": 9.258539094650205e-08
      },
      {
        "rank": 15,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 117,
        "primitive_calls": 117,
        "total_time": 0.000971464,
        "cumulative_time": 0.000971464,
        "time_percent": 0.21168393315452205,
        "time_per_call": 8.30311111111111e-06
      },
      {
        "rank": 16,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 814,
        "function_name": "get_children",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.0009558640000000001,
        "cumulative_time": 0.0010204040000000001,
        "time_percent": 0.2223480562600436,
        "time_per_call": 9.276400000000001e-05
      },
      {
        "rank": 17,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 873,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0009167400000000001,
        "cumulative_time": 0.001281266,
        "time_percent": 0.27919040365588627,
        "time_per_call": 0.0001423628888888889
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 87,
        "primitive_calls": 87,
        "total_time": 0.000877481,
        "cumulative_time": 0.000877481,
        "time_percent": 0.1912048509758089,
        "time_per_call": 1.0085988505747127e-05
      },
      {
        "rank": 19,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1239,
        "function_name": "apply_virtual_loss",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.00080594,
        "cumulative_time": 0.00080594,
        "time_percent": 0.17561592512594962,
        "time_per_call": 4.4774444444444445e-05
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000709876,
        "cumulative_time": 0.000853979,
        "time_percent": 0.1860837185437295,
        "time_per_call": 0.00021349475
      },
      {
        "rank": 21,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1244,
        "function_name": "remove_virtual_loss",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.000584586,
        "cumulative_time": 0.000707096,
        "time_percent": 0.15407762140216205,
        "time_per_call": 7.856622222222222e-05
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'long' of 'torch._C.TensorBase' objects>",
        "total_calls": 81,
        "primitive_calls": 81,
        "total_time": 0.000441053,
        "cumulative_time": 0.000441053,
        "time_percent": 0.09610632382630897,
        "time_per_call": 5.445098765432099e-06
      },
      {
        "rank": 23,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.00043878700000000005,
        "cumulative_time": 0.00277915,
        "time_percent": 0.6055822993197792,
        "time_per_call": 0.00055583
      },
      {
        "rank": 24,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros>",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 0.00042895600000000003,
        "cumulative_time": 0.00042895600000000003,
        "time_percent": 0.09347036352374476,
        "time_per_call": 1.588725925925926e-05
      },
      {
        "rank": 25,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 54,
        "primitive_calls": 54,
        "total_time": 0.000394666,
        "cumulative_time": 0.000394666,
        "time_percent": 0.08599850448638613,
        "time_per_call": 7.30862962962963e-06
      },
      {
        "rank": 26,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 45,
        "primitive_calls": 45,
        "total_time": 0.00037566600000000003,
        "cumulative_time": 0.00037566600000000003,
        "time_percent": 0.0818583667870623,
        "time_per_call": 8.348133333333334e-06
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 3605,
        "primitive_calls": 3605,
        "total_time": 0.00035784,
        "cumulative_time": 0.000950684,
        "time_percent": 0.20715592992336687,
        "time_per_call": 2.637126213592233e-07
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.000357452,
        "cumulative_time": 0.000357452,
        "time_percent": 0.07788950004729998,
        "time_per_call": 3.971688888888889e-05
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 3394,
        "primitive_calls": 3394,
        "total_time": 0.000335137,
        "cumulative_time": 0.000335137,
        "time_percent": 0.07302701727043623,
        "time_per_call": 9.874395992928698e-08
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 36,
        "primitive_calls": 36,
        "total_time": 0.00033038500000000004,
        "cumulative_time": 0.00033038500000000004,
        "time_percent": 0.07199154704163693,
        "time_per_call": 9.177361111111112e-06
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x746c91bdbba0>",
        "total_calls": 74,
        "primitive_calls": 74,
        "total_time": 0.00031292900000000004,
        "cumulative_time": 0.00031292900000000004,
        "time_percent": 0.06818785000587921,
        "time_per_call": 4.2287702702702704e-06
      },
      {
        "rank": 32,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 275,
        "primitive_calls": 275,
        "total_time": 0.000310307,
        "cumulative_time": 0.0026251620000000003,
        "time_percent": 0.572028008580649,
        "time_per_call": 9.546043636363638e-06
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 74,
        "primitive_calls": 74,
        "total_time": 0.000304031,
        "cumulative_time": 0.000304031,
        "time_percent": 0.06624895815069061,
        "time_per_call": 4.108527027027028e-06
      },
      {
        "rank": 34,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 194,
        "primitive_calls": 194,
        "total_time": 0.000298958,
        "cumulative_time": 0.000592844,
        "time_percent": 0.12918188390620702,
        "time_per_call": 3.055896907216495e-06
      },
      {
        "rank": 35,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 264,
        "primitive_calls": 264,
        "total_time": 0.000283122,
        "cumulative_time": 0.00048336200000000004,
        "time_percent": 0.10532553887476644,
        "time_per_call": 1.8309166666666668e-06
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 36,
        "primitive_calls": 36,
        "total_time": 0.00027810700000000004,
        "cumulative_time": 0.00027810700000000004,
        "time_percent": 0.06060006711293952,
        "time_per_call": 7.725194444444446e-06
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method mcts_cuda_kernels.batched_ucb_selection>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.00027338600000000003,
        "cumulative_time": 0.00027338600000000003,
        "time_percent": 0.059571351845649635,
        "time_per_call": 1.5188111111111113e-05
      },
      {
        "rank": 38,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 77,
        "primitive_calls": 77,
        "total_time": 0.00026887300000000004,
        "cumulative_time": 0.013017418000000001,
        "time_percent": 2.836521211034555,
        "time_per_call": 0.00016905737662337663
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 0.000254001,
        "cumulative_time": 0.000254001,
        "time_percent": 0.055347321882418456,
        "time_per_call": 9.407444444444445e-06
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 15,
        "primitive_calls": 15,
        "total_time": 0.000251915,
        "cumulative_time": 0.000276302,
        "time_percent": 0.06020675403150376,
        "time_per_call": 1.8420133333333333e-05
      },
      {
        "rank": 41,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.000248261,
        "cumulative_time": 0.00044874600000000003,
        "time_percent": 0.0977826437905668,
        "time_per_call": 8.974920000000001e-05
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.ones_like>",
        "total_calls": 36,
        "primitive_calls": 36,
        "total_time": 0.00024677600000000004,
        "cumulative_time": 0.00024677600000000004,
        "time_percent": 0.053772980046754536,
        "time_per_call": 6.85488888888889e-06
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'scatter_add_' of 'torch._C.TensorBase' objects>",
        "total_calls": 36,
        "primitive_calls": 36,
        "total_time": 0.00024330300000000003,
        "cumulative_time": 0.00024330300000000003,
        "time_percent": 0.05301620645571497,
        "time_per_call": 6.758416666666667e-06
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 45,
        "primitive_calls": 45,
        "total_time": 0.00023647400000000003,
        "cumulative_time": 0.00023647400000000003,
        "time_percent": 0.05152815380578432,
        "time_per_call": 5.2549777777777785e-06
      },
      {
        "rank": 45,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 812,
        "function_name": "_get_device_index",
        "total_calls": 255,
        "primitive_calls": 255,
        "total_time": 0.000226729,
        "cumulative_time": 0.002183176,
        "time_percent": 0.47571838220310475,
        "time_per_call": 8.561474509803923e-06
      },
      {
        "rank": 46,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 109,
        "primitive_calls": 109,
        "total_time": 0.00022363700000000003,
        "cumulative_time": 0.001874271,
        "time_percent": 0.40840736978154546,
        "time_per_call": 1.7195146788990828e-05
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 109,
        "primitive_calls": 109,
        "total_time": 0.00020595900000000002,
        "cumulative_time": 0.00020595900000000002,
        "time_percent": 0.044878874758686085,
        "time_per_call": 1.8895321100917433e-06
      },
      {
        "rank": 48,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 421,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 2,
        "total_time": 0.00020572,
        "cumulative_time": 0.060281699,
        "time_percent": 13.135501821536383,
        "time_per_call": 0.060281699
      },
      {
        "rank": 49,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 770,
        "function_name": "_get_device_attr",
        "total_calls": 255,
        "primitive_calls": 255,
        "total_time": 0.00019864,
        "cumulative_time": 0.0017746600000000002,
        "time_percent": 0.38670193523589574,
        "time_per_call": 6.959450980392157e-06
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._get_tracing_state>",
        "total_calls": 194,
        "primitive_calls": 194,
        "total_time": 0.00019086300000000002,
        "cumulative_time": 0.00019086300000000002,
        "time_percent": 0.04158942640558122,
        "time_per_call": 9.838298969072166e-07
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": null,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": true,
      "quantum_config": "QuantumConfig(quantum_level='tree_level', min_wave_size=3072, optimal_wave_size=3072, hbar_eff=0.1, temperature=1.0, coupling_strength=0.1, decoherence_rate=0.01, measurement_noise=0.0, path_integral_steps=10, path_integral_beta=1.0, use_wick_rotation=True, interference_alpha=0.05, interference_method='minhash', minhash_size=64, phase_kick_strength=0.1, use_mixed_precision=True, cache_corrections=True, fast_mode=True, enable_quantum=True, uncertainty_decay=0.99, phase_temperature=1.0, device='cuda')",
      "quantum_version": "v2",
      "quantum_branching_factor": null,
      "quantum_avg_game_length": null,
      "enable_phase_adaptation": true,
      "envariance_threshold": 0.001,
      "envariance_check_interval": 1000,
      "enable_virtual_loss": true,
      "virtual_loss": 1.0,
      "virtual_loss_value": -1.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "compile_mode": "reduce-overhead",
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "target_sims_per_second": 100000,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "tree_batch_size": 1024,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "tree_level",
    "num_simulations": 25000,
    "wave_size": 3072,
    "total_time_ms": 252.37834895960987,
    "simulations_per_second": 99057.62559688094,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 19.762975692749023,
        "cpu_time_ms": 19.83107696287334,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 2.500351905822754,
        "cpu_time_ms": 2.5524109369143844,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0483839511871338,
        "cpu_time_ms": 1.0968069545924664,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7751680016517639,
        "cpu_time_ms": 0.8210770320147276,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 16.681215286254883,
        "cpu_time_ms": 16.744549036957324,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 2.8064000606536865,
        "cpu_time_ms": 2.8548609698191285,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0445120334625244,
        "cpu_time_ms": 1.0922689689323306,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7331839799880981,
        "cpu_time_ms": 0.7792189717292786,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 16.285951614379883,
        "cpu_time_ms": 16.33447699714452,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 2.7908480167388916,
        "cpu_time_ms": 2.839141059666872,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0328320264816284,
        "cpu_time_ms": 1.087700016796589,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7250880002975464,
        "cpu_time_ms": 0.7720050634816289,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 17.44588851928711,
        "cpu_time_ms": 17.4946840852499,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 3.648927927017212,
        "cpu_time_ms": 3.6964970640838146,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 2.254848003387451,
        "cpu_time_ms": 2.3046339629217982,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.0977280139923096,
        "cpu_time_ms": 1.1512800119817257,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 17.457599639892578,
        "cpu_time_ms": 17.505854950286448,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 6.004191875457764,
        "cpu_time_ms": 6.052277982234955,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0475519895553589,
        "cpu_time_ms": 1.0954539757221937,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.8744959831237793,
        "cpu_time_ms": 0.9215069003403187,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 18.655231475830078,
        "cpu_time_ms": 18.704975955188274,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 6.559455871582031,
        "cpu_time_ms": 6.606391980312765,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0457600355148315,
        "cpu_time_ms": 1.0912769939750433,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.013759970664978,
        "cpu_time_ms": 1.0595079511404037,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.51036834716797,
        "cpu_time_ms": 19.558423082344234,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 6.309375762939453,
        "cpu_time_ms": 6.357011967338622,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.7569279670715332,
        "cpu_time_ms": 1.8029080238193274,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.0131200551986694,
        "cpu_time_ms": 1.0674810037016869,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 20.138591766357422,
        "cpu_time_ms": 20.18702798523009,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 6.301951885223389,
        "cpu_time_ms": 6.351090036332607,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0453439950942993,
        "cpu_time_ms": 1.1021379614248872,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.7848320007324219,
        "cpu_time_ms": 1.8316720379516482,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 18.629568099975586,
        "cpu_time_ms": 18.677683896385133,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "expansion",
        "gpu_time_ms": 9.220352172851562,
        "cpu_time_ms": 9.270943002775311,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0565760135650635,
        "cpu_time_ms": 1.1042720871046185,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.58515202999115,
        "cpu_time_ms": 1.634411048144102,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      }
    ],
    "peak_gpu_memory_mb": 4236.19580078125,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 184.2,
    "avg_ram_usage_mb": 1337.97265625,
    "final_tree_nodes": 489,
    "final_tree_edges": 488,
    "tree_memory_mb": 47.73538589477539,
    "efficiency_score": 23944.83479552555,
    "bottleneck_phase": "selection",
    "recommendations": [
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Consider using classical selection for hot paths",
      "Tree-level quantum may be excessive - consider one-loop for balance",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 320,
    "total_kernel_calls": 504,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         98173 function calls (75581 primitive calls) in 0.250 seconds\n\n   Ordered by: cumulative time\n   List reduced from 233 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.248    0.248 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:461(_search_optimized)\n        9    0.000    0.000    0.248    0.028 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:637(_run_search_wave_vectorized)\n       36    0.001    0.000    0.248    0.007 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:394(_profile_phase)\n        9    0.000    0.000    0.169    0.019 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:369(instrumented_select)\n        9    0.008    0.001    0.144    0.016 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:661(_select_batch_vectorized)\n       28    0.000    0.000    0.130    0.005 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:964(batch_select_ucb_optimized)\n       28    0.004    0.000    0.128    0.005 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:208(batch_ucb_selection)\n       28    0.001    0.000    0.121    0.004 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py:1124(__format__)\n       22    0.072    0.003    0.073    0.003 {built-in method time.sleep}\n        9    0.000    0.000    0.050    0.006 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:372(instrumented_expand)\n        9    0.001    0.000    0.046    0.005 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:873(_expand_batch_vectorized)\n       10    0.005    0.001    0.043    0.004 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:897(_expand_node_batch)\n      160    0.040    0.000    0.040    0.000 {method 'item' of 'torch._C.TensorBase' objects}\n      141    0.002    0.000    0.026    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       23    0.001    0.000    0.020    0.001 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py:1009(cpu_percent)\n22701/141    0.015    0.000    0.019    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       95    0.000    0.000    0.018    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       61    0.013    0.000    0.018    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:512(add_children_batch)\n        9    0.000    0.000    0.015    0.002 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:375(instrumented_evaluate)\n        9    0.000    0.000    0.013    0.001 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:378(instrumented_backup)\n       19    0.009    0.000    0.012    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:391(get_nn_features)\n        9    0.002    0.000    0.011    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1029(_evaluate_batch_vectorized)\n        9    0.005    0.001    0.009    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1098(_backup_batch_vectorized)\n       28    0.006    0.000    0.008    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1162(batch_action_to_child)\n       46    0.000    0.000    0.008    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n      261    0.007    0.000    0.007    0.000 {built-in method torch.where}\n        9    0.000    0.000    0.006    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1389(ensure_consistent)\n        9    0.001    0.000    0.006    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1351(_rebuild_row_pointers)\n       29    0.005    0.000    0.005    0.000 {method 'sum' of 'torch._C.TensorBase' objects}\n       28    0.005    0.000    0.005    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:920(batch_get_children)\n      347    0.000    0.000    0.003    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n       74    0.000    0.000    0.003    0.000 {built-in method builtins.next}\n       74    0.000    0.000    0.003    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:196(timer)\n     6203    0.001    0.000    0.003    0.000 {built-in method builtins.len}\n      141    0.000    0.000    0.003    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n        9    0.002    0.000    0.002    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:318(apply_moves)\n      255    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n      216    0.002    0.000    0.002    0.000 {built-in method torch.arange}\n      109    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n       23    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py:1964(virtual_memory)\n      255    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n       46    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_common.py:452(wrapper)\n    69/46    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py:1642(wrapper)\n      124    0.002    0.000    0.002    0.000 {built-in method torch.tensor}\n    24963    0.002    0.000    0.002    0.000 {built-in method builtins.isinstance}\n      255    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n       23    0.001    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py:352(virtual_memory)\n      614    0.001    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py:1159(__len__)\n       37    0.000    0.000    0.002    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n    17298    0.002    0.000    0.002    0.000 {method 'append' of 'list' objects}\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 22,
        "primitive_calls": 22,
        "total_time": 0.07220385600000001,
        "cumulative_time": 0.072817529,
        "time_percent": 3.648177216904152,
        "time_per_call": 0.0033098876818181823
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 160,
        "primitive_calls": 160,
        "total_time": 0.039541979000000005,
        "cumulative_time": 0.039541979000000005,
        "time_percent": 1.9810634730423555,
        "time_per_call": 0.00024713736875
      },
      {
        "rank": 3,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 141,
        "primitive_calls": 22701,
        "total_time": 0.01474752,
        "cumulative_time": 0.019225085000000003,
        "time_percent": 0.963181778525412,
        "time_per_call": 0.0001363481205673759
      },
      {
        "rank": 4,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 512,
        "function_name": "add_children_batch",
        "total_calls": 61,
        "primitive_calls": 61,
        "total_time": 0.012943540000000002,
        "cumulative_time": 0.018228575,
        "time_percent": 0.9132563673182126,
        "time_per_call": 0.00029882909836065574
      },
      {
        "rank": 5,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 391,
        "function_name": "get_nn_features",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.008787728,
        "cumulative_time": 0.01208671,
        "time_percent": 0.6055473270636192,
        "time_per_call": 0.0006361426315789474
      },
      {
        "rank": 6,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 661,
        "function_name": "_select_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.008170198,
        "cumulative_time": 0.14434011000000002,
        "time_percent": 7.231477200873422,
        "time_per_call": 0.016037790000000003
      },
      {
        "rank": 7,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 261,
        "primitive_calls": 261,
        "total_time": 0.006623489000000001,
        "cumulative_time": 0.006623489000000001,
        "time_percent": 0.3318385284155312,
        "time_per_call": 2.537735249042146e-05
      },
      {
        "rank": 8,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1162,
        "function_name": "batch_action_to_child",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.006499912,
        "cumulative_time": 0.008455247,
        "time_percent": 0.4236100825214377,
        "time_per_call": 0.00030197310714285717
      },
      {
        "rank": 9,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 897,
        "function_name": "_expand_node_batch",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 0.005193619,
        "cumulative_time": 0.043327302000000005,
        "time_percent": 2.17070914376023,
        "time_per_call": 0.004332730200000001
      },
      {
        "rank": 10,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 29,
        "primitive_calls": 29,
        "total_time": 0.005124112,
        "cumulative_time": 0.005124112,
        "time_percent": 0.25671934920045375,
        "time_per_call": 0.00017669351724137932
      },
      {
        "rank": 11,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1098,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.004933637,
        "cumulative_time": 0.008761092,
        "time_percent": 0.4389329968832262,
        "time_per_call": 0.0009734546666666666
      },
      {
        "rank": 12,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 920,
        "function_name": "batch_get_children",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.004558840000000001,
        "cumulative_time": 0.005065539,
        "time_percent": 0.2537848266059597,
        "time_per_call": 0.00018091210714285715
      },
      {
        "rank": 13,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 208,
        "function_name": "batch_ucb_selection",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.0038414610000000004,
        "cumulative_time": 0.128223595,
        "time_percent": 6.424035591053152,
        "time_per_call": 0.004579414107142857
      },
      {
        "rank": 14,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 141,
        "primitive_calls": 141,
        "total_time": 0.0022845720000000003,
        "cumulative_time": 0.025732861000000003,
        "time_percent": 1.289223055426138,
        "time_per_call": 0.00018250256028368796
      },
      {
        "rank": 15,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1029,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.00217046,
        "cumulative_time": 0.010841123000000001,
        "time_percent": 0.5431430931178068,
        "time_per_call": 0.0012045692222222223
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 216,
        "primitive_calls": 216,
        "total_time": 0.002113176,
        "cumulative_time": 0.002128945,
        "time_percent": 0.106660700406931,
        "time_per_call": 9.856226851851853e-06
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 124,
        "primitive_calls": 124,
        "total_time": 0.001960487,
        "cumulative_time": 0.001960487,
        "time_percent": 0.09822091061943024,
        "time_per_call": 1.5810379032258063e-05
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 24963,
        "primitive_calls": 24963,
        "total_time": 0.0019356100000000002,
        "cumulative_time": 0.0019356100000000002,
        "time_percent": 0.09697456642358526,
        "time_per_call": 7.753915795377158e-08
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 17298,
        "primitive_calls": 17298,
        "total_time": 0.0017598520000000001,
        "cumulative_time": 0.0017598520000000001,
        "time_percent": 0.08816904472991945,
        "time_per_call": 1.0173731067175396e-07
      },
      {
        "rank": 20,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 318,
        "function_name": "apply_moves",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0016910240000000002,
        "cumulative_time": 0.0024173370000000003,
        "time_percent": 0.12110921491141828,
        "time_per_call": 0.000268593
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 141,
        "primitive_calls": 141,
        "total_time": 0.0016872870000000002,
        "cumulative_time": 0.0016872870000000002,
        "time_percent": 0.08453351928185529,
        "time_per_call": 1.1966574468085108e-05
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 141,
        "primitive_calls": 141,
        "total_time": 0.001610361,
        "cumulative_time": 0.001610361,
        "time_percent": 0.08067950659505334,
        "time_per_call": 1.1421e-05
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 184,
        "primitive_calls": 184,
        "total_time": 0.001580627,
        "cumulative_time": 0.001580627,
        "time_percent": 0.07918982543095576,
        "time_per_call": 8.590364130434783e-06
      },
      {
        "rank": 24,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 124,
        "primitive_calls": 124,
        "total_time": 0.001373965,
        "cumulative_time": 0.001373965,
        "time_percent": 0.06883600526768373,
        "time_per_call": 1.1080362903225807e-05
      },
      {
        "rank": 25,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 873,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.001353819,
        "cumulative_time": 0.045665608,
        "time_percent": 2.2878588849351917,
        "time_per_call": 0.005073956444444445
      },
      {
        "rank": 26,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1124,
        "function_name": "__format__",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.0013039500000000001,
        "cumulative_time": 0.12079130900000001,
        "time_percent": 6.051676121745761,
        "time_per_call": 0.0043139753214285715
      },
      {
        "rank": 27,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1239,
        "function_name": "apply_virtual_loss",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.001202945,
        "cumulative_time": 0.001202945,
        "time_percent": 0.06026785861119738,
        "time_per_call": 4.296232142857143e-05
      },
      {
        "rank": 28,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1014,
        "function_name": "_clone_states_batch",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.00116192,
        "cumulative_time": 0.00116192,
        "time_percent": 0.05821249539881081,
        "time_per_call": 0.00012910222222222223
      },
      {
        "rank": 29,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.0010505450000000002,
        "cumulative_time": 0.0018656360000000002,
        "time_percent": 0.09346885075207916,
        "time_per_call": 8.111460869565219e-05
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.topk>",
        "total_calls": 61,
        "primitive_calls": 61,
        "total_time": 0.0010426460000000002,
        "cumulative_time": 0.0010426460000000002,
        "time_percent": 0.0522368368541625,
        "time_per_call": 1.7092557377049183e-05
      },
      {
        "rank": 31,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.000995163,
        "cumulative_time": 0.020171210000000002,
        "time_percent": 1.0105828880761554,
        "time_per_call": 0.0008770091304347826
      },
      {
        "rank": 32,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1351,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.000981703,
        "cumulative_time": 0.006241696000000001,
        "time_percent": 0.3127105994223146,
        "time_per_call": 0.0006935217777777778
      },
      {
        "rank": 33,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 614,
        "primitive_calls": 614,
        "total_time": 0.000910456,
        "cumulative_time": 0.0017768970000000002,
        "time_percent": 0.08902300368068433,
        "time_per_call": 2.893969055374593e-06
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'long' of 'torch._C.TensorBase' objects>",
        "total_calls": 164,
        "primitive_calls": 164,
        "total_time": 0.0008830940000000001,
        "cumulative_time": 0.0008830940000000001,
        "time_percent": 0.04424323999218314,
        "time_per_call": 5.3847195121951224e-06
      },
      {
        "rank": 35,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 814,
        "function_name": "get_children",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.000874045,
        "cumulative_time": 0.00092929,
        "time_percent": 0.0465576716548135,
        "time_per_call": 8.44809090909091e-05
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 6203,
        "primitive_calls": 6203,
        "total_time": 0.000827455,
        "cumulative_time": 0.0026043520000000003,
        "time_percent": 0.13047871524449509,
        "time_per_call": 4.198536192165082e-07
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method mcts_cuda_kernels.batched_ucb_selection_quantum>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.000792782,
        "cumulative_time": 0.000792782,
        "time_percent": 0.0397185852100489,
        "time_per_call": 2.831364285714286e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 102,
        "primitive_calls": 102,
        "total_time": 0.000760385,
        "cumulative_time": 0.000760385,
        "time_percent": 0.03809548705059277,
        "time_per_call": 7.454754901960784e-06
      },
      {
        "rank": 39,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1344,
        "function_name": "set_expanded",
        "total_calls": 61,
        "primitive_calls": 61,
        "total_time": 0.000757361,
        "cumulative_time": 0.000757361,
        "time_percent": 0.037943983860970414,
        "time_per_call": 1.2415754098360656e-05
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 69,
        "primitive_calls": 69,
        "total_time": 0.0007512580000000001,
        "cumulative_time": 0.0007937090000000001,
        "time_percent": 0.039765028152105766,
        "time_per_call": 1.1503028985507247e-05
      },
      {
        "rank": 41,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 36,
        "primitive_calls": 36,
        "total_time": 0.0007071610000000001,
        "cumulative_time": 0.24752902200000002,
        "time_percent": 12.40126863660763,
        "time_per_call": 0.006875806166666667
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 134,
        "primitive_calls": 134,
        "total_time": 0.0006243230000000001,
        "cumulative_time": 0.0006243230000000001,
        "time_percent": 0.03127874532228705,
        "time_per_call": 4.6591268656716424e-06
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 5500,
        "primitive_calls": 5500,
        "total_time": 0.0006193310000000001,
        "cumulative_time": 0.0006193310000000001,
        "time_percent": 0.031028644818783476,
        "time_per_call": 1.1260563636363638e-07
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 63,
        "primitive_calls": 63,
        "total_time": 0.0006135330000000001,
        "cumulative_time": 0.0006135330000000001,
        "time_percent": 0.030738163504818398,
        "time_per_call": 9.73861904761905e-06
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._get_tracing_state>",
        "total_calls": 654,
        "primitive_calls": 654,
        "total_time": 0.000586034,
        "cumulative_time": 0.000586034,
        "time_percent": 0.02936045642432069,
        "time_per_call": 8.960764525993885e-07
      },
      {
        "rank": 46,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1244,
        "function_name": "remove_virtual_loss",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0005822000000000001,
        "cumulative_time": 0.000707314,
        "time_percent": 0.03543661609277271,
        "time_per_call": 7.859044444444444e-05
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros>",
        "total_calls": 57,
        "primitive_calls": 57,
        "total_time": 0.0005583620000000001,
        "cumulative_time": 0.0005583620000000001,
        "time_percent": 0.027974081998649477,
        "time_per_call": 9.79582456140351e-06
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 56,
        "primitive_calls": 56,
        "total_time": 0.000545962,
        "cumulative_time": 0.000545962,
        "time_percent": 0.02735283876078004,
        "time_per_call": 9.749321428571428e-06
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'scatter_add_' of 'torch._C.TensorBase' objects>",
        "total_calls": 56,
        "primitive_calls": 56,
        "total_time": 0.00037343500000000003,
        "cumulative_time": 0.00037343500000000003,
        "time_percent": 0.018709191010788107,
        "time_per_call": 6.6684821428571436e-06
      },
      {
        "rank": 50,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 95,
        "primitive_calls": 95,
        "total_time": 0.000372436,
        "cumulative_time": 0.018239178,
        "time_percent": 0.9137875803868523,
        "time_per_call": 0.00019199134736842108
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": null,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": true,
      "quantum_config": "QuantumConfig(quantum_level='one_loop', min_wave_size=3072, optimal_wave_size=3072, hbar_eff=0.1, temperature=1.0, coupling_strength=0.1, decoherence_rate=0.01, measurement_noise=0.0, path_integral_steps=10, path_integral_beta=1.0, use_wick_rotation=True, interference_alpha=0.05, interference_method='minhash', minhash_size=64, phase_kick_strength=0.1, use_mixed_precision=True, cache_corrections=True, fast_mode=True, enable_quantum=True, uncertainty_decay=0.99, phase_temperature=1.0, device='cuda')",
      "quantum_version": "v2",
      "quantum_branching_factor": null,
      "quantum_avg_game_length": null,
      "enable_phase_adaptation": true,
      "envariance_threshold": 0.001,
      "envariance_check_interval": 1000,
      "enable_virtual_loss": true,
      "virtual_loss": 1.0,
      "virtual_loss_value": -1.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "compile_mode": "reduce-overhead",
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "target_sims_per_second": 100000,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "tree_batch_size": 1024,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "one_loop",
    "num_simulations": 25000,
    "wave_size": 3072,
    "total_time_ms": 260.322732036002,
    "simulations_per_second": 96034.64055740842,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 19.733440399169922,
        "cpu_time_ms": 19.795860978774726,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 2.4995839595794678,
        "cpu_time_ms": 2.5488139363005757,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.050879955291748,
        "cpu_time_ms": 1.0986609850078821,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.758080005645752,
        "cpu_time_ms": 0.8047770243138075,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 16.842527389526367,
        "cpu_time_ms": 16.892228042706847,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 2.8701119422912598,
        "cpu_time_ms": 2.9177990509197116,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0342400074005127,
        "cpu_time_ms": 1.0820890311151743,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7251520156860352,
        "cpu_time_ms": 0.7711829384788871,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 17.209856033325195,
        "cpu_time_ms": 17.25637400522828,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 2.827359914779663,
        "cpu_time_ms": 2.8743670554831624,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0364480018615723,
        "cpu_time_ms": 1.0826910147443414,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7290880084037781,
        "cpu_time_ms": 0.7801910396665335,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 18.64672088623047,
        "cpu_time_ms": 18.702349974773824,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 4.465184211730957,
        "cpu_time_ms": 4.512816085480154,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0383360385894775,
        "cpu_time_ms": 1.0843540076166391,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.936959981918335,
        "cpu_time_ms": 0.9912579553201795,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 18.05241584777832,
        "cpu_time_ms": 18.100515007972717,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 5.006495952606201,
        "cpu_time_ms": 5.053234053775668,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0455360412597656,
        "cpu_time_ms": 1.0914569720625877,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.8622080087661743,
        "cpu_time_ms": 0.9078310104086995,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 18.682720184326172,
        "cpu_time_ms": 18.73179490212351,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 6.522272109985352,
        "cpu_time_ms": 6.570262950845063,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0936319828033447,
        "cpu_time_ms": 1.1530040064826608,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.751039981842041,
        "cpu_time_ms": 2.0437020575627685,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 21.129215240478516,
        "cpu_time_ms": 21.17817592807114,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 7.533919811248779,
        "cpu_time_ms": 7.581820013001561,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.082368016242981,
        "cpu_time_ms": 1.131362048909068,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.0667200088500977,
        "cpu_time_ms": 1.1175659019500017,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 21.825759887695312,
        "cpu_time_ms": 21.877634921111166,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 7.411839962005615,
        "cpu_time_ms": 7.464308990165591,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0570240020751953,
        "cpu_time_ms": 1.1056140065193176,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.022976040840149,
        "cpu_time_ms": 1.0706780012696981,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 20.5383358001709,
        "cpu_time_ms": 20.58903605211526,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "expansion",
        "gpu_time_ms": 9.53110408782959,
        "cpu_time_ms": 9.581670048646629,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0455039739608765,
        "cpu_time_ms": 1.0927889961749315,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.305567979812622,
        "cpu_time_ms": 1.3527489500120282,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      }
    ],
    "peak_gpu_memory_mb": 4238.9150390625,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 185.9,
    "avg_ram_usage_mb": 1337.97265625,
    "final_tree_nodes": 489,
    "final_tree_edges": 488,
    "tree_memory_mb": 47.73538589477539,
    "efficiency_score": 23199.208057856114,
    "bottleneck_phase": "selection",
    "recommendations": [
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Consider using classical selection for hot paths",
      "One-loop quantum is a good balance - monitor overhead",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 574,
    "total_kernel_calls": 758,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         98173 function calls (75581 primitive calls) in 0.258 seconds\n\n   Ordered by: cumulative time\n   List reduced from 233 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.256    0.256 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:461(_search_optimized)\n        9    0.000    0.000    0.256    0.028 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:637(_run_search_wave_vectorized)\n       36    0.001    0.000    0.255    0.007 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:394(_profile_phase)\n        9    0.000    0.000    0.177    0.020 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:369(instrumented_select)\n        9    0.011    0.001    0.154    0.017 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:661(_select_batch_vectorized)\n       28    0.000    0.000    0.134    0.005 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:964(batch_select_ucb_optimized)\n       28    0.004    0.000    0.132    0.005 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:208(batch_ucb_selection)\n       28    0.001    0.000    0.110    0.004 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py:1124(__format__)\n       22    0.089    0.004    0.108    0.005 {built-in method time.sleep}\n        9    0.000    0.000    0.053    0.006 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:372(instrumented_expand)\n        9    0.001    0.000    0.048    0.005 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:873(_expand_batch_vectorized)\n       10    0.005    0.000    0.042    0.004 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:897(_expand_node_batch)\n      141    0.002    0.000    0.025    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n      160    0.025    0.000    0.025    0.000 {method 'item' of 'torch._C.TensorBase' objects}\n22701/141    0.014    0.000    0.019    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       61    0.013    0.000    0.019    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:512(add_children_batch)\n       95    0.000    0.000    0.018    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       23    0.000    0.000    0.016    0.001 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py:1964(virtual_memory)\n       19    0.010    0.001    0.013    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:391(get_nn_features)\n        9    0.000    0.000    0.013    0.001 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:375(instrumented_evaluate)\n        9    0.000    0.000    0.013    0.001 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:378(instrumented_backup)\n       28    0.008    0.000    0.010    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1162(batch_action_to_child)\n        9    0.002    0.000    0.009    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1029(_evaluate_batch_vectorized)\n        9    0.006    0.001    0.009    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1098(_backup_batch_vectorized)\n       46    0.000    0.000    0.008    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n      261    0.007    0.000    0.007    0.000 {built-in method torch.where}\n        9    0.000    0.000    0.006    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1389(ensure_consistent)\n        9    0.001    0.000    0.006    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1351(_rebuild_row_pointers)\n       46    0.001    0.000    0.006    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_common.py:452(wrapper)\n       29    0.005    0.000    0.005    0.000 {method 'sum' of 'torch._C.TensorBase' objects}\n       28    0.004    0.000    0.005    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:920(batch_get_children)\n      347    0.000    0.000    0.003    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n       74    0.000    0.000    0.003    0.000 {built-in method builtins.next}\n       74    0.000    0.000    0.003    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:196(timer)\n     6203    0.001    0.000    0.003    0.000 {built-in method builtins.len}\n      141    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n        9    0.002    0.000    0.002    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:318(apply_moves)\n      255    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n      109    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n      216    0.002    0.000    0.002    0.000 {built-in method torch.arange}\n       23    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py:1009(cpu_percent)\n    69/46    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py:1642(wrapper)\n    24963    0.002    0.000    0.002    0.000 {built-in method builtins.isinstance}\n      255    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n      124    0.002    0.000    0.002    0.000 {built-in method torch.tensor}\n      255    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n      614    0.001    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py:1159(__len__)\n       37    0.000    0.000    0.002    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n      141    0.002    0.000    0.002    0.000 {method 'sort' of 'list' objects}\n    17298    0.002    0.000    0.002    0.000 {method 'append' of 'list' objects}\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 22,
        "primitive_calls": 22,
        "total_time": 0.08900804400000001,
        "cumulative_time": 0.107523276,
        "time_percent": 5.232639410665779,
        "time_per_call": 0.0048874216363636366
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 160,
        "primitive_calls": 160,
        "total_time": 0.024904432,
        "cumulative_time": 0.024924831,
        "time_percent": 1.212971347662288,
        "time_per_call": 0.00015578019375000001
      },
      {
        "rank": 3,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 141,
        "primitive_calls": 22701,
        "total_time": 0.014435897000000001,
        "cumulative_time": 0.018970945,
        "time_percent": 0.9232244231897557,
        "time_per_call": 0.00013454570921985815
      },
      {
        "rank": 4,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 512,
        "function_name": "add_children_batch",
        "total_calls": 61,
        "primitive_calls": 61,
        "total_time": 0.01288087,
        "cumulative_time": 0.018685805,
        "time_percent": 0.9093480342155467,
        "time_per_call": 0.0003063246721311475
      },
      {
        "rank": 5,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 661,
        "function_name": "_select_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.010864875000000001,
        "cumulative_time": 0.153509473,
        "time_percent": 7.470565892452294,
        "time_per_call": 0.01705660811111111
      },
      {
        "rank": 6,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 391,
        "function_name": "get_nn_features",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.009613164,
        "cumulative_time": 0.013115449000000001,
        "time_percent": 0.6382656656218053,
        "time_per_call": 0.0006902867894736843
      },
      {
        "rank": 7,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1162,
        "function_name": "batch_action_to_child",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.007850222,
        "cumulative_time": 0.009927044000000001,
        "time_percent": 0.48310136742683757,
        "time_per_call": 0.00035453728571428576
      },
      {
        "rank": 8,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 261,
        "primitive_calls": 261,
        "total_time": 0.007043799000000001,
        "cumulative_time": 0.007043799000000001,
        "time_percent": 0.34278773507801424,
        "time_per_call": 2.6987735632183913e-05
      },
      {
        "rank": 9,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1098,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.005801033000000001,
        "cumulative_time": 0.008687582000000001,
        "time_percent": 0.4227827280540693,
        "time_per_call": 0.000965286888888889
      },
      {
        "rank": 10,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 29,
        "primitive_calls": 29,
        "total_time": 0.005117006,
        "cumulative_time": 0.005117006,
        "time_percent": 0.24902000995778123,
        "time_per_call": 0.0001764484827586207
      },
      {
        "rank": 11,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 897,
        "function_name": "_expand_node_batch",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 0.004677342,
        "cumulative_time": 0.041584598,
        "time_percent": 2.0237218811254722,
        "time_per_call": 0.0041584598
      },
      {
        "rank": 12,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 920,
        "function_name": "batch_get_children",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.004479305,
        "cumulative_time": 0.005010464,
        "time_percent": 0.24383512451873307,
        "time_per_call": 0.00017894514285714285
      },
      {
        "rank": 13,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 208,
        "function_name": "batch_ucb_selection",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.004005677,
        "cumulative_time": 0.13240000200000002,
        "time_percent": 6.443269719920252,
        "time_per_call": 0.004728571500000001
      },
      {
        "rank": 14,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 141,
        "primitive_calls": 141,
        "total_time": 0.0022372200000000003,
        "cumulative_time": 0.0253798,
        "time_percent": 1.2351124952221075,
        "time_per_call": 0.0001799985815602837
      },
      {
        "rank": 15,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 216,
        "primitive_calls": 216,
        "total_time": 0.002105909,
        "cumulative_time": 0.002105909,
        "time_percent": 0.10248443721781468,
        "time_per_call": 9.749578703703704e-06
      },
      {
        "rank": 16,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1029,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.002099979,
        "cumulative_time": 0.008981767,
        "time_percent": 0.4370992935670723,
        "time_per_call": 0.0009979741111111112
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 24963,
        "primitive_calls": 24963,
        "total_time": 0.002024994,
        "cumulative_time": 0.002024994,
        "time_percent": 0.09854669430609368,
        "time_per_call": 8.111981732964788e-08
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 124,
        "primitive_calls": 124,
        "total_time": 0.001959503,
        "cumulative_time": 0.001959503,
        "time_percent": 0.09535956310629734,
        "time_per_call": 1.5802443548387098e-05
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 141,
        "primitive_calls": 141,
        "total_time": 0.0017444270000000002,
        "cumulative_time": 0.0017444270000000002,
        "time_percent": 0.08489285119279172,
        "time_per_call": 1.2371822695035462e-05
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 17298,
        "primitive_calls": 17298,
        "total_time": 0.0017256110000000002,
        "cumulative_time": 0.0017256110000000002,
        "time_percent": 0.083977167195672,
        "time_per_call": 9.97578332755232e-08
      },
      {
        "rank": 21,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 318,
        "function_name": "apply_moves",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.001646677,
        "cumulative_time": 0.002360628,
        "time_percent": 0.11488038279935907,
        "time_per_call": 0.000262292
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 184,
        "primitive_calls": 184,
        "total_time": 0.001588598,
        "cumulative_time": 0.0016106590000000002,
        "time_percent": 0.07838300760612553,
        "time_per_call": 8.75358152173913e-06
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 141,
        "primitive_calls": 141,
        "total_time": 0.0015284150000000002,
        "cumulative_time": 0.0015284150000000002,
        "time_percent": 0.07438058867228653,
        "time_per_call": 1.0839822695035463e-05
      },
      {
        "rank": 24,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1124,
        "function_name": "__format__",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.001379585,
        "cumulative_time": 0.110353083,
        "time_percent": 5.370352473210282,
        "time_per_call": 0.003941181535714286
      },
      {
        "rank": 25,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 873,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0013670800000000001,
        "cumulative_time": 0.048165763,
        "time_percent": 2.3439954500510902,
        "time_per_call": 0.005351751444444445
      },
      {
        "rank": 26,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 124,
        "primitive_calls": 124,
        "total_time": 0.001365962,
        "cumulative_time": 0.0013830440000000002,
        "time_percent": 0.06730608302043219,
        "time_per_call": 1.1153580645161292e-05
      },
      {
        "rank": 27,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1239,
        "function_name": "apply_virtual_loss",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.0013157280000000002,
        "cumulative_time": 0.0013157280000000002,
        "time_percent": 0.06403013787002236,
        "time_per_call": 4.699028571428572e-05
      },
      {
        "rank": 28,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1014,
        "function_name": "_clone_states_batch",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0011425340000000002,
        "cumulative_time": 0.0011425340000000002,
        "time_percent": 0.05560162095903417,
        "time_per_call": 0.00012694822222222225
      },
      {
        "rank": 29,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.0010191830000000001,
        "cumulative_time": 0.0016538520000000001,
        "time_percent": 0.08048500265754943,
        "time_per_call": 7.190660869565218e-05
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.topk>",
        "total_calls": 61,
        "primitive_calls": 61,
        "total_time": 0.00101183,
        "cumulative_time": 0.00101183,
        "time_percent": 0.0492408874790418,
        "time_per_call": 1.658737704918033e-05
      },
      {
        "rank": 31,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1351,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.000930268,
        "cumulative_time": 0.006167586,
        "time_percent": 0.30014667310053417,
        "time_per_call": 0.0006852873333333333
      },
      {
        "rank": 32,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 614,
        "primitive_calls": 614,
        "total_time": 0.0009165690000000001,
        "cumulative_time": 0.00179104,
        "time_percent": 0.0871612811544064,
        "time_per_call": 2.91700325732899e-06
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'long' of 'torch._C.TensorBase' objects>",
        "total_calls": 164,
        "primitive_calls": 164,
        "total_time": 0.0009042490000000001,
        "cumulative_time": 0.0009042490000000001,
        "time_percent": 0.044005438919617,
        "time_per_call": 5.513713414634147e-06
      },
      {
        "rank": 34,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 814,
        "function_name": "get_children",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.0009037940000000001,
        "cumulative_time": 0.00095872,
        "time_percent": 0.04665627985324309,
        "time_per_call": 8.715636363636365e-05
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method mcts_cuda_kernels.batched_ucb_selection_quantum>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.000872886,
        "cumulative_time": 0.000872886,
        "time_percent": 0.0424791529288822,
        "time_per_call": 3.11745e-05
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 6203,
        "primitive_calls": 6203,
        "total_time": 0.0008440240000000001,
        "cumulative_time": 0.0026350640000000003,
        "time_percent": 0.1282358597037781,
        "time_per_call": 4.2480477188457206e-07
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 102,
        "primitive_calls": 102,
        "total_time": 0.0007941280000000001,
        "cumulative_time": 0.0007941280000000001,
        "time_percent": 0.038646380807009585,
        "time_per_call": 7.785568627450982e-06
      },
      {
        "rank": 38,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1344,
        "function_name": "set_expanded",
        "total_calls": 61,
        "primitive_calls": 61,
        "total_time": 0.000768708,
        "cumulative_time": 0.000768708,
        "time_percent": 0.03740931197161505,
        "time_per_call": 1.2601770491803279e-05
      },
      {
        "rank": 39,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 36,
        "primitive_calls": 36,
        "total_time": 0.0007059740000000001,
        "cumulative_time": 0.255447931,
        "time_percent": 12.431419138714046,
        "time_per_call": 0.007095775861111112
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 134,
        "primitive_calls": 134,
        "total_time": 0.000636261,
        "cumulative_time": 0.000636261,
        "time_percent": 0.030963755085639498,
        "time_per_call": 4.748216417910448e-06
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 69,
        "primitive_calls": 69,
        "total_time": 0.000636195,
        "cumulative_time": 0.0007096310000000001,
        "time_percent": 0.03453431922619404,
        "time_per_call": 1.0284507246376813e-05
      },
      {
        "rank": 42,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 46,
        "primitive_calls": 46,
        "total_time": 0.0006308440000000001,
        "cumulative_time": 0.005924835000000001,
        "time_percent": 0.2883331523743007,
        "time_per_call": 0.00012880076086956523
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 5500,
        "primitive_calls": 5500,
        "total_time": 0.0006166020000000001,
        "cumulative_time": 0.0006166020000000001,
        "time_percent": 0.030007046343113103,
        "time_per_call": 1.1210945454545455e-07
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 63,
        "primitive_calls": 63,
        "total_time": 0.000603166,
        "cumulative_time": 0.000603166,
        "time_percent": 0.029353181005884115,
        "time_per_call": 9.574063492063493e-06
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._get_tracing_state>",
        "total_calls": 654,
        "primitive_calls": 654,
        "total_time": 0.000595439,
        "cumulative_time": 0.000595439,
        "time_percent": 0.028977145172245505,
        "time_per_call": 9.104571865443426e-07
      },
      {
        "rank": 46,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1244,
        "function_name": "remove_virtual_loss",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.000594971,
        "cumulative_time": 0.0007234850000000001,
        "time_percent": 0.035208526608001896,
        "time_per_call": 8.038722222222223e-05
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 56,
        "primitive_calls": 56,
        "total_time": 0.0005673200000000001,
        "cumulative_time": 0.0005673200000000001,
        "time_percent": 0.027608729020299847,
        "time_per_call": 1.0130714285714287e-05
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros>",
        "total_calls": 57,
        "primitive_calls": 57,
        "total_time": 0.000567021,
        "cumulative_time": 0.000567021,
        "time_percent": 0.02759417813195276,
        "time_per_call": 9.947736842105263e-06
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 109,
        "primitive_calls": 109,
        "total_time": 0.00045239900000000003,
        "cumulative_time": 0.00045239900000000003,
        "time_percent": 0.02201607805128434,
        "time_per_call": 4.150449541284404e-06
      },
      {
        "rank": 50,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1001,
        "function_name": "_allocate_states",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 0.00043268900000000004,
        "cumulative_time": 0.0009501310000000001,
        "time_percent": 0.046238294635807864,
        "time_per_call": 9.501310000000001e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": null,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": false,
      "quantum_config": null,
      "quantum_version": "v2",
      "quantum_branching_factor": null,
      "quantum_avg_game_length": null,
      "enable_phase_adaptation": true,
      "envariance_threshold": 0.001,
      "envariance_check_interval": 1000,
      "enable_virtual_loss": true,
      "virtual_loss": 1.0,
      "virtual_loss_value": -1.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "compile_mode": "reduce-overhead",
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "target_sims_per_second": 100000,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "tree_batch_size": 1024,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "classical",
    "num_simulations": 50000,
    "wave_size": 3072,
    "total_time_ms": 112.89695696905255,
    "simulations_per_second": 442881.733417368,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 2.6804800033569336,
        "cpu_time_ms": 2.7409869944676757,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.20508800446987152,
        "cpu_time_ms": 0.25262602139264345,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.3750720024108887,
        "cpu_time_ms": 1.4209580840542912,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7301120162010193,
        "cpu_time_ms": 0.7765740156173706,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 3.747328042984009,
        "cpu_time_ms": 3.801305079832673,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.1966720074415207,
        "cpu_time_ms": 0.2427869476377964,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1059839725494385,
        "cpu_time_ms": 1.1623708996921778,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7273280024528503,
        "cpu_time_ms": 0.7721560541540384,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 2.4521920680999756,
        "cpu_time_ms": 2.4978070287033916,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.18806399405002594,
        "cpu_time_ms": 0.23228803183883429,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0268160104751587,
        "cpu_time_ms": 1.0706379543989897,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7212160229682922,
        "cpu_time_ms": 0.7676869863644242,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 3.1283841133117676,
        "cpu_time_ms": 3.17414291203022,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.18598400056362152,
        "cpu_time_ms": 0.23017404600977898,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0224640369415283,
        "cpu_time_ms": 1.0660189436748624,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7024639844894409,
        "cpu_time_ms": 0.7475180318579078,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 2.4655680656433105,
        "cpu_time_ms": 2.510011079721153,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.1844480037689209,
        "cpu_time_ms": 0.23083493579179049,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.074336051940918,
        "cpu_time_ms": 1.1726799421012402,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.236799955368042,
        "cpu_time_ms": 1.2847319012507796,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 2.4390079975128174,
        "cpu_time_ms": 2.493700012564659,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.19043199717998505,
        "cpu_time_ms": 0.23433100432157516,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0158720016479492,
        "cpu_time_ms": 1.0584950214251876,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7239680290222168,
        "cpu_time_ms": 0.7681879214942455,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 2.442784070968628,
        "cpu_time_ms": 2.488230005837977,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.18352000415325165,
        "cpu_time_ms": 0.22835098206996918,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.8153280019760132,
        "cpu_time_ms": 1.8618289614096284,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7434239983558655,
        "cpu_time_ms": 0.7886970415711403,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 2.4556479454040527,
        "cpu_time_ms": 2.501603914424777,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.18505600094795227,
        "cpu_time_ms": 0.2288010437041521,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.021567940711975,
        "cpu_time_ms": 1.0722910519689322,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7637119889259338,
        "cpu_time_ms": 0.8084439905360341,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 3.0737600326538086,
        "cpu_time_ms": 3.119278931990266,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.19487999379634857,
        "cpu_time_ms": 0.23980194237083197,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0326720476150513,
        "cpu_time_ms": 1.077061053365469,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7024639844894409,
        "cpu_time_ms": 0.9500399464741349,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 2.432512044906616,
        "cpu_time_ms": 2.4783009430393577,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.1894720047712326,
        "cpu_time_ms": 0.23579399567097425,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0255359411239624,
        "cpu_time_ms": 1.070027006790042,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7034879922866821,
        "cpu_time_ms": 0.7564659463241696,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 3.137216091156006,
        "cpu_time_ms": 3.18602507468313,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.18409599363803864,
        "cpu_time_ms": 0.22895203437656164,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0194560289382935,
        "cpu_time_ms": 1.0653979843482375,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7161279916763306,
        "cpu_time_ms": 0.7619460811838508,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 2.456671953201294,
        "cpu_time_ms": 2.5128358975052834,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.18646399676799774,
        "cpu_time_ms": 0.230104080401361,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.6858240365982056,
        "cpu_time_ms": 1.728528062812984,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7147520184516907,
        "cpu_time_ms": 0.7595909992232919,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 2.4603519439697266,
        "cpu_time_ms": 2.505352022126317,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.1844799965620041,
        "cpu_time_ms": 0.23273902479559183,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0181759595870972,
        "cpu_time_ms": 1.0621919063851237,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7014399766921997,
        "cpu_time_ms": 0.7457260508090258,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 2.4326400756835938,
        "cpu_time_ms": 2.48096592258662,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.0710400342941284,
        "cpu_time_ms": 1.1195699917152524,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0355520248413086,
        "cpu_time_ms": 1.0796550195664167,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7103679776191711,
        "cpu_time_ms": 0.754181994125247,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 2.5009279251098633,
        "cpu_time_ms": 2.5469609536230564,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.19862399995326996,
        "cpu_time_ms": 0.24305807892233133,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0336320400238037,
        "cpu_time_ms": 1.077731023542583,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7373440265655518,
        "cpu_time_ms": 0.7811930263414979,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 3.474368095397949,
        "cpu_time_ms": 3.523580962792039,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.18758399784564972,
        "cpu_time_ms": 0.23492297623306513,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0303360223770142,
        "cpu_time_ms": 1.0742949089035392,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7157760262489319,
        "cpu_time_ms": 0.7685680175200105,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 2.415008068084717,
        "cpu_time_ms": 2.461710013449192,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.1870719939470291,
        "cpu_time_ms": 0.23348000831902027,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.022655963897705,
        "cpu_time_ms": 1.066640019416809,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.3247359991073608,
        "cpu_time_ms": 1.3838880695402622,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      }
    ],
    "peak_gpu_memory_mb": 2874.03271484375,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 183.7,
    "avg_ram_usage_mb": 1337.97265625,
    "final_tree_nodes": 17,
    "final_tree_edges": 16,
    "tree_memory_mb": 47.73538589477539,
    "efficiency_score": 157796.0100026351,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 794,
    "total_kernel_calls": 1086,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         116153 function calls (89565 primitive calls) in 0.111 seconds\n\n   Ordered by: cumulative time\n   List reduced from 201 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    0.111    0.111 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:421(search)\n       68    0.001    0.000    0.110    0.002 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:394(_profile_phase)\n       17    0.000    0.000    0.110    0.006 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:637(_run_search_wave_vectorized)\n        1    0.000    0.000    0.104    0.104 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:461(_search_optimized)\n       17    0.000    0.000    0.053    0.003 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:369(instrumented_select)\n       17    0.010    0.001    0.041    0.002 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:661(_select_batch_vectorized)\n      166    0.002    0.000    0.027    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       17    0.000    0.000    0.025    0.001 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:375(instrumented_evaluate)\n      146    0.001    0.000    0.024    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       17    0.000    0.000    0.022    0.001 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:378(instrumented_backup)\n26726/166    0.015    0.000    0.019    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       17    0.004    0.000    0.018    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1029(_evaluate_batch_vectorized)\n       17    0.007    0.000    0.012    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1098(_backup_batch_vectorized)\n       17    0.008    0.000    0.012    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:391(get_nn_features)\n       17    0.000    0.000    0.011    0.001 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:372(instrumented_expand)\n       34    0.008    0.000    0.010    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1162(batch_action_to_child)\n       34    0.000    0.000    0.009    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:964(batch_select_ucb_optimized)\n       34    0.004    0.000    0.008    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:208(batch_ucb_selection)\n       34    0.007    0.000    0.007    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:920(batch_get_children)\n      519    0.001    0.000    0.005    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n      138    0.000    0.000    0.005    0.000 {built-in method builtins.next}\n      138    0.000    0.000    0.005    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:196(timer)\n      479    0.000    0.000    0.004    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n      205    0.000    0.000    0.004    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n      479    0.000    0.000    0.003    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n       20    0.000    0.000    0.003    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n      153    0.003    0.000    0.003    0.000 {built-in method torch.where}\n      479    0.000    0.000    0.003    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n      166    0.000    0.000    0.003    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n       69    0.000    0.000    0.003    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       69    0.000    0.000    0.003    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:178(end_timer)\n      138    0.000    0.000    0.003    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n      205    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:490(__init__)\n       17    0.002    0.000    0.002    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:873(_expand_batch_vectorized)\n    30768    0.002    0.000    0.002    0.000 {built-in method builtins.isinstance}\n      479    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:753(_get_available_device_type)\n      496    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:161(is_available)\n      138    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1056(current_stream)\n    30/20    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py:1642(wrapper)\n      166    0.002    0.000    0.002    0.000 {method 'sort' of 'list' objects}\n       69    0.000    0.000    0.002    0.000 /usr/lib/python3.12/contextlib.py:132(__enter__)\n    20399    0.002    0.000    0.002    0.000 {method 'append' of 'list' objects}\n       10    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py:1009(cpu_percent)\n      221    0.002    0.000    0.002    0.000 {method 'any' of 'torch._C.TensorBase' objects}\n       20    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_common.py:452(wrapper)\n     6870    0.001    0.000    0.002    0.000 {built-in method builtins.len}\n       19    0.002    0.000    0.002    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:814(get_children)\n       69    0.000    0.000    0.002    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:169(start_timer)\n      166    0.002    0.000    0.002    0.000 {built-in method torch._C._cuda_memoryStats}\n      496    0.000    0.000    0.002    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:157(_nvml_based_avail)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 166,
        "primitive_calls": 26726,
        "total_time": 0.014657273,
        "cumulative_time": 0.019436155,
        "time_percent": 2.2675022519270063,
        "time_per_call": 0.00011708527108433735
      },
      {
        "rank": 2,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 661,
        "function_name": "_select_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.009746907,
        "cumulative_time": 0.041225611,
        "time_percent": 4.809550334393133,
        "time_per_call": 0.002425035941176471
      },
      {
        "rank": 3,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 391,
        "function_name": "get_nn_features",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.007968017,
        "cumulative_time": 0.011874459,
        "time_percent": 1.3853235129538177,
        "time_per_call": 0.0006984975882352941
      },
      {
        "rank": 4,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1162,
        "function_name": "batch_action_to_child",
        "total_calls": 34,
        "primitive_calls": 34,
        "total_time": 0.007967921000000001,
        "cumulative_time": 0.010270819,
        "time_percent": 1.1982362361091834,
        "time_per_call": 0.0003020829117647059
      },
      {
        "rank": 5,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1098,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.006998726,
        "cumulative_time": 0.01227712,
        "time_percent": 1.4322996110690664,
        "time_per_call": 0.0007221835294117648
      },
      {
        "rank": 6,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 920,
        "function_name": "batch_get_children",
        "total_calls": 34,
        "primitive_calls": 34,
        "total_time": 0.0066534,
        "cumulative_time": 0.007257741000000001,
        "time_percent": 0.8467180911761077,
        "time_per_call": 0.0002134629705882353
      },
      {
        "rank": 7,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 208,
        "function_name": "batch_ucb_selection",
        "total_calls": 34,
        "primitive_calls": 34,
        "total_time": 0.004365192,
        "cumulative_time": 0.008132881,
        "time_percent": 0.9488155441317669,
        "time_per_call": 0.00023920238235294118
      },
      {
        "rank": 8,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1029,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.0037857570000000003,
        "cumulative_time": 0.017639438,
        "time_percent": 2.0578898134804344,
        "time_per_call": 0.001037614
      },
      {
        "rank": 9,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 153,
        "primitive_calls": 153,
        "total_time": 0.003383674,
        "cumulative_time": 0.0033913280000000003,
        "time_percent": 0.3956463547971865,
        "time_per_call": 2.2165542483660134e-05
      },
      {
        "rank": 10,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 166,
        "primitive_calls": 166,
        "total_time": 0.0023879,
        "cumulative_time": 0.026752837,
        "time_percent": 3.121096644008866,
        "time_per_call": 0.0001611616686746988
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 30768,
        "primitive_calls": 30768,
        "total_time": 0.002226646,
        "cumulative_time": 0.002226646,
        "time_percent": 0.2597697342526987,
        "time_per_call": 7.236888975559022e-08
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 166,
        "primitive_calls": 166,
        "total_time": 0.001906003,
        "cumulative_time": 0.001906003,
        "time_percent": 0.2223621953354267,
        "time_per_call": 1.148194578313253e-05
      },
      {
        "rank": 13,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 20399,
        "primitive_calls": 20399,
        "total_time": 0.001871281,
        "cumulative_time": 0.001871281,
        "time_percent": 0.2183113831664864,
        "time_per_call": 9.173395754693858e-08
      },
      {
        "rank": 14,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 221,
        "primitive_calls": 221,
        "total_time": 0.0018407050000000002,
        "cumulative_time": 0.0018407050000000002,
        "time_percent": 0.21474426051002887,
        "time_per_call": 8.32898190045249e-06
      },
      {
        "rank": 15,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 873,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.001638067,
        "cumulative_time": 0.002298774,
        "time_percent": 0.26818448513459847,
        "time_per_call": 0.000135222
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 166,
        "primitive_calls": 166,
        "total_time": 0.001602134,
        "cumulative_time": 0.001602134,
        "time_percent": 0.18691158065413774,
        "time_per_call": 9.651409638554217e-06
      },
      {
        "rank": 17,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 814,
        "function_name": "get_children",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.0015316750000000001,
        "cumulative_time": 0.0016307630000000001,
        "time_percent": 0.1902515582356305,
        "time_per_call": 8.582963157894738e-05
      },
      {
        "rank": 18,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1239,
        "function_name": "apply_virtual_loss",
        "total_calls": 34,
        "primitive_calls": 34,
        "total_time": 0.001443183,
        "cumulative_time": 0.001443183,
        "time_percent": 0.16836769939541912,
        "time_per_call": 4.244655882352941e-05
      },
      {
        "rank": 19,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 68,
        "primitive_calls": 68,
        "total_time": 0.0014425030000000001,
        "cumulative_time": 0.11027698600000001,
        "time_percent": 12.865369415438547,
        "time_per_call": 0.0016217203823529413
      },
      {
        "rank": 20,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1244,
        "function_name": "remove_virtual_loss",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.0010770950000000001,
        "cumulative_time": 0.0013074360000000001,
        "time_percent": 0.15253089277433926,
        "time_per_call": 7.6908e-05
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'long' of 'torch._C.TensorBase' objects>",
        "total_calls": 153,
        "primitive_calls": 153,
        "total_time": 0.0008388460000000001,
        "cumulative_time": 0.0008388460000000001,
        "time_percent": 0.09786324476317265,
        "time_per_call": 5.482653594771242e-06
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0008109920000000001,
        "cumulative_time": 0.0010249010000000002,
        "time_percent": 0.11956919079428215,
        "time_per_call": 0.00011387788888888891
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 102,
        "primitive_calls": 102,
        "total_time": 0.000736461,
        "cumulative_time": 0.000736461,
        "time_percent": 0.08591858708455531,
        "time_per_call": 7.220205882352941e-06
      },
      {
        "rank": 24,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 85,
        "primitive_calls": 85,
        "total_time": 0.0007013480000000001,
        "cumulative_time": 0.0007013480000000001,
        "time_percent": 0.08182215923800269,
        "time_per_call": 8.251152941176472e-06
      },
      {
        "rank": 25,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 6870,
        "primitive_calls": 6870,
        "total_time": 0.0006896280000000001,
        "cumulative_time": 0.0018064440000000001,
        "time_percent": 0.21074723050829905,
        "time_per_call": 2.629467248908297e-07
      },
      {
        "rank": 26,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 6475,
        "primitive_calls": 6475,
        "total_time": 0.0006522020000000001,
        "cumulative_time": 0.0006522020000000001,
        "time_percent": 0.07608858355530183,
        "time_per_call": 1.0072617760617761e-07
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros>",
        "total_calls": 51,
        "primitive_calls": 51,
        "total_time": 0.000645301,
        "cumulative_time": 0.000645301,
        "time_percent": 0.07528348434506461,
        "time_per_call": 1.2652960784313726e-05
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 68,
        "primitive_calls": 68,
        "total_time": 0.0006290870000000001,
        "cumulative_time": 0.0006290870000000001,
        "time_percent": 0.07339189202586648,
        "time_per_call": 9.251279411764706e-06
      },
      {
        "rank": 29,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 519,
        "primitive_calls": 519,
        "total_time": 0.000602551,
        "cumulative_time": 0.004881435,
        "time_percent": 0.5694884021626349,
        "time_per_call": 9.405462427745664e-06
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x746c91bdbba0>",
        "total_calls": 138,
        "primitive_calls": 138,
        "total_time": 0.000592727,
        "cumulative_time": 0.000592727,
        "time_percent": 0.06914998400033025,
        "time_per_call": 4.295123188405797e-06
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.000589641,
        "cumulative_time": 0.000589641,
        "time_percent": 0.0687899584731904,
        "time_per_call": 3.468476470588235e-05
      },
      {
        "rank": 32,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 362,
        "primitive_calls": 362,
        "total_time": 0.00056371,
        "cumulative_time": 0.001116816,
        "time_percent": 0.1302923749572954,
        "time_per_call": 3.0851270718232046e-06
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 138,
        "primitive_calls": 138,
        "total_time": 0.000557458,
        "cumulative_time": 0.000557458,
        "time_percent": 0.06503535654838753,
        "time_per_call": 4.039550724637682e-06
      },
      {
        "rank": 34,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 496,
        "primitive_calls": 496,
        "total_time": 0.000523759,
        "cumulative_time": 0.000886279,
        "time_percent": 0.10339697477899384,
        "time_per_call": 1.7868528225806453e-06
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 68,
        "primitive_calls": 68,
        "total_time": 0.000503817,
        "cumulative_time": 0.000503817,
        "time_percent": 0.05877737556935045,
        "time_per_call": 7.4090735294117655e-06
      },
      {
        "rank": 36,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 146,
        "primitive_calls": 146,
        "total_time": 0.000502491,
        "cumulative_time": 0.023946468000000002,
        "time_percent": 2.793694026194893,
        "time_per_call": 0.00016401690410958904
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method mcts_cuda_kernels.batched_ucb_selection>",
        "total_calls": 34,
        "primitive_calls": 34,
        "total_time": 0.000492462,
        "cumulative_time": 0.000492462,
        "time_percent": 0.05745265429239876,
        "time_per_call": 1.4484176470588236e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 51,
        "primitive_calls": 51,
        "total_time": 0.00046595500000000005,
        "cumulative_time": 0.00046595500000000005,
        "time_percent": 0.05436023800986607,
        "time_per_call": 9.136372549019609e-06
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'scatter_add_' of 'torch._C.TensorBase' objects>",
        "total_calls": 68,
        "primitive_calls": 68,
        "total_time": 0.000460988,
        "cumulative_time": 0.000460988,
        "time_percent": 0.0537807672408111,
        "time_per_call": 6.7792352941176475e-06
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.ones_like>",
        "total_calls": 68,
        "primitive_calls": 68,
        "total_time": 0.000450304,
        "cumulative_time": 0.000450304,
        "time_percent": 0.052534327599864206,
        "time_per_call": 6.622117647058824e-06
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 85,
        "primitive_calls": 85,
        "total_time": 0.000430108,
        "cumulative_time": 0.000430108,
        "time_percent": 0.05017817868667033,
        "time_per_call": 5.060094117647059e-06
      },
      {
        "rank": 42,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 812,
        "function_name": "_get_device_index",
        "total_calls": 479,
        "primitive_calls": 479,
        "total_time": 0.00042439800000000004,
        "cumulative_time": 0.00404963,
        "time_percent": 0.47244658958889574,
        "time_per_call": 8.454342379958246e-06
      },
      {
        "rank": 43,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 205,
        "primitive_calls": 205,
        "total_time": 0.00041127400000000005,
        "cumulative_time": 0.0035228700000000004,
        "time_percent": 0.4109925887216938,
        "time_per_call": 1.7184731707317075e-05
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 205,
        "primitive_calls": 205,
        "total_time": 0.000392011,
        "cumulative_time": 0.000392011,
        "time_percent": 0.045733625054963686,
        "time_per_call": 1.912248780487805e-06
      },
      {
        "rank": 45,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 770,
        "function_name": "_get_device_attr",
        "total_calls": 479,
        "primitive_calls": 479,
        "total_time": 0.00036822300000000004,
        "cumulative_time": 0.0032760550000000004,
        "time_percent": 0.38219812971941874,
        "time_per_call": 6.83936325678497e-06
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._get_tracing_state>",
        "total_calls": 362,
        "primitive_calls": 362,
        "total_time": 0.000354395,
        "cumulative_time": 0.000354395,
        "time_percent": 0.04134518687320982,
        "time_per_call": 9.789917127071824e-07
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 30,
        "primitive_calls": 30,
        "total_time": 0.00034787500000000004,
        "cumulative_time": 0.000369065,
        "time_percent": 0.04305664976470092,
        "time_per_call": 1.2302166666666667e-05
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.maximum>",
        "total_calls": 51,
        "primitive_calls": 51,
        "total_time": 0.00032760600000000003,
        "cumulative_time": 0.00032760600000000003,
        "time_percent": 0.03821987130401043,
        "time_per_call": 6.42364705882353e-06
      },
      {
        "rank": 49,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 0.00031331400000000003,
        "cumulative_time": 0.000832239,
        "time_percent": 0.0970924448092475,
        "time_per_call": 8.322390000000001e-05
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method __new__ of type object at 0xa44b40>",
        "total_calls": 357,
        "primitive_calls": 357,
        "total_time": 0.00030033100000000004,
        "cumulative_time": 0.00030033100000000004,
        "time_percent": 0.03503785696417269,
        "time_per_call": 8.412633053221289e-07
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": null,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": true,
      "quantum_config": "QuantumConfig(quantum_level='tree_level', min_wave_size=3072, optimal_wave_size=3072, hbar_eff=0.1, temperature=1.0, coupling_strength=0.1, decoherence_rate=0.01, measurement_noise=0.0, path_integral_steps=10, path_integral_beta=1.0, use_wick_rotation=True, interference_alpha=0.05, interference_method='minhash', minhash_size=64, phase_kick_strength=0.1, use_mixed_precision=True, cache_corrections=True, fast_mode=True, enable_quantum=True, uncertainty_decay=0.99, phase_temperature=1.0, device='cuda')",
      "quantum_version": "v2",
      "quantum_branching_factor": null,
      "quantum_avg_game_length": null,
      "enable_phase_adaptation": true,
      "envariance_threshold": 0.001,
      "envariance_check_interval": 1000,
      "enable_virtual_loss": true,
      "virtual_loss": 1.0,
      "virtual_loss_value": -1.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "compile_mode": "reduce-overhead",
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "target_sims_per_second": 100000,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "tree_batch_size": 1024,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "tree_level",
    "num_simulations": 50000,
    "wave_size": 3072,
    "total_time_ms": 581.5999910701066,
    "simulations_per_second": 85969.73997197492,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 19.666976928710938,
        "cpu_time_ms": 19.733704044483602,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 2.5387840270996094,
        "cpu_time_ms": 2.5887800147756934,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0813440084457397,
        "cpu_time_ms": 1.1373229790478945,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7557439804077148,
        "cpu_time_ms": 0.8041450055316091,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 16.7455997467041,
        "cpu_time_ms": 16.793621936812997,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 2.823744058609009,
        "cpu_time_ms": 2.8706700541079044,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0474239587783813,
        "cpu_time_ms": 1.0931299766525626,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7219520211219788,
        "cpu_time_ms": 0.7684680167585611,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 16.367839813232422,
        "cpu_time_ms": 16.415189020335674,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 2.797919988632202,
        "cpu_time_ms": 2.846183953806758,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1127040386199951,
        "cpu_time_ms": 1.1590640060603619,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7280640006065369,
        "cpu_time_ms": 0.7734870305284858,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 18.341087341308594,
        "cpu_time_ms": 18.38916994165629,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 3.774399995803833,
        "cpu_time_ms": 3.822104074060917,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.6435199975967407,
        "cpu_time_ms": 1.694674021564424,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.936959981918335,
        "cpu_time_ms": 0.9845659369602799,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 17.57708740234375,
        "cpu_time_ms": 17.625799984671175,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 5.76643180847168,
        "cpu_time_ms": 5.813437048345804,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0444799661636353,
        "cpu_time_ms": 1.0902349604293704,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.8581119775772095,
        "cpu_time_ms": 0.9060370502993464,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 18.62860870361328,
        "cpu_time_ms": 18.6784949619323,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 6.618879795074463,
        "cpu_time_ms": 6.665833061560988,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0475519895553589,
        "cpu_time_ms": 1.0935809696093202,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.0191999673843384,
        "cpu_time_ms": 1.0737739503383636,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.6615047454834,
        "cpu_time_ms": 19.70879698637873,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 6.378943920135498,
        "cpu_time_ms": 6.427053944207728,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.738495945930481,
        "cpu_time_ms": 1.784863998182118,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.011680006980896,
        "cpu_time_ms": 1.0576930362731218,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 20.213855743408203,
        "cpu_time_ms": 20.261578960344195,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 6.512479782104492,
        "cpu_time_ms": 6.562588969245553,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0708800554275513,
        "cpu_time_ms": 1.117776962928474,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.667072057723999,
        "cpu_time_ms": 1.718398998491466,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 18.609119415283203,
        "cpu_time_ms": 18.659058026969433,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 9.290656089782715,
        "cpu_time_ms": 9.339662967249751,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0474560260772705,
        "cpu_time_ms": 1.0935110040009022,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.632256031036377,
        "cpu_time_ms": 1.8851630156859756,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 18.609119415283203,
        "cpu_time_ms": 18.658287008292973,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 9.281408309936523,
        "cpu_time_ms": 9.328132029622793,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0526080131530762,
        "cpu_time_ms": 1.0998930083587766,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.705888032913208,
        "cpu_time_ms": 1.7488659359514713,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.264575958251953,
        "cpu_time_ms": 19.320856081321836,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 9.3307523727417,
        "cpu_time_ms": 9.38499893527478,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1080000400543213,
        "cpu_time_ms": 1.156909973360598,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6924159526824951,
        "cpu_time_ms": 1.74040999263525,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 18.696895599365234,
        "cpu_time_ms": 18.747776048257947,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 14.878751754760742,
        "cpu_time_ms": 14.92880703881383,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.02947199344635,
        "cpu_time_ms": 1.0751370573416352,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.9985600113868713,
        "cpu_time_ms": 1.0441079502925277,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 20.57916831970215,
        "cpu_time_ms": 20.627238089218736,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 14.233759880065918,
        "cpu_time_ms": 14.282759046182036,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 2.564095973968506,
        "cpu_time_ms": 2.613476011902094,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4108799695968628,
        "cpu_time_ms": 1.464981003664434,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 20.439136505126953,
        "cpu_time_ms": 20.505369058810174,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 19.728736877441406,
        "cpu_time_ms": 19.776144064962864,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.052672028541565,
        "cpu_time_ms": 1.0985611006617546,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.1335680484771729,
        "cpu_time_ms": 1.1782399378716946,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 20.462976455688477,
        "cpu_time_ms": 20.509926951490343,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 19.97590446472168,
        "cpu_time_ms": 20.02373104915023,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1045119762420654,
        "cpu_time_ms": 1.1513199424371123,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.1375360488891602,
        "cpu_time_ms": 1.1825980618596077,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 22.2109432220459,
        "cpu_time_ms": 22.259233985096216,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 21.23868751525879,
        "cpu_time_ms": 21.285498049110174,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0741759538650513,
        "cpu_time_ms": 1.1191890807822347,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.32915198802948,
        "cpu_time_ms": 1.3763249153271317,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 20.97475242614746,
        "cpu_time_ms": 21.02388604544103,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "expansion",
        "gpu_time_ms": 25.016159057617188,
        "cpu_time_ms": 25.062967906706035,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.045248031616211,
        "cpu_time_ms": 1.0914569720625877,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.2963839769363403,
        "cpu_time_ms": 1.3429009122774005,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      }
    ],
    "peak_gpu_memory_mb": 4236.19580078125,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 185.9,
    "avg_ram_usage_mb": 1337.97265625,
    "final_tree_nodes": 2441,
    "final_tree_edges": 2440,
    "tree_memory_mb": 47.73538589477539,
    "efficiency_score": 20781.14843394799,
    "bottleneck_phase": "selection",
    "recommendations": [
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Consider using classical selection for hot paths",
      "Tree-level quantum may be excessive - consider one-loop for balance"
    ],
    "quantum_kernel_calls": 867,
    "total_kernel_calls": 1227,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         210686 function calls (163416 primitive calls) in 0.579 seconds\n\n   Ordered by: cumulative time\n   List reduced from 233 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.577    0.577 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:461(_search_optimized)\n       17    0.000    0.000    0.577    0.034 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:637(_run_search_wave_vectorized)\n       68    0.001    0.000    0.577    0.008 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:394(_profile_phase)\n       17    0.000    0.000    0.335    0.020 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:369(instrumented_select)\n       17    0.020    0.001    0.272    0.016 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:661(_select_batch_vectorized)\n       67    0.001    0.000    0.253    0.004 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:964(batch_select_ucb_optimized)\n       67    0.009    0.000    0.249    0.004 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:208(batch_ucb_selection)\n       67    0.001    0.000    0.216    0.003 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py:1124(__format__)\n       17    0.000    0.000    0.187    0.011 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:372(instrumented_expand)\n       17    0.002    0.000    0.177    0.010 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:873(_expand_batch_vectorized)\n       52    0.136    0.003    0.176    0.003 {built-in method time.sleep}\n       18    0.012    0.001    0.123    0.007 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:897(_expand_node_batch)\n      305    0.065    0.000    0.090    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:512(add_children_batch)\n      695    0.087    0.000    0.087    0.000 {method 'item' of 'torch._C.TensorBase' objects}\n      106    0.004    0.000    0.056    0.001 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_common.py:452(wrapper)\n      295    0.005    0.000    0.050    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n47495/295    0.028    0.000    0.037    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n      189    0.001    0.000    0.034    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       17    0.000    0.000    0.028    0.002 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:378(instrumented_backup)\n       53    0.002    0.000    0.027    0.001 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py:1009(cpu_percent)\n       17    0.000    0.000    0.026    0.002 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:375(instrumented_evaluate)\n      914    0.024    0.000    0.024    0.000 {built-in method torch.where}\n       35    0.017    0.000    0.024    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:391(get_nn_features)\n       67    0.016    0.000    0.021    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1162(batch_action_to_child)\n       17    0.004    0.000    0.018    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1029(_evaluate_batch_vectorized)\n      106    0.000    0.000    0.018    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n       17    0.011    0.001    0.018    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1098(_backup_batch_vectorized)\n       67    0.011    0.000    0.012    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:920(batch_get_children)\n      612    0.009    0.000    0.009    0.000 {built-in method torch.tensor}\n      799    0.008    0.000    0.008    0.000 {built-in method torch.arange}\n       17    0.000    0.000    0.008    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1389(ensure_consistent)\n    13900    0.002    0.000    0.008    0.000 {built-in method builtins.len}\n       17    0.001    0.000    0.008    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1351(_rebuild_row_pointers)\n      612    0.007    0.000    0.007    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n       53    0.006    0.000    0.006    0.000 {method 'sum' of 'torch._C.TensorBase' objects}\n     2022    0.003    0.000    0.006    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py:1159(__len__)\n  159/106    0.000    0.000    0.005    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py:1642(wrapper)\n      691    0.001    0.000    0.005    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n      305    0.005    0.000    0.005    0.000 {built-in method torch.topk}\n       53    0.000    0.000    0.005    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py:1964(virtual_memory)\n      138    0.000    0.000    0.005    0.000 {built-in method builtins.next}\n      138    0.000    0.000    0.005    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:196(timer)\n      295    0.000    0.000    0.005    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n      479    0.000    0.000    0.004    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n       17    0.003    0.000    0.004    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:318(apply_moves)\n    51796    0.004    0.000    0.004    0.000 {built-in method builtins.isinstance}\n      205    0.000    0.000    0.004    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n       53    0.002    0.000    0.004    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py:352(virtual_memory)\n      479    0.000    0.000    0.004    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n      295    0.004    0.000    0.004    0.000 {method 'sort' of 'list' objects}\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 52,
        "primitive_calls": 52,
        "total_time": 0.135604694,
        "cumulative_time": 0.17604814100000002,
        "time_percent": 3.876925414408625,
        "time_per_call": 0.0033855411730769236
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 695,
        "primitive_calls": 695,
        "total_time": 0.087137221,
        "cumulative_time": 0.08715257,
        "time_percent": 1.9192705565918282,
        "time_per_call": 0.00012539938129496402
      },
      {
        "rank": 3,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 512,
        "function_name": "add_children_batch",
        "total_calls": 305,
        "primitive_calls": 305,
        "total_time": 0.064586854,
        "cumulative_time": 0.090479419,
        "time_percent": 1.9925342977749851,
        "time_per_call": 0.00029665383278688526
      },
      {
        "rank": 4,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 295,
        "primitive_calls": 47495,
        "total_time": 0.028215451000000003,
        "cumulative_time": 0.037376182,
        "time_percent": 0.823096847636478,
        "time_per_call": 0.0001266989220338983
      },
      {
        "rank": 5,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 914,
        "primitive_calls": 914,
        "total_time": 0.024252181,
        "cumulative_time": 0.024252181,
        "time_percent": 0.5340806005656031,
        "time_per_call": 2.653411487964989e-05
      },
      {
        "rank": 6,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 661,
        "function_name": "_select_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.019970095,
        "cumulative_time": 0.272401976,
        "time_percent": 5.99882587621035,
        "time_per_call": 0.016023645647058823
      },
      {
        "rank": 7,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 391,
        "function_name": "get_nn_features",
        "total_calls": 35,
        "primitive_calls": 35,
        "total_time": 0.01746935,
        "cumulative_time": 0.023981382000000002,
        "time_percent": 0.528117075365434,
        "time_per_call": 0.000685182342857143
      },
      {
        "rank": 8,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1162,
        "function_name": "batch_action_to_child",
        "total_calls": 67,
        "primitive_calls": 67,
        "total_time": 0.016069860000000002,
        "cumulative_time": 0.020711326000000002,
        "time_percent": 0.4561040274517987,
        "time_per_call": 0.0003091242686567164
      },
      {
        "rank": 9,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 897,
        "function_name": "_expand_node_batch",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.012018444000000001,
        "cumulative_time": 0.12345447500000001,
        "time_percent": 2.7187097173038266,
        "time_per_call": 0.006858581944444445
      },
      {
        "rank": 10,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 920,
        "function_name": "batch_get_children",
        "total_calls": 67,
        "primitive_calls": 67,
        "total_time": 0.011228566,
        "cumulative_time": 0.012428507,
        "time_percent": 0.2737001048562932,
        "time_per_call": 0.00018550010447761193
      },
      {
        "rank": 11,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1098,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.01067563,
        "cumulative_time": 0.017826609,
        "time_percent": 0.3925769002288159,
        "time_per_call": 0.0010486240588235293
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 612,
        "primitive_calls": 612,
        "total_time": 0.009325215000000001,
        "cumulative_time": 0.009325215000000001,
        "time_percent": 0.20535952735976082,
        "time_per_call": 1.5237279411764708e-05
      },
      {
        "rank": 13,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 208,
        "function_name": "batch_ucb_selection",
        "total_calls": 67,
        "primitive_calls": 67,
        "total_time": 0.009254655,
        "cumulative_time": 0.24898877800000002,
        "time_percent": 5.483221327118399,
        "time_per_call": 0.003716250417910448
      },
      {
        "rank": 14,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 799,
        "primitive_calls": 799,
        "total_time": 0.007954874,
        "cumulative_time": 0.007954874,
        "time_percent": 0.17518193037334256,
        "time_per_call": 9.956037546933667e-06
      },
      {
        "rank": 15,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 612,
        "primitive_calls": 612,
        "total_time": 0.006727277,
        "cumulative_time": 0.0067370450000000005,
        "time_percent": 0.14836294680620657,
        "time_per_call": 1.1008243464052289e-05
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 53,
        "primitive_calls": 53,
        "total_time": 0.005668262,
        "cumulative_time": 0.005668262,
        "time_percent": 0.12482624853918031,
        "time_per_call": 0.00010694833962264151
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.topk>",
        "total_calls": 305,
        "primitive_calls": 305,
        "total_time": 0.005000161,
        "cumulative_time": 0.005023495,
        "time_percent": 0.11062721437458778,
        "time_per_call": 1.6470475409836067e-05
      },
      {
        "rank": 18,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 295,
        "primitive_calls": 295,
        "total_time": 0.004534969000000001,
        "cumulative_time": 0.050338237,
        "time_percent": 1.1085467261016098,
        "time_per_call": 0.00017063809152542374
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 51796,
        "primitive_calls": 51796,
        "total_time": 0.004058620000000001,
        "cumulative_time": 0.004058620000000001,
        "time_percent": 0.08937877410149496,
        "time_per_call": 7.835778824619663e-08
      },
      {
        "rank": 20,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1029,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.003637368,
        "cumulative_time": 0.018210813000000003,
        "time_percent": 0.4010378259929651,
        "time_per_call": 0.0010712242941176473
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 295,
        "primitive_calls": 295,
        "total_time": 0.0036357950000000003,
        "cumulative_time": 0.0036357950000000003,
        "time_percent": 0.08006733815541855,
        "time_per_call": 1.2324728813559322e-05
      },
      {
        "rank": 22,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 106,
        "primitive_calls": 106,
        "total_time": 0.003593357,
        "cumulative_time": 0.056123778000000006,
        "time_percent": 1.2359556882843066,
        "time_per_call": 0.0005294696037735849
      },
      {
        "rank": 23,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1344,
        "function_name": "set_expanded",
        "total_calls": 305,
        "primitive_calls": 305,
        "total_time": 0.003489508,
        "cumulative_time": 0.003489508,
        "time_percent": 0.07684581144757564,
        "time_per_call": 1.1441009836065574e-05
      },
      {
        "rank": 24,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 36180,
        "primitive_calls": 36180,
        "total_time": 0.003481581,
        "cumulative_time": 0.003481581,
        "time_percent": 0.0766712433573621,
        "time_per_call": 9.622943615257049e-08
      },
      {
        "rank": 25,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 389,
        "primitive_calls": 389,
        "total_time": 0.0032505790000000004,
        "cumulative_time": 0.0032918870000000003,
        "time_percent": 0.07249380935900575,
        "time_per_call": 8.462434447300773e-06
      },
      {
        "rank": 26,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 295,
        "primitive_calls": 295,
        "total_time": 0.0030394970000000004,
        "cumulative_time": 0.0030394970000000004,
        "time_percent": 0.0669356864513484,
        "time_per_call": 1.0303379661016951e-05
      },
      {
        "rank": 27,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 318,
        "function_name": "apply_moves",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.003020469,
        "cumulative_time": 0.004266921,
        "time_percent": 0.09396597074077517,
        "time_per_call": 0.00025099535294117645
      },
      {
        "rank": 28,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1239,
        "function_name": "apply_virtual_loss",
        "total_calls": 67,
        "primitive_calls": 67,
        "total_time": 0.0029073180000000003,
        "cumulative_time": 0.0029073180000000003,
        "time_percent": 0.06402484557884457,
        "time_per_call": 4.339280597014926e-05
      },
      {
        "rank": 29,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 2022,
        "primitive_calls": 2022,
        "total_time": 0.002832116,
        "cumulative_time": 0.00555369,
        "time_percent": 0.12230314834592336,
        "time_per_call": 2.7466320474777448e-06
      },
      {
        "rank": 30,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 873,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.002376212,
        "cumulative_time": 0.17707176200000002,
        "time_percent": 3.8994675568423944,
        "time_per_call": 0.010415986000000002
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 13900,
        "primitive_calls": 13900,
        "total_time": 0.002216722,
        "cumulative_time": 0.007770412000000001,
        "time_percent": 0.17111971527848027,
        "time_per_call": 5.590224460431655e-07
      },
      {
        "rank": 32,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1014,
        "function_name": "_clone_states_batch",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.00211224,
        "cumulative_time": 0.00211224,
        "time_percent": 0.04651566833262087,
        "time_per_call": 0.00012424941176470588
      },
      {
        "rank": 33,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 53,
        "primitive_calls": 53,
        "total_time": 0.0020143170000000003,
        "cumulative_time": 0.0038826990000000003,
        "time_percent": 0.08550464858131591,
        "time_per_call": 7.325847169811321e-05
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method mcts_cuda_kernels.batched_ucb_selection_quantum>",
        "total_calls": 67,
        "primitive_calls": 67,
        "total_time": 0.0018965330000000002,
        "cumulative_time": 0.0018965330000000002,
        "time_percent": 0.041765377045160805,
        "time_per_call": 2.8306462686567167e-05
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'long' of 'torch._C.TensorBase' objects>",
        "total_calls": 338,
        "primitive_calls": 338,
        "total_time": 0.0018782830000000001,
        "cumulative_time": 0.0018782830000000001,
        "time_percent": 0.0413634762445556,
        "time_per_call": 5.557050295857989e-06
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._get_tracing_state>",
        "total_calls": 2094,
        "primitive_calls": 2094,
        "total_time": 0.001824934,
        "cumulative_time": 0.001824934,
        "time_percent": 0.04018862661104947,
        "time_per_call": 8.715062082139446e-07
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 235,
        "primitive_calls": 235,
        "total_time": 0.001754558,
        "cumulative_time": 0.001754558,
        "time_percent": 0.0386388090360691,
        "time_per_call": 7.466204255319149e-06
      },
      {
        "rank": 38,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 53,
        "primitive_calls": 53,
        "total_time": 0.0017474650000000001,
        "cumulative_time": 0.02692825,
        "time_percent": 0.5930128895286036,
        "time_per_call": 0.0005080801886792454
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 159,
        "primitive_calls": 159,
        "total_time": 0.0017071640000000002,
        "cumulative_time": 0.001828011,
        "time_percent": 0.040256388187129594,
        "time_per_call": 1.1496924528301887e-05
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'numpy' of 'torch._C.TensorBase' objects>",
        "total_calls": 612,
        "primitive_calls": 612,
        "total_time": 0.001570739,
        "cumulative_time": 0.001570739,
        "time_percent": 0.03459075406256513,
        "time_per_call": 2.5665669934640522e-06
      },
      {
        "rank": 41,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 814,
        "function_name": "get_children",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.001527399,
        "cumulative_time": 0.0016216070000000002,
        "time_percent": 0.03571096720915064,
        "time_per_call": 8.534773684210527e-05
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 134,
        "primitive_calls": 134,
        "total_time": 0.0012914900000000002,
        "cumulative_time": 0.0012914900000000002,
        "time_percent": 0.028441143286225302,
        "time_per_call": 9.637985074626868e-06
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 11506,
        "primitive_calls": 11506,
        "total_time": 0.0012585720000000001,
        "cumulative_time": 0.0012585720000000001,
        "time_percent": 0.027716224351741904,
        "time_per_call": 1.0938397357900227e-07
      },
      {
        "rank": 44,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1124,
        "function_name": "__format__",
        "total_calls": 67,
        "primitive_calls": 67,
        "total_time": 0.0012530150000000001,
        "cumulative_time": 0.216060733,
        "time_percent": 4.758081182029955,
        "time_per_call": 0.0032247870597014927
      },
      {
        "rank": 45,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 68,
        "primitive_calls": 68,
        "total_time": 0.001250582,
        "cumulative_time": 0.5766385430000001,
        "time_percent": 12.698711895425586,
        "time_per_call": 0.008479978573529412
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 291,
        "primitive_calls": 291,
        "total_time": 0.001250316,
        "cumulative_time": 0.001250316,
        "time_percent": 0.02753441103613661,
        "time_per_call": 4.296618556701031e-06
      },
      {
        "rank": 47,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1351,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.001249618,
        "cumulative_time": 0.007743263,
        "time_percent": 0.17052184104091148,
        "time_per_call": 0.00045548605882352944
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 119,
        "primitive_calls": 119,
        "total_time": 0.001126786,
        "cumulative_time": 0.001126786,
        "time_percent": 0.024814038110177128,
        "time_per_call": 9.468789915966387e-06
      },
      {
        "rank": 49,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1244,
        "function_name": "remove_virtual_loss",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.001113611,
        "cumulative_time": 0.0013452680000000002,
        "time_percent": 0.029625440341290863,
        "time_per_call": 7.913341176470589e-05
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros>",
        "total_calls": 120,
        "primitive_calls": 120,
        "total_time": 0.001110716,
        "cumulative_time": 0.0011664210000000002,
        "time_percent": 0.025686878561244922,
        "time_per_call": 9.720175000000002e-06
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": null,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": true,
      "quantum_config": "QuantumConfig(quantum_level='one_loop', min_wave_size=3072, optimal_wave_size=3072, hbar_eff=0.1, temperature=1.0, coupling_strength=0.1, decoherence_rate=0.01, measurement_noise=0.0, path_integral_steps=10, path_integral_beta=1.0, use_wick_rotation=True, interference_alpha=0.05, interference_method='minhash', minhash_size=64, phase_kick_strength=0.1, use_mixed_precision=True, cache_corrections=True, fast_mode=True, enable_quantum=True, uncertainty_decay=0.99, phase_temperature=1.0, device='cuda')",
      "quantum_version": "v2",
      "quantum_branching_factor": null,
      "quantum_avg_game_length": null,
      "enable_phase_adaptation": true,
      "envariance_threshold": 0.001,
      "envariance_check_interval": 1000,
      "enable_virtual_loss": true,
      "virtual_loss": 1.0,
      "virtual_loss_value": -1.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "compile_mode": "reduce-overhead",
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "target_sims_per_second": 100000,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "tree_batch_size": 1024,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "one_loop",
    "num_simulations": 50000,
    "wave_size": 3072,
    "total_time_ms": 596.8921920284629,
    "simulations_per_second": 83767.22072721591,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 20.249343872070312,
        "cpu_time_ms": 20.328654907643795,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 3.2509119510650635,
        "cpu_time_ms": 3.3230429980903864,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.102944016456604,
        "cpu_time_ms": 1.1552469804883003,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7814720273017883,
        "cpu_time_ms": 0.8297439198940992,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 16.382047653198242,
        "cpu_time_ms": 16.43254200462252,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 2.878528118133545,
        "cpu_time_ms": 2.9275070410221815,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0598399639129639,
        "cpu_time_ms": 1.1066249571740627,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.7464960217475891,
        "cpu_time_ms": 0.792304053902626,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 17.957216262817383,
        "cpu_time_ms": 18.01112701650709,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 2.8961598873138428,
        "cpu_time_ms": 2.945432090200484,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0544320344924927,
        "cpu_time_ms": 1.1007649591192603,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5135040283203125,
        "cpu_time_ms": 1.5663220547139645,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 18.50783920288086,
        "cpu_time_ms": 18.567495979368687,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 5.308703899383545,
        "cpu_time_ms": 5.369930993765593,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0639679431915283,
        "cpu_time_ms": 1.1138099944218993,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.8897600173950195,
        "cpu_time_ms": 0.9361939737573266,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.954879760742188,
        "cpu_time_ms": 20.00786003191024,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 6.165503978729248,
        "cpu_time_ms": 6.218570983037353,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1263999938964844,
        "cpu_time_ms": 1.1763470247387886,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 0.8980479836463928,
        "cpu_time_ms": 0.9462730959057808,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.68729591369629,
        "cpu_time_ms": 19.737581023946404,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 6.143743991851807,
        "cpu_time_ms": 6.193873938173056,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0691519975662231,
        "cpu_time_ms": 1.1178969871252775,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.8585599660873413,
        "cpu_time_ms": 1.909039099700749,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.193439483642578,
        "cpu_time_ms": 19.243479007855058,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 8.242048263549805,
        "cpu_time_ms": 8.29180795699358,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0639359951019287,
        "cpu_time_ms": 1.1130579514428973,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.1984959840774536,
        "cpu_time_ms": 1.2564989738166332,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.330623626708984,
        "cpu_time_ms": 19.381509046070278,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 7.062079906463623,
        "cpu_time_ms": 7.11343705188483,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1109119653701782,
        "cpu_time_ms": 1.1653569526970387,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.2156480550765991,
        "cpu_time_ms": 1.2641429202631116,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 18.6560001373291,
        "cpu_time_ms": 18.704734975472093,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 9.32153606414795,
        "cpu_time_ms": 9.372315020300448,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0508160591125488,
        "cpu_time_ms": 1.1046120198443532,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.0242880582809448,
        "cpu_time_ms": 1.0713990777730942,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 18.681535720825195,
        "cpu_time_ms": 18.73007300309837,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 9.239775657653809,
        "cpu_time_ms": 9.286653948947787,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0485759973526,
        "cpu_time_ms": 1.0956350015476346,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.9671039581298828,
        "cpu_time_ms": 2.028021961450577,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.056608200073242,
        "cpu_time_ms": 19.110249006189406,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 9.26524829864502,
        "cpu_time_ms": 9.31627000682056,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0567679405212402,
        "cpu_time_ms": 1.1027379659935832,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.0240000486373901,
        "cpu_time_ms": 1.0707280598580837,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 18.639232635498047,
        "cpu_time_ms": 18.686951021663845,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 14.524352073669434,
        "cpu_time_ms": 14.571835054084659,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.760256052017212,
        "cpu_time_ms": 1.8068059580400586,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.0216319561004639,
        "cpu_time_ms": 1.0671609779819846,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 20.69424057006836,
        "cpu_time_ms": 20.743136992678046,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 15.260736465454102,
        "cpu_time_ms": 15.308241941966116,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0556479692459106,
        "cpu_time_ms": 1.101866946555674,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.1632319688796997,
        "cpu_time_ms": 1.2085679918527603,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.854591369628906,
        "cpu_time_ms": 19.904304994270205,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 19.567359924316406,
        "cpu_time_ms": 19.61682306136936,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0504319667816162,
        "cpu_time_ms": 1.098250038921833,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.1581439971923828,
        "cpu_time_ms": 1.204631058499217,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.76470375061035,
        "cpu_time_ms": 19.814396044239402,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 20.101343154907227,
        "cpu_time_ms": 20.149437012150884,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0842880010604858,
        "cpu_time_ms": 1.1291579576209188,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.1571199893951416,
        "cpu_time_ms": 1.2031270889565349,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 22.09324836730957,
        "cpu_time_ms": 22.14290399570018,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 23.136192321777344,
        "cpu_time_ms": 23.187954095192254,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1519999504089355,
        "cpu_time_ms": 1.2102810433134437,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.3560960292816162,
        "cpu_time_ms": 1.4042069669812918,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 23.208959579467773,
        "cpu_time_ms": 23.257915978319943,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "expansion",
        "gpu_time_ms": 27.3253116607666,
        "cpu_time_ms": 27.697153040207922,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1520639657974243,
        "cpu_time_ms": 1.2034879764541984,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.3332480192184448,
        "cpu_time_ms": 1.3812839752063155,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      }
    ],
    "peak_gpu_memory_mb": 4238.9150390625,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 186.0,
    "avg_ram_usage_mb": 1337.97265625,
    "final_tree_nodes": 2441,
    "final_tree_edges": 2440,
    "tree_memory_mb": 47.73538589477539,
    "efficiency_score": 20235.75212860131,
    "bottleneck_phase": "selection",
    "recommendations": [
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Consider using classical selection for hot paths",
      "One-loop quantum is a good balance - monitor overhead"
    ],
    "quantum_kernel_calls": 1441,
    "total_kernel_calls": 1801,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         212401 function calls (164650 primitive calls) in 0.594 seconds\n\n   Ordered by: cumulative time\n   List reduced from 233 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.592    0.592 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:461(_search_optimized)\n       17    0.000    0.000    0.592    0.035 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:637(_run_search_wave_vectorized)\n       68    0.001    0.000    0.591    0.009 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:394(_profile_phase)\n       17    0.000    0.000    0.342    0.020 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:369(instrumented_select)\n       17    0.020    0.001    0.294    0.017 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:661(_select_batch_vectorized)\n       67    0.001    0.000    0.259    0.004 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:964(batch_select_ucb_optimized)\n       67    0.010    0.000    0.254    0.004 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:208(batch_ucb_selection)\n       67    0.001    0.000    0.219    0.003 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py:1124(__format__)\n       17    0.000    0.000    0.198    0.012 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:372(instrumented_expand)\n       17    0.003    0.000    0.189    0.011 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:873(_expand_batch_vectorized)\n       53    0.154    0.003    0.172    0.003 {built-in method time.sleep}\n       18    0.015    0.001    0.161    0.009 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:897(_expand_node_batch)\n      305    0.067    0.000    0.094    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:512(add_children_batch)\n      695    0.066    0.000    0.066    0.000 {method 'item' of 'torch._C.TensorBase' objects}\n      298    0.005    0.000    0.055    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n47978/298    0.032    0.000    0.041    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n      190    0.001    0.000    0.037    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n      108    0.003    0.000    0.032    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_common.py:452(wrapper)\n       17    0.000    0.000    0.026    0.002 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:375(instrumented_evaluate)\n       17    0.000    0.000    0.026    0.002 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:378(instrumented_backup)\n       54    0.001    0.000    0.024    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py:1964(virtual_memory)\n      914    0.024    0.000    0.024    0.000 {built-in method torch.where}\n       35    0.016    0.000    0.023    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:391(get_nn_features)\n       67    0.017    0.000    0.023    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1162(batch_action_to_child)\n      108    0.000    0.000    0.020    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n       17    0.012    0.001    0.019    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1098(_backup_batch_vectorized)\n       17    0.004    0.000    0.017    0.001 /home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py:1029(_evaluate_batch_vectorized)\n       54    0.001    0.000    0.016    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py:1009(cpu_percent)\n       67    0.011    0.000    0.013    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:920(batch_get_children)\n      612    0.010    0.000    0.010    0.000 {built-in method torch.tensor}\n      799    0.008    0.000    0.008    0.000 {built-in method torch.arange}\n    14017    0.002    0.000    0.008    0.000 {built-in method builtins.len}\n       17    0.000    0.000    0.007    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1389(ensure_consistent)\n       17    0.001    0.000    0.007    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1351(_rebuild_row_pointers)\n      612    0.007    0.000    0.007    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n  162/108    0.000    0.000    0.006    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py:1642(wrapper)\n      695    0.001    0.000    0.006    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n       53    0.006    0.000    0.006    0.000 {method 'sum' of 'torch._C.TensorBase' objects}\n     2022    0.003    0.000    0.006    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py:1159(__len__)\n      138    0.000    0.000    0.005    0.000 {built-in method builtins.next}\n      298    0.000    0.000    0.005    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n      138    0.000    0.000    0.005    0.000 /home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py:196(timer)\n       54    0.003    0.000    0.005    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py:352(virtual_memory)\n      305    0.005    0.000    0.005    0.000 {built-in method torch.topk}\n       17    0.003    0.000    0.005    0.000 /home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:318(apply_moves)\n      479    0.000    0.000    0.005    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n    52283    0.004    0.000    0.004    0.000 {built-in method builtins.isinstance}\n      479    0.000    0.000    0.004    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n       54    0.000    0.000    0.004    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py:1863(cpu_times)\n      205    0.000    0.000    0.004    0.000 /home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 53,
        "primitive_calls": 53,
        "total_time": 0.154126454,
        "cumulative_time": 0.172451137,
        "time_percent": 3.689942780818635,
        "time_per_call": 0.003253795037735849
      },
      {
        "rank": 2,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 512,
        "function_name": "add_children_batch",
        "total_calls": 305,
        "primitive_calls": 305,
        "total_time": 0.066766028,
        "cumulative_time": 0.09364032100000001,
        "time_percent": 2.0036250991345432,
        "time_per_call": 0.0003070174459016394
      },
      {
        "rank": 3,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 695,
        "primitive_calls": 695,
        "total_time": 0.065763128,
        "cumulative_time": 0.06580548800000001,
        "time_percent": 1.4080422408803681,
        "time_per_call": 9.468415539568347e-05
      },
      {
        "rank": 4,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 298,
        "primitive_calls": 47978,
        "total_time": 0.031768261,
        "cumulative_time": 0.041313143000000004,
        "time_percent": 0.8839787108262321,
        "time_per_call": 0.00013863470805369128
      },
      {
        "rank": 5,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 914,
        "primitive_calls": 914,
        "total_time": 0.024162965,
        "cumulative_time": 0.024217468000000002,
        "time_percent": 0.5181819776364033,
        "time_per_call": 2.6496135667396064e-05
      },
      {
        "rank": 6,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 661,
        "function_name": "_select_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.020342143,
        "cumulative_time": 0.29392897,
        "time_percent": 6.289208060860493,
        "time_per_call": 0.017289939411764706
      },
      {
        "rank": 7,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1162,
        "function_name": "batch_action_to_child",
        "total_calls": 67,
        "primitive_calls": 67,
        "total_time": 0.017455201,
        "cumulative_time": 0.022582754,
        "time_percent": 0.4832039471755014,
        "time_per_call": 0.00033705602985074624
      },
      {
        "rank": 8,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 391,
        "function_name": "get_nn_features",
        "total_calls": 35,
        "primitive_calls": 35,
        "total_time": 0.016497948000000002,
        "cumulative_time": 0.022767579000000003,
        "time_percent": 0.48715865391927204,
        "time_per_call": 0.0006505022571428572
      },
      {
        "rank": 9,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 897,
        "function_name": "_expand_node_batch",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.014779732,
        "cumulative_time": 0.161392889,
        "time_percent": 3.4533290762879303,
        "time_per_call": 0.008966271611111111
      },
      {
        "rank": 10,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1098,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.011907019000000001,
        "cumulative_time": 0.018966808,
        "time_percent": 0.4058334289484745,
        "time_per_call": 0.0011156945882352942
      },
      {
        "rank": 11,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 920,
        "function_name": "batch_get_children",
        "total_calls": 67,
        "primitive_calls": 67,
        "total_time": 0.011337777,
        "cumulative_time": 0.012541539,
        "time_percent": 0.2683517319657067,
        "time_per_call": 0.00018718714925373134
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 612,
        "primitive_calls": 612,
        "total_time": 0.009890890000000001,
        "cumulative_time": 0.009890890000000001,
        "time_percent": 0.2116357061268389,
        "time_per_call": 1.6161584967320263e-05
      },
      {
        "rank": 13,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 208,
        "function_name": "batch_ucb_selection",
        "total_calls": 67,
        "primitive_calls": 67,
        "total_time": 0.009574423,
        "cumulative_time": 0.253840206,
        "time_percent": 5.431427428693701,
        "time_per_call": 0.0037886597910447763
      },
      {
        "rank": 14,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 799,
        "primitive_calls": 799,
        "total_time": 0.008003351,
        "cumulative_time": 0.008003351,
        "time_percent": 0.1712479706341838,
        "time_per_call": 1.0016709637046308e-05
      },
      {
        "rank": 15,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 612,
        "primitive_calls": 612,
        "total_time": 0.006688908,
        "cumulative_time": 0.006716039,
        "time_percent": 0.143703312456249,
        "time_per_call": 1.0973919934640524e-05
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 53,
        "primitive_calls": 53,
        "total_time": 0.00563266,
        "cumulative_time": 0.00563266,
        "time_percent": 0.12052221554100798,
        "time_per_call": 0.0001062766037735849
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.topk>",
        "total_calls": 305,
        "primitive_calls": 305,
        "total_time": 0.005079826,
        "cumulative_time": 0.005079826,
        "time_percent": 0.10869320784191064,
        "time_per_call": 1.6655167213114752e-05
      },
      {
        "rank": 18,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 298,
        "primitive_calls": 298,
        "total_time": 0.005044321,
        "cumulative_time": 0.055491225000000005,
        "time_percent": 1.1873476084273809,
        "time_per_call": 0.0001862121644295302
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 52283,
        "primitive_calls": 52283,
        "total_time": 0.004123972,
        "cumulative_time": 0.004123972,
        "time_percent": 0.08824076764247828,
        "time_per_call": 7.887787617389974e-08
      },
      {
        "rank": 20,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1029,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.0039608690000000005,
        "cumulative_time": 0.016576645,
        "time_percent": 0.35469103081612813,
        "time_per_call": 0.0009750967647058824
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 298,
        "primitive_calls": 298,
        "total_time": 0.0037418520000000004,
        "cumulative_time": 0.0037418520000000004,
        "time_percent": 0.08006453314536148,
        "time_per_call": 1.2556550335570472e-05
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 36547,
        "primitive_calls": 36547,
        "total_time": 0.003720189,
        "cumulative_time": 0.003720189,
        "time_percent": 0.07960100920547075,
        "time_per_call": 1.0179191178482502e-07
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 298,
        "primitive_calls": 298,
        "total_time": 0.0035625490000000004,
        "cumulative_time": 0.0035625490000000004,
        "time_percent": 0.07622798082138856,
        "time_per_call": 1.1954862416107384e-05
      },
      {
        "rank": 24,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1344,
        "function_name": "set_expanded",
        "total_calls": 305,
        "primitive_calls": 305,
        "total_time": 0.0035277480000000003,
        "cumulative_time": 0.003553206,
        "time_percent": 0.07602806833602646,
        "time_per_call": 1.164985573770492e-05
      },
      {
        "rank": 25,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 389,
        "primitive_calls": 389,
        "total_time": 0.0033965,
        "cumulative_time": 0.0033965,
        "time_percent": 0.07267502478137036,
        "time_per_call": 8.731362467866324e-06
      },
      {
        "rank": 26,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 318,
        "function_name": "apply_moves",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.003309558,
        "cumulative_time": 0.0047538400000000005,
        "time_percent": 0.10171807443152354,
        "time_per_call": 0.0002796376470588236
      },
      {
        "rank": 27,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1239,
        "function_name": "apply_virtual_loss",
        "total_calls": 67,
        "primitive_calls": 67,
        "total_time": 0.002928968,
        "cumulative_time": 0.002928968,
        "time_percent": 0.06267122684641271,
        "time_per_call": 4.3715940298507464e-05
      },
      {
        "rank": 28,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 2022,
        "primitive_calls": 2022,
        "total_time": 0.0028574620000000003,
        "cumulative_time": 0.005609932000000001,
        "time_percent": 0.1200359037602834,
        "time_per_call": 2.774447082096934e-06
      },
      {
        "rank": 29,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 54,
        "primitive_calls": 54,
        "total_time": 0.002769638,
        "cumulative_time": 0.0051267100000000005,
        "time_percent": 0.10969638636740742,
        "time_per_call": 9.493907407407408e-05
      },
      {
        "rank": 30,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 873,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.002657622,
        "cumulative_time": 0.18868494800000002,
        "time_percent": 4.037298181001495,
        "time_per_call": 0.011099114588235296
      },
      {
        "rank": 31,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 108,
        "primitive_calls": 108,
        "total_time": 0.0026285460000000003,
        "cumulative_time": 0.032011239000000004,
        "time_percent": 0.6849455579588899,
        "time_per_call": 0.00029640036111111117
      },
      {
        "rank": 32,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/core/mcts.py",
        "line_number": 1014,
        "function_name": "_clone_states_batch",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.0022773750000000003,
        "cumulative_time": 0.0022773750000000003,
        "time_percent": 0.04872906950139065,
        "time_per_call": 0.00013396323529411768
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 14017,
        "primitive_calls": 14017,
        "total_time": 0.002243136,
        "cumulative_time": 0.007853068000000001,
        "time_percent": 0.16803236022664114,
        "time_per_call": 5.602531212099594e-07
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'long' of 'torch._C.TensorBase' objects>",
        "total_calls": 338,
        "primitive_calls": 338,
        "total_time": 0.001943756,
        "cumulative_time": 0.0019599260000000003,
        "time_percent": 0.041936602567246316,
        "time_per_call": 5.798597633136095e-06
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method mcts_cuda_kernels.batched_ucb_selection_quantum>",
        "total_calls": 67,
        "primitive_calls": 67,
        "total_time": 0.0019410130000000001,
        "cumulative_time": 0.0019410130000000001,
        "time_percent": 0.0415319204698843,
        "time_per_call": 2.897034328358209e-05
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 162,
        "primitive_calls": 162,
        "total_time": 0.0018676300000000001,
        "cumulative_time": 0.002068365,
        "time_percent": 0.044256875498872104,
        "time_per_call": 1.2767685185185186e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._get_tracing_state>",
        "total_calls": 2094,
        "primitive_calls": 2094,
        "total_time": 0.001831727,
        "cumulative_time": 0.001831727,
        "time_percent": 0.039193524250759657,
        "time_per_call": 8.747502387774594e-07
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 235,
        "primitive_calls": 235,
        "total_time": 0.001801693,
        "cumulative_time": 0.001827772,
        "time_percent": 0.039108898982686546,
        "time_per_call": 7.777753191489362e-06
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'numpy' of 'torch._C.TensorBase' objects>",
        "total_calls": 612,
        "primitive_calls": 612,
        "total_time": 0.001604221,
        "cumulative_time": 0.001604221,
        "time_percent": 0.03432557071390983,
        "time_per_call": 2.62127614379085e-06
      },
      {
        "rank": 40,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 814,
        "function_name": "get_children",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.0015705290000000002,
        "cumulative_time": 0.001667192,
        "time_percent": 0.035672963319682734,
        "time_per_call": 8.774694736842105e-05
      },
      {
        "rank": 41,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1124,
        "function_name": "__format__",
        "total_calls": 67,
        "primitive_calls": 67,
        "total_time": 0.001445162,
        "cumulative_time": 0.218996407,
        "time_percent": 4.68587348910822,
        "time_per_call": 0.003268603089552239
      },
      {
        "rank": 42,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 54,
        "primitive_calls": 54,
        "total_time": 0.001388266,
        "cumulative_time": 0.016493883,
        "time_percent": 0.3529201695174513,
        "time_per_call": 0.0003054422777777778
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 11623,
        "primitive_calls": 11623,
        "total_time": 0.001319042,
        "cumulative_time": 0.001319042,
        "time_percent": 0.028223586055547863,
        "time_per_call": 1.1348550288221631e-07
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 134,
        "primitive_calls": 134,
        "total_time": 0.001316357,
        "cumulative_time": 0.001316357,
        "time_percent": 0.028166135020206196,
        "time_per_call": 9.823559701492537e-06
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 291,
        "primitive_calls": 291,
        "total_time": 0.0012856640000000002,
        "cumulative_time": 0.0012856640000000002,
        "time_percent": 0.027509395866484838,
        "time_per_call": 4.418089347079038e-06
      },
      {
        "rank": 46,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/benchmark_mcts_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 68,
        "primitive_calls": 68,
        "total_time": 0.001257026,
        "cumulative_time": 0.591462328,
        "time_percent": 12.655539333033122,
        "time_per_call": 0.008697975411764706
      },
      {
        "rank": 47,
        "filename": "/home/cosmosapjw/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1351,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.0012436110000000002,
        "cumulative_time": 0.0070786980000000005,
        "time_percent": 0.15146313928156538,
        "time_per_call": 0.00041639400000000005
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 119,
        "primitive_calls": 119,
        "total_time": 0.0011803430000000001,
        "cumulative_time": 0.0011803430000000001,
        "time_percent": 0.025255838885769773,
        "time_per_call": 9.9188487394958e-06
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros>",
        "total_calls": 120,
        "primitive_calls": 120,
        "total_time": 0.001137868,
        "cumulative_time": 0.001137868,
        "time_percent": 0.024346999881621766,
        "time_per_call": 9.482233333333334e-06
      },
      {
        "rank": 50,
        "filename": "/home/cosmosapjw/venv/lib/python3.12/site-packages/psutil-7.0.0-py3.12-linux-x86_64.egg/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 54,
        "primitive_calls": 54,
        "total_time": 0.0010965970000000002,
        "cumulative_time": 0.024301697,
        "time_percent": 0.5199842283834399,
        "time_per_call": 0.0004500314259259259
      }
    ]
  }
]