[
  {
    "config": {
      "num_simulations": 1000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -3.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "num_simulations": 1000,
    "wave_size": 3072,
    "total_time_ms": 35.37825799867278,
    "simulations_per_second": 28265.947973965114,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 19.314815521240234,
        "cpu_time_ms": 17.839574000390712,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.36735999584198,
        "cpu_time_ms": 1.81632199746673,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.5915199518203735,
        "cpu_time_ms": 1.838962998590432,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.235136032104492,
        "cpu_time_ms": 5.907604998355964,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      }
    ],
    "peak_gpu_memory_mb": 2367.73779296875,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 178.3,
    "avg_ram_usage_mb": 1215.8828125,
    "final_tree_nodes": 9,
    "final_tree_edges": 8,
    "tree_memory_mb": 52.830238342285156,
    "efficiency_score": 12224.466244232599,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "cprofile_stats": "         12742 function calls (9538 primitive calls) in 0.034 seconds\n\n   Ordered by: cumulative time\n   List reduced from 170 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.033    0.033 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:190(search)\n        1    0.000    0.000    0.029    0.029 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:272(_run_search_wave_vectorized)\n        4    0.000    0.000    0.029    0.007 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:383(_profile_phase)\n        1    0.000    0.000    0.018    0.018 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:358(instrumented_select)\n        1    0.004    0.004    0.018    0.018 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:294(_select_batch_vectorized)\n        1    0.000    0.000    0.006    0.006 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:367(instrumented_backup)\n        1    0.004    0.004    0.005    0.005 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:687(_backup_batch_vectorized)\n       11    0.005    0.000    0.005    0.000 {built-in method torch.where}\n        3    0.004    0.001    0.005    0.002 {built-in method time.sleep}\n        2    0.002    0.001    0.004    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n       20    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       13    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n  3220/20    0.002    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        2    0.002    0.001    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:364(instrumented_evaluate)\n       12    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:361(instrumented_expand)\n       10    0.000    0.000    0.002    0.000 {built-in method builtins.next}\n       10    0.000    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:185(timer)\n        3    0.002    0.001    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:785(_extract_policy)\n        5    0.000    0.000    0.002    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n        5    0.000    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:167(end_timer)\n        2    0.000    0.000    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n        2    0.000    0.000    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n       13    0.002    0.000    0.002    0.000 {built-in method torch._C._cuda_synchronize}\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:731(_add_dirichlet_noise_to_root)\n        8    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:644(_evaluate_batch_vectorized)\n        1    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n      2/1    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        1    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        1    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n        1    0.000    0.000    0.000    0.000 {built-in method torch._unique2}\n        4    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n       47    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n     10/7    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n        7    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n       20    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n       31    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n       10    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n        3    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n        4    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n       31    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n       31    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n        1    0.000    0.000    0.000    0.000 {method 'to' of 'torch._C.TensorBase' objects}\n        5    0.000    0.000    0.000    0.000 /usr/lib/python3.12/contextlib.py:132(__enter__)\n     3491    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}\n       20    0.000    0.000    0.000    0.000 {built-in method torch._C._cuda_memoryStats}\n        3    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.0046944000000000005,
        "cumulative_time": 0.0046944000000000005,
        "time_percent": 2.296627414578831,
        "time_per_call": 0.0004267636363636364
      },
      {
        "rank": 2,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 294,
        "function_name": "_select_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.004493632,
        "cumulative_time": 0.017542541000000002,
        "time_percent": 8.582285400045404,
        "time_per_call": 0.017542541000000002
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 687,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.004203158,
        "cumulative_time": 0.0054596490000000004,
        "time_percent": 2.671007917386226,
        "time_per_call": 0.0054596490000000004
      },
      {
        "rank": 4,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.003516102,
        "cumulative_time": 0.004674482000000001,
        "time_percent": 2.2868829904045844,
        "time_per_call": 0.0015581606666666668
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0023321920000000003,
        "cumulative_time": 0.00238164,
        "time_percent": 1.1651626865323632,
        "time_per_call": 0.00119082
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.001971029,
        "cumulative_time": 0.001999416,
        "time_percent": 0.9781683705580153,
        "time_per_call": 0.000666472
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 20,
        "primitive_calls": 3220,
        "total_time": 0.001828717,
        "cumulative_time": 0.0023945900000000003,
        "time_percent": 1.171498176694854,
        "time_per_call": 0.00011972950000000001
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.001771671,
        "cumulative_time": 0.003881957,
        "time_percent": 1.8991583308657536,
        "time_per_call": 0.0019409785
      },
      {
        "rank": 9,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.001538288,
        "cumulative_time": 0.001538288,
        "time_percent": 0.7525720842530761,
        "time_per_call": 0.00011832984615384615
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 644,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.001091449,
        "cumulative_time": 0.001153891,
        "time_percent": 0.5645146779217325,
        "time_per_call": 0.001153891
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00048525900000000004,
        "cumulative_time": 0.00048525900000000004,
        "time_percent": 0.2374018239969131,
        "time_per_call": 0.00048525900000000004
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 20,
        "primitive_calls": 20,
        "total_time": 0.00037039800000000003,
        "cumulative_time": 0.003415167,
        "time_percent": 1.6707920410627433,
        "time_per_call": 0.00017075835
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00032957500000000003,
        "cumulative_time": 0.0015911170000000002,
        "time_percent": 0.7784174595267608,
        "time_per_call": 0.0007955585000000001
      },
      {
        "rank": 14,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'to' of 'torch._C.TensorBase' objects>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00028041400000000004,
        "cumulative_time": 0.00028041400000000004,
        "time_percent": 0.13718611107526166,
        "time_per_call": 0.00028041400000000004
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 190,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00025786,
        "cumulative_time": 0.032752349,
        "time_percent": 16.023334740382914,
        "time_per_call": 0.032752349
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 3491,
        "primitive_calls": 3491,
        "total_time": 0.000255998,
        "cumulative_time": 0.000255998,
        "time_percent": 0.1252411436770091,
        "time_per_call": 7.333085075909482e-08
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 20,
        "primitive_calls": 20,
        "total_time": 0.00025369600000000003,
        "cumulative_time": 0.00025369600000000003,
        "time_percent": 0.12411494303190845,
        "time_per_call": 1.2684800000000001e-05
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 20,
        "primitive_calls": 20,
        "total_time": 0.00022428000000000001,
        "cumulative_time": 0.00022428000000000001,
        "time_percent": 0.10972384043578311,
        "time_per_call": 1.1214000000000001e-05
      },
      {
        "rank": 19,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00021759100000000002,
        "cumulative_time": 0.000362947,
        "time_percent": 0.17756348633246907,
        "time_per_call": 9.073675e-05
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 2453,
        "primitive_calls": 2453,
        "total_time": 0.00021523,
        "cumulative_time": 0.00021523,
        "time_percent": 0.10529633572763329,
        "time_per_call": 8.774154097024052e-08
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.00019658700000000002,
        "cumulative_time": 0.00019658700000000002,
        "time_percent": 0.09617567602884472,
        "time_per_call": 1.7871545454545455e-05
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 731,
        "function_name": "_add_dirichlet_noise_to_root",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00014620100000000002,
        "cumulative_time": 0.001292607,
        "time_percent": 0.6323782959433578,
        "time_per_call": 0.001292607
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.00014579800000000002,
        "cumulative_time": 0.00014579800000000002,
        "time_percent": 0.07132832391589221,
        "time_per_call": 1.3254363636363638e-05
      },
      {
        "rank": 24,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000143704,
        "cumulative_time": 0.000229776,
        "time_percent": 0.1124126322452849,
        "time_per_call": 5.7444e-05
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1098,
        "function_name": "remove_virtual_loss",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000106948,
        "cumulative_time": 0.000133052,
        "time_percent": 0.06509263606947482,
        "time_per_call": 0.000133052
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000104766,
        "cumulative_time": 0.000104766,
        "time_percent": 0.05125436002806871,
        "time_per_call": 5.2383e-05
      },
      {
        "rank": 27,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 785,
        "function_name": "_extract_policy",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000101149,
        "cumulative_time": 0.001965613,
        "time_percent": 0.9616310289392764,
        "time_per_call": 0.001965613
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x7333ab978360>",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 8.932e-05,
        "cumulative_time": 8.932e-05,
        "time_percent": 0.043697759174800004,
        "time_per_call": 8.932e-06
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 8.7446e-05,
        "cumulative_time": 8.7446e-05,
        "time_percent": 0.042780947702637274,
        "time_per_call": 7.287166666666667e-06
      },
      {
        "rank": 30,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 383,
        "function_name": "_profile_phase",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 7.9968e-05,
        "cumulative_time": 0.029219262000000003,
        "time_percent": 14.294853046813538,
        "time_per_call": 0.007304815500000001
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 809,
        "primitive_calls": 809,
        "total_time": 7.7858e-05,
        "cumulative_time": 0.000191188,
        "time_percent": 0.09353433924218163,
        "time_per_call": 2.363263288009889e-07
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 781,
        "primitive_calls": 781,
        "total_time": 7.6018e-05,
        "cumulative_time": 7.6018e-05,
        "time_percent": 0.03719006109437916,
        "time_per_call": 9.733418693982075e-08
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 6.328900000000001e-05,
        "cumulative_time": 6.328900000000001e-05,
        "time_percent": 0.03096269010763455,
        "time_per_call": 2.1096333333333337e-05
      },
      {
        "rank": 34,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 6.0895000000000006e-05,
        "cumulative_time": 0.00011333,
        "time_percent": 0.05544410039498528,
        "time_per_call": 4.197407407407408e-06
      },
      {
        "rank": 35,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 5.8318000000000006e-05,
        "cumulative_time": 0.0024935960000000003,
        "time_percent": 1.2199345889749733,
        "time_per_call": 0.00019181507692307695
      },
      {
        "rank": 36,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 47,
        "primitive_calls": 47,
        "total_time": 5.7140000000000005e-05,
        "cumulative_time": 0.000452787,
        "time_percent": 0.22151564356784784,
        "time_per_call": 9.633765957446809e-06
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 5.5171000000000004e-05,
        "cumulative_time": 6.366600000000001e-05,
        "time_percent": 0.03114712870155416,
        "time_per_call": 3.1833000000000005e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 5.4624000000000004e-05,
        "cumulative_time": 5.4624000000000004e-05,
        "time_percent": 0.026723537809720952,
        "time_per_call": 1.3656000000000001e-05
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 5.3721e-05,
        "cumulative_time": 0.0023383310000000004,
        "time_percent": 1.1439747526754287,
        "time_per_call": 0.0001948609166666667
      },
      {
        "rank": 40,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py",
        "line_number": 179,
        "function_name": "record",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 5.2704e-05,
        "cumulative_time": 0.00036776900000000005,
        "time_percent": 0.17992253911729764,
        "time_per_call": 3.6776900000000004e-05
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'split' of 'bytes' objects>",
        "total_calls": 220,
        "primitive_calls": 220,
        "total_time": 5.1880000000000005e-05,
        "cumulative_time": 5.1880000000000005e-05,
        "time_percent": 0.025381098813128354,
        "time_per_call": 2.3581818181818184e-07
      },
      {
        "rank": 42,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 4.9192000000000006e-05,
        "cumulative_time": 7.8331e-05,
        "time_percent": 0.03832164323691513,
        "time_per_call": 2.5268064516129036e-06
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 4.5444e-05,
        "cumulative_time": 4.5444e-05,
        "time_percent": 0.02223243358642646,
        "time_per_call": 9.0888e-06
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 4.5275e-05,
        "cumulative_time": 4.5275e-05,
        "time_percent": 0.02214975421673836,
        "time_per_call": 5.659375e-06
      },
      {
        "rank": 45,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 765,
        "function_name": "open_binary",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 4.5273000000000005e-05,
        "cumulative_time": 0.00024186000000000002,
        "time_percent": 0.11832445179150392,
        "time_per_call": 2.198727272727273e-05
      },
      {
        "rank": 46,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 4.4462e-05,
        "cumulative_time": 0.000453593,
        "time_percent": 0.22190996056174495,
        "time_per_call": 0.00011339825
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 4.3615e-05,
        "cumulative_time": 4.3615e-05,
        "time_percent": 0.021337637331044587,
        "time_per_call": 4.3615e-05
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 4.3002000000000006e-05,
        "cumulative_time": 4.3002000000000006e-05,
        "time_percent": 0.02103774115578538,
        "time_per_call": 1.0750500000000002e-05
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 4.1523e-05,
        "cumulative_time": 4.1523e-05,
        "time_percent": 0.020314174364254596,
        "time_per_call": 8.3046e-06
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method mcts_cuda_kernels.batched_ucb_selection>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 4.0449000000000005e-05,
        "cumulative_time": 4.0449000000000005e-05,
        "time_percent": 0.01978874452375152,
        "time_per_call": 2.0224500000000003e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 5000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -3.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "num_simulations": 5000,
    "wave_size": 3072,
    "total_time_ms": 70.08159100223565,
    "simulations_per_second": 71345.41223301418,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 19.080703735351562,
        "cpu_time_ms": 17.58679900012794,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.0252799987792969,
        "cpu_time_ms": 1.7002360000333283,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.220352053642273,
        "cpu_time_ms": 1.5218150001601316,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 13.26899242401123,
        "cpu_time_ms": 12.230276999616763,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.731103897094727,
        "cpu_time_ms": 18.227915999887045,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8763840198516846,
        "cpu_time_ms": 1.0877619970415253,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.192255973815918,
        "cpu_time_ms": 1.3652729976456612,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "backup",
        "gpu_time_ms": 7.2520318031311035,
        "cpu_time_ms": 6.8137810012558475,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      }
    ],
    "peak_gpu_memory_mb": 2379.5791015625,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 187.4,
    "avg_ram_usage_mb": 1216.2578125,
    "final_tree_nodes": 9,
    "final_tree_edges": 8,
    "tree_memory_mb": 52.830238342285156,
    "efficiency_score": 30701.943078351436,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "cprofile_stats": "         23612 function calls (17683 primitive calls) in 0.069 seconds\n\n   Ordered by: cumulative time\n   List reduced from 170 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.067    0.067 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:190(search)\n        2    0.000    0.000    0.064    0.032 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:272(_run_search_wave_vectorized)\n        8    0.000    0.000    0.064    0.008 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:383(_profile_phase)\n        2    0.000    0.000    0.037    0.018 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:358(instrumented_select)\n        6    0.009    0.002    0.025    0.004 {built-in method time.sleep}\n        2    0.000    0.000    0.020    0.010 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:367(instrumented_backup)\n        2    0.005    0.003    0.018    0.009 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:294(_select_batch_vectorized)\n        4    0.007    0.002    0.013    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n       22    0.008    0.000    0.008    0.000 {built-in method torch.where}\n        7    0.004    0.001    0.006    0.001 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n       37    0.001    0.000    0.006    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        4    0.005    0.001    0.005    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n  5957/37    0.003    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       23    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       25    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        2    0.000    0.000    0.004    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:361(instrumented_expand)\n        2    0.000    0.000    0.004    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:364(instrumented_evaluate)\n        2    0.003    0.001    0.004    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:687(_backup_batch_vectorized)\n        4    0.000    0.000    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n        4    0.001    0.000    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n        2    0.000    0.000    0.003    0.002 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n      4/2    0.000    0.000    0.003    0.002 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        2    0.000    0.000    0.003    0.002 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        2    0.000    0.000    0.003    0.002 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n        2    0.003    0.002    0.003    0.002 {built-in method torch._unique2}\n       18    0.000    0.000    0.003    0.000 {built-in method builtins.next}\n       18    0.000    0.000    0.003    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:185(timer)\n        9    0.000    0.000    0.003    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n        9    0.000    0.000    0.003    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:167(end_timer)\n       25    0.003    0.000    0.003    0.000 {built-in method torch._C._cuda_synchronize}\n        4    0.003    0.001    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n        7    0.001    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:785(_extract_policy)\n       14    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        2    0.002    0.001    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:644(_evaluate_batch_vectorized)\n        2    0.002    0.001    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:395(_expand_batch_vectorized)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:731(_add_dirichlet_noise_to_root)\n        2    0.001    0.001    0.001    0.001 {method 'cpu' of 'torch._C.TensorBase' objects}\n    21/14    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n       14    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n       87    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n       37    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n        7    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n       59    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n        7    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n       59    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n       59    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n       18    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n        7    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n     6471    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.009385624,
        "cumulative_time": 0.024883810000000003,
        "time_percent": 5.8121599681482605,
        "time_per_call": 0.004147301666666667
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 22,
        "primitive_calls": 22,
        "total_time": 0.008399760000000001,
        "cumulative_time": 0.008436369,
        "time_percent": 1.9704991389311755,
        "time_per_call": 0.0003834713181818182
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.007040299000000001,
        "cumulative_time": 0.01339861,
        "time_percent": 3.129539434308129,
        "time_per_call": 0.0033496525
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 294,
        "function_name": "_select_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.005458292,
        "cumulative_time": 0.018027023,
        "time_percent": 4.210606873524912,
        "time_per_call": 0.0090135115
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0045025970000000005,
        "cumulative_time": 0.004594396000000001,
        "time_percent": 1.073122022271529,
        "time_per_call": 0.0011485990000000001
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.0042526230000000005,
        "cumulative_time": 0.006125041,
        "time_percent": 1.4306377561742671,
        "time_per_call": 0.0008750058571428572
      },
      {
        "rank": 7,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.003345101,
        "cumulative_time": 0.003345101,
        "time_percent": 0.7813217558570297,
        "time_per_call": 0.0016725505
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 37,
        "primitive_calls": 5957,
        "total_time": 0.0032274910000000003,
        "cumulative_time": 0.004219281,
        "time_percent": 0.9855056811062518,
        "time_per_call": 0.00011403462162162162
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 687,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.002980566,
        "cumulative_time": 0.003681858,
        "time_percent": 0.8599787442520425,
        "time_per_call": 0.001840929
      },
      {
        "rank": 10,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.0028296360000000004,
        "cumulative_time": 0.0028296360000000004,
        "time_percent": 0.660923591830639,
        "time_per_call": 0.00011318544000000001
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.002566178,
        "cumulative_time": 0.0026025700000000002,
        "time_percent": 0.6078873439518956,
        "time_per_call": 0.0006506425000000001
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 644,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0017214390000000002,
        "cumulative_time": 0.001829136,
        "time_percent": 0.427234858146676,
        "time_per_call": 0.000914568
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 395,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0015547520000000002,
        "cumulative_time": 0.0015770410000000002,
        "time_percent": 0.3683525379886963,
        "time_per_call": 0.0007885205000000001
      },
      {
        "rank": 14,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.001062407,
        "cumulative_time": 0.001062407,
        "time_percent": 0.2481484722508526,
        "time_per_call": 0.0005312035
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000645707,
        "cumulative_time": 0.0033915150000000003,
        "time_percent": 0.7921627642380467,
        "time_per_call": 0.0008478787500000001
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 37,
        "primitive_calls": 37,
        "total_time": 0.00057342,
        "cumulative_time": 0.005856712,
        "time_percent": 1.3679636290171615,
        "time_per_call": 0.00015828951351351352
      },
      {
        "rank": 17,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.0005114610000000001,
        "cumulative_time": 0.00189812,
        "time_percent": 0.44334758538751,
        "time_per_call": 0.00027116
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 6471,
        "primitive_calls": 6471,
        "total_time": 0.00043938800000000003,
        "cumulative_time": 0.00043938800000000003,
        "time_percent": 0.1026287109604489,
        "time_per_call": 6.790109720290527e-08
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 37,
        "primitive_calls": 37,
        "total_time": 0.000401528,
        "cumulative_time": 0.000401528,
        "time_percent": 0.0937856770201442,
        "time_per_call": 1.0852108108108109e-05
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 37,
        "primitive_calls": 37,
        "total_time": 0.00039390100000000005,
        "cumulative_time": 0.00039390100000000005,
        "time_percent": 0.09200422377495923,
        "time_per_call": 1.0645972972972975e-05
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 190,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00039181700000000003,
        "cumulative_time": 0.06736805,
        "time_percent": 15.735286651931935,
        "time_per_call": 0.06736805
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 4538,
        "primitive_calls": 4538,
        "total_time": 0.00039168300000000004,
        "cumulative_time": 0.00039168300000000004,
        "time_percent": 0.0914861611949382,
        "time_per_call": 8.631181137064787e-08
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.00036990700000000005,
        "cumulative_time": 0.000647957,
        "time_percent": 0.15134457852239838,
        "time_per_call": 9.256528571428572e-05
      },
      {
        "rank": 24,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 21,
        "primitive_calls": 21,
        "total_time": 0.000331096,
        "cumulative_time": 0.00038285200000000004,
        "time_percent": 0.08942348732471024,
        "time_per_call": 1.823104761904762e-05
      },
      {
        "rank": 25,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 22,
        "primitive_calls": 22,
        "total_time": 0.00025107300000000004,
        "cumulative_time": 0.00025107300000000004,
        "time_percent": 0.05864360962741993,
        "time_per_call": 1.1412409090909092e-05
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1098,
        "function_name": "remove_virtual_loss",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000233517,
        "cumulative_time": 0.000283318,
        "time_percent": 0.06617513708133235,
        "time_per_call": 0.000141659
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'to' of 'torch._C.TensorBase' objects>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00021980300000000002,
        "cumulative_time": 0.00021980300000000002,
        "time_percent": 0.05133981482252486,
        "time_per_call": 0.00021980300000000002
      },
      {
        "rank": 28,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00020585400000000003,
        "cumulative_time": 0.00020585400000000003,
        "time_percent": 0.048081719723916554,
        "time_per_call": 5.1463500000000006e-05
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.000185026,
        "cumulative_time": 0.000185026,
        "time_percent": 0.043216883197010426,
        "time_per_call": 2.312825e-05
      },
      {
        "rank": 30,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 383,
        "function_name": "_profile_phase",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.00018415100000000002,
        "cumulative_time": 0.063974497,
        "time_percent": 14.942647868064457,
        "time_per_call": 0.007996812125
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.00017802800000000002,
        "cumulative_time": 0.00017802800000000002,
        "time_percent": 0.0415823467069351,
        "time_per_call": 2.5432571428571433e-05
      },
      {
        "rank": 32,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 731,
        "function_name": "_add_dirichlet_noise_to_root",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00014333300000000002,
        "cumulative_time": 0.001086175,
        "time_percent": 0.25370001030402645,
        "time_per_call": 0.001086175
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 1496,
        "primitive_calls": 1496,
        "total_time": 0.00013664500000000002,
        "cumulative_time": 0.000337252,
        "time_percent": 0.07877260650912932,
        "time_per_call": 2.2543582887700536e-07
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 1444,
        "primitive_calls": 1444,
        "total_time": 0.00012956100000000002,
        "cumulative_time": 0.00012956100000000002,
        "time_percent": 0.030261815117269296,
        "time_per_call": 8.972368421052633e-08
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 22,
        "primitive_calls": 22,
        "total_time": 0.000125341,
        "cumulative_time": 0.000125341,
        "time_percent": 0.029276141497932635,
        "time_per_call": 5.6973181818181824e-06
      },
      {
        "rank": 36,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 785,
        "function_name": "_extract_policy",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000120933,
        "cumulative_time": 0.0018863010000000002,
        "time_percent": 0.4405869985375243,
        "time_per_call": 0.0018863010000000002
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.000111719,
        "cumulative_time": 0.000111719,
        "time_percent": 0.02609442442622555,
        "time_per_call": 1.3964875e-05
      },
      {
        "rank": 38,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 49,
        "primitive_calls": 49,
        "total_time": 0.000105913,
        "cumulative_time": 0.00020060700000000003,
        "time_percent": 0.046856167714281624,
        "time_per_call": 4.094020408163266e-06
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'split' of 'bytes' objects>",
        "total_calls": 386,
        "primitive_calls": 386,
        "total_time": 0.000103114,
        "cumulative_time": 0.000103114,
        "time_percent": 0.024084537816180068,
        "time_per_call": 2.6713471502590676e-07
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 9.9437e-05,
        "cumulative_time": 9.9437e-05,
        "time_percent": 0.023225693764450002,
        "time_per_call": 1.2429625e-05
      },
      {
        "rank": 41,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 9.855600000000001e-05,
        "cumulative_time": 0.000788109,
        "time_percent": 0.18408015413786546,
        "time_per_call": 5.6293500000000006e-05
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x7333ab978360>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 9.7157e-05,
        "cumulative_time": 9.7157e-05,
        "time_percent": 0.022693149723670956,
        "time_per_call": 5.397611111111111e-06
      },
      {
        "rank": 43,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 87,
        "primitive_calls": 87,
        "total_time": 9.613900000000001e-05,
        "cumulative_time": 0.000754207,
        "time_percent": 0.17616159796659736,
        "time_per_call": 8.669045977011494e-06
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 9.2366e-05,
        "cumulative_time": 9.2366e-05,
        "time_percent": 0.021574106522191827,
        "time_per_call": 9.2366e-06
      },
      {
        "rank": 45,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 8.909e-05,
        "cumulative_time": 0.0039693540000000005,
        "time_percent": 0.9271297449309077,
        "time_per_call": 0.00015877416000000002
      },
      {
        "rank": 46,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 8.875300000000001e-05,
        "cumulative_time": 0.00412399,
        "time_percent": 0.9632483766370079,
        "time_per_call": 0.00017930391304347827
      },
      {
        "rank": 47,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 59,
        "primitive_calls": 59,
        "total_time": 8.7495e-05,
        "cumulative_time": 0.00013856100000000002,
        "time_percent": 0.03236396264666027,
        "time_per_call": 2.348491525423729e-06
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 8.639e-05,
        "cumulative_time": 8.639e-05,
        "time_percent": 0.02017828056267622,
        "time_per_call": 4.3195e-05
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 8.6029e-05,
        "cumulative_time": 8.6029e-05,
        "time_percent": 0.020093961089552873,
        "time_per_call": 8.6029e-06
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method mcts_cuda_kernels.batched_ucb_selection>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 7.620100000000001e-05,
        "cumulative_time": 7.620100000000001e-05,
        "time_percent": 0.017798415987457936,
        "time_per_call": 1.9050250000000003e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -3.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "num_simulations": 10000,
    "wave_size": 3072,
    "total_time_ms": 121.56179000157863,
    "simulations_per_second": 82262.69126071718,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 19.53500747680664,
        "cpu_time_ms": 18.045475000690203,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.102944016456604,
        "cpu_time_ms": 1.3008479982090648,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0585600137710571,
        "cpu_time_ms": 1.249777000339236,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 7.363584041595459,
        "cpu_time_ms": 6.900519998453092,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.226816177368164,
        "cpu_time_ms": 17.688888001430314,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8547520041465759,
        "cpu_time_ms": 1.044066000758903,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0093439817428589,
        "cpu_time_ms": 1.176497000415111,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 7.520415782928467,
        "cpu_time_ms": 7.0313719988917,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 21.27395248413086,
        "cpu_time_ms": 19.53261000016937,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7968959808349609,
        "cpu_time_ms": 0.9891449990391266,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1603519916534424,
        "cpu_time_ms": 1.2880889989901334,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 7.059455871582031,
        "cpu_time_ms": 6.618216997594573,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 18.701791763305664,
        "cpu_time_ms": 17.24300799833145,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8079360127449036,
        "cpu_time_ms": 1.1221709974051919,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.2702080011367798,
        "cpu_time_ms": 1.4094010002736468,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.533120155334473,
        "cpu_time_ms": 6.131801001174608,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      }
    ],
    "peak_gpu_memory_mb": 2384.6103515625,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 186.4,
    "avg_ram_usage_mb": 1216.4453125,
    "final_tree_nodes": 9,
    "final_tree_edges": 8,
    "tree_memory_mb": 52.830238342285156,
    "efficiency_score": 35325.26636721956,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "cprofile_stats": "         43593 function calls (32630 primitive calls) in 0.120 seconds\n\n   Ordered by: cumulative time\n   List reduced from 170 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n       17    0.000    0.000    0.123    0.007 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       16    0.000    0.000    0.116    0.007 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:383(_profile_phase)\n        4    0.000    0.000    0.115    0.029 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:272(_run_search_wave_vectorized)\n        4    0.016    0.004    0.060    0.015 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:294(_select_batch_vectorized)\n        4    0.000    0.000    0.057    0.014 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:358(instrumented_select)\n        4    0.000    0.000    0.028    0.007 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:367(instrumented_backup)\n        8    0.015    0.002    0.028    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n        4    0.000    0.000    0.024    0.006 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:361(instrumented_expand)\n        4    0.016    0.004    0.021    0.005 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:687(_backup_batch_vectorized)\n       11    0.008    0.001    0.017    0.002 {built-in method time.sleep}\n       44    0.017    0.000    0.017    0.000 {built-in method torch.where}\n       68    0.001    0.000    0.011    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        8    0.009    0.001    0.009    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n 10948/68    0.006    0.000    0.008    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       44    0.000    0.000    0.008    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        8    0.000    0.000    0.007    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n        4    0.000    0.000    0.007    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:364(instrumented_evaluate)\n       34    0.000    0.000    0.006    0.000 {built-in method builtins.next}\n       49    0.000    0.000    0.006    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        8    0.001    0.000    0.006    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n       34    0.000    0.000    0.005    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:185(timer)\n       49    0.005    0.000    0.005    0.000 {built-in method torch._C._cuda_synchronize}\n       17    0.000    0.000    0.004    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:167(end_timer)\n       24    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        4    0.003    0.001    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:644(_evaluate_batch_vectorized)\n        6    0.003    0.001    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n        4    0.000    0.000    0.002    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n      8/4    0.000    0.000    0.002    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        4    0.000    0.000    0.002    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        4    0.000    0.000    0.002    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n        4    0.002    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:395(_expand_batch_vectorized)\n        4    0.001    0.000    0.001    0.000 {built-in method torch._unique2}\n      163    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:731(_add_dirichlet_noise_to_root)\n       68    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n       12    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1113(memory_info)\n      115    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n       12    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n       12    0.001    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n      115    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n      115    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n       34    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n    11944    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}\n       36    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:765(open_binary)\n       68    0.001    0.000    0.001    0.000 {built-in method torch._C._cuda_memoryStats}\n       68    0.001    0.000    0.001    0.000 {method 'sort' of 'list' objects}\n       12    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n     8341    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}\n       49    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:490(__init__)\n       12    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1893(memory_info)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 44,
        "primitive_calls": 44,
        "total_time": 0.01704901,
        "cumulative_time": 0.01704901,
        "time_percent": 2.293298097763812,
        "time_per_call": 0.0003874775
      },
      {
        "rank": 2,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 294,
        "function_name": "_select_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.01624238,
        "cumulative_time": 0.059644903000000006,
        "time_percent": 8.02296101598903,
        "time_per_call": 0.014911225750000002
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 687,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.015980538000000002,
        "cumulative_time": 0.020867979000000002,
        "time_percent": 2.806995628771124,
        "time_per_call": 0.0052169947500000004
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.015307448000000001,
        "cumulative_time": 0.028040329000000003,
        "time_percent": 3.7717634722703237,
        "time_per_call": 0.0035050411250000003
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.009243597000000001,
        "cumulative_time": 0.009445339,
        "time_percent": 1.2705123617989753,
        "time_per_call": 0.001180667375
      },
      {
        "rank": 6,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.008342574,
        "cumulative_time": 0.017309044000000003,
        "time_percent": 2.328275816561204,
        "time_per_call": 0.0015735494545454547
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 68,
        "primitive_calls": 10948,
        "total_time": 0.006004808,
        "cumulative_time": 0.007830189000000001,
        "time_percent": 1.0532551472977687,
        "time_per_call": 0.00011514983823529414
      },
      {
        "rank": 8,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 49,
        "primitive_calls": 49,
        "total_time": 0.004581279000000001,
        "cumulative_time": 0.004581279000000001,
        "time_percent": 0.6162374481582978,
        "time_per_call": 9.349548979591838e-05
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.003163756,
        "cumulative_time": 0.003216595,
        "time_percent": 0.4326709407042749,
        "time_per_call": 0.0005360991666666666
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 644,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.003099787,
        "cumulative_time": 0.003222136,
        "time_percent": 0.4334162722372911,
        "time_per_call": 0.000805534
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 395,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0016763050000000001,
        "cumulative_time": 0.0016974680000000002,
        "time_percent": 0.22832998135463253,
        "time_per_call": 0.00042436700000000004
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0014912100000000002,
        "cumulative_time": 0.0014912100000000002,
        "time_percent": 0.20058578511986178,
        "time_per_call": 0.00037280250000000005
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.0014779980000000001,
        "cumulative_time": 0.005938675,
        "time_percent": 0.7988236314447296,
        "time_per_call": 0.000742334375
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 68,
        "primitive_calls": 68,
        "total_time": 0.001221875,
        "cumulative_time": 0.011007068,
        "time_percent": 1.4805838055322234,
        "time_per_call": 0.00016186864705882353
      },
      {
        "rank": 15,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 11944,
        "primitive_calls": 11944,
        "total_time": 0.0008261950000000001,
        "cumulative_time": 0.0008261950000000001,
        "time_percent": 0.11113322250863675,
        "time_per_call": 6.917238780977898e-08
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 68,
        "primitive_calls": 68,
        "total_time": 0.000746627,
        "cumulative_time": 0.000746627,
        "time_percent": 0.10043036392371768,
        "time_per_call": 1.0979808823529412e-05
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 68,
        "primitive_calls": 68,
        "total_time": 0.000731595,
        "cumulative_time": 0.000731595,
        "time_percent": 0.09840837807201218,
        "time_per_call": 1.0758750000000001e-05
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 8341,
        "primitive_calls": 8341,
        "total_time": 0.0006932720000000001,
        "cumulative_time": 0.0006932720000000001,
        "time_percent": 0.09325347095420285,
        "time_per_call": 8.311617312072894e-08
      },
      {
        "rank": 19,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.0006038080000000001,
        "cumulative_time": 0.001062271,
        "time_percent": 0.14288830047079934,
        "time_per_call": 8.852258333333334e-05
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 36,
        "primitive_calls": 36,
        "total_time": 0.0005002040000000001,
        "cumulative_time": 0.0005002040000000001,
        "time_percent": 0.06728348928728707,
        "time_per_call": 1.3894555555555558e-05
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000489452,
        "cumulative_time": 0.000489452,
        "time_percent": 0.06583721521347535,
        "time_per_call": 0.000244726
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 44,
        "primitive_calls": 44,
        "total_time": 0.00047446500000000003,
        "cumulative_time": 0.00053981,
        "time_percent": 0.07261097542636691,
        "time_per_call": 1.2268409090909092e-05
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.00046527900000000003,
        "cumulative_time": 0.00046527900000000003,
        "time_percent": 0.06258565427725415,
        "time_per_call": 5.8159875000000004e-05
      },
      {
        "rank": 24,
        "filename": "/usr/lib/python3.12/contextlib.py",
        "line_number": 141,
        "function_name": "__exit__",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.00043759200000000005,
        "cumulative_time": 0.12270977300000001,
        "time_percent": 16.505948967003317,
        "time_per_call": 0.007218221941176471
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1098,
        "function_name": "remove_virtual_loss",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00037864500000000004,
        "cumulative_time": 0.00046358300000000005,
        "time_percent": 0.062357521759658856,
        "time_per_call": 0.00011589575000000001
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 383,
        "function_name": "_profile_phase",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.000316852,
        "cumulative_time": 0.11552424900000001,
        "time_percent": 15.539409061129824,
        "time_per_call": 0.007220265562500001
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 37,
        "primitive_calls": 37,
        "total_time": 0.00030099500000000003,
        "cumulative_time": 0.00030099500000000003,
        "time_percent": 0.0404874688287718,
        "time_per_call": 8.135000000000001e-06
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 2753,
        "primitive_calls": 2753,
        "total_time": 0.000258532,
        "cumulative_time": 0.0006535110000000001,
        "time_percent": 0.087905135439989,
        "time_per_call": 2.3738140210679262e-07
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'to' of 'torch._C.TensorBase' objects>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000256493,
        "cumulative_time": 0.000256493,
        "time_percent": 0.0345014114596527,
        "time_per_call": 0.000256493
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 2653,
        "primitive_calls": 2653,
        "total_time": 0.000254455,
        "cumulative_time": 0.000254455,
        "time_percent": 0.034227275804664954,
        "time_per_call": 9.591217489634377e-08
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.00025243300000000004,
        "cumulative_time": 0.00025243300000000004,
        "time_percent": 0.033955292343239435,
        "time_per_call": 2.1036083333333337e-05
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.000223338,
        "cumulative_time": 0.000223338,
        "time_percent": 0.03004166286244036,
        "time_per_call": 1.3958625e-05
      },
      {
        "rank": 33,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 93,
        "primitive_calls": 93,
        "total_time": 0.000213491,
        "cumulative_time": 0.000394979,
        "time_percent": 0.053129453813250904,
        "time_per_call": 4.247086021505377e-06
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x7333ab978360>",
        "total_calls": 34,
        "primitive_calls": 34,
        "total_time": 0.00020910000000000001,
        "cumulative_time": 0.00020910000000000001,
        "time_percent": 0.028126479616260018,
        "time_per_call": 6.15e-06
      },
      {
        "rank": 35,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 731,
        "function_name": "_add_dirichlet_noise_to_root",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00020419400000000002,
        "cumulative_time": 0.001253004,
        "time_percent": 0.16854419638972867,
        "time_per_call": 0.001253004
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000185169,
        "cumulative_time": 0.000185169,
        "time_percent": 0.024907470607667386,
        "time_per_call": 4.629225e-05
      },
      {
        "rank": 37,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 163,
        "primitive_calls": 163,
        "total_time": 0.00017579300000000002,
        "cumulative_time": 0.0014240840000000002,
        "time_percent": 0.1915565260537639,
        "time_per_call": 8.736711656441719e-06
      },
      {
        "rank": 38,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 44,
        "primitive_calls": 44,
        "total_time": 0.000174572,
        "cumulative_time": 0.007623985000000001,
        "time_percent": 1.0255182147162705,
        "time_per_call": 0.00017327238636363637
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 20,
        "primitive_calls": 20,
        "total_time": 0.000170662,
        "cumulative_time": 0.000170662,
        "time_percent": 0.022956103607222222,
        "time_per_call": 8.5331e-06
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.000162341,
        "cumulative_time": 0.000162341,
        "time_percent": 0.02183682844277029,
        "time_per_call": 1.01463125e-05
      },
      {
        "rank": 41,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 115,
        "primitive_calls": 115,
        "total_time": 0.000161521,
        "cumulative_time": 0.000258677,
        "time_percent": 0.0347951858808957,
        "time_per_call": 2.2493652173913046e-06
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'scatter_add_' of 'torch._C.TensorBase' objects>",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.000158949,
        "cumulative_time": 0.000158949,
        "time_percent": 0.02138056340757969,
        "time_per_call": 9.9343125e-06
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.000152935,
        "cumulative_time": 0.000152935,
        "time_percent": 0.020571607652380322,
        "time_per_call": 1.2744583333333335e-05
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'long' of 'torch._C.TensorBase' objects>",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.000148986,
        "cumulative_time": 0.000148986,
        "time_percent": 0.02004041937880495,
        "time_per_call": 9.311625e-06
      },
      {
        "rank": 45,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 49,
        "primitive_calls": 49,
        "total_time": 0.000146464,
        "cumulative_time": 0.006278158000000001,
        "time_percent": 0.8444882018874212,
        "time_per_call": 0.00012812567346938777
      },
      {
        "rank": 46,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 0,
        "primitive_calls": 23,
        "total_time": 0.000143907,
        "cumulative_time": 0.0,
        "time_percent": 0.0,
        "time_per_call": 0
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method mcts_cuda_kernels.batched_ucb_selection>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.00013951500000000002,
        "cumulative_time": 0.00013951500000000002,
        "time_percent": 0.01876645530206847,
        "time_per_call": 1.7439375000000003e-05
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'split' of 'bytes' objects>",
        "total_calls": 661,
        "primitive_calls": 661,
        "total_time": 0.000130512,
        "cumulative_time": 0.000130512,
        "time_percent": 0.01755544288702691,
        "time_per_call": 1.97446293494705e-07
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 20,
        "primitive_calls": 20,
        "total_time": 0.000127879,
        "cumulative_time": 0.000127879,
        "time_percent": 0.017201272533944115,
        "time_per_call": 6.393950000000001e-06
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 26,
        "primitive_calls": 26,
        "total_time": 0.000126532,
        "cumulative_time": 0.000126532,
        "time_percent": 0.017020084738424736,
        "time_per_call": 4.866615384615385e-06
      }
    ]
  },
  {
    "config": {
      "num_simulations": 25000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -3.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "num_simulations": 25000,
    "wave_size": 3072,
    "total_time_ms": 276.72867600267637,
    "simulations_per_second": 90341.19759875632,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 21.543487548828125,
        "cpu_time_ms": 19.879170999047346,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.9226559996604919,
        "cpu_time_ms": 1.1049929998989683,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1344000101089478,
        "cpu_time_ms": 1.292679000471253,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 8.171520233154297,
        "cpu_time_ms": 7.616671999130631,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 20.465599060058594,
        "cpu_time_ms": 18.8198320029187,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.9960640072822571,
        "cpu_time_ms": 1.8878560003940947,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1993600130081177,
        "cpu_time_ms": 1.3725770004384685,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 8.626175880432129,
        "cpu_time_ms": 8.1568640016485,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.589920043945312,
        "cpu_time_ms": 18.20634199975757,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.031615972518921,
        "cpu_time_ms": 1.2316979991737753,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.9694080352783203,
        "cpu_time_ms": 2.0560930024657864,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 7.020544052124023,
        "cpu_time_ms": 6.615145997784566,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 18.404319763183594,
        "cpu_time_ms": 16.975774000457022,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.9232640266418457,
        "cpu_time_ms": 1.085518000763841,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.184448003768921,
        "cpu_time_ms": 1.2983680026081856,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 7.925920009613037,
        "cpu_time_ms": 7.449377997545525,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.19615936279297,
        "cpu_time_ms": 17.72816300217528,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.9132159948348999,
        "cpu_time_ms": 1.153424000222003,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1546880006790161,
        "cpu_time_ms": 1.3249590010673273,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 7.691487789154053,
        "cpu_time_ms": 7.216508998681093,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 20.12771224975586,
        "cpu_time_ms": 18.534590002673212,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.9784319996833801,
        "cpu_time_ms": 1.2046839983668178,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1095679998397827,
        "cpu_time_ms": 1.470017999963602,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.955008029937744,
        "cpu_time_ms": 6.550719997903798,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 22.46112060546875,
        "cpu_time_ms": 20.712871999421623,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.9152960181236267,
        "cpu_time_ms": 1.1048399974242784,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.2128959894180298,
        "cpu_time_ms": 1.4550529995176475,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 7.094079971313477,
        "cpu_time_ms": 6.7613920000439975,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 21.135168075561523,
        "cpu_time_ms": 19.37811099924147,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.0748480558395386,
        "cpu_time_ms": 1.234835999639472,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1162879467010498,
        "cpu_time_ms": 1.2939949992869515,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 8.336383819580078,
        "cpu_time_ms": 7.767713999783155,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 17.369535446166992,
        "cpu_time_ms": 16.031868999561993,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8377280235290527,
        "cpu_time_ms": 1.320896997640375,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0713599920272827,
        "cpu_time_ms": 1.2230869979248382,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.713247776031494,
        "cpu_time_ms": 6.3328120013466105,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      }
    ],
    "peak_gpu_memory_mb": 2381.216796875,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 186.1,
    "avg_ram_usage_mb": 1216.6328125,
    "final_tree_nodes": 9,
    "final_tree_edges": 8,
    "tree_memory_mb": 52.830238342285156,
    "efficiency_score": 38849.62782999497,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "cprofile_stats": "         96136 function calls (72101 primitive calls) in 0.275 seconds\n\n   Ordered by: cumulative time\n   List reduced from 170 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        9    0.000    0.000    0.278    0.031 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:272(_run_search_wave_vectorized)\n        1    0.000    0.000    0.274    0.274 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:190(search)\n       36    0.001    0.000    0.262    0.007 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:383(_profile_phase)\n        9    0.000    0.000    0.171    0.019 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:358(instrumented_select)\n        9    0.031    0.003    0.097    0.011 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:294(_select_batch_vectorized)\n        9    0.000    0.000    0.070    0.008 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:367(instrumented_backup)\n       25    0.024    0.001    0.069    0.003 {built-in method time.sleep}\n       18    0.027    0.002    0.053    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n        9    0.040    0.004    0.051    0.006 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:687(_backup_batch_vectorized)\n       99    0.042    0.000    0.042    0.000 {built-in method torch.where}\n      150    0.003    0.000    0.025    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       18    0.019    0.001    0.020    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n24150/150    0.014    0.000    0.018    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       98    0.000    0.000    0.017    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       18    0.000    0.000    0.016    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n       18    0.003    0.000    0.016    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n      109    0.000    0.000    0.015    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        9    0.000    0.000    0.015    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:364(instrumented_evaluate)\n        9    0.000    0.000    0.015    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:361(instrumented_expand)\n       52    0.001    0.000    0.014    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n       26    0.004    0.000    0.012    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n       74    0.000    0.000    0.011    0.000 {built-in method builtins.next}\n       74    0.000    0.000    0.011    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:185(timer)\n      109    0.011    0.000    0.011    0.000 {built-in method torch._C._cuda_synchronize}\n       37    0.000    0.000    0.010    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       37    0.000    0.000    0.010    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:167(end_timer)\n       52    0.000    0.000    0.008    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n       11    0.007    0.001    0.007    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n        9    0.006    0.001    0.006    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:395(_expand_batch_vectorized)\n        9    0.006    0.001    0.006    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:644(_evaluate_batch_vectorized)\n    78/52    0.000    0.000    0.005    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n        9    0.000    0.000    0.005    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n     18/9    0.000    0.000    0.005    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        9    0.000    0.000    0.005    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        9    0.000    0.000    0.005    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n        9    0.005    0.001    0.005    0.001 {built-in method torch._unique2}\n       26    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n      359    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n       26    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n      150    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n       26    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n       26    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:812(bcat)\n      255    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n      255    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n       26    0.001    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n      255    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:785(_extract_policy)\n       78    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:765(open_binary)\n       74    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n    26357    0.002    0.000    0.002    0.000 {built-in method builtins.isinstance}\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 99,
        "primitive_calls": 99,
        "total_time": 0.041770445,
        "cumulative_time": 0.041770445,
        "time_percent": 2.4055439192823425,
        "time_per_call": 0.0004219236868686869
      },
      {
        "rank": 2,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 687,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.039625881,
        "cumulative_time": 0.051455976,
        "time_percent": 2.963329937651805,
        "time_per_call": 0.005717330666666667
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 294,
        "function_name": "_select_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.031364137,
        "cumulative_time": 0.096541813,
        "time_percent": 5.559806011610434,
        "time_per_call": 0.010726868111111112
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.027068358,
        "cumulative_time": 0.052512366000000005,
        "time_percent": 3.0241670328967967,
        "time_per_call": 0.002917353666666667
      },
      {
        "rank": 5,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.023856731000000003,
        "cumulative_time": 0.068732651,
        "time_percent": 3.958287029721743,
        "time_per_call": 0.0027493060400000002
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.019184404000000002,
        "cumulative_time": 0.020348645000000002,
        "time_percent": 1.1718706670562176,
        "time_per_call": 0.0011304802777777779
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 150,
        "primitive_calls": 24150,
        "total_time": 0.013662598000000001,
        "cumulative_time": 0.017751007000000003,
        "time_percent": 1.0222736901650988,
        "time_per_call": 0.00011834004666666669
      },
      {
        "rank": 8,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 109,
        "primitive_calls": 109,
        "total_time": 0.010814325000000001,
        "cumulative_time": 0.010849842,
        "time_percent": 0.6248382426443906,
        "time_per_call": 9.953983486238532e-05
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.006690357,
        "cumulative_time": 0.006779243000000001,
        "time_percent": 0.39041400626656925,
        "time_per_call": 0.0006162948181818183
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 395,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.006049654000000001,
        "cumulative_time": 0.006130497,
        "time_percent": 0.35305297275450725,
        "time_per_call": 0.0006811663333333334
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 644,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.005792237,
        "cumulative_time": 0.006056266,
        "time_percent": 0.3487780379130841,
        "time_per_call": 0.0006729184444444445
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.00476073,
        "cumulative_time": 0.00476073,
        "time_percent": 0.2741686161793351,
        "time_per_call": 0.00052897
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 26,
        "primitive_calls": 26,
        "total_time": 0.004197608,
        "cumulative_time": 0.011996116000000001,
        "time_percent": 0.6908517230018886,
        "time_per_call": 0.00046138907692307694
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.003173206,
        "cumulative_time": 0.015620427000000001,
        "time_percent": 0.8995744044968572,
        "time_per_call": 0.0008678015
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 150,
        "primitive_calls": 150,
        "total_time": 0.002528058,
        "cumulative_time": 0.024781340000000002,
        "time_percent": 1.4271478733029606,
        "time_per_call": 0.00016520893333333336
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 26357,
        "primitive_calls": 26357,
        "total_time": 0.0018531950000000002,
        "cumulative_time": 0.0018531950000000002,
        "time_percent": 0.10672478982434688,
        "time_per_call": 7.031130250028456e-08
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 150,
        "primitive_calls": 150,
        "total_time": 0.0017602940000000001,
        "cumulative_time": 0.0017602940000000001,
        "time_percent": 0.10137465683808713,
        "time_per_call": 1.1735293333333335e-05
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 150,
        "primitive_calls": 150,
        "total_time": 0.001652632,
        "cumulative_time": 0.001652632,
        "time_percent": 0.09517444351889036,
        "time_per_call": 1.1017546666666666e-05
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 78,
        "primitive_calls": 78,
        "total_time": 0.001607345,
        "cumulative_time": 0.0016330160000000002,
        "time_percent": 0.09404476559660244,
        "time_per_call": 2.0936102564102567e-05
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 18399,
        "primitive_calls": 18399,
        "total_time": 0.001595798,
        "cumulative_time": 0.001595798,
        "time_percent": 0.09190139524017338,
        "time_per_call": 8.67328659166259e-08
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 52,
        "primitive_calls": 52,
        "total_time": 0.001357223,
        "cumulative_time": 0.013691776000000001,
        "time_percent": 0.788504132550561,
        "time_per_call": 0.0002633033846153846
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 26,
        "primitive_calls": 26,
        "total_time": 0.0013437260000000002,
        "cumulative_time": 0.002146303,
        "time_percent": 0.12360476721249797,
        "time_per_call": 8.255011538461538e-05
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 99,
        "primitive_calls": 99,
        "total_time": 0.00108806,
        "cumulative_time": 0.0011187900000000001,
        "time_percent": 0.0644306873305729,
        "time_per_call": 1.1300909090909092e-05
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.001036739,
        "cumulative_time": 0.001036739,
        "time_percent": 0.059705401686116974,
        "time_per_call": 5.759661111111111e-05
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 383,
        "function_name": "_profile_phase",
        "total_calls": 36,
        "primitive_calls": 36,
        "total_time": 0.000809345,
        "cumulative_time": 0.26213122,
        "time_percent": 15.09603649961263,
        "time_per_call": 0.007281422777777778
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1098,
        "function_name": "remove_virtual_loss",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.000802181,
        "cumulative_time": 0.000999083,
        "time_percent": 0.05753680707754874,
        "time_per_call": 0.00011100922222222223
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 26,
        "primitive_calls": 26,
        "total_time": 0.000733772,
        "cumulative_time": 0.000733772,
        "time_percent": 0.04225764826636736,
        "time_per_call": 2.8222000000000002e-05
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 0.000678214,
        "cumulative_time": 0.000835628,
        "time_percent": 0.048123496270678114,
        "time_per_call": 3.0949185185185184e-05
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 6071,
        "primitive_calls": 6071,
        "total_time": 0.000566224,
        "cumulative_time": 0.0014013810000000002,
        "time_percent": 0.08070499471929994,
        "time_per_call": 2.3083198814033935e-07
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 5851,
        "primitive_calls": 5851,
        "total_time": 0.000553745,
        "cumulative_time": 0.000553745,
        "time_percent": 0.031889962330614405,
        "time_per_call": 9.46410869936763e-08
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 36,
        "primitive_calls": 36,
        "total_time": 0.000543994,
        "cumulative_time": 0.000543994,
        "time_percent": 0.03132840597762553,
        "time_per_call": 1.5110944444444445e-05
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x7333ab978360>",
        "total_calls": 74,
        "primitive_calls": 74,
        "total_time": 0.000536972,
        "cumulative_time": 0.000536972,
        "time_percent": 0.030924011688764103,
        "time_per_call": 7.256378378378379e-06
      },
      {
        "rank": 33,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 190,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000492073,
        "cumulative_time": 0.273564403,
        "time_percent": 15.754469126885152,
        "time_per_call": 0.273564403
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 79,
        "primitive_calls": 79,
        "total_time": 0.00045811100000000003,
        "cumulative_time": 0.00045811100000000003,
        "time_percent": 0.026382436921760188,
        "time_per_call": 5.79887341772152e-06
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 45,
        "primitive_calls": 45,
        "total_time": 0.00045562,
        "cumulative_time": 0.00045562,
        "time_percent": 0.026238981186420707,
        "time_per_call": 1.012488888888889e-05
      },
      {
        "rank": 36,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 203,
        "primitive_calls": 203,
        "total_time": 0.00043594900000000004,
        "cumulative_time": 0.000835157,
        "time_percent": 0.048096371561185985,
        "time_per_call": 4.1140738916256155e-06
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 36,
        "primitive_calls": 36,
        "total_time": 0.00042011200000000005,
        "cumulative_time": 0.00042011200000000005,
        "time_percent": 0.02419408907464461,
        "time_per_call": 1.1669777777777778e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.00040145800000000004,
        "cumulative_time": 0.00040145800000000004,
        "time_percent": 0.023119812363676055,
        "time_per_call": 4.460644444444445e-05
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 359,
        "primitive_calls": 359,
        "total_time": 0.000395197,
        "cumulative_time": 0.003164524,
        "time_percent": 0.18224372437552522,
        "time_per_call": 8.81483008356546e-06
      },
      {
        "rank": 40,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 98,
        "primitive_calls": 98,
        "total_time": 0.00038639800000000004,
        "cumulative_time": 0.017051111,
        "time_percent": 0.9819669477559615,
        "time_per_call": 0.00017399092857142858
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method mcts_cuda_kernels.batched_ucb_selection>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.00038452800000000003,
        "cumulative_time": 0.00038452800000000003,
        "time_percent": 0.022144820151995044,
        "time_per_call": 2.1362666666666668e-05
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'scatter_add_' of 'torch._C.TensorBase' objects>",
        "total_calls": 36,
        "primitive_calls": 36,
        "total_time": 0.000381801,
        "cumulative_time": 0.000381801,
        "time_percent": 0.02198777326710112,
        "time_per_call": 1.0605583333333334e-05
      },
      {
        "rank": 43,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 109,
        "primitive_calls": 109,
        "total_time": 0.000368383,
        "cumulative_time": 0.015319643,
        "time_percent": 0.8822523692104862,
        "time_per_call": 0.00014054718348623853
      },
      {
        "rank": 44,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 255,
        "primitive_calls": 255,
        "total_time": 0.000364426,
        "cumulative_time": 0.000577936,
        "time_percent": 0.033283112749561555,
        "time_per_call": 2.2664156862745098e-06
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'split' of 'bytes' objects>",
        "total_calls": 1431,
        "primitive_calls": 1431,
        "total_time": 0.000322867,
        "cumulative_time": 0.000322867,
        "time_percent": 0.01859378679319629,
        "time_per_call": 2.2562334032145353e-07
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 45,
        "primitive_calls": 45,
        "total_time": 0.00030766100000000003,
        "cumulative_time": 0.00030766100000000003,
        "time_percent": 0.017718079080802824,
        "time_per_call": 6.836911111111112e-06
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'to' of 'torch._C.TensorBase' objects>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000279368,
        "cumulative_time": 0.000279368,
        "time_percent": 0.016088696053922085,
        "time_per_call": 0.000279368
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method __new__ of type object at 0xa43b40>",
        "total_calls": 244,
        "primitive_calls": 244,
        "total_time": 0.000264929,
        "cumulative_time": 0.000264929,
        "time_percent": 0.015257159577580554,
        "time_per_call": 1.0857745901639345e-06
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full_like>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.00025725300000000004,
        "cumulative_time": 0.000330159,
        "time_percent": 0.019013730278581876,
        "time_per_call": 1.834216666666667e-05
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000255086,
        "cumulative_time": 0.000255086,
        "time_percent": 0.014690304979850122,
        "time_per_call": 0.000127543
      }
    ]
  },
  {
    "config": {
      "num_simulations": 50000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -3.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "num_simulations": 50000,
    "wave_size": 3072,
    "total_time_ms": 490.88346999997157,
    "simulations_per_second": 101857.16785289775,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 25.004575729370117,
        "cpu_time_ms": 23.056771002302412,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.9122239947319031,
        "cpu_time_ms": 1.0933529993053526,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1221760511398315,
        "cpu_time_ms": 1.2801910015696194,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.600704193115234,
        "cpu_time_ms": 6.24582599994028,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 20.255840301513672,
        "cpu_time_ms": 19.10446300098556,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8501759767532349,
        "cpu_time_ms": 1.0350499978812877,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.138592004776001,
        "cpu_time_ms": 1.30308400184731,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.149119853973389,
        "cpu_time_ms": 5.8013970010506455,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 20.46659278869629,
        "cpu_time_ms": 18.796602002112195,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8948799967765808,
        "cpu_time_ms": 1.0807210019265767,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0984959602355957,
        "cpu_time_ms": 1.2731030001305044,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.622432231903076,
        "cpu_time_ms": 6.393349998688791,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 20.856992721557617,
        "cpu_time_ms": 19.18885199847864,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8979840278625488,
        "cpu_time_ms": 1.0504420024517458,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.2632960081100464,
        "cpu_time_ms": 1.3488350014085881,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 7.371776103973389,
        "cpu_time_ms": 6.902485001774039,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.442720413208008,
        "cpu_time_ms": 17.94635400074185,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.9207680225372314,
        "cpu_time_ms": 1.070728998456616,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0026240348815918,
        "cpu_time_ms": 1.1746670024876948,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 5.58896017074585,
        "cpu_time_ms": 5.315533999237232,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 17.168672561645508,
        "cpu_time_ms": 15.803793998202309,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.9074559807777405,
        "cpu_time_ms": 1.1120620001747739,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0947840213775635,
        "cpu_time_ms": 1.2660969987337012,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.597760200500488,
        "cpu_time_ms": 6.206106998433825,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 16.748640060424805,
        "cpu_time_ms": 15.494081999349874,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8013120293617249,
        "cpu_time_ms": 0.9544209970044903,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.7697279453277588,
        "cpu_time_ms": 1.8155550023948308,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.414048194885254,
        "cpu_time_ms": 6.0306330015009735,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.231487274169922,
        "cpu_time_ms": 17.659643999650143,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7716799974441528,
        "cpu_time_ms": 0.9247560010408051,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9120320081710815,
        "cpu_time_ms": 1.0258799993607681,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.260992050170898,
        "cpu_time_ms": 5.906352002057247,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 18.503583908081055,
        "cpu_time_ms": 16.997585000353865,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7724480032920837,
        "cpu_time_ms": 0.9471630000916775,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.648192048072815,
        "cpu_time_ms": 1.7153510016214568,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.271999835968018,
        "cpu_time_ms": 5.919724000705173,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 18.931360244750977,
        "cpu_time_ms": 17.48836299884715,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.9079999923706055,
        "cpu_time_ms": 1.1980470007983968,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.2892800569534302,
        "cpu_time_ms": 1.4997859980212525,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 8.415072441101074,
        "cpu_time_ms": 7.829325000784593,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 20.429311752319336,
        "cpu_time_ms": 18.766910001431825,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8891839981079102,
        "cpu_time_ms": 1.0377190010331105,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1919360160827637,
        "cpu_time_ms": 1.3065729981462937,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 7.1221442222595215,
        "cpu_time_ms": 6.647001999226632,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.977439880371094,
        "cpu_time_ms": 18.481580998923164,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.9737920165061951,
        "cpu_time_ms": 1.1140470014652237,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0867840051651,
        "cpu_time_ms": 1.4744310028618202,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.129663944244385,
        "cpu_time_ms": 5.750596003053943,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 18.971359252929688,
        "cpu_time_ms": 17.48129100087681,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.0800319910049438,
        "cpu_time_ms": 1.2876649998361245,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.229599952697754,
        "cpu_time_ms": 1.3561390005634166,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 7.627871990203857,
        "cpu_time_ms": 7.170177999796579,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.168960571289062,
        "cpu_time_ms": 17.756962002749788,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.3635519742965698,
        "cpu_time_ms": 1.8043290001514833,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0973119735717773,
        "cpu_time_ms": 1.3169160010875203,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.177567958831787,
        "cpu_time_ms": 5.803586998808896,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.346271514892578,
        "cpu_time_ms": 17.867690999992192,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8339840173721313,
        "cpu_time_ms": 1.0248239996144548,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1132160425186157,
        "cpu_time_ms": 1.272508001420647,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 7.609344005584717,
        "cpu_time_ms": 7.094732998666586,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.83148765563965,
        "cpu_time_ms": 18.2719240001461,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8417919874191284,
        "cpu_time_ms": 1.0793950023071375,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.073855996131897,
        "cpu_time_ms": 1.2447270019038115,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 7.61030387878418,
        "cpu_time_ms": 7.093406999047147,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 18.236896514892578,
        "cpu_time_ms": 16.83792499898118,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.924992024898529,
        "cpu_time_ms": 1.1214139994990546,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.067296028137207,
        "cpu_time_ms": 1.237577002029866,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "backup",
        "gpu_time_ms": 7.678847789764404,
        "cpu_time_ms": 7.181474000390153,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      }
    ],
    "peak_gpu_memory_mb": 2383.9345703125,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 187.7,
    "avg_ram_usage_mb": 1216.6328125,
    "final_tree_nodes": 9,
    "final_tree_edges": 8,
    "tree_memory_mb": 52.830238342285156,
    "efficiency_score": 43751.93060256466,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "cprofile_stats": "         174364 function calls (130677 primitive calls) in 0.489 seconds\n\n   Ordered by: cumulative time\n   List reduced from 170 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.488    0.488 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:190(search)\n       68    0.001    0.000    0.485    0.007 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:383(_profile_phase)\n       17    0.000    0.000    0.484    0.028 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:272(_run_search_wave_vectorized)\n       17    0.000    0.000    0.296    0.017 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:358(instrumented_select)\n       17    0.058    0.003    0.197    0.012 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:294(_select_batch_vectorized)\n       44    0.057    0.001    0.133    0.003 {built-in method time.sleep}\n       17    0.000    0.000    0.116    0.007 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:367(instrumented_backup)\n       34    0.048    0.001    0.095    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n      187    0.074    0.000    0.074    0.000 {built-in method torch.where}\n       17    0.050    0.003    0.066    0.004 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:687(_backup_batch_vectorized)\n      271    0.004    0.000    0.046    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       17    0.000    0.000    0.044    0.003 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:361(instrumented_expand)\n       34    0.036    0.001    0.036    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n43631/271    0.026    0.000    0.034    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n      181    0.001    0.000    0.032    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       34    0.000    0.000    0.030    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n       17    0.000    0.000    0.029    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:364(instrumented_evaluate)\n       34    0.006    0.000    0.028    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n      205    0.001    0.000    0.025    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n      205    0.019    0.000    0.019    0.000 {built-in method torch._C._cuda_synchronize}\n      138    0.000    0.000    0.019    0.000 {built-in method builtins.next}\n      138    0.000    0.000    0.018    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:185(timer)\n       69    0.000    0.000    0.017    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       69    0.000    0.000    0.016    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:167(end_timer)\n       90    0.000    0.000    0.015    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n       45    0.007    0.000    0.015    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n       17    0.012    0.001    0.012    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:395(_expand_batch_vectorized)\n       17    0.011    0.001    0.012    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:644(_evaluate_batch_vectorized)\n       19    0.011    0.001    0.011    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n       17    0.000    0.000    0.009    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n    34/17    0.000    0.000    0.009    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n       17    0.000    0.000    0.009    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n       17    0.000    0.000    0.009    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n       17    0.009    0.001    0.009    0.001 {built-in method torch._unique2}\n      659    0.001    0.000    0.006    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n      271    0.000    0.000    0.005    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n      479    0.000    0.000    0.005    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n      479    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n       45    0.002    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n      479    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n       45    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n    47762    0.003    0.000    0.003    0.000 {built-in method builtins.isinstance}\n      138    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n      135    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:765(open_binary)\n      271    0.003    0.000    0.003    0.000 {method 'sort' of 'list' objects}\n      271    0.003    0.000    0.003    0.000 {built-in method torch._C._cuda_memoryStats}\n    33244    0.003    0.000    0.003    0.000 {method 'append' of 'list' objects}\n       45    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:812(bcat)\n      205    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:490(__init__)\n      135    0.003    0.000    0.003    0.000 {built-in method _io.open}\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 187,
        "primitive_calls": 187,
        "total_time": 0.07412054600000001,
        "cumulative_time": 0.07412821,
        "time_percent": 2.42573563157481,
        "time_per_call": 0.0003964075401069519
      },
      {
        "rank": 2,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 294,
        "function_name": "_select_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.058415973,
        "cumulative_time": 0.19677623300000002,
        "time_percent": 6.4392101176484235,
        "time_per_call": 0.011575072529411767
      },
      {
        "rank": 3,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 44,
        "primitive_calls": 44,
        "total_time": 0.056724742,
        "cumulative_time": 0.13252133600000002,
        "time_percent": 4.336563997418765,
        "time_per_call": 0.003011848545454546
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 687,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.049871976000000005,
        "cumulative_time": 0.06615269600000001,
        "time_percent": 2.164748775289953,
        "time_per_call": 0.00389133505882353
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 34,
        "primitive_calls": 34,
        "total_time": 0.048155076000000005,
        "cumulative_time": 0.095476737,
        "time_percent": 3.1243344865254006,
        "time_per_call": 0.002808139323529412
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 34,
        "primitive_calls": 34,
        "total_time": 0.035540946000000004,
        "cumulative_time": 0.036221809,
        "time_percent": 1.185304929545677,
        "time_per_call": 0.0010653473235294117
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 271,
        "primitive_calls": 43631,
        "total_time": 0.026105189,
        "cumulative_time": 0.033544396000000004,
        "time_percent": 1.097690563644469,
        "time_per_call": 0.00012378005904059043
      },
      {
        "rank": 8,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 205,
        "primitive_calls": 205,
        "total_time": 0.019010507000000003,
        "cumulative_time": 0.019010507000000003,
        "time_percent": 0.6220906211576182,
        "time_per_call": 9.273418048780489e-05
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 395,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.012279162000000001,
        "cumulative_time": 0.012454693000000001,
        "time_percent": 0.40756133987891213,
        "time_per_call": 0.000732629
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 644,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.011242608000000001,
        "cumulative_time": 0.01184488,
        "time_percent": 0.3876061146994894,
        "time_per_call": 0.0006967576470588235
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.010939624,
        "cumulative_time": 0.011105163000000001,
        "time_percent": 0.3633999739579064,
        "time_per_call": 0.0005844822631578948
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.008623022000000001,
        "cumulative_time": 0.008623022000000001,
        "time_percent": 0.2821755943824016,
        "time_per_call": 0.0005072365882352941
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 45,
        "primitive_calls": 45,
        "total_time": 0.006701935,
        "cumulative_time": 0.014639528,
        "time_percent": 0.47905682194453525,
        "time_per_call": 0.00032532284444444445
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 34,
        "primitive_calls": 34,
        "total_time": 0.005771206,
        "cumulative_time": 0.027685534,
        "time_percent": 0.905968001965458,
        "time_per_call": 0.0008142804117647059
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 271,
        "primitive_calls": 271,
        "total_time": 0.004397952,
        "cumulative_time": 0.045761430000000006,
        "time_percent": 1.4974748655446621,
        "time_per_call": 0.00016886136531365316
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 47762,
        "primitive_calls": 47762,
        "total_time": 0.0032677300000000004,
        "cumulative_time": 0.0032677300000000004,
        "time_percent": 0.10693161342174531,
        "time_per_call": 6.841694233909803e-08
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 271,
        "primitive_calls": 271,
        "total_time": 0.002970131,
        "cumulative_time": 0.002970131,
        "time_percent": 0.09719312792181171,
        "time_per_call": 1.095989298892989e-05
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 271,
        "primitive_calls": 271,
        "total_time": 0.002953864,
        "cumulative_time": 0.002953864,
        "time_percent": 0.09666081449459114,
        "time_per_call": 1.0899867158671587e-05
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 33244,
        "primitive_calls": 33244,
        "total_time": 0.0029089190000000003,
        "cumulative_time": 0.0029089190000000003,
        "time_percent": 0.09519005608883535,
        "time_per_call": 8.750207556250753e-08
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 135,
        "primitive_calls": 135,
        "total_time": 0.0025630310000000003,
        "cumulative_time": 0.0027303550000000003,
        "time_percent": 0.08934681426070375,
        "time_per_call": 2.0224851851851853e-05
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 1642,
        "function_name": "wrapper",
        "total_calls": 0,
        "primitive_calls": 133,
        "total_time": 0.002493878,
        "cumulative_time": 0.0,
        "time_percent": 0.0,
        "time_per_call": 0
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 45,
        "primitive_calls": 45,
        "total_time": 0.002368266,
        "cumulative_time": 0.0039878150000000005,
        "time_percent": 0.13049532610632988,
        "time_per_call": 8.861811111111113e-05
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 187,
        "primitive_calls": 187,
        "total_time": 0.0021156400000000002,
        "cumulative_time": 0.0021452520000000003,
        "time_percent": 0.0702001871501703,
        "time_per_call": 1.1471935828877006e-05
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 34,
        "primitive_calls": 34,
        "total_time": 0.0018876700000000001,
        "cumulative_time": 0.0018876700000000001,
        "time_percent": 0.06177119857143215,
        "time_per_call": 5.5519705882352944e-05
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 0,
        "primitive_calls": 44,
        "total_time": 0.0016091830000000001,
        "cumulative_time": 0.0,
        "time_percent": 0.0,
        "time_per_call": 0
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1098,
        "function_name": "remove_virtual_loss",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.001476855,
        "cumulative_time": 0.001838711,
        "time_percent": 0.060169087974315735,
        "time_per_call": 0.0001081594705882353
      },
      {
        "rank": 27,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 383,
        "function_name": "_profile_phase",
        "total_calls": 68,
        "primitive_calls": 68,
        "total_time": 0.001460803,
        "cumulative_time": 0.484619713,
        "time_percent": 15.858460707302365,
        "time_per_call": 0.007126760485294118
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 45,
        "primitive_calls": 45,
        "total_time": 0.001137419,
        "cumulative_time": 0.001137419,
        "time_percent": 0.03722034831719515,
        "time_per_call": 2.527597777777778e-05
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 10570,
        "primitive_calls": 10570,
        "total_time": 0.001057538,
        "cumulative_time": 0.001057538,
        "time_percent": 0.034606361172681246,
        "time_per_call": 1.0005089877010407e-07
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 68,
        "primitive_calls": 68,
        "total_time": 0.001046101,
        "cumulative_time": 0.001046101,
        "time_percent": 0.0342321023254985,
        "time_per_call": 1.538383823529412e-05
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 10982,
        "primitive_calls": 10982,
        "total_time": 0.001037304,
        "cumulative_time": 0.0026613630000000004,
        "time_percent": 0.08708915347685899,
        "time_per_call": 2.4233864505554545e-07
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 135,
        "primitive_calls": 135,
        "total_time": 0.000823225,
        "cumulative_time": 0.000937551,
        "time_percent": 0.030679964714089212,
        "time_per_call": 6.944822222222222e-06
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x7333ab978360>",
        "total_calls": 138,
        "primitive_calls": 138,
        "total_time": 0.000822536,
        "cumulative_time": 0.000822536,
        "time_percent": 0.026916269574741088,
        "time_per_call": 5.9604057971014494e-06
      },
      {
        "rank": 34,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 379,
        "primitive_calls": 379,
        "total_time": 0.000818378,
        "cumulative_time": 0.0016240590000000002,
        "time_percent": 0.053144919917528774,
        "time_per_call": 4.285116094986808e-06
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 45,
        "primitive_calls": 45,
        "total_time": 0.000775507,
        "cumulative_time": 0.000775507,
        "time_percent": 0.02537731536260874,
        "time_per_call": 1.723348888888889e-05
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 85,
        "primitive_calls": 85,
        "total_time": 0.0007725750000000001,
        "cumulative_time": 0.000802917,
        "time_percent": 0.026274266923444554,
        "time_per_call": 9.446082352941177e-06
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000757026,
        "cumulative_time": 0.000757026,
        "time_percent": 0.024772552071991923,
        "time_per_call": 0.000378513
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'scatter_add_' of 'torch._C.TensorBase' objects>",
        "total_calls": 68,
        "primitive_calls": 68,
        "total_time": 0.000753796,
        "cumulative_time": 0.000753796,
        "time_percent": 0.024666855116811343,
        "time_per_call": 1.1085235294117648e-05
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 181,
        "primitive_calls": 181,
        "total_time": 0.000743836,
        "cumulative_time": 0.032189912,
        "time_percent": 1.0533670854274988,
        "time_per_call": 0.00017784481767955801
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.000726215,
        "cumulative_time": 0.000726215,
        "time_percent": 0.023764307834818903,
        "time_per_call": 4.2718529411764705e-05
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 68,
        "primitive_calls": 68,
        "total_time": 0.000709918,
        "cumulative_time": 0.000709918,
        "time_percent": 0.023231012702132244,
        "time_per_call": 1.0439970588235294e-05
      },
      {
        "rank": 42,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 659,
        "primitive_calls": 659,
        "total_time": 0.000699136,
        "cumulative_time": 0.005661867,
        "time_percent": 0.18527619273603904,
        "time_per_call": 8.591603945371776e-06
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method mcts_cuda_kernels.batched_ucb_selection>",
        "total_calls": 34,
        "primitive_calls": 34,
        "total_time": 0.000637462,
        "cumulative_time": 0.000637462,
        "time_percent": 0.020859997660471523,
        "time_per_call": 1.8748882352941177e-05
      },
      {
        "rank": 44,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 479,
        "primitive_calls": 479,
        "total_time": 0.000625281,
        "cumulative_time": 0.001012344,
        "time_percent": 0.033127454611557056,
        "time_per_call": 2.113453027139875e-06
      },
      {
        "rank": 45,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 205,
        "primitive_calls": 205,
        "total_time": 0.000606919,
        "cumulative_time": 0.025372802,
        "time_percent": 0.8302872804333548,
        "time_per_call": 0.00012376976585365854
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'split' of 'bytes' objects>",
        "total_calls": 2476,
        "primitive_calls": 2476,
        "total_time": 0.000571421,
        "cumulative_time": 0.000571421,
        "time_percent": 0.018698903970972854,
        "time_per_call": 2.3078392568659128e-07
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 85,
        "primitive_calls": 85,
        "total_time": 0.0005461940000000001,
        "cumulative_time": 0.000584912,
        "time_percent": 0.01914037691906611,
        "time_per_call": 6.881317647058824e-06
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._get_tracing_state>",
        "total_calls": 379,
        "primitive_calls": 379,
        "total_time": 0.000536902,
        "cumulative_time": 0.000536902,
        "time_percent": 0.017569320938193148,
        "time_per_call": 1.4166279683377308e-06
      },
      {
        "rank": 49,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 812,
        "function_name": "_get_device_index",
        "total_calls": 479,
        "primitive_calls": 479,
        "total_time": 0.000439273,
        "cumulative_time": 0.004694883,
        "time_percent": 0.1536330767891851,
        "time_per_call": 9.801425887265136e-06
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'long' of 'torch._C.TensorBase' objects>",
        "total_calls": 68,
        "primitive_calls": 68,
        "total_time": 0.000435745,
        "cumulative_time": 0.000435745,
        "time_percent": 0.014259108277139915,
        "time_per_call": 6.408014705882353e-06
      }
    ]
  },
  {
    "config": {
      "num_simulations": 100000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -3.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "num_simulations": 100000,
    "wave_size": 3072,
    "total_time_ms": 1007.6053369994042,
    "simulations_per_second": 99245.20675703719,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 19.450847625732422,
        "cpu_time_ms": 17.94310499826679,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.1075199842453003,
        "cpu_time_ms": 1.6323260024364572,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.4695680141448975,
        "cpu_time_ms": 1.5998550006770529,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.9416961669921875,
        "cpu_time_ms": 6.51495100100874,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.511232376098633,
        "cpu_time_ms": 17.931401998794172,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.9065600037574768,
        "cpu_time_ms": 1.1076360024162568,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.20307195186615,
        "cpu_time_ms": 1.3496920000761747,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.918047904968262,
        "cpu_time_ms": 6.4978010013874155,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 20.912128448486328,
        "cpu_time_ms": 19.178489998012083,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8984320163726807,
        "cpu_time_ms": 1.1175809995620511,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0359679460525513,
        "cpu_time_ms": 1.2000579990854021,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 7.3297600746154785,
        "cpu_time_ms": 6.893489000503905,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.10598373413086,
        "cpu_time_ms": 17.55510799921467,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.6134079694747925,
        "cpu_time_ms": 1.700512999377679,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.05731201171875,
        "cpu_time_ms": 1.1853970027004834,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 10.490880012512207,
        "cpu_time_ms": 9.691135997854872,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.092384338378906,
        "cpu_time_ms": 17.64271900174208,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8672959804534912,
        "cpu_time_ms": 1.4643319991591852,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1111680269241333,
        "cpu_time_ms": 1.2528970000857953,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.38259220123291,
        "cpu_time_ms": 6.0287289998086635,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.83977508544922,
        "cpu_time_ms": 18.201779999799328,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8992000222206116,
        "cpu_time_ms": 1.088646000425797,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1280319690704346,
        "cpu_time_ms": 1.2952760007465258,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 7.069568157196045,
        "cpu_time_ms": 6.609954001760343,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.85500717163086,
        "cpu_time_ms": 18.22019300016109,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.0096640586853027,
        "cpu_time_ms": 1.202275998366531,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0853439569473267,
        "cpu_time_ms": 1.374082999973325,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 7.397535800933838,
        "cpu_time_ms": 6.9332060011220165,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 17.93609619140625,
        "cpu_time_ms": 16.530901000805898,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.9207680225372314,
        "cpu_time_ms": 1.1076089976995718,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.8129279613494873,
        "cpu_time_ms": 1.8903870004578494,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.599711894989014,
        "cpu_time_ms": 6.230226998013677,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 21.19513511657715,
        "cpu_time_ms": 19.457699003396556,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 2.9742720127105713,
        "cpu_time_ms": 2.9918489999545272,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0012160539627075,
        "cpu_time_ms": 1.19434099906357,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.4049601554870605,
        "cpu_time_ms": 6.200331001309678,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.88924789428711,
        "cpu_time_ms": 18.23467500071274,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.9210879802703857,
        "cpu_time_ms": 1.1117739995825104,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0217920541763306,
        "cpu_time_ms": 1.17675900037284,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.661312103271484,
        "cpu_time_ms": 6.2491190001310315,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 16.618751525878906,
        "cpu_time_ms": 15.273233999323566,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7617599964141846,
        "cpu_time_ms": 0.9097440015466418,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.042240023612976,
        "cpu_time_ms": 1.1817269987659529,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 7.160831928253174,
        "cpu_time_ms": 6.708147000608733,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 16.320383071899414,
        "cpu_time_ms": 15.085684000951005,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.1758400201797485,
        "cpu_time_ms": 1.3191159996495117,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1011199951171875,
        "cpu_time_ms": 1.2415980017976835,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 5.709824085235596,
        "cpu_time_ms": 5.405061998317251,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 17.558528900146484,
        "cpu_time_ms": 16.155739001987968,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.061344027519226,
        "cpu_time_ms": 1.2347090014372952,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0034559965133667,
        "cpu_time_ms": 1.1774619997595437,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.322175979614258,
        "cpu_time_ms": 5.924871999013703,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 16.630367279052734,
        "cpu_time_ms": 15.317860998038668,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7927680015563965,
        "cpu_time_ms": 0.9680820003268309,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0333119630813599,
        "cpu_time_ms": 1.1963879987888504,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.9734721183776855,
        "cpu_time_ms": 6.530774997372646,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 16.9769287109375,
        "cpu_time_ms": 16.973418998531997,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8048639893531799,
        "cpu_time_ms": 1.0028150027210359,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0365439653396606,
        "cpu_time_ms": 1.1812400007329416,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.128640174865723,
        "cpu_time_ms": 5.781965002825018,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 17.023040771484375,
        "cpu_time_ms": 16.853060998982983,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8459200263023376,
        "cpu_time_ms": 1.07159500112175,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9702079892158508,
        "cpu_time_ms": 1.1284190004516859,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.114304065704346,
        "cpu_time_ms": 5.7345179993717466,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 16.17296028137207,
        "cpu_time_ms": 14.909487999830162,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7565119862556458,
        "cpu_time_ms": 0.9440610010642558,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.3186880350112915,
        "cpu_time_ms": 1.4929419994587079,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 5.453824043273926,
        "cpu_time_ms": 5.1549800009524915,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 20.43961524963379,
        "cpu_time_ms": 18.7887319989386,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.9456959962844849,
        "cpu_time_ms": 1.091999998607207,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.125440001487732,
        "cpu_time_ms": 1.278756000829162,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 7.1741437911987305,
        "cpu_time_ms": 6.740704000549158,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 94.2034912109375,
        "cpu_time_ms": 85.16592699743342,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8336640000343323,
        "cpu_time_ms": 1.0053219994006213,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1564799547195435,
        "cpu_time_ms": 1.3291159993968904,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.331424236297607,
        "cpu_time_ms": 5.922551998082781,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 17.634559631347656,
        "cpu_time_ms": 16.321753999363864,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.2514560222625732,
        "cpu_time_ms": 1.345264998235507,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.04585599899292,
        "cpu_time_ms": 1.1888499975611921,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.025023937225342,
        "cpu_time_ms": 5.670978000125615,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 16.7524471282959,
        "cpu_time_ms": 15.429216000484303,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.1476800441741943,
        "cpu_time_ms": 1.491187998908572,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0090559720993042,
        "cpu_time_ms": 1.1999669986835215,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.0581440925598145,
        "cpu_time_ms": 5.694401999789989,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 17.15011215209961,
        "cpu_time_ms": 15.854362998652505,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7688639760017395,
        "cpu_time_ms": 0.9470190016145352,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9044479727745056,
        "cpu_time_ms": 1.06988200059277,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.730751991271973,
        "cpu_time_ms": 6.290269997407449,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 24.2194881439209,
        "cpu_time_ms": 22.204304001206765,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8582080006599426,
        "cpu_time_ms": 1.1008000001311302,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0396159887313843,
        "cpu_time_ms": 1.2526350001280662,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.623424053192139,
        "cpu_time_ms": 6.249270998523571,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 17.955615997314453,
        "cpu_time_ms": 16.514334998646518,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8727359771728516,
        "cpu_time_ms": 1.5308500005630776,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0975040197372437,
        "cpu_time_ms": 1.2819410003430676,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.910848140716553,
        "cpu_time_ms": 6.50129999849014,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 18.428640365600586,
        "cpu_time_ms": 17.040566002833657,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.9679039716720581,
        "cpu_time_ms": 1.1945840014959686,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.2371840476989746,
        "cpu_time_ms": 1.4862250027363189,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.82912015914917,
        "cpu_time_ms": 6.433792997995624,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.167264938354492,
        "cpu_time_ms": 17.625640997721348,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8029119968414307,
        "cpu_time_ms": 0.9681269984866958,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.2825599908828735,
        "cpu_time_ms": 1.3995730005262885,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 7.165952205657959,
        "cpu_time_ms": 7.1713220022502355,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 20.513471603393555,
        "cpu_time_ms": 18.861344000470126,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 1.285375952720642,
        "cpu_time_ms": 2.080487000057474,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.3706879615783691,
        "cpu_time_ms": 1.5960589989845175,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 8.07910442352295,
        "cpu_time_ms": 7.553725998150185,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 19.06934356689453,
        "cpu_time_ms": 18.57944299990777,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8824319839477539,
        "cpu_time_ms": 1.0696659992390778,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.2793279886245728,
        "cpu_time_ms": 1.9570090007619,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.618271827697754,
        "cpu_time_ms": 6.242696999834152,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 20.15920066833496,
        "cpu_time_ms": 18.554371999925934,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.9391999840736389,
        "cpu_time_ms": 1.1447850010881666,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.2640639543533325,
        "cpu_time_ms": 1.4308790014183614,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 8.515423774719238,
        "cpu_time_ms": 7.970875001774402,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 21.7521915435791,
        "cpu_time_ms": 20.00935699834372,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8820160031318665,
        "cpu_time_ms": 1.0863019997486845,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0902400016784668,
        "cpu_time_ms": 1.2458460005291272,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 7.876319885253906,
        "cpu_time_ms": 7.428770000842633,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 21.59507179260254,
        "cpu_time_ms": 19.824132999929134,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8782079815864563,
        "cpu_time_ms": 1.0501450014999136,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1259520053863525,
        "cpu_time_ms": 1.2871690014435444,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.986783981323242,
        "cpu_time_ms": 6.604893998883199,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 23.336896896362305,
        "cpu_time_ms": 21.39482799975667,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.858847975730896,
        "cpu_time_ms": 1.0441929989610799,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1921919584274292,
        "cpu_time_ms": 1.3858950005669612,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.177792072296143,
        "cpu_time_ms": 5.8214050004608,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 18.931583404541016,
        "cpu_time_ms": 17.401608998625306,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1696
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.9613760113716125,
        "cpu_time_ms": 1.0862559975066688,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1696
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0653120279312134,
        "cpu_time_ms": 1.2207059990032576,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1696
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.598944187164307,
        "cpu_time_ms": 6.2064339981589,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1696
      }
    ],
    "peak_gpu_memory_mb": 2384.2763671875,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 273.5,
    "avg_ram_usage_mb": 1216.8203125,
    "final_tree_nodes": 9,
    "final_tree_edges": 8,
    "tree_memory_mb": 52.830238342285156,
    "efficiency_score": 42623.87243266003,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "cprofile_stats": "         347971 function calls (260965 primitive calls) in 1.006 seconds\n\n   Ordered by: cumulative time\n   List reduced from 170 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    1.005    1.005 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:190(search)\n       33    0.000    0.000    1.002    0.030 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:272(_run_search_wave_vectorized)\n      132    0.003    0.000    1.000    0.008 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:383(_profile_phase)\n       33    0.000    0.000    0.664    0.020 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:358(instrumented_select)\n       33    0.125    0.004    0.477    0.014 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:294(_select_batch_vectorized)\n       92    0.168    0.002    0.293    0.003 {built-in method time.sleep}\n       33    0.000    0.000    0.227    0.007 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:367(instrumented_backup)\n       66    0.102    0.002    0.198    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n      363    0.140    0.000    0.140    0.000 {built-in method torch.where}\n       33    0.094    0.003    0.129    0.004 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:687(_backup_batch_vectorized)\n      543    0.009    0.000    0.091    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n87423/543    0.052    0.000    0.067    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       66    0.065    0.001    0.066    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n      357    0.001    0.000    0.064    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       33    0.000    0.000    0.057    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:364(instrumented_evaluate)\n       66    0.001    0.000    0.056    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n       33    0.000    0.000    0.053    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:361(instrumented_expand)\n       66    0.012    0.000    0.053    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n      397    0.002    0.000    0.051    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n      266    0.000    0.000    0.040    0.000 {built-in method builtins.next}\n      266    0.000    0.000    0.040    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:185(timer)\n      397    0.038    0.000    0.038    0.000 {built-in method torch._C._cuda_synchronize}\n      133    0.000    0.000    0.037    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n      133    0.001    0.000    0.036    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:167(end_timer)\n      186    0.001    0.000    0.029    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n       33    0.024    0.001    0.025    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:644(_evaluate_batch_vectorized)\n      186    0.002    0.000    0.022    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n       33    0.022    0.001    0.022    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:395(_expand_batch_vectorized)\n       35    0.021    0.001    0.021    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n       33    0.000    0.000    0.018    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n    66/33    0.000    0.000    0.018    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n       93    0.003    0.000    0.017    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n       33    0.000    0.000    0.017    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n       33    0.000    0.000    0.017    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n       33    0.016    0.000    0.016    0.000 {built-in method torch._unique2}\n       93    0.004    0.000    0.015    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n  279/186    0.000    0.000    0.013    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n     1299    0.001    0.000    0.011    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n      543    0.001    0.000    0.010    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n      927    0.001    0.000    0.009    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n       93    0.000    0.000    0.009    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n      927    0.001    0.000    0.008    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n       93    0.004    0.000    0.008    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n       93    0.000    0.000    0.008    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n      927    0.001    0.000    0.008    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n       93    0.000    0.000    0.007    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:812(bcat)\n    95442    0.007    0.000    0.007    0.000 {built-in method builtins.isinstance}\n      266    0.000    0.000    0.007    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n       93    0.001    0.000    0.006    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:795(cat)\n      543    0.006    0.000    0.006    0.000 {method 'sort' of 'list' objects}\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 92,
        "primitive_calls": 92,
        "total_time": 0.168196374,
        "cumulative_time": 0.293308102,
        "time_percent": 4.597862368455135,
        "time_per_call": 0.003188131543478261
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 363,
        "primitive_calls": 363,
        "total_time": 0.139910388,
        "cumulative_time": 0.13994340800000002,
        "time_percent": 2.1937359553626083,
        "time_per_call": 0.00038551903030303034
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 294,
        "function_name": "_select_batch_vectorized",
        "total_calls": 33,
        "primitive_calls": 33,
        "total_time": 0.125420775,
        "cumulative_time": 0.477283053,
        "time_percent": 7.481831471842798,
        "time_per_call": 0.01446312281818182
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 66,
        "primitive_calls": 66,
        "total_time": 0.10154004200000001,
        "cumulative_time": 0.197872817,
        "time_percent": 3.1018303716155424,
        "time_per_call": 0.002998072984848485
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 687,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 33,
        "primitive_calls": 33,
        "total_time": 0.094389952,
        "cumulative_time": 0.128619072,
        "time_percent": 2.016217032471955,
        "time_per_call": 0.0038975476363636366
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 66,
        "primitive_calls": 66,
        "total_time": 0.06486468100000001,
        "cumulative_time": 0.066183321,
        "time_percent": 1.0374817434988088,
        "time_per_call": 0.001002777590909091
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 543,
        "primitive_calls": 87423,
        "total_time": 0.051898926000000005,
        "cumulative_time": 0.066928377,
        "time_percent": 1.0491611513345722,
        "time_per_call": 0.00012325667955801105
      },
      {
        "rank": 8,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 397,
        "primitive_calls": 397,
        "total_time": 0.037827657,
        "cumulative_time": 0.037827657,
        "time_percent": 0.592981780663967,
        "time_per_call": 9.528377078085642e-05
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 644,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 33,
        "primitive_calls": 33,
        "total_time": 0.024255271000000002,
        "cumulative_time": 0.025298404,
        "time_percent": 0.3965747244635433,
        "time_per_call": 0.000766618303030303
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 395,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 33,
        "primitive_calls": 33,
        "total_time": 0.021743863000000002,
        "cumulative_time": 0.022047205,
        "time_percent": 0.34560932176062387,
        "time_per_call": 0.0006680971212121213
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 35,
        "primitive_calls": 35,
        "total_time": 0.020908601000000002,
        "cumulative_time": 0.021146362000000002,
        "time_percent": 0.3314878157355833,
        "time_per_call": 0.0006041817714285715
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 33,
        "primitive_calls": 33,
        "total_time": 0.016040211000000002,
        "cumulative_time": 0.016048786000000002,
        "time_percent": 0.25157883026630345,
        "time_per_call": 0.00048632684848484855
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 66,
        "primitive_calls": 66,
        "total_time": 0.011544871,
        "cumulative_time": 0.053408742,
        "time_percent": 0.8372289865635189,
        "time_per_call": 0.0008092233636363636
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 543,
        "primitive_calls": 543,
        "total_time": 0.008746435,
        "cumulative_time": 0.091252229,
        "time_percent": 1.4304589163948507,
        "time_per_call": 0.00016805198710865562
      },
      {
        "rank": 15,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 95442,
        "primitive_calls": 95442,
        "total_time": 0.006660689,
        "cumulative_time": 0.006660689,
        "time_percent": 0.10441215599657408,
        "time_per_call": 6.978781877999204e-08
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 543,
        "primitive_calls": 543,
        "total_time": 0.005962862,
        "cumulative_time": 0.005962862,
        "time_percent": 0.09347310425843988,
        "time_per_call": 1.0981329650092082e-05
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 66604,
        "primitive_calls": 66604,
        "total_time": 0.005850705,
        "cumulative_time": 0.005850705,
        "time_percent": 0.0917149446776356,
        "time_per_call": 8.784314755870519e-08
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 543,
        "primitive_calls": 543,
        "total_time": 0.005743094000000001,
        "cumulative_time": 0.005743094000000001,
        "time_percent": 0.09002804764356791,
        "time_per_call": 1.0576600368324127e-05
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 279,
        "primitive_calls": 279,
        "total_time": 0.004472724,
        "cumulative_time": 0.004614959,
        "time_percent": 0.07234353968873093,
        "time_per_call": 1.6541071684587814e-05
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 93,
        "primitive_calls": 93,
        "total_time": 0.004429093,
        "cumulative_time": 0.007694842,
        "time_percent": 0.12062341347464055,
        "time_per_call": 8.274023655913979e-05
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 363,
        "primitive_calls": 363,
        "total_time": 0.0040921360000000006,
        "cumulative_time": 0.0040921360000000006,
        "time_percent": 0.06414782951000966,
        "time_per_call": 1.1273101928374658e-05
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 93,
        "primitive_calls": 93,
        "total_time": 0.003699452,
        "cumulative_time": 0.015081319000000001,
        "time_percent": 0.23641293446700434,
        "time_per_call": 0.00016216472043010754
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 66,
        "primitive_calls": 66,
        "total_time": 0.0035792040000000003,
        "cumulative_time": 0.0035792040000000003,
        "time_percent": 0.056107169452223625,
        "time_per_call": 5.423036363636364e-05
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1098,
        "function_name": "remove_virtual_loss",
        "total_calls": 33,
        "primitive_calls": 33,
        "total_time": 0.003075574,
        "cumulative_time": 0.0038163790000000004,
        "time_percent": 0.05982509609592183,
        "time_per_call": 0.0001156478484848485
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 93,
        "primitive_calls": 93,
        "total_time": 0.002782324,
        "cumulative_time": 0.017426837,
        "time_percent": 0.273180991241427,
        "time_per_call": 0.0001873853440860215
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 383,
        "function_name": "_profile_phase",
        "total_calls": 132,
        "primitive_calls": 132,
        "total_time": 0.002655733,
        "cumulative_time": 1.0003318270000001,
        "time_percent": 15.681080856509283,
        "time_per_call": 0.0075782714166666675
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 93,
        "primitive_calls": 93,
        "total_time": 0.0021189480000000003,
        "cumulative_time": 0.0021189480000000003,
        "time_percent": 0.03321637282939178,
        "time_per_call": 2.2784387096774198e-05
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 21974,
        "primitive_calls": 21974,
        "total_time": 0.00209917,
        "cumulative_time": 0.005086715,
        "time_percent": 0.07973872974554334,
        "time_per_call": 2.314878947847456e-07
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 21178,
        "primitive_calls": 21178,
        "total_time": 0.002065832,
        "cumulative_time": 0.002065832,
        "time_percent": 0.03238373283105016,
        "time_per_call": 9.754613277929928e-08
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 94,
        "primitive_calls": 94,
        "total_time": 0.002042369,
        "cumulative_time": 0.002217239,
        "time_percent": 0.03475717066953403,
        "time_per_call": 2.3587648936170214e-05
      },
      {
        "rank": 31,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 397,
        "primitive_calls": 397,
        "total_time": 0.001969115,
        "cumulative_time": 0.051172970000000005,
        "time_percent": 0.802181294825206,
        "time_per_call": 0.00012889916876574308
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 132,
        "primitive_calls": 132,
        "total_time": 0.0018571150000000001,
        "cumulative_time": 0.0018571150000000001,
        "time_percent": 0.029111910356958218,
        "time_per_call": 1.4069053030303031e-05
      },
      {
        "rank": 33,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 186,
        "primitive_calls": 186,
        "total_time": 0.001658631,
        "cumulative_time": 0.022109317,
        "time_percent": 0.3465829819680377,
        "time_per_call": 0.00011886729569892474
      },
      {
        "rank": 34,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 731,
        "primitive_calls": 731,
        "total_time": 0.0015382030000000001,
        "cumulative_time": 0.0029875450000000003,
        "time_percent": 0.04683239445450538,
        "time_per_call": 4.086928864569084e-06
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x7333ab978360>",
        "total_calls": 266,
        "primitive_calls": 266,
        "total_time": 0.00153801,
        "cumulative_time": 0.00153801,
        "time_percent": 0.024109658932325303,
        "time_per_call": 5.7819924812030076e-06
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 165,
        "primitive_calls": 165,
        "total_time": 0.001474341,
        "cumulative_time": 0.001474341,
        "time_percent": 0.02311159138103356,
        "time_per_call": 8.935400000000001e-06
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 132,
        "primitive_calls": 132,
        "total_time": 0.001438218,
        "cumulative_time": 0.001467757,
        "time_percent": 0.023008381392535155,
        "time_per_call": 1.1119371212121212e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 33,
        "primitive_calls": 33,
        "total_time": 0.0014365900000000002,
        "cumulative_time": 0.0014365900000000002,
        "time_percent": 0.02251981126623963,
        "time_per_call": 4.3533030303030306e-05
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 357,
        "primitive_calls": 357,
        "total_time": 0.001424083,
        "cumulative_time": 0.064466388,
        "time_percent": 1.0105673092365777,
        "time_per_call": 0.00018057811764705882
      },
      {
        "rank": 40,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 1299,
        "primitive_calls": 1299,
        "total_time": 0.00140006,
        "cumulative_time": 0.011229082000000001,
        "time_percent": 0.17602573269556981,
        "time_per_call": 8.644404926866821e-06
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 280,
        "primitive_calls": 280,
        "total_time": 0.001344488,
        "cumulative_time": 0.001344488,
        "time_percent": 0.021076031442321043,
        "time_per_call": 4.801742857142857e-06
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'scatter_add_' of 'torch._C.TensorBase' objects>",
        "total_calls": 132,
        "primitive_calls": 132,
        "total_time": 0.0013012450000000001,
        "cumulative_time": 0.0013012450000000001,
        "time_percent": 0.0203981593990895,
        "time_per_call": 9.857916666666668e-06
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method mcts_cuda_kernels.batched_ucb_selection>",
        "total_calls": 66,
        "primitive_calls": 66,
        "total_time": 0.00126306,
        "cumulative_time": 0.00126306,
        "time_percent": 0.019799575952732948,
        "time_per_call": 1.9137272727272728e-05
      },
      {
        "rank": 44,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 927,
        "primitive_calls": 927,
        "total_time": 0.00126026,
        "cumulative_time": 0.0020149910000000003,
        "time_percent": 0.031586755457835194,
        "time_per_call": 2.17366882416397e-06
      },
      {
        "rank": 45,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 795,
        "function_name": "cat",
        "total_calls": 93,
        "primitive_calls": 93,
        "total_time": 0.0011482690000000002,
        "cumulative_time": 0.006488957,
        "time_percent": 0.10172010591382684,
        "time_per_call": 6.97737311827957e-05
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.ones_like>",
        "total_calls": 66,
        "primitive_calls": 66,
        "total_time": 0.001132449,
        "cumulative_time": 0.0011859820000000001,
        "time_percent": 0.018591310537562845,
        "time_per_call": 1.7969424242424245e-05
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 165,
        "primitive_calls": 165,
        "total_time": 0.001089488,
        "cumulative_time": 0.001089488,
        "time_percent": 0.01707868225230085,
        "time_per_call": 6.602957575757576e-06
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'split' of 'bytes' objects>",
        "total_calls": 5116,
        "primitive_calls": 5116,
        "total_time": 0.001069449,
        "cumulative_time": 0.001069449,
        "time_percent": 0.01676455330948197,
        "time_per_call": 2.0904007036747462e-07
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._get_tracing_state>",
        "total_calls": 731,
        "primitive_calls": 731,
        "total_time": 0.000890881,
        "cumulative_time": 0.000890881,
        "time_percent": 0.013965342916683832,
        "time_per_call": 1.218715458276334e-06
      },
      {
        "rank": 50,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 812,
        "function_name": "_get_device_index",
        "total_calls": 927,
        "primitive_calls": 927,
        "total_time": 0.0008842530000000001,
        "cumulative_time": 0.009281669000000001,
        "time_percent": 0.1454983218007275,
        "time_per_call": 1.0012587918015104e-05
      }
    ]
  }
]