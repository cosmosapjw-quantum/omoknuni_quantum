[
  {
    "config": {
      "num_simulations": 1000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 1824,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 1000,
    "wave_size": 1824,
    "total_time_ms": 82.54574000056891,
    "simulations_per_second": 12114.495551110305,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 31.554399490356445,
        "cpu_time_ms": 30.945722000979003,
        "memory_allocated_mb": 0.19482421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "expansion",
        "gpu_time_ms": 39.40595245361328,
        "cpu_time_ms": 36.23853099998087,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.019296169281006,
        "cpu_time_ms": 3.9652329996897606,
        "memory_allocated_mb": 0.00390625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.522079944610596,
        "cpu_time_ms": 6.209922001289669,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      }
    ],
    "peak_gpu_memory_mb": 341.587890625,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 187.4,
    "avg_ram_usage_mb": 1248.90625,
    "final_tree_nodes": 351,
    "final_tree_edges": 350,
    "tree_memory_mb": 8.756935119628906,
    "efficiency_score": 36316.40284917361,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "cprofile_stats": "         18296 function calls (13647 primitive calls) in 0.081 seconds\n\n   Ordered by: cumulative time\n   List reduced from 215 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    0.080    0.080 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    0.080    0.080 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n        1    0.000    0.000    0.079    0.079 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n        4    0.002    0.000    0.079    0.020 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n        1    0.000    0.000    0.037    0.037 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n        1    0.005    0.005    0.035    0.035 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n        1    0.000    0.000    0.032    0.032 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n        6    0.007    0.001    0.019    0.003 {built-in method time.sleep}\n        2    0.007    0.003    0.011    0.006 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n        1    0.002    0.002    0.010    0.010 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n        3    0.002    0.001    0.010    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n       19    0.008    0.000    0.008    0.000 {built-in method torch.where}\n        1    0.000    0.000    0.007    0.007 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n        3    0.006    0.002    0.006    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n       13    0.000    0.000    0.006    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n       10    0.000    0.000    0.006    0.001 {built-in method builtins.next}\n       10    0.000    0.000    0.006    0.001 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n        5    0.000    0.000    0.006    0.001 /usr/lib/python3.12/contextlib.py:141(__exit__)\n        5    0.000    0.000    0.006    0.001 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n       13    0.005    0.000    0.005    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n        3    0.001    0.000    0.005    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n        3    0.002    0.001    0.005    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n       29    0.000    0.000    0.005    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        1    0.000    0.000    0.004    0.004 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n        3    0.004    0.001    0.004    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n       13    0.004    0.000    0.004    0.000 {built-in method torch._C._cuda_synchronize}\n        1    0.002    0.002    0.004    0.004 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n        2    0.000    0.000    0.003    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n        1    0.002    0.002    0.003    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n  4669/29    0.002    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        3    0.003    0.001    0.003    0.001 {built-in method torch.repeat_interleave}\n        2    0.000    0.000    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n       15    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        2    0.000    0.000    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n       11    0.002    0.000    0.002    0.000 {built-in method torch.tensor}\n        3    0.002    0.001    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n       14    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n       14    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:489(_extract_policy)\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n    21/14    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n        1    0.001    0.001    0.001    0.001 {built-in method torch.bincount}\n        3    0.001    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n        7    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n        7    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n        7    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n        7    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n        7    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.008127535,
        "cumulative_time": 0.008127535,
        "time_percent": 1.3254703438781048,
        "time_per_call": 0.000427765
      },
      {
        "rank": 2,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.006941379,
        "cumulative_time": 0.011169419,
        "time_percent": 1.8215527392805613,
        "time_per_call": 0.0055847095
      },
      {
        "rank": 3,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.006542738,
        "cumulative_time": 0.018783222000000002,
        "time_percent": 3.0632416499564488,
        "time_per_call": 0.0031305370000000005
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.005953184,
        "cumulative_time": 0.006046055000000001,
        "time_percent": 0.9860144065766479,
        "time_per_call": 0.002015351666666667
      },
      {
        "rank": 5,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.005209779,
        "cumulative_time": 0.005209779,
        "time_percent": 0.8496312304602724,
        "time_per_call": 0.0004007522307692308
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.004815278,
        "cumulative_time": 0.035198888000000005,
        "time_percent": 5.740372964433485,
        "time_per_call": 0.035198888000000005
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.004191257,
        "cumulative_time": 0.004191257,
        "time_percent": 0.6835266605522479,
        "time_per_call": 0.0013970856666666667
      },
      {
        "rank": 8,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.004028345,
        "cumulative_time": 0.004028345,
        "time_percent": 0.656958331451005,
        "time_per_call": 0.0003098726923076923
      },
      {
        "rank": 9,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.002983218,
        "cumulative_time": 0.002983218,
        "time_percent": 0.4865149136021379,
        "time_per_call": 0.000994406
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 29,
        "primitive_calls": 4669,
        "total_time": 0.002493959,
        "cumulative_time": 0.0032514930000000003,
        "time_percent": 0.5302662547534093,
        "time_per_call": 0.00011212044827586207
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0022243460000000003,
        "cumulative_time": 0.0033375180000000003,
        "time_percent": 0.5442955497773144,
        "time_per_call": 0.0033375180000000003
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.002219132,
        "cumulative_time": 0.002219132,
        "time_percent": 0.3619047663468575,
        "time_per_call": 0.00020173927272727272
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0020953770000000003,
        "cumulative_time": 0.0020953770000000003,
        "time_percent": 0.3417223146678879,
        "time_per_call": 0.0006984590000000001
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.002083976,
        "cumulative_time": 0.004587038,
        "time_percent": 0.7480721812015493,
        "time_per_call": 0.0015290126666666667
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.001970651,
        "cumulative_time": 0.003538742,
        "time_percent": 0.5771119503805142,
        "time_per_call": 0.003538742
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.001912164,
        "cumulative_time": 0.009988187,
        "time_percent": 1.6289127832250265,
        "time_per_call": 0.003329395666666667
      },
      {
        "rank": 17,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 390,
        "function_name": "_profile_phase",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0018926910000000002,
        "cumulative_time": 0.07859007500000001,
        "time_percent": 12.816778240346679,
        "time_per_call": 0.019647518750000002
      },
      {
        "rank": 18,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.001803506,
        "cumulative_time": 0.010303248000000001,
        "time_percent": 1.6802941690957216,
        "time_per_call": 0.010303248000000001
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0010610320000000002,
        "cumulative_time": 0.0010610320000000002,
        "time_percent": 0.1730372677454694,
        "time_per_call": 0.0010610320000000002
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.000841899,
        "cumulative_time": 0.0050331560000000004,
        "time_percent": 0.8208268576034612,
        "time_per_call": 0.0016777186666666669
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0006081740000000001,
        "cumulative_time": 0.000617881,
        "time_percent": 0.10076646136199319,
        "time_per_call": 0.000617881
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000584114,
        "cumulative_time": 0.000584114,
        "time_percent": 0.09525960631901498,
        "time_per_call": 0.000584114
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0005809890000000001,
        "cumulative_time": 0.001057241,
        "time_percent": 0.17241901656923428,
        "time_per_call": 0.0003524136666666667
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000522323,
        "cumulative_time": 0.0013116520000000002,
        "time_percent": 0.21390936212374406,
        "time_per_call": 0.0013116520000000002
      },
      {
        "rank": 25,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 21,
        "primitive_calls": 21,
        "total_time": 0.000517105,
        "cumulative_time": 0.000579855,
        "time_percent": 0.09456503186383552,
        "time_per_call": 2.7612142857142856e-05
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 29,
        "primitive_calls": 29,
        "total_time": 0.000448108,
        "cumulative_time": 0.004502499,
        "time_percent": 0.7342852288966856,
        "time_per_call": 0.00015525858620689655
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00041416,
        "cumulative_time": 0.00041416,
        "time_percent": 0.0675428401871608,
        "time_per_call": 0.00041416
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.000408928,
        "cumulative_time": 0.000408928,
        "time_percent": 0.06668958506870604,
        "time_per_call": 4.5436444444444447e-05
      },
      {
        "rank": 29,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000364748,
        "cumulative_time": 0.0025439670000000003,
        "time_percent": 0.41488013454319805,
        "time_per_call": 0.0012719835000000001
      },
      {
        "rank": 30,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.00036101300000000003,
        "cumulative_time": 0.0006284480000000001,
        "time_percent": 0.10248976924362765,
        "time_per_call": 8.977828571428573e-05
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 29,
        "primitive_calls": 29,
        "total_time": 0.000352868,
        "cumulative_time": 0.000352868,
        "time_percent": 0.05754709998832106,
        "time_per_call": 1.2167862068965518e-05
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 4954,
        "primitive_calls": 4954,
        "total_time": 0.00033206500000000004,
        "cumulative_time": 0.00033206500000000004,
        "time_percent": 0.05415446500567305,
        "time_per_call": 6.702967299152201e-08
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 29,
        "primitive_calls": 29,
        "total_time": 0.00030713400000000003,
        "cumulative_time": 0.00030713400000000003,
        "time_percent": 0.05008861956259283,
        "time_per_call": 1.0590827586206897e-05
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 3554,
        "primitive_calls": 3554,
        "total_time": 0.000281509,
        "cumulative_time": 0.000281509,
        "time_percent": 0.04590959387253102,
        "time_per_call": 7.920906021384355e-08
      },
      {
        "rank": 35,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.00020543500000000001,
        "cumulative_time": 0.00020543500000000001,
        "time_percent": 0.0335031470297696,
        "time_per_call": 6.847833333333334e-05
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 21,
        "primitive_calls": 21,
        "total_time": 0.000190501,
        "cumulative_time": 0.000228342,
        "time_percent": 0.03723891059980845,
        "time_per_call": 1.0873428571428572e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.00017946000000000002,
        "cumulative_time": 0.00017946000000000002,
        "time_percent": 0.02926704196442891,
        "time_per_call": 2.563714285714286e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.000177517,
        "cumulative_time": 0.000177517,
        "time_percent": 0.02895016988966637,
        "time_per_call": 2.5359571428571428e-05
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.00015702200000000002,
        "cumulative_time": 0.00015702200000000002,
        "time_percent": 0.02560776475726377,
        "time_per_call": 2.243171428571429e-05
      },
      {
        "rank": 40,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 367,
        "function_name": "get_nn_features",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000136507,
        "cumulative_time": 0.000220418,
        "time_percent": 0.03594663354349432,
        "time_per_call": 0.000220418
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.000132888,
        "cumulative_time": 0.000132888,
        "time_percent": 0.02167189720589005,
        "time_per_call": 2.65776e-05
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.000124112,
        "cumulative_time": 0.000124112,
        "time_percent": 0.020240672641754155,
        "time_per_call": 9.547076923076924e-06
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 1184,
        "primitive_calls": 1184,
        "total_time": 0.000116736,
        "cumulative_time": 0.000320653,
        "time_percent": 0.0522933512037224,
        "time_per_call": 2.7082179054054055e-07
      },
      {
        "rank": 44,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.00011489,
        "cumulative_time": 0.000169208,
        "time_percent": 0.02759510552054545,
        "time_per_call": 3.3841600000000005e-05
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'numpy' of 'torch._C.TensorBase' objects>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.00011029,
        "cumulative_time": 0.00011029,
        "time_percent": 0.017986526570025987,
        "time_per_call": 8.483846153846155e-06
      },
      {
        "rank": 46,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 48,
        "primitive_calls": 48,
        "total_time": 0.000104728,
        "cumulative_time": 0.00020391700000000002,
        "time_percent": 0.03325558562498858,
        "time_per_call": 4.248270833333334e-06
      },
      {
        "rank": 47,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 782,
        "function_name": "batch_select_ucb_optimized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000104022,
        "cumulative_time": 0.002885125,
        "time_percent": 0.47051752171861666,
        "time_per_call": 0.0014425625
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 1131,
        "primitive_calls": 1131,
        "total_time": 0.00010174000000000001,
        "cumulative_time": 0.00010174000000000001,
        "time_percent": 0.016592158973927323,
        "time_per_call": 8.995579133510169e-08
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 9.874e-05,
        "cumulative_time": 9.874e-05,
        "time_percent": 0.016102907185822524,
        "time_per_call": 4.937e-05
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 9.513100000000001e-05,
        "cumulative_time": 9.513100000000001e-05,
        "time_percent": 0.015514337284732454,
        "time_per_call": 1.5855166666666667e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 5000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 1824,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 5000,
    "wave_size": 1824,
    "total_time_ms": 230.7637319991045,
    "simulations_per_second": 21667.182952386138,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 30.84876823425293,
        "cpu_time_ms": 28.65793599994504,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 33.61743927001953,
        "cpu_time_ms": 30.815403999440605,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.498944044113159,
        "cpu_time_ms": 3.4152950011048233,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6424959897994995,
        "cpu_time_ms": 1.7147470007330412,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 39.017215728759766,
        "cpu_time_ms": 36.822707999817794,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 37.06256103515625,
        "cpu_time_ms": 34.009162000074866,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.023615837097168,
        "cpu_time_ms": 3.9269099997909507,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.9100799560546875,
        "cpu_time_ms": 1.9615050005086232,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 38.4799690246582,
        "cpu_time_ms": 35.392413001318346,
        "memory_allocated_mb": 0.263671875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1352
      },
      {
        "name": "expansion",
        "gpu_time_ms": 43.710784912109375,
        "cpu_time_ms": 40.00011599964637,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1352
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.545664072036743,
        "cpu_time_ms": 3.5291910007799743,
        "memory_allocated_mb": 0.00537109375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1352
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.7255359888076782,
        "cpu_time_ms": 1.8603499993332662,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1352
      }
    ],
    "peak_gpu_memory_mb": 660.35205078125,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 187.3,
    "avg_ram_usage_mb": 1250.0078125,
    "final_tree_nodes": 651,
    "final_tree_edges": 650,
    "tree_memory_mb": 8.756935119628906,
    "efficiency_score": 33599.0405678216,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "cprofile_stats": "         54554 function calls (40609 primitive calls) in 0.229 seconds\n\n   Ordered by: cumulative time\n   List reduced from 214 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    0.229    0.229 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    0.229    0.229 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n        3    0.000    0.000    0.227    0.076 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n       12    0.000    0.000    0.226    0.019 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n        3    0.000    0.000    0.106    0.035 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n        3    0.000    0.000    0.102    0.034 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n        3    0.011    0.004    0.064    0.021 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n       20    0.019    0.001    0.057    0.003 {built-in method time.sleep}\n        3    0.015    0.005    0.053    0.018 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n       21    0.006    0.000    0.041    0.002 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n       69    0.027    0.000    0.027    0.000 {built-in method torch.where}\n        8    0.012    0.001    0.025    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n        9    0.005    0.001    0.025    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n        9    0.012    0.001    0.020    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n       11    0.016    0.001    0.017    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n        9    0.002    0.000    0.016    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n        8    0.000    0.000    0.015    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n       87    0.002    0.000    0.014    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       35    0.013    0.000    0.013    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n        3    0.000    0.000    0.012    0.004 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n 14007/87    0.008    0.000    0.010    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        9    0.010    0.001    0.010    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n        3    0.005    0.002    0.010    0.003 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n        8    0.000    0.000    0.009    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n        3    0.006    0.002    0.009    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n       21    0.003    0.000    0.009    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n       45    0.000    0.000    0.008    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        3    0.000    0.000    0.007    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n        9    0.007    0.001    0.007    0.001 {built-in method torch.repeat_interleave}\n       33    0.006    0.000    0.006    0.000 {built-in method torch.tensor}\n       42    0.000    0.000    0.006    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        8    0.001    0.000    0.006    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n        9    0.006    0.001    0.006    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n       42    0.001    0.000    0.005    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n       37    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        3    0.002    0.001    0.004    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n       37    0.004    0.000    0.004    0.000 {built-in method torch._C._cuda_synchronize}\n       26    0.000    0.000    0.003    0.000 {built-in method builtins.next}\n       26    0.000    0.000    0.003    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n       13    0.000    0.000    0.003    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       13    0.000    0.000    0.003    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n        3    0.003    0.001    0.003    0.001 {built-in method torch.bincount}\n    63/42    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n        9    0.002    0.000    0.003    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n       21    0.001    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:489(_extract_policy)\n        3    0.000    0.000    0.002    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n      6/3    0.000    0.000    0.002    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        3    0.000    0.000    0.002    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        3    0.000    0.000    0.002    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 69,
        "primitive_calls": 69,
        "total_time": 0.027054308000000003,
        "cumulative_time": 0.027054308000000003,
        "time_percent": 1.5769863092729823,
        "time_per_call": 0.0003920914202898551
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 20,
        "primitive_calls": 20,
        "total_time": 0.018603038000000002,
        "cumulative_time": 0.057140062000000005,
        "time_percent": 3.3306745633637864,
        "time_per_call": 0.0028570031000000004
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.015714405,
        "cumulative_time": 0.017470353,
        "time_percent": 1.01834086827008,
        "time_per_call": 0.001588213909090909
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.015078426,
        "cumulative_time": 0.053106303,
        "time_percent": 3.095548138474017,
        "time_per_call": 0.017702101
      },
      {
        "rank": 5,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 35,
        "primitive_calls": 35,
        "total_time": 0.012819571,
        "cumulative_time": 0.012819571,
        "time_percent": 0.7472483849061285,
        "time_per_call": 0.0003662734571428571
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.012412908,
        "cumulative_time": 0.01981072,
        "time_percent": 1.1547600558417703,
        "time_per_call": 0.002201191111111111
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.011804775,
        "cumulative_time": 0.025017145,
        "time_percent": 1.4582407785886462,
        "time_per_call": 0.003127143125
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.011037149000000001,
        "cumulative_time": 0.064295133,
        "time_percent": 3.7477411913062246,
        "time_per_call": 0.021431711000000003
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.009950213000000001,
        "cumulative_time": 0.009950213000000001,
        "time_percent": 0.5799944938658217,
        "time_per_call": 0.0011055792222222224
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 87,
        "primitive_calls": 14007,
        "total_time": 0.007655394,
        "cumulative_time": 0.010205691000000001,
        "time_percent": 0.5948862186262717,
        "time_per_call": 0.00011730679310344829
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.006598376,
        "cumulative_time": 0.006598376,
        "time_percent": 0.38461706784129995,
        "time_per_call": 0.000733152888888889
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 21,
        "primitive_calls": 21,
        "total_time": 0.006452848000000001,
        "cumulative_time": 0.04095091,
        "time_percent": 2.3870144607753434,
        "time_per_call": 0.0019500433333333334
      },
      {
        "rank": 13,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 33,
        "primitive_calls": 33,
        "total_time": 0.006409687000000001,
        "cumulative_time": 0.006409687000000001,
        "time_percent": 0.37361845092193874,
        "time_per_call": 0.00019423293939393942
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.005828951000000001,
        "cumulative_time": 0.008706297,
        "time_percent": 0.5074870580117753,
        "time_per_call": 0.002902099
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.005575682,
        "cumulative_time": 0.005575682,
        "time_percent": 0.3250045862884314,
        "time_per_call": 0.0006195202222222222
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.005324239000000001,
        "cumulative_time": 0.009629264,
        "time_percent": 0.561286487031019,
        "time_per_call": 0.0032097546666666667
      },
      {
        "rank": 17,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.004584817000000001,
        "cumulative_time": 0.024709435000000002,
        "time_percent": 1.4403044685109172,
        "time_per_call": 0.002745492777777778
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 37,
        "primitive_calls": 37,
        "total_time": 0.0035651360000000004,
        "cumulative_time": 0.0035651360000000004,
        "time_percent": 0.20781055138043977,
        "time_per_call": 9.635502702702704e-05
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.002705612,
        "cumulative_time": 0.002705612,
        "time_percent": 0.15770919301298306,
        "time_per_call": 0.0009018706666666667
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 21,
        "primitive_calls": 21,
        "total_time": 0.0026401800000000002,
        "cumulative_time": 0.008662126000000001,
        "time_percent": 0.5049123456122974,
        "time_per_call": 0.0004124821904761905
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0023164310000000003,
        "cumulative_time": 0.016029131000000002,
        "time_percent": 0.9343325335300814,
        "time_per_call": 0.0017810145555555558
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.001909656,
        "cumulative_time": 0.0026096690000000002,
        "time_percent": 0.15211670853803078,
        "time_per_call": 0.00028996322222222225
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 63,
        "primitive_calls": 63,
        "total_time": 0.0017005330000000002,
        "cumulative_time": 0.0017966570000000001,
        "time_percent": 0.10472651865497608,
        "time_per_call": 2.8518365079365082e-05
      },
      {
        "rank": 24,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full_like>",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.0016208820000000001,
        "cumulative_time": 0.0016208820000000001,
        "time_percent": 0.0944806543544566,
        "time_per_call": 0.0001473529090909091
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 87,
        "primitive_calls": 87,
        "total_time": 0.001573498,
        "cumulative_time": 0.014163229000000001,
        "time_percent": 0.8255697476386412,
        "time_per_call": 0.00016279573563218391
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.001556969,
        "cumulative_time": 0.003963885,
        "time_percent": 0.23105349345961965,
        "time_per_call": 0.001321295
      },
      {
        "rank": 27,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 42,
        "primitive_calls": 42,
        "total_time": 0.0014571760000000001,
        "cumulative_time": 0.004791518000000001,
        "time_percent": 0.27929593640447437,
        "time_per_call": 0.00011408376190476192
      },
      {
        "rank": 28,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.001377832,
        "cumulative_time": 0.006239052,
        "time_percent": 0.36367219545375984,
        "time_per_call": 0.0007798815
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0012567770000000002,
        "cumulative_time": 0.0012567770000000002,
        "time_percent": 0.07325709912111487,
        "time_per_call": 0.0004189256666666667
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 14816,
        "primitive_calls": 14816,
        "total_time": 0.0011424640000000002,
        "cumulative_time": 0.0011424640000000002,
        "time_percent": 0.06659383366365344,
        "time_per_call": 7.711015118790498e-08
      },
      {
        "rank": 31,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.001094177,
        "cumulative_time": 0.0011002660000000001,
        "time_percent": 0.0641341267556556,
        "time_per_call": 0.0011002660000000001
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 87,
        "primitive_calls": 87,
        "total_time": 0.001035516,
        "cumulative_time": 0.001035516,
        "time_percent": 0.06035987152334931,
        "time_per_call": 1.1902482758620689e-05
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0010211480000000002,
        "cumulative_time": 0.0010211480000000002,
        "time_percent": 0.05952236574454196,
        "time_per_call": 0.0003403826666666667
      },
      {
        "rank": 34,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 21,
        "primitive_calls": 21,
        "total_time": 0.000986941,
        "cumulative_time": 0.002325676,
        "time_percent": 0.13556285423396347,
        "time_per_call": 0.0001107464761904762
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 87,
        "primitive_calls": 87,
        "total_time": 0.0009293750000000001,
        "cumulative_time": 0.0009293750000000001,
        "time_percent": 0.054172949135515784,
        "time_per_call": 1.0682471264367816e-05
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 10660,
        "primitive_calls": 10660,
        "total_time": 0.0009007790000000001,
        "cumulative_time": 0.0009007790000000001,
        "time_percent": 0.05250609812975471,
        "time_per_call": 8.450084427767356e-08
      },
      {
        "rank": 37,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.0007369540000000001,
        "cumulative_time": 0.0007369540000000001,
        "time_percent": 0.04295679521959909,
        "time_per_call": 6.699581818181819e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.0006079000000000001,
        "cumulative_time": 0.0006079000000000001,
        "time_percent": 0.03543428194160597,
        "time_per_call": 2.64304347826087e-05
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 47,
        "primitive_calls": 47,
        "total_time": 0.000579849,
        "cumulative_time": 0.000579849,
        "time_percent": 0.03379919879841796,
        "time_per_call": 1.2337212765957448e-05
      },
      {
        "rank": 40,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 367,
        "function_name": "get_nn_features",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.000464814,
        "cumulative_time": 0.000886884,
        "time_percent": 0.05169616335828141,
        "time_per_call": 0.000295628
      },
      {
        "rank": 41,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.00045027600000000005,
        "cumulative_time": 0.000685686,
        "time_percent": 0.03996840113079788,
        "time_per_call": 3.6088736842105266e-05
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 0.000427502,
        "cumulative_time": 0.000427502,
        "time_percent": 0.024918944560948238,
        "time_per_call": 1.5833407407407407e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 3558,
        "primitive_calls": 3558,
        "total_time": 0.000423295,
        "cumulative_time": 0.0010883660000000001,
        "time_percent": 0.0634404798480966,
        "time_per_call": 3.058926363125352e-07
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 63,
        "primitive_calls": 63,
        "total_time": 0.00042189900000000005,
        "cumulative_time": 0.000471251,
        "time_percent": 0.02746905872555314,
        "time_per_call": 7.480174603174603e-06
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 21,
        "primitive_calls": 21,
        "total_time": 0.00042091400000000004,
        "cumulative_time": 0.00042091400000000004,
        "time_percent": 0.024534932306578612,
        "time_per_call": 2.0043523809523813e-05
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.00039453700000000003,
        "cumulative_time": 0.00039453700000000003,
        "time_percent": 0.02299742604769764,
        "time_per_call": 4.9317125000000004e-05
      },
      {
        "rank": 47,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 390,
        "function_name": "_profile_phase",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.00035507700000000003,
        "cumulative_time": 0.22628662900000002,
        "time_percent": 13.190169783848644,
        "time_per_call": 0.018857219083333335
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros>",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.00034889400000000004,
        "cumulative_time": 0.00034889400000000004,
        "time_percent": 0.020336911274444272,
        "time_per_call": 1.5169304347826089e-05
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.rsub>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.000340574,
        "cumulative_time": 0.000340574,
        "time_percent": 0.01985194133571395,
        "time_per_call": 2.838116666666667e-05
      },
      {
        "rank": 50,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 152,
        "primitive_calls": 152,
        "total_time": 0.00033377,
        "cumulative_time": 0.000665071,
        "time_percent": 0.038766759870350095,
        "time_per_call": 4.375467105263158e-06
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 1824,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 10000,
    "wave_size": 1824,
    "total_time_ms": 604.1328329993121,
    "simulations_per_second": 16552.65109554373,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 34.245025634765625,
        "cpu_time_ms": 32.41237899965199,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 120.86287689208984,
        "cpu_time_ms": 110.24677000023075,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.5803840160369873,
        "cpu_time_ms": 3.4726129997579847,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6097279787063599,
        "cpu_time_ms": 1.7012049993354594,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 35.62684631347656,
        "cpu_time_ms": 32.794279999507125,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 35.114463806152344,
        "cpu_time_ms": 32.14776299864752,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.404160022735596,
        "cpu_time_ms": 4.242694998538354,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4960639476776123,
        "cpu_time_ms": 1.5951839995977934,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 39.63417434692383,
        "cpu_time_ms": 36.48165899903688,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 37.11177444458008,
        "cpu_time_ms": 33.97985300034634,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.641727924346924,
        "cpu_time_ms": 3.684236000481178,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4984320402145386,
        "cpu_time_ms": 1.621393999812426,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 36.27260971069336,
        "cpu_time_ms": 33.39187299934565,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 49.37376022338867,
        "cpu_time_ms": 45.15092100155016,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.761823892593384,
        "cpu_time_ms": 3.6365019986988045,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.2997119426727295,
        "cpu_time_ms": 1.4177100001688814,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 56.034175872802734,
        "cpu_time_ms": 51.3285029992403,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 59.397056579589844,
        "cpu_time_ms": 54.256030000033206,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.987391948699951,
        "cpu_time_ms": 3.853836000416777,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5209280252456665,
        "cpu_time_ms": 1.6380910001316806,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 51.03897476196289,
        "cpu_time_ms": 46.845252998537035,
        "memory_allocated_mb": 0.17138671875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 880
      },
      {
        "name": "expansion",
        "gpu_time_ms": 55.63929748535156,
        "cpu_time_ms": 50.84106299909763,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 880
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.7094719409942627,
        "cpu_time_ms": 3.777642999921227,
        "memory_allocated_mb": 0.00341796875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 880
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.415168046951294,
        "cpu_time_ms": 1.5179069996520411,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 880
      }
    ],
    "peak_gpu_memory_mb": 660.35205078125,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 189.2,
    "avg_ram_usage_mb": 1251.5078125,
    "final_tree_nodes": 1351,
    "final_tree_edges": 1350,
    "tree_memory_mb": 8.756935119628906,
    "efficiency_score": 25667.997398938423,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth"
    ],
    "cprofile_stats": "         131852 function calls (97710 primitive calls) in 0.602 seconds\n\n   Ordered by: cumulative time\n   List reduced from 214 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    0.602    0.602 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    0.602    0.602 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n        6    0.000    0.000    0.601    0.100 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n       24    0.002    0.000    0.600    0.025 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n        6    0.000    0.000    0.329    0.055 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n       54    0.131    0.002    0.291    0.005 {built-in method time.sleep}\n        6    0.000    0.000    0.236    0.039 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n        6    0.017    0.003    0.204    0.034 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n       19    0.039    0.002    0.079    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n        6    0.023    0.004    0.077    0.013 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n      166    0.072    0.000    0.072    0.000 {built-in method torch.where}\n       23    0.014    0.001    0.070    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n       23    0.029    0.001    0.048    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n      110    0.010    0.000    0.039    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n       19    0.000    0.000    0.033    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n       23    0.006    0.000    0.033    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n      213    0.003    0.000    0.033    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       25    0.030    0.001    0.030    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n       83    0.028    0.000    0.028    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n       23    0.027    0.001    0.027    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n        6    0.000    0.000    0.025    0.004 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n34293/213    0.019    0.000    0.025    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       23    0.022    0.001    0.022    0.001 {built-in method torch.repeat_interleave}\n        6    0.009    0.001    0.018    0.003 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n       19    0.000    0.000    0.018    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n      110    0.000    0.000    0.017    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n      103    0.000    0.000    0.017    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       81    0.016    0.000    0.016    0.000 {built-in method torch.tensor}\n       55    0.002    0.000    0.016    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n       55    0.002    0.000    0.016    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n        6    0.010    0.002    0.016    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n       19    0.003    0.000    0.015    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n       23    0.014    0.001    0.014    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n        6    0.000    0.000    0.012    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n       73    0.000    0.000    0.008    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n  165/110    0.000    0.000    0.007    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n        6    0.003    0.001    0.007    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n       50    0.000    0.000    0.007    0.000 {built-in method builtins.next}\n       50    0.000    0.000    0.007    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n       23    0.005    0.000    0.006    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n       25    0.000    0.000    0.006    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       25    0.000    0.000    0.006    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n       73    0.006    0.000    0.006    0.000 {built-in method torch._C._cuda_synchronize}\n        6    0.005    0.001    0.005    0.001 {built-in method torch.bincount}\n       55    0.003    0.000    0.005    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n       55    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n      165    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:765(open_binary)\n      165    0.003    0.000    0.003    0.000 {built-in method _io.open}\n       55    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n       55    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1113(memory_info)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 54,
        "primitive_calls": 54,
        "total_time": 0.130814583,
        "cumulative_time": 0.291344618,
        "time_percent": 6.52762602388176,
        "time_per_call": 0.005395270703703704
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 166,
        "primitive_calls": 166,
        "total_time": 0.072228764,
        "cumulative_time": 0.072228764,
        "time_percent": 1.6182978178756473,
        "time_per_call": 0.0004351130361445783
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.039320526,
        "cumulative_time": 0.07927268,
        "time_percent": 1.7761179612758495,
        "time_per_call": 0.004172246315789474
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.029723023,
        "cumulative_time": 0.030173317,
        "time_percent": 0.6760383309227079,
        "time_per_call": 0.00120693268
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.029162680000000003,
        "cumulative_time": 0.047787797,
        "time_percent": 1.0706937696758096,
        "time_per_call": 0.002077730304347826
      },
      {
        "rank": 6,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 83,
        "primitive_calls": 83,
        "total_time": 0.028382103000000002,
        "cumulative_time": 0.028382103000000002,
        "time_percent": 0.635905874723564,
        "time_per_call": 0.0003419530481927711
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.027426172000000002,
        "cumulative_time": 0.027426172000000002,
        "time_percent": 0.6144880770807899,
        "time_per_call": 0.0011924422608695653
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.022774013000000003,
        "cumulative_time": 0.077328118,
        "time_percent": 1.7325497168943742,
        "time_per_call": 0.012888019666666667
      },
      {
        "rank": 9,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.022223069,
        "cumulative_time": 0.022223069,
        "time_percent": 0.49791166396257236,
        "time_per_call": 0.0009662203913043479
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 213,
        "primitive_calls": 34293,
        "total_time": 0.018777627,
        "cumulative_time": 0.024584885,
        "time_percent": 0.55082855561842,
        "time_per_call": 0.00011542199530516433
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.016765187,
        "cumulative_time": 0.20358662700000002,
        "time_percent": 4.561393217565835,
        "time_per_call": 0.0339311045
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 81,
        "primitive_calls": 81,
        "total_time": 0.016395812000000003,
        "cumulative_time": 0.016395812000000003,
        "time_percent": 0.36735097366333663,
        "time_per_call": 0.00020241743209876547
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.014145628,
        "cumulative_time": 0.014145628,
        "time_percent": 0.31693521607099157,
        "time_per_call": 0.0006150273043478261
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.013860385000000001,
        "cumulative_time": 0.069912611,
        "time_percent": 1.5664040135490755,
        "time_per_call": 0.003039678739130435
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.009728898000000001,
        "cumulative_time": 0.015756769,
        "time_percent": 0.3530331058893746,
        "time_per_call": 0.0026261281666666667
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 110,
        "primitive_calls": 110,
        "total_time": 0.009579901,
        "cumulative_time": 0.039266815000000004,
        "time_percent": 0.8797797097763814,
        "time_per_call": 0.0003569710454545455
      },
      {
        "rank": 17,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.008947059,
        "cumulative_time": 0.018165086,
        "time_percent": 0.4069918604079044,
        "time_per_call": 0.0030275143333333334
      },
      {
        "rank": 18,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.005956166000000001,
        "cumulative_time": 0.033382338000000004,
        "time_percent": 0.7479369955851287,
        "time_per_call": 0.0014514060000000001
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 73,
        "primitive_calls": 73,
        "total_time": 0.005757745000000001,
        "cumulative_time": 0.005757745000000001,
        "time_percent": 0.129003262043698,
        "time_per_call": 7.887321917808221e-05
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.004613789,
        "cumulative_time": 0.004613789,
        "time_percent": 0.10337273209934292,
        "time_per_call": 0.0007689648333333333
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.0045391500000000005,
        "cumulative_time": 0.006273636,
        "time_percent": 0.14056188818274815,
        "time_per_call": 0.00027276678260869565
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 213,
        "primitive_calls": 213,
        "total_time": 0.0032839350000000004,
        "cumulative_time": 0.033284521000000004,
        "time_percent": 0.7457453889607769,
        "time_per_call": 0.00015626535680751175
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.0031914820000000003,
        "cumulative_time": 0.015350087,
        "time_percent": 0.3439213260841808,
        "time_per_call": 0.0008078993157894737
      },
      {
        "rank": 24,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 165,
        "primitive_calls": 165,
        "total_time": 0.003188742,
        "cumulative_time": 0.0032792100000000003,
        "time_percent": 0.07347126121881307,
        "time_per_call": 1.9874000000000003e-05
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.0030776370000000003,
        "cumulative_time": 0.007048047000000001,
        "time_percent": 0.15791269916213718,
        "time_per_call": 0.0011746745
      },
      {
        "rank": 26,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.0027848400000000002,
        "cumulative_time": 0.0027848400000000002,
        "time_percent": 0.062394816767635926,
        "time_per_call": 0.00046414000000000004
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.002674334,
        "cumulative_time": 0.002674334,
        "time_percent": 0.05991891092682482,
        "time_per_call": 0.00044572233333333333
      },
      {
        "rank": 28,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 55,
        "primitive_calls": 55,
        "total_time": 0.002561392,
        "cumulative_time": 0.004603463,
        "time_percent": 0.10314137630226208,
        "time_per_call": 8.369932727272728e-05
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 35942,
        "primitive_calls": 35942,
        "total_time": 0.0025181490000000003,
        "cumulative_time": 0.0025181490000000003,
        "time_percent": 0.05641955927399981,
        "time_per_call": 7.006146013020979e-08
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 213,
        "primitive_calls": 213,
        "total_time": 0.0023483830000000003,
        "cumulative_time": 0.0023483830000000003,
        "time_percent": 0.05261592299206819,
        "time_per_call": 1.1025272300469486e-05
      },
      {
        "rank": 31,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 55,
        "primitive_calls": 55,
        "total_time": 0.0023298900000000003,
        "cumulative_time": 0.015940703,
        "time_percent": 0.35715417863586574,
        "time_per_call": 0.00028983096363636367
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 26090,
        "primitive_calls": 26090,
        "total_time": 0.002173519,
        "cumulative_time": 0.002173519,
        "time_percent": 0.04869806514771953,
        "time_per_call": 8.330850900728249e-08
      },
      {
        "rank": 33,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 390,
        "function_name": "_profile_phase",
        "total_calls": 24,
        "primitive_calls": 24,
        "total_time": 0.002173061,
        "cumulative_time": 0.600154237,
        "time_percent": 13.44655838394139,
        "time_per_call": 0.025006426541666668
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 213,
        "primitive_calls": 213,
        "total_time": 0.002169261,
        "cumulative_time": 0.002169261,
        "time_percent": 0.048602663929051104,
        "time_per_call": 1.0184323943661973e-05
      },
      {
        "rank": 35,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 55,
        "primitive_calls": 55,
        "total_time": 0.002019191,
        "cumulative_time": 0.015854483000000003,
        "time_percent": 0.35522240478110007,
        "time_per_call": 0.00028826332727272734
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 50,
        "primitive_calls": 50,
        "total_time": 0.0018439720000000001,
        "cumulative_time": 0.0018439720000000001,
        "time_percent": 0.04131450821758203,
        "time_per_call": 3.687944e-05
      },
      {
        "rank": 37,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.0013787830000000002,
        "cumulative_time": 0.001390886,
        "time_percent": 0.031163038851305662,
        "time_per_call": 5.563544e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 54,
        "primitive_calls": 54,
        "total_time": 0.0013383070000000002,
        "cumulative_time": 0.0013383070000000002,
        "time_percent": 0.02998499735849978,
        "time_per_call": 2.4783462962962966e-05
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 55,
        "primitive_calls": 55,
        "total_time": 0.0010323350000000001,
        "cumulative_time": 0.0010323350000000001,
        "time_percent": 0.023129642337734818,
        "time_per_call": 1.8769727272727273e-05
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 69,
        "primitive_calls": 69,
        "total_time": 0.001031142,
        "cumulative_time": 0.001031142,
        "time_percent": 0.0231029129685776,
        "time_per_call": 1.494408695652174e-05
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 106,
        "primitive_calls": 106,
        "total_time": 0.001008956,
        "cumulative_time": 0.001008956,
        "time_percent": 0.02260583184190362,
        "time_per_call": 9.51845283018868e-06
      },
      {
        "rank": 42,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 46,
        "primitive_calls": 46,
        "total_time": 0.0009971720000000002,
        "cumulative_time": 0.002257808,
        "time_percent": 0.05058657461703456,
        "time_per_call": 4.908278260869565e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.000866951,
        "cumulative_time": 0.000866951,
        "time_percent": 0.019424185515691646,
        "time_per_call": 4.5629e-05
      },
      {
        "rank": 44,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 367,
        "function_name": "get_nn_features",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.0008562200000000001,
        "cumulative_time": 0.0013627530000000002,
        "time_percent": 0.030532714171925913,
        "time_per_call": 0.00022712550000000004
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 55,
        "primitive_calls": 55,
        "total_time": 0.000846176,
        "cumulative_time": 0.000944177,
        "time_percent": 0.021154447261320646,
        "time_per_call": 1.7166854545454545e-05
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 8696,
        "primitive_calls": 8696,
        "total_time": 0.0008381310000000001,
        "cumulative_time": 0.002318028,
        "time_percent": 0.05193581402243919,
        "time_per_call": 2.6656255749770013e-07
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 8307,
        "primitive_calls": 8307,
        "total_time": 0.0007950110000000001,
        "cumulative_time": 0.0007950110000000001,
        "time_percent": 0.017812357504651974,
        "time_per_call": 9.57037438305044e-08
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 46,
        "primitive_calls": 46,
        "total_time": 0.000775989,
        "cumulative_time": 0.000775989,
        "time_percent": 0.017386166339431002,
        "time_per_call": 1.6869326086956523e-05
      },
      {
        "rank": 49,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 359,
        "primitive_calls": 359,
        "total_time": 0.000758175,
        "cumulative_time": 0.0014798970000000002,
        "time_percent": 0.03315734553869311,
        "time_per_call": 4.1222757660167135e-06
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 165,
        "primitive_calls": 165,
        "total_time": 0.0007455690000000001,
        "cumulative_time": 0.0008297160000000001,
        "time_percent": 0.018589928968693287,
        "time_per_call": 5.0285818181818185e-06
      }
    ]
  },
  {
    "config": {
      "num_simulations": 25000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 1824,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 25000,
    "wave_size": 1824,
    "total_time_ms": 1908.4319879984832,
    "simulations_per_second": 13099.759465999827,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 42.18864059448242,
        "cpu_time_ms": 38.982734999081,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 50.12092971801758,
        "cpu_time_ms": 45.91882400018221,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.55401611328125,
        "cpu_time_ms": 4.467131000637892,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6609280109405518,
        "cpu_time_ms": 1.7816970012063393,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 41.34159851074219,
        "cpu_time_ms": 37.993432000803296,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 39.8205451965332,
        "cpu_time_ms": 36.4950189996307,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.814271926879883,
        "cpu_time_ms": 3.7908939993940294,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.7440639734268188,
        "cpu_time_ms": 1.8600860003061825,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 38.94918441772461,
        "cpu_time_ms": 35.851482998623396,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 46.741790771484375,
        "cpu_time_ms": 42.848982999203145,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.1178879737854,
        "cpu_time_ms": 4.13185600154975,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5752960443496704,
        "cpu_time_ms": 1.7376329997205175,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 35.048927307128906,
        "cpu_time_ms": 32.26879399881,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 42.61503982543945,
        "cpu_time_ms": 39.06221199940774,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.4526400566101074,
        "cpu_time_ms": 3.3537409999553347,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.3547519445419312,
        "cpu_time_ms": 1.4435659995797323,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 44.38422393798828,
        "cpu_time_ms": 40.72806400108675,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 63.57059097290039,
        "cpu_time_ms": 58.06448099974659,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.216095924377441,
        "cpu_time_ms": 4.083229001480504,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.7582080364227295,
        "cpu_time_ms": 1.8951660003949655,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 48.420127868652344,
        "cpu_time_ms": 44.4450989998586,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 59.438720703125,
        "cpu_time_ms": 54.333014999429,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.198912143707275,
        "cpu_time_ms": 4.067034000399872,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.431488037109375,
        "cpu_time_ms": 1.5399719995912164,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 45.05561447143555,
        "cpu_time_ms": 41.345552999700885,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 98.49260711669922,
        "cpu_time_ms": 89.84308000071906,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.6112000942230225,
        "cpu_time_ms": 3.495195998766576,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.3926399946212769,
        "cpu_time_ms": 1.482527000916889,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 37.74319839477539,
        "cpu_time_ms": 35.63256199959142,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 96.17375946044922,
        "cpu_time_ms": 87.76974700049323,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 6.180575847625732,
        "cpu_time_ms": 5.932324000241351,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 2.2505600452423096,
        "cpu_time_ms": 2.5698699992062757,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 48.708961486816406,
        "cpu_time_ms": 44.72322699984943,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 191.06777954101562,
        "cpu_time_ms": 174.04798200004734,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.552704095840454,
        "cpu_time_ms": 3.5118939995300025,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5052800178527832,
        "cpu_time_ms": 1.6681130000506528,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 64.27852630615234,
        "cpu_time_ms": 58.871012000963674,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 135.6805419921875,
        "cpu_time_ms": 123.6931680014095,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.129695892333984,
        "cpu_time_ms": 4.027280001537292,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.3853119611740112,
        "cpu_time_ms": 1.4756639993720455,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 51.782047271728516,
        "cpu_time_ms": 47.49736700068752,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 108.08509063720703,
        "cpu_time_ms": 98.91010199862649,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 6.399424076080322,
        "cpu_time_ms": 6.107537999923807,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5831040143966675,
        "cpu_time_ms": 1.7034749998856569,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 46.97932815551758,
        "cpu_time_ms": 43.14179599896306,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 96.14947509765625,
        "cpu_time_ms": 87.73831100006646,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 6.190624237060547,
        "cpu_time_ms": 5.896671000300557,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.437440037727356,
        "cpu_time_ms": 1.5546449994872091,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 47.13593673706055,
        "cpu_time_ms": 43.2905790003133,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 138.1642303466797,
        "cpu_time_ms": 125.91685900042648,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.627808094024658,
        "cpu_time_ms": 3.538670000125421,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5575040578842163,
        "cpu_time_ms": 1.646812999752001,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 65.0633316040039,
        "cpu_time_ms": 59.598954998364206,
        "memory_allocated_mb": 0.25146484375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1288
      },
      {
        "name": "expansion",
        "gpu_time_ms": 140.7183380126953,
        "cpu_time_ms": 128.3173040010297,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1288
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.057727813720703,
        "cpu_time_ms": 4.063544000018737,
        "memory_allocated_mb": 0.00537109375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1288
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5226880311965942,
        "cpu_time_ms": 1.6484269999637036,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1288
      }
    ],
    "peak_gpu_memory_mb": 660.35205078125,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 188.4,
    "avg_ram_usage_mb": 1252.0703125,
    "final_tree_nodes": 5251,
    "final_tree_edges": 5250,
    "tree_memory_mb": 8.756935119628906,
    "efficiency_score": 20313.639788524608,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth"
    ],
    "cprofile_stats": "         391737 function calls (289627 primitive calls) in 1.906 seconds\n\n   Ordered by: cumulative time\n   List reduced from 214 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    1.906    1.906 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    1.906    1.906 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n       14    0.000    0.000    1.904    0.136 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n       56    0.002    0.000    1.904    0.034 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n       14    0.000    0.000    1.034    0.074 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n      174    0.251    0.001    0.721    0.004 {built-in method time.sleep}\n       14    0.060    0.004    0.642    0.046 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n       14    0.000    0.000    0.610    0.044 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n      101    0.061    0.001    0.335    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n       14    0.081    0.006    0.286    0.020 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n      101    0.150    0.001    0.242    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n       14    0.000    0.000    0.232    0.017 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n      528    0.228    0.000    0.228    0.000 {built-in method torch.where}\n      175    0.020    0.000    0.207    0.001 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n       52    0.093    0.002    0.193    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n      101    0.023    0.000    0.170    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n      333    0.126    0.000    0.126    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n      101    0.120    0.001    0.121    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n      637    0.010    0.000    0.106    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n      175    0.017    0.000    0.095    0.001 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n      101    0.093    0.001    0.093    0.001 {built-in method torch.repeat_interleave}\n       52    0.000    0.000    0.089    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n       66    0.084    0.001    0.086    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n102557/637    0.061    0.000    0.078    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n      101    0.070    0.001    0.070    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n      350    0.013    0.000    0.070    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n      331    0.067    0.000    0.067    0.000 {built-in method torch.tensor}\n      350    0.001    0.000    0.054    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n      287    0.001    0.000    0.054    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       52    0.000    0.000    0.047    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n       52    0.008    0.000    0.043    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n       14    0.022    0.002    0.041    0.003 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n       14    0.022    0.002    0.036    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n      101    0.021    0.000    0.029    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n       14    0.000    0.000    0.029    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n  525/350    0.001    0.000    0.027    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n      175    0.009    0.000    0.019    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n      169    0.000    0.000    0.018    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n      175    0.001    0.000    0.018    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n       14    0.007    0.001    0.017    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n      175    0.001    0.000    0.016    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n      114    0.000    0.000    0.015    0.000 {built-in method builtins.next}\n      114    0.000    0.000    0.014    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n      169    0.014    0.000    0.014    0.000 {built-in method torch._C._cuda_synchronize}\n      175    0.000    0.000    0.014    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:812(bcat)\n      525    0.001    0.000    0.013    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:765(open_binary)\n       14    0.013    0.001    0.013    0.001 {built-in method torch.bincount}\n       57    0.000    0.000    0.013    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       57    0.000    0.000    0.012    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n      175    0.001    0.000    0.012    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:795(cat)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 174,
        "primitive_calls": 174,
        "total_time": 0.251170708,
        "cumulative_time": 0.72061485,
        "time_percent": 5.016598951391655,
        "time_per_call": 0.004141464655172414
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 528,
        "primitive_calls": 528,
        "total_time": 0.228412533,
        "cumulative_time": 0.22844414000000002,
        "time_percent": 1.5903261404834617,
        "time_per_call": 0.0004326593560606061
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 101,
        "primitive_calls": 101,
        "total_time": 0.150094574,
        "cumulative_time": 0.242003569,
        "time_percent": 1.6847208331585701,
        "time_per_call": 0.0023960749405940594
      },
      {
        "rank": 4,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 333,
        "primitive_calls": 333,
        "total_time": 0.12598146100000002,
        "cumulative_time": 0.12598146100000002,
        "time_percent": 0.8770267017775012,
        "time_per_call": 0.00037832270570570573
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 101,
        "primitive_calls": 101,
        "total_time": 0.12049151500000001,
        "cumulative_time": 0.12052771500000001,
        "time_percent": 0.8390601563132266,
        "time_per_call": 0.001193343712871287
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 52,
        "primitive_calls": 52,
        "total_time": 0.09299371000000001,
        "cumulative_time": 0.192987718,
        "time_percent": 1.3434943558965908,
        "time_per_call": 0.0037113022692307693
      },
      {
        "rank": 7,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 101,
        "primitive_calls": 101,
        "total_time": 0.092800062,
        "cumulative_time": 0.092807818,
        "time_percent": 0.6460866057086494,
        "time_per_call": 0.0009188892871287128
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 66,
        "primitive_calls": 66,
        "total_time": 0.08426573000000001,
        "cumulative_time": 0.085645131,
        "time_percent": 0.596223175759424,
        "time_per_call": 0.0012976535
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.08106811,
        "cumulative_time": 0.28639741300000005,
        "time_percent": 1.9937709606415728,
        "time_per_call": 0.020456958071428576
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 101,
        "primitive_calls": 101,
        "total_time": 0.070452608,
        "cumulative_time": 0.070452608,
        "time_percent": 0.4904596115603325,
        "time_per_call": 0.0006975505742574257
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 331,
        "primitive_calls": 331,
        "total_time": 0.067415086,
        "cumulative_time": 0.067438464,
        "time_percent": 0.4694764863447705,
        "time_per_call": 0.000203741583081571
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 637,
        "primitive_calls": 102557,
        "total_time": 0.06093827,
        "cumulative_time": 0.078377266,
        "time_percent": 0.5456275435186283,
        "time_per_call": 0.0001230412339089482
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 101,
        "primitive_calls": 101,
        "total_time": 0.060653475000000005,
        "cumulative_time": 0.334684609,
        "time_percent": 2.329924867016446,
        "time_per_call": 0.003313709
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.060433365,
        "cumulative_time": 0.641844213,
        "time_percent": 4.468232934545551,
        "time_per_call": 0.04584601521428572
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 101,
        "primitive_calls": 101,
        "total_time": 0.023110527000000002,
        "cumulative_time": 0.16991349,
        "time_percent": 1.1828618793538552,
        "time_per_call": 0.0016823117821782177
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.022155333000000003,
        "cumulative_time": 0.035774274,
        "time_percent": 0.24904452834298066,
        "time_per_call": 0.002555305285714286
      },
      {
        "rank": 17,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.021654816,
        "cumulative_time": 0.041135764000000005,
        "time_percent": 0.28636882871216796,
        "time_per_call": 0.0029382688571428575
      },
      {
        "rank": 18,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 101,
        "primitive_calls": 101,
        "total_time": 0.020995964000000002,
        "cumulative_time": 0.029109147000000002,
        "time_percent": 0.20264488903622446,
        "time_per_call": 0.0002882093762376238
      },
      {
        "rank": 19,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 175,
        "primitive_calls": 175,
        "total_time": 0.019529598000000002,
        "cumulative_time": 0.206748584,
        "time_percent": 1.4392913630576856,
        "time_per_call": 0.0011814204800000001
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 175,
        "primitive_calls": 175,
        "total_time": 0.017177309,
        "cumulative_time": 0.094759854,
        "time_percent": 0.6596758090822391,
        "time_per_call": 0.00054148488
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 169,
        "primitive_calls": 169,
        "total_time": 0.014259550000000001,
        "cumulative_time": 0.014259550000000001,
        "time_percent": 0.09926862258988539,
        "time_per_call": 8.437603550295858e-05
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.013094860000000002,
        "cumulative_time": 0.013094860000000002,
        "time_percent": 0.09116057064966193,
        "time_per_call": 0.000935347142857143
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 350,
        "primitive_calls": 350,
        "total_time": 0.013018977000000001,
        "cumulative_time": 0.06982534600000001,
        "time_percent": 0.4860928934841678,
        "time_per_call": 0.0001995009885714286
      },
      {
        "rank": 24,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 525,
        "primitive_calls": 525,
        "total_time": 0.011233943000000001,
        "cumulative_time": 0.011412475,
        "time_percent": 0.07944855718388745,
        "time_per_call": 2.173804761904762e-05
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 637,
        "primitive_calls": 637,
        "total_time": 0.010431094,
        "cumulative_time": 0.105602497,
        "time_percent": 0.7351574502170478,
        "time_per_call": 0.00016578100000000002
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 175,
        "primitive_calls": 175,
        "total_time": 0.008836767,
        "cumulative_time": 0.018672256,
        "time_percent": 0.1299879122248404,
        "time_per_call": 0.00010669860571428572
      },
      {
        "rank": 27,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 52,
        "primitive_calls": 52,
        "total_time": 0.008413378000000001,
        "cumulative_time": 0.042801531000000004,
        "time_percent": 0.29796515507910704,
        "time_per_call": 0.0008231063653846155
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 106567,
        "primitive_calls": 106567,
        "total_time": 0.007451742000000001,
        "cumulative_time": 0.007451742000000001,
        "time_percent": 0.05187570184439185,
        "time_per_call": 6.992541781226835e-08
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 637,
        "primitive_calls": 637,
        "total_time": 0.007102332,
        "cumulative_time": 0.007102332,
        "time_percent": 0.0494432653776638,
        "time_per_call": 1.114965777080063e-05
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 637,
        "primitive_calls": 637,
        "total_time": 0.007094719,
        "cumulative_time": 0.007094719,
        "time_percent": 0.04939026706959821,
        "time_per_call": 1.1137706436420722e-05
      },
      {
        "rank": 31,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.007054429,
        "cumulative_time": 0.016774194000000003,
        "time_percent": 0.11677445174886447,
        "time_per_call": 0.0011981567142857145
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.006831666,
        "cumulative_time": 0.006831666,
        "time_percent": 0.04755900949287684,
        "time_per_call": 0.0004879761428571429
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 78002,
        "primitive_calls": 78002,
        "total_time": 0.0065680800000000004,
        "cumulative_time": 0.0065680800000000004,
        "time_percent": 0.04572404140805106,
        "time_per_call": 8.420399476936489e-08
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.005732776,
        "cumulative_time": 0.005732776,
        "time_percent": 0.03990902778393097,
        "time_per_call": 0.000409484
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 303,
        "primitive_calls": 303,
        "total_time": 0.004620793000000001,
        "cumulative_time": 0.004620793000000001,
        "time_percent": 0.03216789845282526,
        "time_per_call": 1.5250141914191422e-05
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 181,
        "primitive_calls": 181,
        "total_time": 0.004294234,
        "cumulative_time": 0.004424038,
        "time_percent": 0.030798177961107565,
        "time_per_call": 2.4442198895027625e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 175,
        "primitive_calls": 175,
        "total_time": 0.003721874,
        "cumulative_time": 0.003721874,
        "time_percent": 0.025910025592189592,
        "time_per_call": 2.126785142857143e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 202,
        "primitive_calls": 202,
        "total_time": 0.0034055970000000002,
        "cumulative_time": 0.0034055970000000002,
        "time_percent": 0.023708246283104722,
        "time_per_call": 1.685939108910891e-05
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 66,
        "primitive_calls": 66,
        "total_time": 0.0033806960000000003,
        "cumulative_time": 0.0033806960000000003,
        "time_percent": 0.02353489663524692,
        "time_per_call": 5.1222666666666673e-05
      },
      {
        "rank": 40,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 134,
        "primitive_calls": 134,
        "total_time": 0.0031970920000000003,
        "cumulative_time": 0.004787617,
        "time_percent": 0.033329252681740966,
        "time_per_call": 3.572848507462687e-05
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 525,
        "primitive_calls": 525,
        "total_time": 0.003159644,
        "cumulative_time": 0.003259863,
        "time_percent": 0.022693711221022515,
        "time_per_call": 6.2092628571428574e-06
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 175,
        "primitive_calls": 175,
        "total_time": 0.0030956050000000004,
        "cumulative_time": 0.003551095,
        "time_percent": 0.02472113841852156,
        "time_per_call": 2.029197142857143e-05
      },
      {
        "rank": 43,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 1188,
        "primitive_calls": 1188,
        "total_time": 0.002796016,
        "cumulative_time": 0.005046264,
        "time_percent": 0.03512983765300626,
        "time_per_call": 4.2476969696969695e-06
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 278,
        "primitive_calls": 278,
        "total_time": 0.0026779110000000003,
        "cumulative_time": 0.0026779110000000003,
        "time_percent": 0.018642421141501844,
        "time_per_call": 9.632773381294964e-06
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 26147,
        "primitive_calls": 26147,
        "total_time": 0.00262538,
        "cumulative_time": 0.007671644000000001,
        "time_percent": 0.05340656141883571,
        "time_per_call": 2.934043676138754e-07
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full_like>",
        "total_calls": 66,
        "primitive_calls": 66,
        "total_time": 0.0025910660000000004,
        "cumulative_time": 0.0025910660000000004,
        "time_percent": 0.018037845013305753,
        "time_per_call": 3.925857575757576e-05
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 24843,
        "primitive_calls": 24843,
        "total_time": 0.002371289,
        "cumulative_time": 0.002371289,
        "time_percent": 0.01650785563307024,
        "time_per_call": 9.545099223121201e-08
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.ones>",
        "total_calls": 181,
        "primitive_calls": 181,
        "total_time": 0.002292962,
        "cumulative_time": 0.002292962,
        "time_percent": 0.01596257801900823,
        "time_per_call": 1.2668298342541437e-05
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'numpy' of 'torch._C.TensorBase' objects>",
        "total_calls": 333,
        "primitive_calls": 333,
        "total_time": 0.0022312350000000002,
        "cumulative_time": 0.0022312350000000002,
        "time_percent": 0.015532862195815643,
        "time_per_call": 6.700405405405406e-06
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 52,
        "primitive_calls": 52,
        "total_time": 0.002221921,
        "cumulative_time": 0.002221921,
        "time_percent": 0.015468022284962761,
        "time_per_call": 4.272925e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 50000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 1824,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 50000,
    "wave_size": 1824,
    "total_time_ms": 4679.542392999792,
    "simulations_per_second": 10684.805436274251,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 30.049503326416016,
        "cpu_time_ms": 27.982510000583716,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 33.70655822753906,
        "cpu_time_ms": 30.935918000977836,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.375744104385376,
        "cpu_time_ms": 3.2983199998852797,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 2.3644158840179443,
        "cpu_time_ms": 2.40401699920767,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 48.12607955932617,
        "cpu_time_ms": 44.34367000067141,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 44.13302230834961,
        "cpu_time_ms": 40.95629299990833,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.5549120903015137,
        "cpu_time_ms": 3.4875689998443704,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.427456021308899,
        "cpu_time_ms": 1.53495899940026,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 34.79654312133789,
        "cpu_time_ms": 31.988427001124364,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 33.31190490722656,
        "cpu_time_ms": 30.54295599940815,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.3154239654541016,
        "cpu_time_ms": 3.2689109993953025,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.3272639513015747,
        "cpu_time_ms": 1.456944999517873,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 34.60950469970703,
        "cpu_time_ms": 31.837290998737444,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 58.29017639160156,
        "cpu_time_ms": 53.33730500024103,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 5.331967830657959,
        "cpu_time_ms": 5.194871000639978,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.70905601978302,
        "cpu_time_ms": 1.8988649990205886,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 138.59756469726562,
        "cpu_time_ms": 126.59663100021135,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 67.65760040283203,
        "cpu_time_ms": 61.79378300112148,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.458336114883423,
        "cpu_time_ms": 3.381538001121953,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4202879667282104,
        "cpu_time_ms": 1.5345219999289839,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 46.829952239990234,
        "cpu_time_ms": 42.962984000041615,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 64.30182647705078,
        "cpu_time_ms": 58.78035400019144,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.440416097640991,
        "cpu_time_ms": 3.3565290013939375,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.3980799913406372,
        "cpu_time_ms": 1.4976839993323665,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 50.69721603393555,
        "cpu_time_ms": 46.47755599944503,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 97.8892822265625,
        "cpu_time_ms": 89.34623599998304,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.940768003463745,
        "cpu_time_ms": 3.833603001112351,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.435744047164917,
        "cpu_time_ms": 1.5694460016675293,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 36.30303955078125,
        "cpu_time_ms": 33.43292099998507,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 89.47325134277344,
        "cpu_time_ms": 81.73372599958384,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.656287908554077,
        "cpu_time_ms": 3.549434000888141,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 2.4957759380340576,
        "cpu_time_ms": 2.5097660000028554,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 47.5366096496582,
        "cpu_time_ms": 43.679967000571196,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 103.09446716308594,
        "cpu_time_ms": 94.04071099925204,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.45692777633667,
        "cpu_time_ms": 4.273827000361052,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.70307195186615,
        "cpu_time_ms": 1.8546899991633836,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 59.35446548461914,
        "cpu_time_ms": 54.40805799844384,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 141.3219451904297,
        "cpu_time_ms": 128.8217990004341,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.0088958740234375,
        "cpu_time_ms": 4.024026000479353,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6127040386199951,
        "cpu_time_ms": 1.7392730005667545,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 63.13849639892578,
        "cpu_time_ms": 58.902153999952134,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 127.08319854736328,
        "cpu_time_ms": 115.96754899983353,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.512959957122803,
        "cpu_time_ms": 4.561604999253177,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5957119464874268,
        "cpu_time_ms": 1.7138550010713516,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 56.84291076660156,
        "cpu_time_ms": 52.11867399884795,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 107.56598663330078,
        "cpu_time_ms": 98.09358699931181,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.651808023452759,
        "cpu_time_ms": 3.5590850002336083,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4511359930038452,
        "cpu_time_ms": 1.5577529993606731,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 52.12742233276367,
        "cpu_time_ms": 47.87609000049997,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 132.85081481933594,
        "cpu_time_ms": 121.12132799848041,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.265056133270264,
        "cpu_time_ms": 4.174532001343323,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 2.63372802734375,
        "cpu_time_ms": 2.6833379997697193,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 60.50214385986328,
        "cpu_time_ms": 55.453733999456745,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 109.51074981689453,
        "cpu_time_ms": 99.84008599894878,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.5173120498657227,
        "cpu_time_ms": 3.422861000217381,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 2.1483519077301025,
        "cpu_time_ms": 2.1701200003008125,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 62.70924758911133,
        "cpu_time_ms": 57.57041799915896,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 116.4119644165039,
        "cpu_time_ms": 106.116375000056,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.4458560943603516,
        "cpu_time_ms": 3.3984639994741883,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.3671040534973145,
        "cpu_time_ms": 1.5208239983621752,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 62.59366226196289,
        "cpu_time_ms": 57.40685199998552,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 142.68028259277344,
        "cpu_time_ms": 130.125104000399,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.9820799827575684,
        "cpu_time_ms": 3.8427620002039475,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.3772799968719482,
        "cpu_time_ms": 1.481423998484388,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 63.39740753173828,
        "cpu_time_ms": 58.09770199994091,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 122.80758666992188,
        "cpu_time_ms": 111.93851900134177,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.217696189880371,
        "cpu_time_ms": 4.089045000000624,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4387840032577515,
        "cpu_time_ms": 1.6029569997044746,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 65.10671997070312,
        "cpu_time_ms": 60.08432099952188,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 131.63644409179688,
        "cpu_time_ms": 119.99577999995381,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.8469760417938232,
        "cpu_time_ms": 3.8105069997982355,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4470080137252808,
        "cpu_time_ms": 1.5395800000987947,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 59.83087921142578,
        "cpu_time_ms": 54.82466899957217,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 135.4081268310547,
        "cpu_time_ms": 123.41394400027639,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 5.175392150878906,
        "cpu_time_ms": 5.011687000660459,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.656831979751587,
        "cpu_time_ms": 1.7801479989429936,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 66.8322525024414,
        "cpu_time_ms": 61.19159599984414,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 161.396728515625,
        "cpu_time_ms": 147.0544690000679,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.237088203430176,
        "cpu_time_ms": 4.139593000218156,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4561280012130737,
        "cpu_time_ms": 1.5876010002102703,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 145.40748596191406,
        "cpu_time_ms": 132.71280899971316,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 138.4850616455078,
        "cpu_time_ms": 126.22405900037847,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.005695819854736,
        "cpu_time_ms": 3.9113170005293796,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4078400135040283,
        "cpu_time_ms": 1.5199490007944405,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 56.333343505859375,
        "cpu_time_ms": 51.63997799900244,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 101.93981170654297,
        "cpu_time_ms": 92.99053799986723,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.834527969360352,
        "cpu_time_ms": 4.705723000370199,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 2.405184030532837,
        "cpu_time_ms": 2.4767539998720167,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 57.97123336791992,
        "cpu_time_ms": 53.52565700013656,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 158.30726623535156,
        "cpu_time_ms": 144.25444500011508,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.458559989929199,
        "cpu_time_ms": 3.442189999987022,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6166720390319824,
        "cpu_time_ms": 1.7409310003131395,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 63.693119049072266,
        "cpu_time_ms": 58.29543300023943,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 151.86239624023438,
        "cpu_time_ms": 138.3944210010668,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.052095890045166,
        "cpu_time_ms": 3.936699000405497,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6312320232391357,
        "cpu_time_ms": 1.7805959996621823,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 61.0722541809082,
        "cpu_time_ms": 55.99909500051581,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 201.45263671875,
        "cpu_time_ms": 183.56611099989095,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.020768165588379,
        "cpu_time_ms": 3.955681999286753,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.8657280206680298,
        "cpu_time_ms": 2.0743519999086857,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 61.94966506958008,
        "cpu_time_ms": 57.565232998967986,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 129.4607696533203,
        "cpu_time_ms": 118.03235200022755,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.8978559970855713,
        "cpu_time_ms": 3.8444120000349358,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6035840511322021,
        "cpu_time_ms": 1.7267599996557692,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 58.258399963378906,
        "cpu_time_ms": 53.392916001030244,
        "memory_allocated_mb": 0.35546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "expansion",
        "gpu_time_ms": 125.40790557861328,
        "cpu_time_ms": 114.32104899904516,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.5679678916931152,
        "cpu_time_ms": 3.497302001051139,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.3585920333862305,
        "cpu_time_ms": 1.5017300011095358,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1824
      },
      {
        "name": "selection",
        "gpu_time_ms": 62.551422119140625,
        "cpu_time_ms": 57.30742299965641,
        "memory_allocated_mb": 0.146484375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 752
      },
      {
        "name": "expansion",
        "gpu_time_ms": 157.70262145996094,
        "cpu_time_ms": 143.72523699967132,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 752
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.84550404548645,
        "cpu_time_ms": 3.790503998970962,
        "memory_allocated_mb": 0.0029296875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 752
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5554560422897339,
        "cpu_time_ms": 2.097144999424927,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 752
      }
    ],
    "peak_gpu_memory_mb": 660.6376953125,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 281.5,
    "avg_ram_usage_mb": 1255.7553835556844,
    "final_tree_nodes": 13551,
    "final_tree_edges": 13550,
    "tree_memory_mb": 8.756935119628906,
    "efficiency_score": 16561.635589942114,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth"
    ],
    "cprofile_stats": "         927184 function calls (684485 primitive calls) in 4.677 seconds\n\n   Ordered by: cumulative time\n   List reduced from 214 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    4.677    4.677 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    4.677    4.677 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n       28    0.000    0.000    4.676    0.167 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n      112    0.004    0.000    4.456    0.040 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n       28    0.000    0.000    2.916    0.104 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n      429    0.636    0.001    2.020    0.005 {built-in method time.sleep}\n       28    0.000    0.000    1.579    0.056 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n       28    0.094    0.003    0.949    0.034 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n      267    0.163    0.001    0.867    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n       28    0.186    0.007    0.808    0.029 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n      267    0.376    0.001    0.680    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n      430    0.064    0.000    0.591    0.001 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n     1294    0.561    0.000    0.562    0.000 {built-in method torch.where}\n      122    0.204    0.002    0.516    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n      860    0.047    0.000    0.442    0.001 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n      267    0.060    0.000    0.419    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n      430    0.047    0.000    0.407    0.001 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n      859    0.334    0.000    0.334    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n      267    0.311    0.001    0.311    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n      122    0.001    0.000    0.269    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n     1514    0.024    0.000    0.253    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n      267    0.247    0.001    0.247    0.001 {built-in method torch.repeat_interleave}\n      150    0.195    0.001    0.200    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n243754/1514    0.148    0.000    0.190    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n      857    0.179    0.000    0.179    0.000 {built-in method torch.tensor}\n      267    0.175    0.001    0.175    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n      122    0.000    0.000    0.163    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n       28    0.049    0.002    0.151    0.005 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n      860    0.003    0.000    0.138    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n      654    0.003    0.000    0.121    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       28    0.000    0.000    0.120    0.004 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n      122    0.020    0.000    0.103    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n       28    0.047    0.002    0.089    0.003 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n      267    0.052    0.000    0.073    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n 1290/860    0.002    0.000    0.063    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n       28    0.000    0.000    0.061    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n      430    0.022    0.000    0.040    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n      337    0.001    0.000    0.038    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n      430    0.002    0.000    0.038    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n       28    0.015    0.001    0.038    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n      430    0.003    0.000    0.033    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n      226    0.000    0.000    0.031    0.000 {built-in method builtins.next}\n      226    0.000    0.000    0.030    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n     1290    0.002    0.000    0.030    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:765(open_binary)\n      430    0.001    0.000    0.029    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:812(bcat)\n      337    0.028    0.000    0.028    0.000 {built-in method torch._C._cuda_synchronize}\n      113    0.000    0.000    0.028    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n      113    0.001    0.000    0.027    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n      430    0.001    0.000    0.026    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:795(cat)\n     1290    0.024    0.000    0.025    0.000 {built-in method _io.open}\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 429,
        "primitive_calls": 429,
        "total_time": 0.635991677,
        "cumulative_time": 2.020333961,
        "time_percent": 5.684102772274162,
        "time_per_call": 0.004709403172494173
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 1294,
        "primitive_calls": 1294,
        "total_time": 0.561493444,
        "cumulative_time": 0.561549383,
        "time_percent": 1.579889496635129,
        "time_per_call": 0.0004339639744976816
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 267,
        "primitive_calls": 267,
        "total_time": 0.375589094,
        "cumulative_time": 0.679535564,
        "time_percent": 1.9118373782517863,
        "time_per_call": 0.002545077018726592
      },
      {
        "rank": 4,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 859,
        "primitive_calls": 859,
        "total_time": 0.33379379400000003,
        "cumulative_time": 0.33387683900000004,
        "time_percent": 0.9393448324843728,
        "time_per_call": 0.00038868083701979047
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 267,
        "primitive_calls": 267,
        "total_time": 0.311302674,
        "cumulative_time": 0.311302674,
        "time_percent": 0.8758336128864193,
        "time_per_call": 0.001165927617977528
      },
      {
        "rank": 6,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 267,
        "primitive_calls": 267,
        "total_time": 0.24656413600000002,
        "cumulative_time": 0.24656413600000002,
        "time_percent": 0.6936951593326128,
        "time_per_call": 0.0009234611835205993
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 122,
        "primitive_calls": 122,
        "total_time": 0.20392664500000002,
        "cumulative_time": 0.51609198,
        "time_percent": 1.4519974968962381,
        "time_per_call": 0.004230262131147541
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 150,
        "primitive_calls": 150,
        "total_time": 0.195327207,
        "cumulative_time": 0.199587068,
        "time_percent": 0.5615276624698939,
        "time_per_call": 0.0013305804533333334
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.186110575,
        "cumulative_time": 0.8078506990000001,
        "time_percent": 2.2728452257945886,
        "time_per_call": 0.02885181067857143
      },
      {
        "rank": 10,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 857,
        "primitive_calls": 857,
        "total_time": 0.17926245700000001,
        "cumulative_time": 0.17948127,
        "time_percent": 0.5049610629092858,
        "time_per_call": 0.00020942971995332554
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 267,
        "primitive_calls": 267,
        "total_time": 0.17531344000000001,
        "cumulative_time": 0.175345584,
        "time_percent": 0.49332552902645194,
        "time_per_call": 0.0006567250337078652
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 267,
        "primitive_calls": 267,
        "total_time": 0.16343142600000002,
        "cumulative_time": 0.866755738,
        "time_percent": 2.4385714383634705,
        "time_per_call": 0.003246276172284644
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 1514,
        "primitive_calls": 243754,
        "total_time": 0.147883769,
        "cumulative_time": 0.190458877,
        "time_percent": 0.5358459797528117,
        "time_per_call": 0.00012579846565389697
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.094097766,
        "cumulative_time": 0.9492049180000001,
        "time_percent": 2.6705378467179415,
        "time_per_call": 0.03390017564285715
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 430,
        "primitive_calls": 430,
        "total_time": 0.064411828,
        "cumulative_time": 0.590653461,
        "time_percent": 1.6617722811834816,
        "time_per_call": 0.0013736127000000002
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 267,
        "primitive_calls": 267,
        "total_time": 0.059735459000000005,
        "cumulative_time": 0.419258991,
        "time_percent": 1.1795630024772763,
        "time_per_call": 0.001570258393258427
      },
      {
        "rank": 17,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 267,
        "primitive_calls": 267,
        "total_time": 0.052264611,
        "cumulative_time": 0.07308677100000001,
        "time_percent": 0.20562576567887872,
        "time_per_call": 0.00027373322471910115
      },
      {
        "rank": 18,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.048841051,
        "cumulative_time": 0.151115828,
        "time_percent": 0.42515639169088126,
        "time_per_call": 0.005396993857142858
      },
      {
        "rank": 19,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.047475418000000005,
        "cumulative_time": 0.089084675,
        "time_percent": 0.2506350226791257,
        "time_per_call": 0.0031815955357142856
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 860,
        "primitive_calls": 860,
        "total_time": 0.047148999000000004,
        "cumulative_time": 0.44230296100000005,
        "time_percent": 1.2443959936013624,
        "time_per_call": 0.0005143057686046512
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 430,
        "primitive_calls": 430,
        "total_time": 0.046885086000000006,
        "cumulative_time": 0.40661489300000003,
        "time_percent": 1.1439895013224808,
        "time_per_call": 0.0009456160302325582
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 337,
        "primitive_calls": 337,
        "total_time": 0.028228472,
        "cumulative_time": 0.028228472,
        "time_percent": 0.07941931336581813,
        "time_per_call": 8.37640118694362e-05
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.025249203,
        "cumulative_time": 0.025249203,
        "time_percent": 0.07103729756588154,
        "time_per_call": 0.0009017572500000001
      },
      {
        "rank": 24,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 1290,
        "primitive_calls": 1290,
        "total_time": 0.024393269000000002,
        "cumulative_time": 0.025473849000000003,
        "time_percent": 0.07166932720851958,
        "time_per_call": 1.9747169767441864e-05
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 1514,
        "primitive_calls": 1514,
        "total_time": 0.023978956000000003,
        "cumulative_time": 0.253310386,
        "time_percent": 0.712675376993496,
        "time_per_call": 0.00016731201188903565
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 430,
        "primitive_calls": 430,
        "total_time": 0.021905744,
        "cumulative_time": 0.039882594,
        "time_percent": 0.11220756939049686,
        "time_per_call": 9.275021860465116e-05
      },
      {
        "rank": 27,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 122,
        "primitive_calls": 122,
        "total_time": 0.02044543,
        "cumulative_time": 0.10330987400000001,
        "time_percent": 0.290656867895265,
        "time_per_call": 0.0008468022459016395
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 252088,
        "primitive_calls": 252088,
        "total_time": 0.017635477,
        "cumulative_time": 0.017635477,
        "time_percent": 0.04961648204758225,
        "time_per_call": 6.995762194154422e-08
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 1514,
        "primitive_calls": 1514,
        "total_time": 0.016589069,
        "cumulative_time": 0.016589069,
        "time_percent": 0.04667246846935885,
        "time_per_call": 1.0957112945838839e-05
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 1514,
        "primitive_calls": 1514,
        "total_time": 0.016486441,
        "cumulative_time": 0.016486441,
        "time_percent": 0.04638373001790788,
        "time_per_call": 1.0889326948480845e-05
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 185363,
        "primitive_calls": 185363,
        "total_time": 0.016275334000000002,
        "cumulative_time": 0.016275334000000002,
        "time_percent": 0.04578979163588289,
        "time_per_call": 8.780249564368295e-08
      },
      {
        "rank": 32,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.015099708000000002,
        "cumulative_time": 0.038052715,
        "time_percent": 0.10705930158051659,
        "time_per_call": 0.0013590255357142857
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.012458085,
        "cumulative_time": 0.012458085,
        "time_percent": 0.035050163414902455,
        "time_per_call": 0.0004449316071428572
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 801,
        "primitive_calls": 801,
        "total_time": 0.012066100000000001,
        "cumulative_time": 0.012066100000000001,
        "time_percent": 0.03394733434396655,
        "time_per_call": 1.506379525593009e-05
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.011496744000000001,
        "cumulative_time": 0.011496744000000001,
        "time_percent": 0.032345481343183914,
        "time_per_call": 0.00041059800000000003
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 430,
        "primitive_calls": 430,
        "total_time": 0.010713211,
        "cumulative_time": 0.012122198,
        "time_percent": 0.03410516310073368,
        "time_per_call": 2.8191158139534885e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 445,
        "primitive_calls": 445,
        "total_time": 0.010502155,
        "cumulative_time": 0.010502155,
        "time_percent": 0.029547257781483663,
        "time_per_call": 2.3600348314606742e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 534,
        "primitive_calls": 534,
        "total_time": 0.008967021,
        "cumulative_time": 0.009091801,
        "time_percent": 0.025579301376236683,
        "time_per_call": 1.702584456928839e-05
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 430,
        "primitive_calls": 430,
        "total_time": 0.008795217000000001,
        "cumulative_time": 0.008795217000000001,
        "time_percent": 0.024744877974385963,
        "time_per_call": 2.0453993023255817e-05
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 1290,
        "primitive_calls": 1290,
        "total_time": 0.008481691000000001,
        "cumulative_time": 0.009741407,
        "time_percent": 0.027406933508727437,
        "time_per_call": 7.551478294573644e-06
      },
      {
        "rank": 41,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 150,
        "primitive_calls": 150,
        "total_time": 0.007815364,
        "cumulative_time": 0.007815364,
        "time_percent": 0.021988113369506283,
        "time_per_call": 5.210242666666667e-05
      },
      {
        "rank": 42,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 316,
        "primitive_calls": 316,
        "total_time": 0.0077279620000000005,
        "cumulative_time": 0.013092707,
        "time_percent": 0.036835638855685866,
        "time_per_call": 4.1432617088607595e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 62268,
        "primitive_calls": 62268,
        "total_time": 0.006214947,
        "cumulative_time": 0.017725495,
        "time_percent": 0.04986974293079847,
        "time_per_call": 2.8466459497655296e-07
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 628,
        "primitive_calls": 628,
        "total_time": 0.0060290100000000004,
        "cumulative_time": 0.0060290100000000004,
        "time_percent": 0.016962300845601956,
        "time_per_call": 9.60033439490446e-06
      },
      {
        "rank": 45,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 2926,
        "primitive_calls": 2926,
        "total_time": 0.0059471770000000005,
        "cumulative_time": 0.011510548,
        "time_percent": 0.03238431816728483,
        "time_per_call": 3.933885167464115e-06
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 59046,
        "primitive_calls": 59046,
        "total_time": 0.005944083,
        "cumulative_time": 0.005944083,
        "time_percent": 0.016723363221694477,
        "time_per_call": 1.0066868204450767e-07
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'numpy' of 'torch._C.TensorBase' objects>",
        "total_calls": 859,
        "primitive_calls": 859,
        "total_time": 0.005693798000000001,
        "cumulative_time": 0.005693798000000001,
        "time_percent": 0.01601919960824194,
        "time_per_call": 6.62840279394645e-06
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.ones>",
        "total_calls": 445,
        "primitive_calls": 445,
        "total_time": 0.0056392410000000006,
        "cumulative_time": 0.005815202,
        "time_percent": 0.0163607633428948,
        "time_per_call": 1.3067869662921348e-05
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'split' of 'bytes' objects>",
        "total_calls": 23650,
        "primitive_calls": 23650,
        "total_time": 0.005293913,
        "cumulative_time": 0.005293913,
        "time_percent": 0.014894144305025732,
        "time_per_call": 2.2384410147991542e-07
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.topk>",
        "total_calls": 267,
        "primitive_calls": 267,
        "total_time": 0.005148024,
        "cumulative_time": 0.005200063,
        "time_percent": 0.01463010229243001,
        "time_per_call": 1.9475891385767793e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 1000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 2048,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 1000,
    "wave_size": 2048,
    "total_time_ms": 67.19894399975601,
    "simulations_per_second": 14881.186228218568,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 24.843168258666992,
        "cpu_time_ms": 23.23326899931999,
        "memory_allocated_mb": 0.19482421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "expansion",
        "gpu_time_ms": 34.28441619873047,
        "cpu_time_ms": 31.420069999512634,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 6.075488090515137,
        "cpu_time_ms": 5.791506999230478,
        "memory_allocated_mb": 0.00390625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.3895679712295532,
        "cpu_time_ms": 1.4888250007061288,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      }
    ],
    "peak_gpu_memory_mb": 760.09326171875,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 182.3,
    "avg_ram_usage_mb": 1257.42431640625,
    "final_tree_nodes": 351,
    "final_tree_edges": 350,
    "tree_memory_mb": 9.375587463378906,
    "efficiency_score": 20047.980248158427,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "cprofile_stats": "         16555 function calls (12387 primitive calls) in 0.066 seconds\n\n   Ordered by: cumulative time\n   List reduced from 214 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    0.065    0.065 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    0.065    0.065 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n        1    0.000    0.000    0.064    0.064 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n        4    0.001    0.000    0.063    0.016 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n        1    0.000    0.000    0.032    0.032 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n        1    0.005    0.005    0.031    0.031 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n        1    0.000    0.000    0.024    0.024 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n        5    0.006    0.001    0.016    0.003 {built-in method time.sleep}\n        3    0.002    0.001    0.008    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n       19    0.008    0.000    0.008    0.000 {built-in method torch.where}\n        1    0.000    0.000    0.006    0.006 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n        1    0.003    0.003    0.005    0.005 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n        3    0.003    0.001    0.005    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n        2    0.002    0.001    0.005    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n        2    0.000    0.000    0.004    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n       26    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        3    0.004    0.001    0.004    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n        3    0.001    0.000    0.004    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n       13    0.004    0.000    0.004    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n        3    0.003    0.001    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n  4186/26    0.002    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        3    0.003    0.001    0.003    0.001 {built-in method torch.repeat_interleave}\n        2    0.000    0.000    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n        1    0.002    0.002    0.003    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n       14    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       11    0.002    0.000    0.002    0.000 {built-in method torch.tensor}\n        1    0.001    0.001    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n        3    0.002    0.001    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n       12    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n       13    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        2    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n       13    0.001    0.000    0.001    0.000 {built-in method torch._C._cuda_synchronize}\n       10    0.000    0.000    0.001    0.000 {built-in method builtins.next}\n       10    0.000    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n       18    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:765(open_binary)\n        5    0.000    0.000    0.001    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n        5    0.000    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n    18/12    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n        6    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n       12    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n        6    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n        1    0.001    0.001    0.001    0.001 {built-in method torch.bincount}\n        3    0.001    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:489(_extract_policy)\n        6    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n        6    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1113(memory_info)\n        6    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1893(memory_info)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.008384134,
        "cumulative_time": 0.008384134,
        "time_percent": 1.7552924518995687,
        "time_per_call": 0.0004412702105263158
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.005866284,
        "cumulative_time": 0.016251766,
        "time_percent": 3.4024506514134973,
        "time_per_call": 0.0032503532
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0047806770000000005,
        "cumulative_time": 0.031154366000000003,
        "time_percent": 6.522441492886036,
        "time_per_call": 0.031154366000000003
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.003874067,
        "cumulative_time": 0.003952401,
        "time_percent": 0.8274700335395772,
        "time_per_call": 0.0013174670000000001
      },
      {
        "rank": 5,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.0036416770000000003,
        "cumulative_time": 0.0036416770000000003,
        "time_percent": 0.7624172216660977,
        "time_per_call": 0.000280129
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0032193300000000003,
        "cumulative_time": 0.005243747,
        "time_percent": 1.0978247161568515,
        "time_per_call": 0.0017479156666666666
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.00317038,
        "cumulative_time": 0.00317038,
        "time_percent": 0.6637470350131993,
        "time_per_call": 0.0010567933333333333
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0031591230000000002,
        "cumulative_time": 0.005346224,
        "time_percent": 1.1192791805765891,
        "time_per_call": 0.005346224
      },
      {
        "rank": 9,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.002862496,
        "cumulative_time": 0.002862496,
        "time_percent": 0.5992888022057744,
        "time_per_call": 0.0009541653333333334
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 26,
        "primitive_calls": 4186,
        "total_time": 0.002228821,
        "cumulative_time": 0.0029454330000000003,
        "time_percent": 0.6166523951639971,
        "time_per_call": 0.00011328588461538463
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0020787310000000003,
        "cumulative_time": 0.005001987,
        "time_percent": 1.0472101263648421,
        "time_per_call": 0.0025009935
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.001990113,
        "cumulative_time": 0.001990113,
        "time_percent": 0.4166477214375637,
        "time_per_call": 0.00018091936363636362
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.001853269,
        "cumulative_time": 0.001853269,
        "time_percent": 0.3879982222420899,
        "time_per_call": 0.0006177563333333334
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.001706599,
        "cumulative_time": 0.0025621230000000004,
        "time_percent": 0.5364030635410025,
        "time_per_call": 0.0025621230000000004
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0017019880000000002,
        "cumulative_time": 0.008398834,
        "time_percent": 1.7583700266428786,
        "time_per_call": 0.0027996113333333336
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 390,
        "function_name": "_profile_phase",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0014469600000000002,
        "cumulative_time": 0.06312450900000001,
        "time_percent": 13.215673100831454,
        "time_per_call": 0.015781127250000002
      },
      {
        "rank": 17,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.001391782,
        "cumulative_time": 0.0019755040000000003,
        "time_percent": 0.413589198347427,
        "time_per_call": 0.0019755040000000003
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.001356639,
        "cumulative_time": 0.001356639,
        "time_percent": 0.2840243484482213,
        "time_per_call": 0.00010435684615384616
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000807002,
        "cumulative_time": 0.000807002,
        "time_percent": 0.16895299136056938,
        "time_per_call": 0.000807002
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0006083480000000001,
        "cumulative_time": 0.0037787280000000003,
        "time_percent": 0.7911100581385692,
        "time_per_call": 0.001259576
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.000538809,
        "cumulative_time": 0.000752774,
        "time_percent": 0.1575998809401479,
        "time_per_call": 0.00025092466666666667
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0005173840000000001,
        "cumulative_time": 0.0005235260000000001,
        "time_percent": 0.1096047887799949,
        "time_per_call": 0.0005235260000000001
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.00047192200000000005,
        "cumulative_time": 0.00047192200000000005,
        "time_percent": 0.09880103591919552,
        "time_per_call": 2.6217888888888893e-05
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000469854,
        "cumulative_time": 0.001115705,
        "time_percent": 0.23358268904655013,
        "time_per_call": 0.001115705
      },
      {
        "rank": 25,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000426955,
        "cumulative_time": 0.000426955,
        "time_percent": 0.08938679758705914,
        "time_per_call": 0.000426955
      },
      {
        "rank": 26,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000406349,
        "cumulative_time": 0.000406349,
        "time_percent": 0.08507274961694768,
        "time_per_call": 0.000406349
      },
      {
        "rank": 27,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 26,
        "primitive_calls": 26,
        "total_time": 0.00037452400000000005,
        "cumulative_time": 0.003985379,
        "time_percent": 0.8343742689058943,
        "time_per_call": 0.0001532838076923077
      },
      {
        "rank": 28,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000312477,
        "cumulative_time": 0.001472082,
        "time_percent": 0.3081933594068536,
        "time_per_call": 0.000736041
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 4467,
        "primitive_calls": 4467,
        "total_time": 0.000302027,
        "cumulative_time": 0.000302027,
        "time_percent": 0.06323201816310083,
        "time_per_call": 6.76129393328856e-08
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 3187,
        "primitive_calls": 3187,
        "total_time": 0.00028898000000000004,
        "cumulative_time": 0.00028898000000000004,
        "time_percent": 0.06050051355929396,
        "time_per_call": 9.067461562598056e-08
      },
      {
        "rank": 31,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.000281366,
        "cumulative_time": 0.000911291,
        "time_percent": 0.19078681397315572,
        "time_per_call": 0.00015188183333333333
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 26,
        "primitive_calls": 26,
        "total_time": 0.00027900500000000003,
        "cumulative_time": 0.00027900500000000003,
        "time_percent": 0.05841215926919098,
        "time_per_call": 1.073096153846154e-05
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 26,
        "primitive_calls": 26,
        "total_time": 0.000257327,
        "cumulative_time": 0.000257327,
        "time_percent": 0.053873678637526595,
        "time_per_call": 9.897192307692308e-06
      },
      {
        "rank": 34,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.00019280300000000002,
        "cumulative_time": 0.00019280300000000002,
        "time_percent": 0.040365009743831934,
        "time_per_call": 6.426766666666667e-05
      },
      {
        "rank": 35,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 367,
        "function_name": "get_nn_features",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000168297,
        "cumulative_time": 0.00025177,
        "time_percent": 0.052710271641025125,
        "time_per_call": 0.00025177
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.00016605500000000002,
        "cumulative_time": 0.00016605500000000002,
        "time_percent": 0.034765079863964835,
        "time_per_call": 2.372214285714286e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.000146396,
        "cumulative_time": 0.000146396,
        "time_percent": 0.03064929470214685,
        "time_per_call": 2.4399333333333332e-05
      },
      {
        "rank": 38,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.000124286,
        "cumulative_time": 0.00018910400000000002,
        "time_percent": 0.03959059144617871,
        "time_per_call": 3.78208e-05
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.000118808,
        "cumulative_time": 0.000118808,
        "time_percent": 0.02487350340837634,
        "time_per_call": 9.139076923076924e-06
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.00011834100000000001,
        "cumulative_time": 0.00011834100000000001,
        "time_percent": 0.024775732836599094,
        "time_per_call": 1.3149e-05
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.00011538100000000001,
        "cumulative_time": 0.00011538100000000001,
        "time_percent": 0.024156030711415654,
        "time_per_call": 2.30762e-05
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.000111744,
        "cumulative_time": 0.000111744,
        "time_percent": 0.02339459266097911,
        "time_per_call": 1.8624e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.00010596600000000001,
        "cumulative_time": 0.00010596600000000001,
        "time_percent": 0.022184917363914952,
        "time_per_call": 5.8870000000000006e-06
      },
      {
        "rank": 44,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1098,
        "function_name": "remove_virtual_loss",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000102885,
        "cumulative_time": 0.00012341,
        "time_percent": 0.025836972725975734,
        "time_per_call": 0.00012341
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 1065,
        "primitive_calls": 1065,
        "total_time": 0.00010117000000000001,
        "cumulative_time": 0.000276512,
        "time_percent": 0.057890227715784795,
        "time_per_call": 2.596356807511737e-07
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 9.4182e-05,
        "cumulative_time": 9.4182e-05,
        "time_percent": 0.019717832957441422,
        "time_per_call": 4.7091e-05
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 1014,
        "primitive_calls": 1014,
        "total_time": 9.375900000000001e-05,
        "cumulative_time": 9.375900000000001e-05,
        "time_percent": 0.019629274174011495,
        "time_per_call": 9.246449704142013e-08
      },
      {
        "rank": 48,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 765,
        "function_name": "open_binary",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 9.3335e-05,
        "cumulative_time": 0.0010609950000000001,
        "time_percent": 0.2221286676719603,
        "time_per_call": 5.894416666666667e-05
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 9.3125e-05,
        "cumulative_time": 9.3125e-05,
        "time_percent": 0.019496540678279634,
        "time_per_call": 1.5520833333333332e-05
      },
      {
        "rank": 50,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 46,
        "primitive_calls": 46,
        "total_time": 9.2618e-05,
        "cumulative_time": 0.00017534200000000002,
        "time_percent": 0.03670939528172787,
        "time_per_call": 3.8117826086956526e-06
      }
    ]
  },
  {
    "config": {
      "num_simulations": 5000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 2048,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 5000,
    "wave_size": 2048,
    "total_time_ms": 304.6512020009686,
    "simulations_per_second": 16412.211628116613,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 42.38044738769531,
        "cpu_time_ms": 39.174613000795944,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 53.08108901977539,
        "cpu_time_ms": 48.51434100055485,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.4757120609283447,
        "cpu_time_ms": 3.3818020001490368,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4909440279006958,
        "cpu_time_ms": 1.6242650017375126,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 45.33894348144531,
        "cpu_time_ms": 41.650838998975814,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 55.03772735595703,
        "cpu_time_ms": 50.28230599964445,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 8.9683837890625,
        "cpu_time_ms": 8.452952000880032,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4267200231552124,
        "cpu_time_ms": 1.5640599995094817,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 45.59920120239258,
        "cpu_time_ms": 41.841752999971504,
        "memory_allocated_mb": 0.1767578125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 904
      },
      {
        "name": "expansion",
        "gpu_time_ms": 59.78694534301758,
        "cpu_time_ms": 54.653654999128776,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 904
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.7458879947662354,
        "cpu_time_ms": 3.676898999401601,
        "memory_allocated_mb": 0.00390625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 904
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.299456000328064,
        "cpu_time_ms": 1.4204079998307861,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 904
      }
    ],
    "peak_gpu_memory_mb": 356.9130859375,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 188.2,
    "avg_ram_usage_mb": 1256.99609375,
    "final_tree_nodes": 1351,
    "final_tree_edges": 1350,
    "tree_memory_mb": 9.375587463378906,
    "efficiency_score": 47087.38729219464,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth"
    ],
    "cprofile_stats": "         67252 function calls (49940 primitive calls) in 0.303 seconds\n\n   Ordered by: cumulative time\n   List reduced from 214 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    0.303    0.303 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    0.303    0.303 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n        3    0.000    0.000    0.301    0.100 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n       12    0.002    0.000    0.300    0.025 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n        3    0.000    0.000    0.155    0.052 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n        3    0.000    0.000    0.124    0.041 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n        3    0.016    0.005    0.115    0.038 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n       27    0.034    0.001    0.092    0.003 {built-in method time.sleep}\n        3    0.015    0.005    0.056    0.019 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n       14    0.010    0.001    0.044    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n       11    0.020    0.002    0.042    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n       97    0.037    0.000    0.037    0.000 {built-in method torch.where}\n       14    0.020    0.001    0.034    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n       28    0.003    0.000    0.023    0.001 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n       14    0.003    0.000    0.019    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n       14    0.018    0.001    0.018    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n       50    0.018    0.000    0.018    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n      108    0.002    0.000    0.017    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        3    0.000    0.000    0.017    0.006 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n       11    0.000    0.000    0.015    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n       14    0.014    0.001    0.014    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n17388/108    0.010    0.000    0.013    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       14    0.012    0.001    0.012    0.001 {built-in method torch.repeat_interleave}\n       48    0.009    0.000    0.009    0.000 {built-in method torch.tensor}\n       52    0.000    0.000    0.009    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       14    0.009    0.001    0.009    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n        3    0.004    0.001    0.009    0.003 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n       56    0.000    0.000    0.008    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n       11    0.002    0.000    0.008    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n       11    0.000    0.000    0.008    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n        3    0.006    0.002    0.008    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n        3    0.000    0.000    0.006    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n       56    0.002    0.000    0.005    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n       28    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n       14    0.003    0.000    0.004    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n       37    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        3    0.001    0.000    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n    84/56    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n       37    0.003    0.000    0.003    0.000 {built-in method torch._C._cuda_synchronize}\n       26    0.000    0.000    0.003    0.000 {built-in method builtins.next}\n       26    0.000    0.000    0.003    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n       13    0.000    0.000    0.003    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n        3    0.003    0.001    0.003    0.001 {built-in method torch.bincount}\n       13    0.000    0.000    0.003    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n       28    0.001    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:489(_extract_policy)\n       28    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n       84    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:765(open_binary)\n        3    0.000    0.000    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:367(get_nn_features)\n      108    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 97,
        "primitive_calls": 97,
        "total_time": 0.037257524,
        "cumulative_time": 0.037257524,
        "time_percent": 1.660065740993783,
        "time_per_call": 0.0003840981855670103
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 0.033856660000000004,
        "cumulative_time": 0.092141839,
        "time_percent": 4.105520008148282,
        "time_per_call": 0.003412660703703704
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.020270074000000003,
        "cumulative_time": 0.0415374,
        "time_percent": 1.8507621362588444,
        "time_per_call": 0.003776127272727273
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.020109125000000002,
        "cumulative_time": 0.033629375,
        "time_percent": 1.4984080350732056,
        "time_per_call": 0.0024020982142857147
      },
      {
        "rank": 5,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 50,
        "primitive_calls": 50,
        "total_time": 0.017812713,
        "cumulative_time": 0.017812713,
        "time_percent": 0.7936725641095901,
        "time_per_call": 0.00035625426
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.017625897,
        "cumulative_time": 0.017911133000000003,
        "time_percent": 0.7980578171454228,
        "time_per_call": 0.001279366642857143
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.016038714000000003,
        "cumulative_time": 0.11540468100000001,
        "time_percent": 5.142031372734703,
        "time_per_call": 0.038468227
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.015393582000000001,
        "cumulative_time": 0.05624304,
        "time_percent": 2.5059943294498845,
        "time_per_call": 0.01874768
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.014450189,
        "cumulative_time": 0.014450189,
        "time_percent": 0.6438501847247071,
        "time_per_call": 0.0010321563571428572
      },
      {
        "rank": 10,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.012327552,
        "cumulative_time": 0.012327552,
        "time_percent": 0.549272859504013,
        "time_per_call": 0.0008805394285714286
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.009712752,
        "cumulative_time": 0.043567159,
        "time_percent": 1.9412011406965464,
        "time_per_call": 0.0031119399285714287
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 108,
        "primitive_calls": 17388,
        "total_time": 0.009637484,
        "cumulative_time": 0.012565704,
        "time_percent": 0.5598840846715563,
        "time_per_call": 0.00011634911111111111
      },
      {
        "rank": 13,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 48,
        "primitive_calls": 48,
        "total_time": 0.00936234,
        "cumulative_time": 0.00936234,
        "time_percent": 0.41715332155555296,
        "time_per_call": 0.00019504875
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.008745745000000001,
        "cumulative_time": 0.008745745000000001,
        "time_percent": 0.389679991992159,
        "time_per_call": 0.0006246960714285715
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.005636462,
        "cumulative_time": 0.008333991,
        "time_percent": 0.37133366524438177,
        "time_per_call": 0.0027779970000000004
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.003966961000000001,
        "cumulative_time": 0.008710701000000001,
        "time_percent": 0.3881185531851308,
        "time_per_call": 0.0029035670000000006
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 37,
        "primitive_calls": 37,
        "total_time": 0.0030987280000000002,
        "cumulative_time": 0.0030987280000000002,
        "time_percent": 0.13806854673053912,
        "time_per_call": 8.374940540540541e-05
      },
      {
        "rank": 18,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.002768181,
        "cumulative_time": 0.0037741880000000004,
        "time_percent": 0.16816469604555162,
        "time_per_call": 0.0002695848571428572
      },
      {
        "rank": 19,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.0026761980000000003,
        "cumulative_time": 0.018696898,
        "time_percent": 0.8330687737772154,
        "time_per_call": 0.0013354927142857143
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.0026734750000000002,
        "cumulative_time": 0.023216957,
        "time_percent": 1.0344668885089034,
        "time_per_call": 0.0008291770357142858
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0025574210000000003,
        "cumulative_time": 0.0025574210000000003,
        "time_percent": 0.1139497887030298,
        "time_per_call": 0.0008524736666666667
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.001845538,
        "cumulative_time": 0.008373053,
        "time_percent": 0.37307413216254565,
        "time_per_call": 0.0007611866363636363
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 390,
        "function_name": "_profile_phase",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.0016890520000000001,
        "cumulative_time": 0.300150585,
        "time_percent": 13.373666572629531,
        "time_per_call": 0.025012548750000002
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 108,
        "primitive_calls": 108,
        "total_time": 0.0016274800000000002,
        "cumulative_time": 0.016891397000000002,
        "time_percent": 0.7526219261705411,
        "time_per_call": 0.00015640182407407408
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 56,
        "primitive_calls": 56,
        "total_time": 0.001502223,
        "cumulative_time": 0.005224926,
        "time_percent": 0.23280453773116225,
        "time_per_call": 9.330225000000001e-05
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.001465301,
        "cumulative_time": 0.003361031,
        "time_percent": 0.14975585649540413,
        "time_per_call": 0.0011203436666666667
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 84,
        "primitive_calls": 84,
        "total_time": 0.0014248840000000002,
        "cumulative_time": 0.001445611,
        "time_percent": 0.06441140038999274,
        "time_per_call": 1.7209654761904764e-05
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0013215500000000001,
        "cumulative_time": 0.0013215500000000001,
        "time_percent": 0.058883673536929984,
        "time_per_call": 0.0004405166666666667
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full_like>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.001318422,
        "cumulative_time": 0.001318422,
        "time_percent": 0.058744300731645646,
        "time_per_call": 9.417300000000001e-05
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.001307041,
        "cumulative_time": 0.001307041,
        "time_percent": 0.05823720293850592,
        "time_per_call": 0.00043568033333333335
      },
      {
        "rank": 31,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.0012665620000000002,
        "cumulative_time": 0.0022255540000000002,
        "time_percent": 0.09916294894238484,
        "time_per_call": 7.948407142857143e-05
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 18228,
        "primitive_calls": 18228,
        "total_time": 0.0012662530000000002,
        "cumulative_time": 0.0012662530000000002,
        "time_percent": 0.0564198314609044,
        "time_per_call": 6.946746763221419e-08
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 108,
        "primitive_calls": 108,
        "total_time": 0.001160692,
        "cumulative_time": 0.001160692,
        "time_percent": 0.05171640029126884,
        "time_per_call": 1.0747148148148148e-05
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 108,
        "primitive_calls": 108,
        "total_time": 0.001099048,
        "cumulative_time": 0.001099048,
        "time_percent": 0.04896975796104258,
        "time_per_call": 1.0176370370370371e-05
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 13229,
        "primitive_calls": 13229,
        "total_time": 0.001086965,
        "cumulative_time": 0.001086965,
        "time_percent": 0.04843138148845606,
        "time_per_call": 8.216531861818733e-08
      },
      {
        "rank": 36,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.000736223,
        "cumulative_time": 0.000736223,
        "time_percent": 0.032803537348098225,
        "time_per_call": 5.258735714285715e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 0.0007284180000000001,
        "cumulative_time": 0.0007284180000000001,
        "time_percent": 0.0324557736827388,
        "time_per_call": 2.349735483870968e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 42,
        "primitive_calls": 42,
        "total_time": 0.0006300790000000001,
        "cumulative_time": 0.0006300790000000001,
        "time_percent": 0.02807412972530386,
        "time_per_call": 1.5001880952380954e-05
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 0.0006197290000000001,
        "cumulative_time": 0.0009196450000000001,
        "time_percent": 0.040976183988399965,
        "time_per_call": 3.406092592592593e-05
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 59,
        "primitive_calls": 59,
        "total_time": 0.000563943,
        "cumulative_time": 0.000563943,
        "time_percent": 0.025127339491836785,
        "time_per_call": 9.558355932203391e-06
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.000520865,
        "cumulative_time": 0.000520865,
        "time_percent": 0.023207933575584,
        "time_per_call": 1.8602321428571428e-05
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.00044445700000000004,
        "cumulative_time": 0.000446927,
        "time_percent": 0.019913513346327804,
        "time_per_call": 1.5961678571428572e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.000444444,
        "cumulative_time": 0.000444444,
        "time_percent": 0.019802879498654842,
        "time_per_call": 1.5873e-05
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 4439,
        "primitive_calls": 4439,
        "total_time": 0.000444017,
        "cumulative_time": 0.00123856,
        "time_percent": 0.05518592765759903,
        "time_per_call": 2.790177968010813e-07
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 84,
        "primitive_calls": 84,
        "total_time": 0.00043911700000000004,
        "cumulative_time": 0.000526627,
        "time_percent": 0.023464668263579,
        "time_per_call": 6.269369047619048e-06
      },
      {
        "rank": 46,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 367,
        "function_name": "get_nn_features",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.00043514400000000005,
        "cumulative_time": 0.0015411110000000002,
        "time_percent": 0.06866654837741418,
        "time_per_call": 0.0005137036666666668
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.000421515,
        "cumulative_time": 0.000421515,
        "time_percent": 0.018781242972962842,
        "time_per_call": 3.831954545454545e-05
      },
      {
        "rank": 48,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.000416746,
        "cumulative_time": 0.00420722,
        "time_percent": 0.18745909649884043,
        "time_per_call": 0.00015025785714285715
      },
      {
        "rank": 49,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 209,
        "primitive_calls": 209,
        "total_time": 0.00040987300000000005,
        "cumulative_time": 0.0007945430000000001,
        "time_percent": 0.03540207379444816,
        "time_per_call": 3.8016411483253593e-06
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 4212,
        "primitive_calls": 4212,
        "total_time": 0.000403428,
        "cumulative_time": 0.000403428,
        "time_percent": 0.017975349133711616,
        "time_per_call": 9.578062678062678e-08
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 2048,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 10000,
    "wave_size": 2048,
    "total_time_ms": 523.6835320010869,
    "simulations_per_second": 19095.502128524535,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 28.753952026367188,
        "cpu_time_ms": 29.703262000111863,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 37.59920120239258,
        "cpu_time_ms": 34.46134299883852,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.712480068206787,
        "cpu_time_ms": 3.7315560002753045,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5035840272903442,
        "cpu_time_ms": 1.6315290013153572,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 38.8587532043457,
        "cpu_time_ms": 35.73746099937125,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 39.8205451965332,
        "cpu_time_ms": 36.48769299979904,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.57151985168457,
        "cpu_time_ms": 4.467075999855297,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5773119926452637,
        "cpu_time_ms": 1.7190579983434873,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 125.77257537841797,
        "cpu_time_ms": 114.92876000011165,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 43.331424713134766,
        "cpu_time_ms": 39.68466799960879,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.632352113723755,
        "cpu_time_ms": 3.5613090003607795,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.661695957183838,
        "cpu_time_ms": 1.7799300003389362,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 40.87839889526367,
        "cpu_time_ms": 37.637703000655165,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 48.30851364135742,
        "cpu_time_ms": 44.20550699978776,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.8296959400177,
        "cpu_time_ms": 3.8544360013474943,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6719679832458496,
        "cpu_time_ms": 1.8460869996488327,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 58.439552307128906,
        "cpu_time_ms": 54.24861800020153,
        "memory_allocated_mb": 0.3525390625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1808
      },
      {
        "name": "expansion",
        "gpu_time_ms": 61.58812713623047,
        "cpu_time_ms": 56.43485800101189,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1808
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.567807912826538,
        "cpu_time_ms": 3.5245899998699315,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1808
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5043519735336304,
        "cpu_time_ms": 1.6073410006356426,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1808
      }
    ],
    "peak_gpu_memory_mb": 662.00537109375,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 187.7,
    "avg_ram_usage_mb": 1257.93359375,
    "final_tree_nodes": 1101,
    "final_tree_edges": 1100,
    "tree_memory_mb": 9.375587463378906,
    "efficiency_score": 29537.21379526392,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth"
    ],
    "cprofile_stats": "         111737 function calls (82724 primitive calls) in 0.522 seconds\n\n   Ordered by: cumulative time\n   List reduced from 214 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        5    0.000    0.000    0.523    0.105 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n      2/1    0.000    0.000    0.522    0.522 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    0.522    0.522 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n       20    0.002    0.000    0.518    0.026 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n        5    0.000    0.000    0.275    0.055 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n       46    0.103    0.002    0.270    0.006 {built-in method time.sleep}\n        5    0.000    0.000    0.214    0.043 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n        5    0.027    0.005    0.171    0.034 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n        5    0.021    0.004    0.158    0.032 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n      131    0.065    0.000    0.065    0.000 {built-in method torch.where}\n       15    0.029    0.002    0.061    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n       18    0.011    0.001    0.056    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n       18    0.028    0.002    0.044    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n      181    0.003    0.000    0.032    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       47    0.007    0.000    0.032    0.001 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n       15    0.000    0.000    0.031    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n       20    0.030    0.001    0.031    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n       18    0.004    0.000    0.027    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n29141/181    0.019    0.000    0.024    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       66    0.023    0.000    0.023    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n       18    0.023    0.001    0.023    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n        5    0.000    0.000    0.022    0.004 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n       87    0.000    0.000    0.017    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       18    0.016    0.001    0.016    0.001 {built-in method torch.repeat_interleave}\n        5    0.009    0.002    0.016    0.003 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n       94    0.000    0.000    0.016    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n       15    0.003    0.000    0.013    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n       15    0.000    0.000    0.013    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n       64    0.013    0.000    0.013    0.000 {built-in method torch.tensor}\n       18    0.012    0.001    0.012    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n        5    0.006    0.001    0.011    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n        5    0.000    0.000    0.010    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n       47    0.002    0.000    0.008    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n   141/94    0.001    0.000    0.007    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n       61    0.000    0.000    0.007    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        5    0.003    0.001    0.006    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n       94    0.000    0.000    0.006    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n       42    0.000    0.000    0.005    0.000 {built-in method builtins.next}\n       61    0.005    0.000    0.005    0.000 {built-in method torch._C._cuda_synchronize}\n       42    0.000    0.000    0.005    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n       18    0.004    0.000    0.005    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n       21    0.000    0.000    0.005    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       21    0.000    0.000    0.005    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n       47    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n       47    0.002    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n        5    0.004    0.001    0.004    0.001 {built-in method torch.bincount}\n       47    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n       47    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:812(bcat)\n      181    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n       47    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:795(cat)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 46,
        "primitive_calls": 46,
        "total_time": 0.102739015,
        "cumulative_time": 0.269915151,
        "time_percent": 6.827325288796173,
        "time_per_call": 0.005867720673913044
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 131,
        "primitive_calls": 131,
        "total_time": 0.06498664500000001,
        "cumulative_time": 0.06506782,
        "time_percent": 1.6458474869861506,
        "time_per_call": 0.0004967009160305343
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 20,
        "primitive_calls": 20,
        "total_time": 0.029535713,
        "cumulative_time": 0.03124543,
        "time_percent": 0.7903324937780561,
        "time_per_call": 0.0015622715
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 15,
        "primitive_calls": 15,
        "total_time": 0.028709189000000003,
        "cumulative_time": 0.061002566,
        "time_percent": 1.5430195748191162,
        "time_per_call": 0.0040668377333333335
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.028042266000000003,
        "cumulative_time": 0.044101578,
        "time_percent": 1.11552025753166,
        "time_per_call": 0.002450087666666667
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.027208344000000002,
        "cumulative_time": 0.171485264,
        "time_percent": 4.337606374542079,
        "time_per_call": 0.0342970528
      },
      {
        "rank": 7,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 66,
        "primitive_calls": 66,
        "total_time": 0.023176511,
        "cumulative_time": 0.023176511,
        "time_percent": 0.586234522479113,
        "time_per_call": 0.0003511592575757576
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.022999086000000002,
        "cumulative_time": 0.022999086000000002,
        "time_percent": 0.581746674409537,
        "time_per_call": 0.0012777270000000002
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.021342973,
        "cumulative_time": 0.157610373,
        "time_percent": 3.9866501801504923,
        "time_per_call": 0.0315220746
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 181,
        "primitive_calls": 29141,
        "total_time": 0.018751719,
        "cumulative_time": 0.024112341000000002,
        "time_percent": 0.6099057236004392,
        "time_per_call": 0.00013321735359116024
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.016058543,
        "cumulative_time": 0.016058543,
        "time_percent": 0.40619022799917137,
        "time_per_call": 0.0008921412777777778
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 64,
        "primitive_calls": 64,
        "total_time": 0.012765874,
        "cumulative_time": 0.012765874,
        "time_percent": 0.3229043426087094,
        "time_per_call": 0.00019946678125
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.011567175,
        "cumulative_time": 0.011567175,
        "time_percent": 0.29258404392953424,
        "time_per_call": 0.0006426208333333333
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.011164619,
        "cumulative_time": 0.055665272,
        "time_percent": 1.4080162518676749,
        "time_per_call": 0.0030925151111111113
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.008677668000000001,
        "cumulative_time": 0.016007678,
        "time_percent": 0.4049036314538199,
        "time_per_call": 0.0032015356000000003
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 47,
        "primitive_calls": 47,
        "total_time": 0.007340608,
        "cumulative_time": 0.031543203,
        "time_percent": 0.7978644649389515,
        "time_per_call": 0.0006711319787234042
      },
      {
        "rank": 17,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.006477512,
        "cumulative_time": 0.010550969,
        "time_percent": 0.2668797850292015,
        "time_per_call": 0.0021101938
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 61,
        "primitive_calls": 61,
        "total_time": 0.005336355,
        "cumulative_time": 0.0053460700000000005,
        "time_percent": 0.13522530606914526,
        "time_per_call": 8.764049180327869e-05
      },
      {
        "rank": 19,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.004199241,
        "cumulative_time": 0.027198327,
        "time_percent": 0.6879636991553977,
        "time_per_call": 0.0015110181666666668
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.0038764650000000004,
        "cumulative_time": 0.0038764650000000004,
        "time_percent": 0.09805261923082359,
        "time_per_call": 0.000775293
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.0036020820000000004,
        "cumulative_time": 0.005129937,
        "time_percent": 0.12975836473155658,
        "time_per_call": 0.0002849965
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 181,
        "primitive_calls": 181,
        "total_time": 0.003088978,
        "cumulative_time": 0.032212548,
        "time_percent": 0.814795104173165,
        "time_per_call": 0.00017796987845303868
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.0026947290000000003,
        "cumulative_time": 0.006321623,
        "time_percent": 0.15990127421241176,
        "time_per_call": 0.0012643246
      },
      {
        "rank": 24,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.0025869590000000002,
        "cumulative_time": 0.0025869590000000002,
        "time_percent": 0.0654354175241495,
        "time_per_call": 0.0005173918
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 15,
        "primitive_calls": 15,
        "total_time": 0.002526888,
        "cumulative_time": 0.013275919,
        "time_percent": 0.33580559366491286,
        "time_per_call": 0.0008850612666666668
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 47,
        "primitive_calls": 47,
        "total_time": 0.0024170570000000002,
        "cumulative_time": 0.0040434500000000005,
        "time_percent": 0.10227639440285767,
        "time_per_call": 8.60308510638298e-05
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 30523,
        "primitive_calls": 30523,
        "total_time": 0.0023389220000000002,
        "cumulative_time": 0.0023389220000000002,
        "time_percent": 0.059161485600049635,
        "time_per_call": 7.662818202666842e-08
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 141,
        "primitive_calls": 141,
        "total_time": 0.0021759680000000003,
        "cumulative_time": 0.0022803850000000002,
        "time_percent": 0.05768083088707926,
        "time_per_call": 1.617294326241135e-05
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 181,
        "primitive_calls": 181,
        "total_time": 0.002160523,
        "cumulative_time": 0.002160523,
        "time_percent": 0.05464900084443861,
        "time_per_call": 1.1936591160220995e-05
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 22170,
        "primitive_calls": 22170,
        "total_time": 0.002040723,
        "cumulative_time": 0.002040723,
        "time_percent": 0.05161873905080635,
        "time_per_call": 9.2048849797023e-08
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 181,
        "primitive_calls": 181,
        "total_time": 0.0020262400000000003,
        "cumulative_time": 0.0020262400000000003,
        "time_percent": 0.051252401141314075,
        "time_per_call": 1.1194696132596686e-05
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.0020035590000000002,
        "cumulative_time": 0.0020035590000000002,
        "time_percent": 0.05067870024197038,
        "time_per_call": 0.00040071180000000005
      },
      {
        "rank": 33,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 390,
        "function_name": "_profile_phase",
        "total_calls": 20,
        "primitive_calls": 20,
        "total_time": 0.001978072,
        "cumulative_time": 0.518126015,
        "time_percent": 13.105654987824988,
        "time_per_call": 0.02590630075
      },
      {
        "rank": 34,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 47,
        "primitive_calls": 47,
        "total_time": 0.001896798,
        "cumulative_time": 0.007903656,
        "time_percent": 0.19991775297840023,
        "time_per_call": 0.00016816289361702128
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 40,
        "primitive_calls": 40,
        "total_time": 0.0015746940000000002,
        "cumulative_time": 0.0015746940000000002,
        "time_percent": 0.03983084361320495,
        "time_per_call": 3.936735e-05
      },
      {
        "rank": 36,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 1642,
        "function_name": "wrapper",
        "total_calls": 94,
        "primitive_calls": 141,
        "total_time": 0.0012451530000000001,
        "cumulative_time": 0.007282772000000001,
        "time_percent": 0.18421290269895477,
        "time_per_call": 7.747629787234043e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 47,
        "primitive_calls": 47,
        "total_time": 0.001234876,
        "cumulative_time": 0.001363931,
        "time_percent": 0.03449973287521401,
        "time_per_call": 2.90198085106383e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 47,
        "primitive_calls": 47,
        "total_time": 0.001148472,
        "cumulative_time": 0.001148472,
        "time_percent": 0.02904983992200689,
        "time_per_call": 2.4435574468085107e-05
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 43,
        "primitive_calls": 43,
        "total_time": 0.00112462,
        "cumulative_time": 0.00112462,
        "time_percent": 0.0284465193518757,
        "time_per_call": 2.6153953488372094e-05
      },
      {
        "rank": 40,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 20,
        "primitive_calls": 20,
        "total_time": 0.001089549,
        "cumulative_time": 0.001089549,
        "time_percent": 0.027559421594242333,
        "time_per_call": 5.447745e-05
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 85,
        "primitive_calls": 85,
        "total_time": 0.0010451940000000002,
        "cumulative_time": 0.0010451940000000002,
        "time_percent": 0.0264374911947719,
        "time_per_call": 1.2296400000000001e-05
      },
      {
        "rank": 42,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 37,
        "primitive_calls": 37,
        "total_time": 0.0008750260000000001,
        "cumulative_time": 0.0014108130000000001,
        "time_percent": 0.03568558206894579,
        "time_per_call": 3.813008108108109e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 54,
        "primitive_calls": 54,
        "total_time": 0.0008602690000000001,
        "cumulative_time": 0.0008602690000000001,
        "time_percent": 0.021759935583858334,
        "time_per_call": 1.593090740740741e-05
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'split' of 'bytes' objects>",
        "total_calls": 2585,
        "primitive_calls": 2585,
        "total_time": 0.000810687,
        "cumulative_time": 0.000810687,
        "time_percent": 0.020505791675245022,
        "time_per_call": 3.1361199226305613e-07
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 15,
        "primitive_calls": 15,
        "total_time": 0.0007958930000000001,
        "cumulative_time": 0.0007958930000000001,
        "time_percent": 0.020131587226371938,
        "time_per_call": 5.305953333333334e-05
      },
      {
        "rank": 46,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 367,
        "function_name": "get_nn_features",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.0007506180000000001,
        "cumulative_time": 0.001233956,
        "time_percent": 0.031212101183833767,
        "time_per_call": 0.0002467912
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.ones>",
        "total_calls": 43,
        "primitive_calls": 43,
        "total_time": 0.0007474290000000001,
        "cumulative_time": 0.0007474290000000001,
        "time_percent": 0.01890572238858735,
        "time_per_call": 1.738206976744186e-05
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 7059,
        "primitive_calls": 7059,
        "total_time": 0.000700918,
        "cumulative_time": 0.000700918,
        "time_percent": 0.017729257394567065,
        "time_per_call": 9.92942343108089e-08
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 7368,
        "primitive_calls": 7368,
        "total_time": 0.0006999920000000001,
        "cumulative_time": 0.001954167,
        "time_percent": 0.04942936225773762,
        "time_per_call": 2.652235342019544e-07
      },
      {
        "rank": 50,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 285,
        "primitive_calls": 285,
        "total_time": 0.000683415,
        "cumulative_time": 0.0012541750000000002,
        "time_percent": 0.03172352742094103,
        "time_per_call": 4.40061403508772e-06
      }
    ]
  },
  {
    "config": {
      "num_simulations": 25000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 2048,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 25000,
    "wave_size": 2048,
    "total_time_ms": 1843.049388999134,
    "simulations_per_second": 13564.47643195076,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 28.851327896118164,
        "cpu_time_ms": 26.842088000194053,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 35.108001708984375,
        "cpu_time_ms": 32.22276100132149,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.516256093978882,
        "cpu_time_ms": 3.4296789999643806,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.3803520202636719,
        "cpu_time_ms": 1.5223910013446584,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 137.00880432128906,
        "cpu_time_ms": 125.08093700125755,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 44.32854461669922,
        "cpu_time_ms": 40.600562999316026,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.542399883270264,
        "cpu_time_ms": 4.535858000963344,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6721919775009155,
        "cpu_time_ms": 1.8046089990093606,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 48.959041595458984,
        "cpu_time_ms": 45.02237800079456,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 43.88623809814453,
        "cpu_time_ms": 40.4206150014943,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 5.152224063873291,
        "cpu_time_ms": 4.956356000548112,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.556480050086975,
        "cpu_time_ms": 1.6836140002851607,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 41.206783294677734,
        "cpu_time_ms": 37.956696998662665,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 59.61225509643555,
        "cpu_time_ms": 54.67815900010464,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.045248031616211,
        "cpu_time_ms": 4.1583409984014,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.7672959566116333,
        "cpu_time_ms": 1.9019459996343357,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 54.541439056396484,
        "cpu_time_ms": 50.04061200088472,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 65.8757095336914,
        "cpu_time_ms": 60.23474499852455,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.501920223236084,
        "cpu_time_ms": 4.4320429988147225,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.551360011100769,
        "cpu_time_ms": 1.6629269994155038,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 51.6352653503418,
        "cpu_time_ms": 47.39094000069599,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 61.30467224121094,
        "cpu_time_ms": 56.06508299933921,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.0015997886657715,
        "cpu_time_ms": 4.102560998944682,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.709280014038086,
        "cpu_time_ms": 1.8693010006245458,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 56.379905700683594,
        "cpu_time_ms": 51.761476999672595,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 95.19174194335938,
        "cpu_time_ms": 86.86364899949695,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.8774399757385254,
        "cpu_time_ms": 3.793099998802063,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5566400289535522,
        "cpu_time_ms": 1.6555900001549162,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 45.03798294067383,
        "cpu_time_ms": 41.382774001249345,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 97.19184112548828,
        "cpu_time_ms": 88.68228299979819,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.225632190704346,
        "cpu_time_ms": 4.209549000734114,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.916864037513733,
        "cpu_time_ms": 2.0343050000519725,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 55.99647903442383,
        "cpu_time_ms": 51.41925899988564,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 127.50006103515625,
        "cpu_time_ms": 116.32394700063742,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.685376167297363,
        "cpu_time_ms": 4.570262999550323,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5731199979782104,
        "cpu_time_ms": 1.7143639997811988,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 66.78294372558594,
        "cpu_time_ms": 61.16841900075087,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 143.4332733154297,
        "cpu_time_ms": 130.75013799971202,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 8.714943885803223,
        "cpu_time_ms": 8.765186999880825,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5176000595092773,
        "cpu_time_ms": 1.6914169991650851,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 50.318687438964844,
        "cpu_time_ms": 46.13995699946827,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 122.42406463623047,
        "cpu_time_ms": 111.6027780008153,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.9476799964904785,
        "cpu_time_ms": 4.739853000501171,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4725120067596436,
        "cpu_time_ms": 1.5820409989828477,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 47.41203308105469,
        "cpu_time_ms": 43.5310840002785,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 102.87296295166016,
        "cpu_time_ms": 93.8444299990806,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.953984022140503,
        "cpu_time_ms": 3.8675790001434507,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6168320178985596,
        "cpu_time_ms": 1.7295029992965283,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 60.236576080322266,
        "cpu_time_ms": 55.20519899982901,
        "memory_allocated_mb": 0.0830078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "expansion",
        "gpu_time_ms": 152.034912109375,
        "cpu_time_ms": 138.75189999998838,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 5.386879920959473,
        "cpu_time_ms": 5.192754999370663,
        "memory_allocated_mb": 0.001953125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5953919887542725,
        "cpu_time_ms": 1.7132980010501342,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      }
    ],
    "peak_gpu_memory_mb": 662.00537109375,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 187.9,
    "avg_ram_usage_mb": 1258.12109375,
    "final_tree_nodes": 4751,
    "final_tree_edges": 4750,
    "tree_memory_mb": 9.375587463378906,
    "efficiency_score": 20981.7389296537,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth"
    ],
    "cprofile_stats": "         374561 function calls (276618 primitive calls) in 1.841 seconds\n\n   Ordered by: cumulative time\n   List reduced from 214 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    1.841    1.841 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    1.841    1.841 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n       13    0.000    0.000    1.839    0.141 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n       52    0.002    0.000    1.839    0.035 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n       13    0.000    0.000    1.057    0.081 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n       13    0.000    0.000    0.689    0.053 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n      168    0.256    0.002    0.666    0.004 {built-in method time.sleep}\n       13    0.069    0.005    0.604    0.046 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n       13    0.070    0.005    0.336    0.026 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n       91    0.054    0.001    0.296    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n       91    0.142    0.002    0.231    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n      477    0.217    0.000    0.217    0.000 {built-in method torch.where}\n       47    0.085    0.002    0.180    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n      169    0.022    0.000    0.177    0.001 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n       47    0.000    0.000    0.174    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n       91    0.024    0.000    0.158    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n      338    0.019    0.000    0.141    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n       47    0.000    0.000    0.128    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n      301    0.119    0.000    0.119    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n       91    0.119    0.001    0.119    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n      611    0.010    0.000    0.106    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       91    0.084    0.001    0.084    0.001 {built-in method torch.repeat_interleave}\n       60    0.076    0.001    0.079    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n98371/611    0.062    0.000    0.079    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       13    0.000    0.000    0.066    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n      299    0.066    0.000    0.066    0.000 {built-in method torch.tensor}\n       91    0.065    0.001    0.065    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n      273    0.001    0.000    0.055    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n      338    0.001    0.000    0.054    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n       13    0.027    0.002    0.050    0.004 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n       47    0.008    0.000    0.041    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n      169    0.008    0.000    0.037    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n       13    0.019    0.001    0.035    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n       13    0.000    0.000    0.027    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n       91    0.019    0.000    0.027    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n  507/338    0.001    0.000    0.024    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n      157    0.001    0.000    0.018    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n       13    0.008    0.001    0.017    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n      106    0.000    0.000    0.015    0.000 {built-in method builtins.next}\n      106    0.000    0.000    0.015    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n      157    0.014    0.000    0.014    0.000 {built-in method torch._C._cuda_synchronize}\n      169    0.009    0.000    0.014    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n      169    0.001    0.000    0.014    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n       13    0.013    0.001    0.013    0.001 {built-in method torch.bincount}\n       53    0.000    0.000    0.013    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       53    0.000    0.000    0.013    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n      169    0.002    0.000    0.012    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1113(memory_info)\n      169    0.001    0.000    0.012    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n      611    0.001    0.000    0.011    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n      169    0.000    0.000    0.010    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:812(bcat)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 168,
        "primitive_calls": 168,
        "total_time": 0.256309179,
        "cumulative_time": 0.665848008,
        "time_percent": 4.753268547315873,
        "time_per_call": 0.003963381
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 477,
        "primitive_calls": 477,
        "total_time": 0.217291906,
        "cumulative_time": 0.21733218,
        "time_percent": 1.551462500603579,
        "time_per_call": 0.0004556230188679246
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 91,
        "primitive_calls": 91,
        "total_time": 0.141574599,
        "cumulative_time": 0.23108136,
        "time_percent": 1.6496133459319087,
        "time_per_call": 0.0025393556043956044
      },
      {
        "rank": 4,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 301,
        "primitive_calls": 301,
        "total_time": 0.118860216,
        "cumulative_time": 0.11887634700000001,
        "time_percent": 0.848618895642784,
        "time_per_call": 0.00039493802990033227
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 91,
        "primitive_calls": 91,
        "total_time": 0.118774849,
        "cumulative_time": 0.118774849,
        "time_percent": 0.8478943350145041,
        "time_per_call": 0.0013052181208791209
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 47,
        "primitive_calls": 47,
        "total_time": 0.08481514700000001,
        "cumulative_time": 0.180160009,
        "time_percent": 1.286102675047493,
        "time_per_call": 0.003833191680851064
      },
      {
        "rank": 7,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 91,
        "primitive_calls": 91,
        "total_time": 0.08364489400000001,
        "cumulative_time": 0.08366156200000001,
        "time_percent": 0.5972322008867779,
        "time_per_call": 0.0009193578241758243
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 60,
        "primitive_calls": 60,
        "total_time": 0.07630610900000001,
        "cumulative_time": 0.078707472,
        "time_percent": 0.5618665920771888,
        "time_per_call": 0.0013117912
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.069555686,
        "cumulative_time": 0.336366506,
        "time_percent": 2.4012091560396103,
        "time_per_call": 0.025874346615384618
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.069310803,
        "cumulative_time": 0.603867943,
        "time_percent": 4.3108133773890245,
        "time_per_call": 0.04645138023076923
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 299,
        "primitive_calls": 299,
        "total_time": 0.065800309,
        "cumulative_time": 0.065800309,
        "time_percent": 0.46972662742180277,
        "time_per_call": 0.0002200679230769231
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 91,
        "primitive_calls": 91,
        "total_time": 0.064958283,
        "cumulative_time": 0.064958283,
        "time_percent": 0.46371568250083794,
        "time_per_call": 0.0007138272857142858
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 611,
        "primitive_calls": 98371,
        "total_time": 0.061772721,
        "cumulative_time": 0.07856041700000001,
        "time_percent": 0.5608168151043252,
        "time_per_call": 0.00012857678723404256
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 91,
        "primitive_calls": 91,
        "total_time": 0.05418483,
        "cumulative_time": 0.295955295,
        "time_percent": 2.112726895978174,
        "time_per_call": 0.003252255989010989
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.026651831,
        "cumulative_time": 0.050014095,
        "time_percent": 0.35703407058321945,
        "time_per_call": 0.003847238076923077
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 91,
        "primitive_calls": 91,
        "total_time": 0.023721210000000003,
        "cumulative_time": 0.15820629700000002,
        "time_percent": 1.1293823913000482,
        "time_per_call": 0.0017385307362637365
      },
      {
        "rank": 17,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 169,
        "primitive_calls": 169,
        "total_time": 0.021685145000000003,
        "cumulative_time": 0.17694552600000002,
        "time_percent": 1.2631555448372884,
        "time_per_call": 0.0010470149467455623
      },
      {
        "rank": 18,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.01947793,
        "cumulative_time": 0.034892254000000004,
        "time_percent": 0.24908425269803686,
        "time_per_call": 0.002684019538461539
      },
      {
        "rank": 19,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 338,
        "primitive_calls": 338,
        "total_time": 0.019153041000000003,
        "cumulative_time": 0.140705558,
        "time_percent": 1.0044504079584622,
        "time_per_call": 0.0004162886331360947
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 91,
        "primitive_calls": 91,
        "total_time": 0.018816803,
        "cumulative_time": 0.026877810000000002,
        "time_percent": 0.19187178959576018,
        "time_per_call": 0.00029536054945054945
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 157,
        "primitive_calls": 157,
        "total_time": 0.014440351,
        "cumulative_time": 0.014440351,
        "time_percent": 0.10308488633415168,
        "time_per_call": 9.197675796178344e-05
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.013332532000000001,
        "cumulative_time": 0.013332532000000001,
        "time_percent": 0.09517653315812337,
        "time_per_call": 0.0010255793846153847
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 611,
        "primitive_calls": 611,
        "total_time": 0.010302684000000001,
        "cumulative_time": 0.10629218200000001,
        "time_percent": 0.7587847068038002,
        "time_per_call": 0.0001739642913256956
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 169,
        "primitive_calls": 169,
        "total_time": 0.009056258000000001,
        "cumulative_time": 0.014268329000000001,
        "time_percent": 0.10185687821184401,
        "time_per_call": 8.442798224852072e-05
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 47,
        "primitive_calls": 47,
        "total_time": 0.00823398,
        "cumulative_time": 0.040750623,
        "time_percent": 0.2909052099911468,
        "time_per_call": 0.0008670345319148936
      },
      {
        "rank": 26,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 507,
        "primitive_calls": 507,
        "total_time": 0.008005333,
        "cumulative_time": 0.008188843000000001,
        "time_percent": 0.05845743984084692,
        "time_per_call": 1.6151564102564104e-05
      },
      {
        "rank": 27,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 169,
        "primitive_calls": 169,
        "total_time": 0.0076681710000000005,
        "cumulative_time": 0.036974807000000005,
        "time_percent": 0.26395090928345133,
        "time_per_call": 0.00021878584023668642
      },
      {
        "rank": 28,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.007557007,
        "cumulative_time": 0.016775658000000002,
        "time_percent": 0.11975587006926647,
        "time_per_call": 0.001290435230769231
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 611,
        "primitive_calls": 611,
        "total_time": 0.007259710000000001,
        "cumulative_time": 0.007259710000000001,
        "time_percent": 0.051824666877481315,
        "time_per_call": 1.1881685761047464e-05
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 102121,
        "primitive_calls": 102121,
        "total_time": 0.007044908000000001,
        "cumulative_time": 0.007044908000000001,
        "time_percent": 0.05029126649446096,
        "time_per_call": 6.898588928819734e-08
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 611,
        "primitive_calls": 611,
        "total_time": 0.006864023,
        "cumulative_time": 0.006864023,
        "time_percent": 0.04899998834862135,
        "time_per_call": 1.1234080196399346e-05
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.006523573,
        "cumulative_time": 0.006523573,
        "time_percent": 0.04656962848046705,
        "time_per_call": 0.0005018133076923078
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 74816,
        "primitive_calls": 74816,
        "total_time": 0.006246603000000001,
        "cumulative_time": 0.006246603000000001,
        "time_percent": 0.04459243132175741,
        "time_per_call": 8.349287585543201e-08
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.0058606990000000005,
        "cumulative_time": 0.0058606990000000005,
        "time_percent": 0.04183759039192859,
        "time_per_call": 0.00045082300000000004
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 273,
        "primitive_calls": 273,
        "total_time": 0.00450221,
        "cumulative_time": 0.004554961000000001,
        "time_percent": 0.032516358981959224,
        "time_per_call": 1.668483882783883e-05
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 164,
        "primitive_calls": 164,
        "total_time": 0.004164573,
        "cumulative_time": 0.004164573,
        "time_percent": 0.029729508260240838,
        "time_per_call": 2.539373780487805e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 169,
        "primitive_calls": 169,
        "total_time": 0.003895733,
        "cumulative_time": 0.003895733,
        "time_percent": 0.027810348480670842,
        "time_per_call": 2.3051674556213018e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 182,
        "primitive_calls": 182,
        "total_time": 0.0032746570000000003,
        "cumulative_time": 0.0032746570000000003,
        "time_percent": 0.0233766924798666,
        "time_per_call": 1.7992620879120882e-05
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 169,
        "primitive_calls": 169,
        "total_time": 0.003192325,
        "cumulative_time": 0.0035458340000000003,
        "time_percent": 0.025312535328938356,
        "time_per_call": 2.098126627218935e-05
      },
      {
        "rank": 40,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 60,
        "primitive_calls": 60,
        "total_time": 0.0031919500000000003,
        "cumulative_time": 0.003205575,
        "time_percent": 0.022883538946567035,
        "time_per_call": 5.342625e-05
      },
      {
        "rank": 41,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 123,
        "primitive_calls": 123,
        "total_time": 0.0030527600000000003,
        "cumulative_time": 0.004643917,
        "time_percent": 0.0331513864233795,
        "time_per_call": 3.7755422764227645e-05
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 507,
        "primitive_calls": 507,
        "total_time": 0.002918471,
        "cumulative_time": 0.003117673,
        "time_percent": 0.02225603566229475,
        "time_per_call": 6.14925641025641e-06
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'readline' of '_io.BufferedReader' objects>",
        "total_calls": 169,
        "primitive_calls": 169,
        "total_time": 0.0027026510000000004,
        "cumulative_time": 0.0029320690000000003,
        "time_percent": 0.020931070137345676,
        "time_per_call": 1.7349520710059173e-05
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 253,
        "primitive_calls": 253,
        "total_time": 0.0026242690000000003,
        "cumulative_time": 0.0026699560000000002,
        "time_percent": 0.01905993218427906,
        "time_per_call": 1.055318577075099e-05
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 25009,
        "primitive_calls": 25009,
        "total_time": 0.0026074690000000003,
        "cumulative_time": 0.007063223,
        "time_percent": 0.050422011217578146,
        "time_per_call": 2.8242724619137114e-07
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 23829,
        "primitive_calls": 23829,
        "total_time": 0.002339961,
        "cumulative_time": 0.002339961,
        "time_percent": 0.016704207100737917,
        "time_per_call": 9.819803600654665e-08
      },
      {
        "rank": 47,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 1075,
        "primitive_calls": 1075,
        "total_time": 0.002316718,
        "cumulative_time": 0.004455754,
        "time_percent": 0.031808153044406026,
        "time_per_call": 4.144887441860466e-06
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'numpy' of 'torch._C.TensorBase' objects>",
        "total_calls": 301,
        "primitive_calls": 301,
        "total_time": 0.0023108110000000003,
        "cumulative_time": 0.0023108110000000003,
        "time_percent": 0.016496114898779633,
        "time_per_call": 7.677112956810632e-06
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.ones>",
        "total_calls": 164,
        "primitive_calls": 164,
        "total_time": 0.002248117,
        "cumulative_time": 0.002278366,
        "time_percent": 0.016264500782397585,
        "time_per_call": 1.3892475609756098e-05
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 47,
        "primitive_calls": 47,
        "total_time": 0.002235225,
        "cumulative_time": 0.002235225,
        "time_percent": 0.015956531462168345,
        "time_per_call": 4.7557978723404254e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 50000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 2048,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 50000,
    "wave_size": 2048,
    "total_time_ms": 4319.635456000469,
    "simulations_per_second": 11575.050836881215,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 29.11414337158203,
        "cpu_time_ms": 30.215431999749853,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 40.2011833190918,
        "cpu_time_ms": 36.87310100031027,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.217887878417969,
        "cpu_time_ms": 4.117233000215492,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.7489919662475586,
        "cpu_time_ms": 1.8964680002682144,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 45.644161224365234,
        "cpu_time_ms": 43.54912099915964,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 56.33222579956055,
        "cpu_time_ms": 51.570094999988214,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 5.264287948608398,
        "cpu_time_ms": 5.121366999446764,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 2.5958399772644043,
        "cpu_time_ms": 2.7679320010065567,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 43.74339294433594,
        "cpu_time_ms": 40.34590300034324,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 40.14908981323242,
        "cpu_time_ms": 37.59947199978342,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.164031982421875,
        "cpu_time_ms": 4.094595000424306,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.8557120561599731,
        "cpu_time_ms": 1.979832000870374,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 44.06275177001953,
        "cpu_time_ms": 41.727293999429094,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 53.26780700683594,
        "cpu_time_ms": 48.71890100002929,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 5.562079906463623,
        "cpu_time_ms": 5.347303000235115,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 2.136064052581787,
        "cpu_time_ms": 2.8995810007472755,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 50.570655822753906,
        "cpu_time_ms": 46.41881300085515,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 62.141727447509766,
        "cpu_time_ms": 56.787157998769544,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.638688087463379,
        "cpu_time_ms": 4.4905529994139215,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.450111985206604,
        "cpu_time_ms": 1.576326998474542,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 49.94054412841797,
        "cpu_time_ms": 45.82424999898649,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 55.62345504760742,
        "cpu_time_ms": 50.87702799937688,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.5516159534454346,
        "cpu_time_ms": 3.5194210013287375,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.3721599578857422,
        "cpu_time_ms": 1.4819079988228623,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 46.56140899658203,
        "cpu_time_ms": 42.72854800001369,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 94.53504180908203,
        "cpu_time_ms": 86.22376099992834,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.987040042877197,
        "cpu_time_ms": 4.877078999925288,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5823999643325806,
        "cpu_time_ms": 1.7243710008187918,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 44.00230407714844,
        "cpu_time_ms": 40.48900599991612,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 106.7220458984375,
        "cpu_time_ms": 97.34695700171869,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.0860161781311035,
        "cpu_time_ms": 4.030141999464831,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6261119842529297,
        "cpu_time_ms": 1.7682819998299237,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 50.4510383605957,
        "cpu_time_ms": 46.415198001341196,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 171.85142517089844,
        "cpu_time_ms": 156.65360599996347,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.123456001281738,
        "cpu_time_ms": 4.037687000163714,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 2.15449595451355,
        "cpu_time_ms": 2.6094019995070994,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 64.4035873413086,
        "cpu_time_ms": 59.2980469991744,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 152.70835876464844,
        "cpu_time_ms": 139.2738400008966,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.079040050506592,
        "cpu_time_ms": 4.044077000799007,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6127680540084839,
        "cpu_time_ms": 1.7435209992981981,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 54.07241439819336,
        "cpu_time_ms": 49.56037900046795,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 113.84979248046875,
        "cpu_time_ms": 103.80047999933595,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 5.245952129364014,
        "cpu_time_ms": 5.066957000963157,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.53164803981781,
        "cpu_time_ms": 1.6612500003247987,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 49.87171173095703,
        "cpu_time_ms": 45.758594998915214,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 104.51014709472656,
        "cpu_time_ms": 95.31462800077861,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.111264228820801,
        "cpu_time_ms": 3.9914349999889964,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 2.261791944503784,
        "cpu_time_ms": 2.3026510007184697,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 49.426143646240234,
        "cpu_time_ms": 45.35477799981891,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 145.66978454589844,
        "cpu_time_ms": 132.7523679992737,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.8048319816589355,
        "cpu_time_ms": 3.7163520009926287,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 2.6837120056152344,
        "cpu_time_ms": 2.721773000303074,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 69.29452514648438,
        "cpu_time_ms": 63.563304998751846,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 134.94114685058594,
        "cpu_time_ms": 123.03744400014693,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 5.563648223876953,
        "cpu_time_ms": 5.404444998930558,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 2.842463970184326,
        "cpu_time_ms": 2.9591490001621423,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 69.95555114746094,
        "cpu_time_ms": 64.12336399989726,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 144.13433837890625,
        "cpu_time_ms": 131.63452700064227,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.502016067504883,
        "cpu_time_ms": 4.551206000542152,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6295679807662964,
        "cpu_time_ms": 1.7476390003139386,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 67.08873748779297,
        "cpu_time_ms": 61.4392819989007,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 136.1732177734375,
        "cpu_time_ms": 124.18827699912072,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 9.091615676879883,
        "cpu_time_ms": 8.547061001081602,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5782719850540161,
        "cpu_time_ms": 1.7115210011979798,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 68.53472137451172,
        "cpu_time_ms": 62.77533700085769,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 138.6050567626953,
        "cpu_time_ms": 126.3760279998678,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.808832168579102,
        "cpu_time_ms": 4.693580998718971,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6834239959716797,
        "cpu_time_ms": 1.83495899909758,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 64.24390411376953,
        "cpu_time_ms": 58.88409599901934,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 146.21218872070312,
        "cpu_time_ms": 133.40694200087455,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.28550386428833,
        "cpu_time_ms": 4.173330000412534,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.7592320442199707,
        "cpu_time_ms": 1.8935879998025484,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 174.32333374023438,
        "cpu_time_ms": 159.02174600159924,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 146.378662109375,
        "cpu_time_ms": 133.41818299886654,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 5.121632099151611,
        "cpu_time_ms": 4.97182799881557,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5164159536361694,
        "cpu_time_ms": 1.630945998840616,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 62.292991638183594,
        "cpu_time_ms": 57.038290999116725,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 166.16812133789062,
        "cpu_time_ms": 151.40983600031177,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.6605119705200195,
        "cpu_time_ms": 3.645347000201582,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5121920108795166,
        "cpu_time_ms": 1.6141219985001953,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 57.91756820678711,
        "cpu_time_ms": 53.04296000031172,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 145.41448974609375,
        "cpu_time_ms": 132.54066499939654,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.973536014556885,
        "cpu_time_ms": 4.80814399998053,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.3743360042572021,
        "cpu_time_ms": 1.4666240003862185,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 62.45052719116211,
        "cpu_time_ms": 57.21941700176103,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 102.87276458740234,
        "cpu_time_ms": 93.86966499914706,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.229951858520508,
        "cpu_time_ms": 4.129791999730514,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 2.1319680213928223,
        "cpu_time_ms": 2.177106998715317,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 64.70870208740234,
        "cpu_time_ms": 59.44233599984727,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 256.8332824707031,
        "cpu_time_ms": 233.99798400168947,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 8.947903633117676,
        "cpu_time_ms": 8.411529999648337,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.56496000289917,
        "cpu_time_ms": 1.6942319998634048,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 60.478145599365234,
        "cpu_time_ms": 55.42568000055326,
        "memory_allocated_mb": 0.3984375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "expansion",
        "gpu_time_ms": 147.093017578125,
        "cpu_time_ms": 134.0279339983681,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.7916479110717773,
        "cpu_time_ms": 3.8344590011547552,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.3995200395584106,
        "cpu_time_ms": 1.5025960001366911,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2048
      },
      {
        "name": "selection",
        "gpu_time_ms": 66.50656127929688,
        "cpu_time_ms": 60.89267000061227,
        "memory_allocated_mb": 0.16552734375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "expansion",
        "gpu_time_ms": 117.90108489990234,
        "cpu_time_ms": 107.5135320006666,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.6553919315338135,
        "cpu_time_ms": 3.578826999728335,
        "memory_allocated_mb": 0.00341796875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.3413759469985962,
        "cpu_time_ms": 1.474634998885449,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      }
    ],
    "peak_gpu_memory_mb": 662.291015625,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 188.3,
    "avg_ram_usage_mb": 1261.49609375,
    "final_tree_nodes": 11651,
    "final_tree_edges": 11650,
    "tree_memory_mb": 9.375587463378906,
    "efficiency_score": 17896.74293826997,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth"
    ],
    "cprofile_stats": "         833909 function calls (615255 primitive calls) in 4.317 seconds\n\n   Ordered by: cumulative time\n   List reduced from 214 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    4.317    4.317 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    4.317    4.317 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n       25    0.000    0.000    4.316    0.173 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n      100    0.004    0.000    4.213    0.042 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n       25    0.000    0.000    2.776    0.111 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n      387    0.592    0.002    1.822    0.005 {built-in method time.sleep}\n       25    0.000    0.000    1.354    0.054 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n       25    0.087    0.003    0.872    0.035 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n      229    0.139    0.001    0.749    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n       25    0.205    0.008    0.740    0.030 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n      388    0.055    0.000    0.572    0.001 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n      229    0.337    0.001    0.542    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n     1125    0.501    0.000    0.501    0.000 {built-in method torch.where}\n      388    0.056    0.000    0.499    0.001 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n      107    0.209    0.002    0.433    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n      229    0.055    0.000    0.383    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n      229    0.297    0.001    0.297    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n      739    0.295    0.000    0.295    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n     1364    0.023    0.000    0.238    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n      229    0.217    0.001    0.217    0.001 {built-in method torch.repeat_interleave}\n      776    0.018    0.000    0.185    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n      107    0.001    0.000    0.183    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n      132    0.173    0.001    0.178    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n219604/1364    0.139    0.000    0.176    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n      737    0.170    0.000    0.170    0.000 {built-in method torch.tensor}\n      229    0.162    0.001    0.162    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n       25    0.000    0.000    0.128    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n      776    0.002    0.000    0.127    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n      588    0.003    0.000    0.116    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n      107    0.019    0.000    0.091    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n       25    0.044    0.002    0.086    0.003 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n      107    0.000    0.000    0.082    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n       25    0.045    0.002    0.073    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n      229    0.048    0.000    0.067    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n      388    0.026    0.000    0.061    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n 1164/776    0.003    0.000    0.059    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n       25    0.000    0.000    0.058    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n      388    0.002    0.000    0.039    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n      301    0.001    0.000    0.038    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n       25    0.014    0.001    0.034    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n      388    0.003    0.000    0.033    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n      388    0.001    0.000    0.028    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:812(bcat)\n      202    0.000    0.000    0.028    0.000 {built-in method builtins.next}\n      202    0.000    0.000    0.028    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n      301    0.027    0.000    0.027    0.000 {built-in method torch._C._cuda_synchronize}\n      388    0.002    0.000    0.027    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:795(cat)\n      101    0.000    0.000    0.025    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n     1164    0.002    0.000    0.025    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:765(open_binary)\n      101    0.001    0.000    0.024    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n       25    0.024    0.001    0.024    0.001 {built-in method torch.bincount}\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 387,
        "primitive_calls": 387,
        "total_time": 0.592213042,
        "cumulative_time": 1.821764082,
        "time_percent": 5.620656224245408,
        "time_per_call": 0.004707400728682171
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 1125,
        "primitive_calls": 1125,
        "total_time": 0.501081824,
        "cumulative_time": 0.5011364420000001,
        "time_percent": 1.5461473248672262,
        "time_per_call": 0.00044545461511111116
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 229,
        "primitive_calls": 229,
        "total_time": 0.33698083300000004,
        "cumulative_time": 0.54185012,
        "time_percent": 1.6717605093205044,
        "time_per_call": 0.002366157729257642
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 229,
        "primitive_calls": 229,
        "total_time": 0.29708022700000003,
        "cumulative_time": 0.297090572,
        "time_percent": 0.9166082420744688,
        "time_per_call": 0.0012973387423580785
      },
      {
        "rank": 5,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 739,
        "primitive_calls": 739,
        "total_time": 0.29520897100000004,
        "cumulative_time": 0.29524663100000004,
        "time_percent": 0.9109191638007261,
        "time_per_call": 0.00039952182814614347
      },
      {
        "rank": 6,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 229,
        "primitive_calls": 229,
        "total_time": 0.21720480900000003,
        "cumulative_time": 0.21720480900000003,
        "time_percent": 0.670138122550758,
        "time_per_call": 0.0009484926157205242
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 107,
        "primitive_calls": 107,
        "total_time": 0.209083188,
        "cumulative_time": 0.432505509,
        "time_percent": 1.3344015315706934,
        "time_per_call": 0.004042107560747663
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.204829898,
        "cumulative_time": 0.7402359770000001,
        "time_percent": 2.283836854971779,
        "time_per_call": 0.029609439080000004
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 132,
        "primitive_calls": 132,
        "total_time": 0.17289858400000002,
        "cumulative_time": 0.17755869500000002,
        "time_percent": 0.5478186742626986,
        "time_per_call": 0.001345141628787879
      },
      {
        "rank": 10,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 737,
        "primitive_calls": 737,
        "total_time": 0.16961199400000002,
        "cumulative_time": 0.169638005,
        "time_percent": 0.5233811107007124,
        "time_per_call": 0.00023017368385346
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 229,
        "primitive_calls": 229,
        "total_time": 0.16159658600000001,
        "cumulative_time": 0.16159658600000001,
        "time_percent": 0.49857106410867763,
        "time_per_call": 0.0007056619475982533
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 229,
        "primitive_calls": 229,
        "total_time": 0.139342788,
        "cumulative_time": 0.748850926,
        "time_percent": 2.31041640344177,
        "time_per_call": 0.003270091379912664
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 1364,
        "primitive_calls": 219604,
        "total_time": 0.13874771400000002,
        "cumulative_time": 0.176494471,
        "time_percent": 0.5445352429398982,
        "time_per_call": 0.00012939477346041056
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.08714281900000001,
        "cumulative_time": 0.872008965,
        "time_percent": 2.690393704186032,
        "time_per_call": 0.0348803586
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 388,
        "primitive_calls": 388,
        "total_time": 0.055928364,
        "cumulative_time": 0.49910936100000003,
        "time_percent": 1.5398932080184673,
        "time_per_call": 0.0012863643324742269
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 388,
        "primitive_calls": 388,
        "total_time": 0.055134662,
        "cumulative_time": 0.571523334,
        "time_percent": 1.7633107471423881,
        "time_per_call": 0.0014729982835051546
      },
      {
        "rank": 17,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 229,
        "primitive_calls": 229,
        "total_time": 0.054595667,
        "cumulative_time": 0.38335060200000004,
        "time_percent": 1.1827447738644812,
        "time_per_call": 0.001674020096069869
      },
      {
        "rank": 18,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 229,
        "primitive_calls": 229,
        "total_time": 0.047846938000000006,
        "cumulative_time": 0.067161154,
        "time_percent": 0.20721111036681664,
        "time_per_call": 0.00029328014847161574
      },
      {
        "rank": 19,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.0451164,
        "cumulative_time": 0.072725092,
        "time_percent": 0.22437742902465452,
        "time_per_call": 0.00290900368
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.043934058000000005,
        "cumulative_time": 0.085511372,
        "time_percent": 0.2638267106177168,
        "time_per_call": 0.0034204548800000002
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 301,
        "primitive_calls": 301,
        "total_time": 0.027287581,
        "cumulative_time": 0.027287581,
        "time_percent": 0.08418988688363586,
        "time_per_call": 9.065641528239203e-05
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 388,
        "primitive_calls": 388,
        "total_time": 0.026062168,
        "cumulative_time": 0.061474913000000006,
        "time_percent": 0.18966745244480837,
        "time_per_call": 0.00015844049742268042
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.024042021,
        "cumulative_time": 0.024042021,
        "time_percent": 0.07417641851228945,
        "time_per_call": 0.00096168084
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 1364,
        "primitive_calls": 1364,
        "total_time": 0.023424424000000003,
        "cumulative_time": 0.238057021,
        "time_percent": 0.7344730802574742,
        "time_per_call": 0.000174528607771261
      },
      {
        "rank": 25,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 1164,
        "primitive_calls": 1164,
        "total_time": 0.020636872,
        "cumulative_time": 0.021921039,
        "time_percent": 0.06763259058330491,
        "time_per_call": 1.8832507731958763e-05
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 107,
        "primitive_calls": 107,
        "total_time": 0.019070833000000002,
        "cumulative_time": 0.09109842500000001,
        "time_percent": 0.2810643455727126,
        "time_per_call": 0.0008513871495327104
      },
      {
        "rank": 27,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 776,
        "primitive_calls": 776,
        "total_time": 0.018482904,
        "cumulative_time": 0.18516352,
        "time_percent": 0.5712817051748137,
        "time_per_call": 0.00023861278350515463
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 1364,
        "primitive_calls": 1364,
        "total_time": 0.017540394,
        "cumulative_time": 0.017540394,
        "time_percent": 0.05411706470992813,
        "time_per_call": 1.2859526392961878e-05
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 227062,
        "primitive_calls": 227062,
        "total_time": 0.015854217,
        "cumulative_time": 0.015854217,
        "time_percent": 0.04891473289107659,
        "time_per_call": 6.982329495908606e-08
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 1364,
        "primitive_calls": 1364,
        "total_time": 0.015080406000000001,
        "cumulative_time": 0.015080406000000001,
        "time_percent": 0.04652730761657853,
        "time_per_call": 1.1056016129032258e-05
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 166997,
        "primitive_calls": 166997,
        "total_time": 0.014157658,
        "cumulative_time": 0.014157658,
        "time_percent": 0.04368036967282671,
        "time_per_call": 8.47779181661946e-08
      },
      {
        "rank": 32,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.014079438000000001,
        "cumulative_time": 0.033965585,
        "time_percent": 0.10479341349775631,
        "time_per_call": 0.0013586234
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.011896145,
        "cumulative_time": 0.011896145,
        "time_percent": 0.036702963956436095,
        "time_per_call": 0.0004758458
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 687,
        "primitive_calls": 687,
        "total_time": 0.011210455000000001,
        "cumulative_time": 0.011245771,
        "time_percent": 0.03469637665607928,
        "time_per_call": 1.6369390101892286e-05
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.010664029,
        "cumulative_time": 0.010664029,
        "time_percent": 0.032901538441015066,
        "time_per_call": 0.00042656116
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 386,
        "primitive_calls": 386,
        "total_time": 0.009677904000000001,
        "cumulative_time": 0.009677904000000001,
        "time_percent": 0.02985906456972815,
        "time_per_call": 2.507229015544042e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 388,
        "primitive_calls": 388,
        "total_time": 0.009330914000000001,
        "cumulative_time": 0.011110649,
        "time_percent": 0.034279487159883534,
        "time_per_call": 2.8635693298969073e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 388,
        "primitive_calls": 388,
        "total_time": 0.008578760000000001,
        "cumulative_time": 0.008578760000000001,
        "time_percent": 0.026467895193856138,
        "time_per_call": 2.2110206185567013e-05
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 458,
        "primitive_calls": 458,
        "total_time": 0.008055168,
        "cumulative_time": 0.008121797,
        "time_percent": 0.025058035401593605,
        "time_per_call": 1.7733181222707425e-05
      },
      {
        "rank": 40,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 132,
        "primitive_calls": 132,
        "total_time": 0.007474158000000001,
        "cumulative_time": 0.0075041610000000005,
        "time_percent": 0.023152454068632606,
        "time_per_call": 5.684970454545455e-05
      },
      {
        "rank": 41,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 274,
        "primitive_calls": 274,
        "total_time": 0.007007926,
        "cumulative_time": 0.011978305000000002,
        "time_percent": 0.03695645073880642,
        "time_per_call": 4.371644160583942e-05
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 1164,
        "primitive_calls": 1164,
        "total_time": 0.0068466790000000005,
        "cumulative_time": 0.007577922000000001,
        "time_percent": 0.023380027566130383,
        "time_per_call": 6.510242268041238e-06
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 553,
        "primitive_calls": 553,
        "total_time": 0.005749846,
        "cumulative_time": 0.005780989,
        "time_percent": 0.01783598223622472,
        "time_per_call": 1.0453867992766727e-05
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 55990,
        "primitive_calls": 55990,
        "total_time": 0.0057179530000000004,
        "cumulative_time": 0.016178863,
        "time_percent": 0.049916357403605754,
        "time_per_call": 2.8895986783354173e-07
      },
      {
        "rank": 45,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 2539,
        "primitive_calls": 2539,
        "total_time": 0.005441662000000001,
        "cumulative_time": 0.01046091,
        "time_percent": 0.032274859013699135,
        "time_per_call": 4.1200905868452145e-06
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'numpy' of 'torch._C.TensorBase' objects>",
        "total_calls": 739,
        "primitive_calls": 739,
        "total_time": 0.005316632,
        "cumulative_time": 0.005316632,
        "time_percent": 0.01640330986766173,
        "time_per_call": 7.194359945872801e-06
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 53196,
        "primitive_calls": 53196,
        "total_time": 0.005288989,
        "cumulative_time": 0.005288989,
        "time_percent": 0.016318023412877615,
        "time_per_call": 9.942456199714264e-08
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.ones>",
        "total_calls": 386,
        "primitive_calls": 386,
        "total_time": 0.0052290670000000004,
        "cumulative_time": 0.0052290670000000004,
        "time_percent": 0.01613314713520972,
        "time_per_call": 1.3546805699481867e-05
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 107,
        "primitive_calls": 107,
        "total_time": 0.005212932,
        "cumulative_time": 0.005212932,
        "time_percent": 0.016083366107537553,
        "time_per_call": 4.871899065420561e-05
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'split' of 'bytes' objects>",
        "total_calls": 21340,
        "primitive_calls": 21340,
        "total_time": 0.005064675,
        "cumulative_time": 0.005064675,
        "time_percent": 0.015625951430153464,
        "time_per_call": 2.3733247422680413e-07
      }
    ]
  },
  {
    "config": {
      "num_simulations": 1000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 3072,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 1000,
    "wave_size": 3072,
    "total_time_ms": 74.50688100107072,
    "simulations_per_second": 13421.579142275856,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 28.493343353271484,
        "cpu_time_ms": 26.736596000773716,
        "memory_allocated_mb": 0.19482421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "expansion",
        "gpu_time_ms": 40.375457763671875,
        "cpu_time_ms": 36.98421300032351,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.210080146789551,
        "cpu_time_ms": 4.1272310008935165,
        "memory_allocated_mb": 0.00390625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4278080463409424,
        "cpu_time_ms": 1.5859779996389989,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      }
    ],
    "peak_gpu_memory_mb": 692.8681640625,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 185.3,
    "avg_ram_usage_mb": 1266.93359375,
    "final_tree_nodes": 351,
    "final_tree_edges": 350,
    "tree_memory_mb": 12.203712463378906,
    "efficiency_score": 19835.94824317939,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "cprofile_stats": "         16555 function calls (12387 primitive calls) in 0.073 seconds\n\n   Ordered by: cumulative time\n   List reduced from 214 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    0.073    0.073 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    0.072    0.072 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n        1    0.000    0.000    0.071    0.071 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n        4    0.002    0.000    0.071    0.018 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n        1    0.000    0.000    0.037    0.037 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n        5    0.005    0.001    0.028    0.006 {built-in method time.sleep}\n        1    0.000    0.000    0.027    0.027 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n        1    0.005    0.005    0.018    0.018 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n        3    0.002    0.001    0.010    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n        1    0.001    0.001    0.009    0.009 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n        3    0.006    0.002    0.009    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n        2    0.003    0.002    0.007    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n       19    0.007    0.000    0.007    0.000 {built-in method torch.where}\n       13    0.005    0.000    0.005    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n        2    0.000    0.000    0.005    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n        3    0.001    0.000    0.005    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n        3    0.004    0.001    0.005    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n        1    0.000    0.000    0.005    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n       26    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        3    0.004    0.001    0.004    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n        2    0.000    0.000    0.003    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n        1    0.002    0.002    0.003    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n  4186/26    0.003    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        3    0.003    0.001    0.003    0.001 {built-in method torch.repeat_interleave}\n       11    0.003    0.000    0.003    0.000 {built-in method torch.tensor}\n       14    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        1    0.001    0.001    0.003    0.003 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n        3    0.002    0.001    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n       12    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n       13    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        2    0.000    0.000    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n       13    0.001    0.000    0.001    0.000 {built-in method torch._C._cuda_synchronize}\n       10    0.000    0.000    0.001    0.000 {built-in method builtins.next}\n       10    0.000    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:489(_extract_policy)\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n        5    0.000    0.000    0.001    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n        5    0.000    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n        3    0.001    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n        1    0.001    0.001    0.001    0.001 {built-in method torch.bincount}\n        6    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n    18/12    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n       12    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n        6    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n        6    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n        6    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n        1    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n       26    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.007101236,
        "cumulative_time": 0.007101236,
        "time_percent": 1.3304785658351639,
        "time_per_call": 0.00037374926315789477
      },
      {
        "rank": 2,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.005672042,
        "cumulative_time": 0.008705852,
        "time_percent": 1.6311173834151114,
        "time_per_call": 0.0029019506666666667
      },
      {
        "rank": 3,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.005437306,
        "cumulative_time": 0.028143502,
        "time_percent": 5.272930821977901,
        "time_per_call": 0.0056287004000000005
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.005410729,
        "cumulative_time": 0.017770234000000003,
        "time_percent": 3.3294084926730036,
        "time_per_call": 0.017770234000000003
      },
      {
        "rank": 5,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.005106328,
        "cumulative_time": 0.005106328,
        "time_percent": 0.9567151343968769,
        "time_per_call": 0.00039279446153846155
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.004497781,
        "cumulative_time": 0.004598399,
        "time_percent": 0.8615502014941979,
        "time_per_call": 0.0015327996666666668
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0041217,
        "cumulative_time": 0.0041217,
        "time_percent": 0.7722364817621601,
        "time_per_call": 0.0013739
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.003172549,
        "cumulative_time": 0.007330540000000001,
        "time_percent": 1.3734406722994845,
        "time_per_call": 0.0036652700000000004
      },
      {
        "rank": 9,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.003161759,
        "cumulative_time": 0.003161759,
        "time_percent": 0.592383154120835,
        "time_per_call": 0.0010539196666666667
      },
      {
        "rank": 10,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.0026924540000000004,
        "cumulative_time": 0.0026924540000000004,
        "time_percent": 0.5044547648461691,
        "time_per_call": 0.0002447685454545455
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 26,
        "primitive_calls": 4186,
        "total_time": 0.002550697,
        "cumulative_time": 0.0032446880000000003,
        "time_percent": 0.6079206263279471,
        "time_per_call": 0.00012479569230769232
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.002254751,
        "cumulative_time": 0.0032678980000000004,
        "time_percent": 0.6122692224755805,
        "time_per_call": 0.0032678980000000004
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.002048158,
        "cumulative_time": 0.002048158,
        "time_percent": 0.38374028386661385,
        "time_per_call": 0.0006827193333333333
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.001909773,
        "cumulative_time": 0.009957034,
        "time_percent": 1.8655372552457015,
        "time_per_call": 0.0033190113333333333
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 390,
        "function_name": "_profile_phase",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0018221370000000001,
        "cumulative_time": 0.07064674,
        "time_percent": 13.236283559105724,
        "time_per_call": 0.017661685
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.0014260780000000001,
        "cumulative_time": 0.0014260780000000001,
        "time_percent": 0.2671881644560298,
        "time_per_call": 0.0001096983076923077
      },
      {
        "rank": 17,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0010953450000000002,
        "cumulative_time": 0.0025795030000000004,
        "time_percent": 0.48329240881552205,
        "time_per_call": 0.0025795030000000004
      },
      {
        "rank": 18,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0009642720000000001,
        "cumulative_time": 0.009118437,
        "time_percent": 1.7084187854647124,
        "time_per_call": 0.009118437
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0009436630000000001,
        "cumulative_time": 0.0009436630000000001,
        "time_percent": 0.17680350221731939,
        "time_per_call": 0.0009436630000000001
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0007169720000000001,
        "cumulative_time": 0.0009932790000000001,
        "time_percent": 0.18609949301701645,
        "time_per_call": 0.000331093
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.000693014,
        "cumulative_time": 0.004814714,
        "time_percent": 0.9020787054009309,
        "time_per_call": 0.0016049046666666668
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00055175,
        "cumulative_time": 0.0012024140000000002,
        "time_percent": 0.22528276123482205,
        "time_per_call": 0.0012024140000000002
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000498589,
        "cumulative_time": 0.00050517,
        "time_percent": 0.09464801016371652,
        "time_per_call": 0.00050517
      },
      {
        "rank": 24,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00045176300000000005,
        "cumulative_time": 0.00045176300000000005,
        "time_percent": 0.08464174241461503,
        "time_per_call": 0.00045176300000000005
      },
      {
        "rank": 25,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00044118200000000003,
        "cumulative_time": 0.00044118200000000003,
        "time_percent": 0.08265929968139199,
        "time_per_call": 0.00044118200000000003
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 26,
        "primitive_calls": 26,
        "total_time": 0.00043065700000000003,
        "cumulative_time": 0.004426022,
        "time_percent": 0.8292538655122691,
        "time_per_call": 0.00017023161538461538
      },
      {
        "rank": 27,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00038807500000000004,
        "cumulative_time": 0.0016746380000000002,
        "time_percent": 0.31375805064541823,
        "time_per_call": 0.0008373190000000001
      },
      {
        "rank": 28,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.000368455,
        "cumulative_time": 0.000510775,
        "time_percent": 0.09569815585124276,
        "time_per_call": 8.512916666666666e-05
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 26,
        "primitive_calls": 26,
        "total_time": 0.000316469,
        "cumulative_time": 0.000316469,
        "time_percent": 0.05929323025615378,
        "time_per_call": 1.2171884615384616e-05
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 4467,
        "primitive_calls": 4467,
        "total_time": 0.000303911,
        "cumulative_time": 0.000303911,
        "time_percent": 0.05694037931164807,
        "time_per_call": 6.803469890306695e-08
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 26,
        "primitive_calls": 26,
        "total_time": 0.00028653,
        "cumulative_time": 0.00028653,
        "time_percent": 0.05368389720729595,
        "time_per_call": 1.1020384615384615e-05
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 3187,
        "primitive_calls": 3187,
        "total_time": 0.000262818,
        "cumulative_time": 0.000262818,
        "time_percent": 0.049241246976676464,
        "time_per_call": 8.246564166928146e-08
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.00024176900000000002,
        "cumulative_time": 0.00024176900000000002,
        "time_percent": 0.045297533046838846,
        "time_per_call": 1.3431611111111113e-05
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.000217628,
        "cumulative_time": 0.000217628,
        "time_percent": 0.0407745059205996,
        "time_per_call": 3.627133333333333e-05
      },
      {
        "rank": 35,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.000205653,
        "cumulative_time": 0.000205653,
        "time_percent": 0.0385308851162951,
        "time_per_call": 6.8551e-05
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.000192294,
        "cumulative_time": 0.000192294,
        "time_percent": 0.03602795982821962,
        "time_per_call": 2.747057142857143e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.000180819,
        "cumulative_time": 0.000180819,
        "time_percent": 0.03387801838943932,
        "time_per_call": 3.61638e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.000164622,
        "cumulative_time": 0.000164622,
        "time_percent": 0.0308433690226485,
        "time_per_call": 2.7437000000000002e-05
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.00015921000000000002,
        "cumulative_time": 0.00015921000000000002,
        "time_percent": 0.0298293835702146,
        "time_per_call": 1.7690000000000002e-05
      },
      {
        "rank": 40,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 367,
        "function_name": "get_nn_features",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000138384,
        "cumulative_time": 0.00022391700000000002,
        "time_percent": 0.04195280498016295,
        "time_per_call": 0.00022391700000000002
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.000133263,
        "cumulative_time": 0.000133263,
        "time_percent": 0.02496798657570195,
        "time_per_call": 1.0251e-05
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.round>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.00012936300000000001,
        "cumulative_time": 0.00012936300000000001,
        "time_percent": 0.024237287524613224,
        "time_per_call": 1.078025e-05
      },
      {
        "rank": 43,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.000128197,
        "cumulative_time": 0.000189497,
        "time_percent": 0.03550391745747727,
        "time_per_call": 3.78994e-05
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.00012133200000000001,
        "cumulative_time": 0.00012133200000000001,
        "time_percent": 0.022732609555563582,
        "time_per_call": 2.0222e-05
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'numpy' of 'torch._C.TensorBase' objects>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.00011947900000000001,
        "cumulative_time": 0.00011947900000000001,
        "time_percent": 0.02238543382693091,
        "time_per_call": 9.190692307692309e-06
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.00011128100000000001,
        "cumulative_time": 0.00011128100000000001,
        "time_percent": 0.020849466949796187,
        "time_per_call": 1.5897285714285717e-05
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.ones>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.00010978500000000001,
        "cumulative_time": 0.00010978500000000001,
        "time_percent": 0.02056917828814779,
        "time_per_call": 1.5683571428571428e-05
      },
      {
        "rank": 48,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 46,
        "primitive_calls": 46,
        "total_time": 0.00010817200000000001,
        "cumulative_time": 0.00020723400000000002,
        "time_percent": 0.038827099270082606,
        "time_per_call": 4.505086956521739e-06
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 1065,
        "primitive_calls": 1065,
        "total_time": 0.000107731,
        "cumulative_time": 0.000314965,
        "time_percent": 0.059011442724657005,
        "time_per_call": 2.957417840375587e-07
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00010374300000000001,
        "cumulative_time": 0.00010374300000000001,
        "time_percent": 0.019437156835153402,
        "time_per_call": 5.1871500000000006e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 5000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 3072,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 5000,
    "wave_size": 3072,
    "total_time_ms": 184.35351799962518,
    "simulations_per_second": 27121.804098200966,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 37.98575973510742,
        "cpu_time_ms": 36.05520499877457,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 41.6409912109375,
        "cpu_time_ms": 38.20098399955896,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.530464172363281,
        "cpu_time_ms": 4.369256999780191,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6424959897994995,
        "cpu_time_ms": 1.9275829999969574,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 44.518592834472656,
        "cpu_time_ms": 40.95625599984487,
        "memory_allocated_mb": 0.3759765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "expansion",
        "gpu_time_ms": 53.23881530761719,
        "cpu_time_ms": 48.68572399936966,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.8224639892578125,
        "cpu_time_ms": 4.646729001251515,
        "memory_allocated_mb": 0.0078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6240639686584473,
        "cpu_time_ms": 2.0731579988932936,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      }
    ],
    "peak_gpu_memory_mb": 721.47412109375,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 185.6,
    "avg_ram_usage_mb": 1257.61328125,
    "final_tree_nodes": 501,
    "final_tree_edges": 500,
    "tree_memory_mb": 12.203712463378906,
    "efficiency_score": 38494.419390198665,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "cprofile_stats": "         41550 function calls (30810 primitive calls) in 0.182 seconds\n\n   Ordered by: cumulative time\n   List reduced from 214 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    0.182    0.182 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    0.182    0.182 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n        2    0.000    0.000    0.180    0.090 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n        8    0.000    0.000    0.180    0.023 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n       16    0.036    0.002    0.092    0.006 {built-in method time.sleep}\n        2    0.000    0.000    0.088    0.044 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n        2    0.013    0.006    0.086    0.043 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n        2    0.000    0.000    0.078    0.039 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n        5    0.012    0.002    0.023    0.005 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n       44    0.022    0.001    0.022    0.001 {built-in method torch.where}\n        6    0.004    0.001    0.021    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n        6    0.010    0.002    0.016    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n        5    0.000    0.000    0.013    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n       24    0.012    0.001    0.012    0.001 {method 'cpu' of 'torch._C.TensorBase' objects}\n        6    0.002    0.000    0.012    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n       67    0.001    0.000    0.012    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        7    0.010    0.001    0.010    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n        2    0.000    0.000    0.010    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n 10787/67    0.007    0.000    0.009    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        5    0.000    0.000    0.008    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n       33    0.000    0.000    0.007    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       22    0.006    0.000    0.006    0.000 {built-in method torch.tensor}\n       17    0.001    0.000    0.005    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n       34    0.000    0.000    0.005    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        5    0.001    0.000    0.005    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n        6    0.005    0.001    0.005    0.001 {built-in method torch.repeat_interleave}\n        2    0.000    0.000    0.005    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n        6    0.004    0.001    0.004    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n        6    0.004    0.001    0.004    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n       34    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n        2    0.002    0.001    0.003    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n    51/34    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n        2    0.001    0.001    0.003    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n        2    0.001    0.000    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n       25    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n       17    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n       18    0.000    0.000    0.002    0.000 {built-in method builtins.next}\n       25    0.002    0.000    0.002    0.000 {built-in method torch._C._cuda_synchronize}\n       18    0.000    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n       17    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n        9    0.000    0.000    0.002    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n        6    0.001    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n        9    0.000    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n       17    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n        2    0.001    0.000    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n       17    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:812(bcat)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:489(_extract_policy)\n       17    0.001    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n        7    0.002    0.000    0.002    0.000 {built-in method torch.full_like}\n       17    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:795(cat)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.035802797000000004,
        "cumulative_time": 0.09192928,
        "time_percent": 6.705514421335233,
        "time_per_call": 0.00574558
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 44,
        "primitive_calls": 44,
        "total_time": 0.022029265000000003,
        "cumulative_time": 0.022029265000000003,
        "time_percent": 1.606860775466919,
        "time_per_call": 0.0005006651136363637
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.012858569,
        "cumulative_time": 0.086251931,
        "time_percent": 6.291396682194307,
        "time_per_call": 0.0431259655
      },
      {
        "rank": 4,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 24,
        "primitive_calls": 24,
        "total_time": 0.012477481,
        "cumulative_time": 0.012477481,
        "time_percent": 0.9101336243190024,
        "time_per_call": 0.0005198950416666667
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.011859588,
        "cumulative_time": 0.022962707000000002,
        "time_percent": 1.674947991993362,
        "time_per_call": 0.0045925414000000005
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.010470295000000001,
        "cumulative_time": 0.016325017,
        "time_percent": 1.1907809668697815,
        "time_per_call": 0.002720836166666667
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.009997538,
        "cumulative_time": 0.010153458,
        "time_percent": 0.7406145141724335,
        "time_per_call": 0.001450494
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 67,
        "primitive_calls": 10787,
        "total_time": 0.006791401000000001,
        "cumulative_time": 0.008687665,
        "time_percent": 0.6336964995834773,
        "time_per_call": 0.00012966664179104478
      },
      {
        "rank": 9,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 22,
        "primitive_calls": 22,
        "total_time": 0.005724592000000001,
        "cumulative_time": 0.005724592000000001,
        "time_percent": 0.4175637426101924,
        "time_per_call": 0.0002602087272727273
      },
      {
        "rank": 10,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.004891444,
        "cumulative_time": 0.004891444,
        "time_percent": 0.3567921807192844,
        "time_per_call": 0.0008152406666666667
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.004335739,
        "cumulative_time": 0.004335739,
        "time_percent": 0.31625789293297635,
        "time_per_call": 0.0007226231666666666
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.004205072000000001,
        "cumulative_time": 0.004205072000000001,
        "time_percent": 0.3067267679976717,
        "time_per_call": 0.0007008453333333334
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.003744849,
        "cumulative_time": 0.021213267,
        "time_percent": 1.547340170532553,
        "time_per_call": 0.0035355445
      },
      {
        "rank": 14,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.002472384,
        "cumulative_time": 0.002472384,
        "time_percent": 0.1803408725389614,
        "time_per_call": 9.889536e-05
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00202984,
        "cumulative_time": 0.003356748,
        "time_percent": 0.244848236848893,
        "time_per_call": 0.001678374
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.0015842080000000001,
        "cumulative_time": 0.012416905,
        "time_percent": 0.9057150838758835,
        "time_per_call": 0.002069484166666667
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full_like>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.0015275750000000002,
        "cumulative_time": 0.0015275750000000002,
        "time_percent": 0.11142452320056428,
        "time_per_call": 0.00021822500000000003
      },
      {
        "rank": 18,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.0014958760000000001,
        "cumulative_time": 0.0021362,
        "time_percent": 0.15581890673848775,
        "time_per_call": 0.00035603333333333333
      },
      {
        "rank": 19,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.001445368,
        "cumulative_time": 0.0030404900000000003,
        "time_percent": 0.2217797152650991,
        "time_per_call": 0.0015202450000000001
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.001346341,
        "cumulative_time": 0.001346341,
        "time_percent": 0.09820493526692366,
        "time_per_call": 0.0006731705
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0011670340000000002,
        "cumulative_time": 0.0011670340000000002,
        "time_percent": 0.08512590675341462,
        "time_per_call": 0.0005835170000000001
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 67,
        "primitive_calls": 67,
        "total_time": 0.001152211,
        "cumulative_time": 0.011746095000000002,
        "time_percent": 0.8567847960614257,
        "time_per_call": 0.0001753148507462687
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 51,
        "primitive_calls": 51,
        "total_time": 0.001128572,
        "cumulative_time": 0.0012147430000000001,
        "time_percent": 0.08860590123969236,
        "time_per_call": 2.3818490196078432e-05
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.0009440220000000001,
        "cumulative_time": 0.005150686000000001,
        "time_percent": 0.3757018357238248,
        "time_per_call": 0.0010301372
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.0009015920000000001,
        "cumulative_time": 0.001593589,
        "time_percent": 0.11623972276494708,
        "time_per_call": 9.37405294117647e-05
      },
      {
        "rank": 26,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000861057,
        "cumulative_time": 0.000861057,
        "time_percent": 0.06280730286467655,
        "time_per_call": 0.0004305285
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 67,
        "primitive_calls": 67,
        "total_time": 0.000815961,
        "cumulative_time": 0.000815961,
        "time_percent": 0.059517906076792054,
        "time_per_call": 1.2178522388059702e-05
      },
      {
        "rank": 28,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0007934740000000001,
        "cumulative_time": 0.0017372490000000002,
        "time_percent": 0.12671858436126351,
        "time_per_call": 0.0008686245000000001
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 11346,
        "primitive_calls": 11346,
        "total_time": 0.000791063,
        "cumulative_time": 0.000791063,
        "time_percent": 0.05770179375586009,
        "time_per_call": 6.972175215935132e-08
      },
      {
        "rank": 30,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000757401,
        "cumulative_time": 0.002985194,
        "time_percent": 0.21774630909198256,
        "time_per_call": 0.001492597
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 67,
        "primitive_calls": 67,
        "total_time": 0.000753092,
        "cumulative_time": 0.000753092,
        "time_percent": 0.05493210940618913,
        "time_per_call": 1.1240179104477613e-05
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 8208,
        "primitive_calls": 8208,
        "total_time": 0.0007383950000000001,
        "cumulative_time": 0.0007383950000000001,
        "time_percent": 0.05386007941258575,
        "time_per_call": 8.996040448343081e-08
      },
      {
        "rank": 33,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.00066326,
        "cumulative_time": 0.005332365,
        "time_percent": 0.3889538828904486,
        "time_per_call": 0.0003136685294117647
      },
      {
        "rank": 34,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00065923,
        "cumulative_time": 0.0006684620000000001,
        "time_percent": 0.04875901977166136,
        "time_per_call": 0.0006684620000000001
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.000537094,
        "cumulative_time": 0.000537094,
        "time_percent": 0.03917676242664607,
        "time_per_call": 3.159376470588235e-05
      },
      {
        "rank": 36,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.0004971660000000001,
        "cumulative_time": 0.0004971660000000001,
        "time_percent": 0.03626433039394579,
        "time_per_call": 7.102371428571429e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.00046313400000000003,
        "cumulative_time": 0.00046313400000000003,
        "time_percent": 0.03378196496274824,
        "time_per_call": 2.7243176470588237e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 15,
        "primitive_calls": 15,
        "total_time": 0.00043606000000000005,
        "cumulative_time": 0.00043606000000000005,
        "time_percent": 0.031807130639633446,
        "time_per_call": 2.907066666666667e-05
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 34,
        "primitive_calls": 34,
        "total_time": 0.000389726,
        "cumulative_time": 0.003795698,
        "time_percent": 0.2768661701476755,
        "time_per_call": 0.00011163817647058824
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.000345216,
        "cumulative_time": 0.000345216,
        "time_percent": 0.0251807788168869,
        "time_per_call": 1.9178666666666666e-05
      },
      {
        "rank": 41,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.000321852,
        "cumulative_time": 0.000465278,
        "time_percent": 0.033938352817840134,
        "time_per_call": 3.877316666666667e-05
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 30,
        "primitive_calls": 30,
        "total_time": 0.00031864400000000003,
        "cumulative_time": 0.00031864400000000003,
        "time_percent": 0.023242561426260973,
        "time_per_call": 1.0621466666666668e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.000301586,
        "cumulative_time": 0.000301586,
        "time_percent": 0.021998315142605356,
        "time_per_call": 6.03172e-05
      },
      {
        "rank": 44,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 367,
        "function_name": "get_nn_features",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000289557,
        "cumulative_time": 0.00046101400000000004,
        "time_percent": 0.03362732771797453,
        "time_per_call": 0.00023050700000000002
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'numpy' of 'torch._C.TensorBase' objects>",
        "total_calls": 24,
        "primitive_calls": 24,
        "total_time": 0.000279168,
        "cumulative_time": 0.000279168,
        "time_percent": 0.02036309922121999,
        "time_per_call": 1.1632e-05
      },
      {
        "rank": 46,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 33,
        "primitive_calls": 33,
        "total_time": 0.000275472,
        "cumulative_time": 0.006845636,
        "time_percent": 0.4993350423413699,
        "time_per_call": 0.00020744351515151517
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 2721,
        "primitive_calls": 2721,
        "total_time": 0.00027530800000000004,
        "cumulative_time": 0.0007473250000000001,
        "time_percent": 0.0545114523351467,
        "time_per_call": 2.7465086365306875e-07
      },
      {
        "rank": 48,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 390,
        "function_name": "_profile_phase",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.00027050100000000003,
        "cumulative_time": 0.180248022,
        "time_percent": 13.147668631127651,
        "time_per_call": 0.02253100275
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 2613,
        "primitive_calls": 2613,
        "total_time": 0.000256687,
        "cumulative_time": 0.000256687,
        "time_percent": 0.01872328794774937,
        "time_per_call": 9.823459624952164e-08
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 51,
        "primitive_calls": 51,
        "total_time": 0.000255064,
        "cumulative_time": 0.000255064,
        "time_percent": 0.018604902924981574,
        "time_per_call": 5.001254901960784e-06
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 3072,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 10000,
    "wave_size": 3072,
    "total_time_ms": 330.4797079999844,
    "simulations_per_second": 30259.04392290395,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 35.69721603393555,
        "cpu_time_ms": 33.40733200093382,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 46.20124816894531,
        "cpu_time_ms": 42.397270999572356,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.866687774658203,
        "cpu_time_ms": 4.768342998431763,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.807360053062439,
        "cpu_time_ms": 2.0233689992892323,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 41.50435256958008,
        "cpu_time_ms": 38.119550999908824,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 36.57727813720703,
        "cpu_time_ms": 33.52251099931891,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.6319680213928223,
        "cpu_time_ms": 3.5327549994690344,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.49782395362854,
        "cpu_time_ms": 1.616208999621449,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 36.82128143310547,
        "cpu_time_ms": 34.747289999359054,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 41.43747329711914,
        "cpu_time_ms": 37.962247000905336,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.656735897064209,
        "cpu_time_ms": 4.557914000542951,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4911680221557617,
        "cpu_time_ms": 1.6070769997895695,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 37.64108657836914,
        "cpu_time_ms": 34.62543800014828,
        "memory_allocated_mb": 0.1533203125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "expansion",
        "gpu_time_ms": 45.76047897338867,
        "cpu_time_ms": 41.87491099946783,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.677151918411255,
        "cpu_time_ms": 3.57153400000243,
        "memory_allocated_mb": 0.00341796875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5137280225753784,
        "cpu_time_ms": 1.7731489988364046,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      }
    ],
    "peak_gpu_memory_mb": 720.88232421875,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 187.9,
    "avg_ram_usage_mb": 1258.36328125,
    "final_tree_nodes": 851,
    "final_tree_edges": 850,
    "tree_memory_mb": 12.203712463378906,
    "efficiency_score": 42982.41188065425,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "cprofile_stats": "         77896 function calls (57793 primitive calls) in 0.329 seconds\n\n   Ordered by: cumulative time\n   List reduced from 212 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        4    0.000    0.000    0.158    0.039 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n        4    0.020    0.005    0.111    0.028 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n        4    0.027    0.007    0.106    0.027 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n       30    0.024    0.001    0.072    0.002 {built-in method time.sleep}\n       96    0.040    0.000    0.040    0.000 {built-in method torch.where}\n       13    0.007    0.001    0.039    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n       13    0.020    0.002    0.034    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n       11    0.016    0.001    0.033    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n       31    0.007    0.000    0.029    0.001 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n       11    0.000    0.000    0.022    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n       49    0.021    0.000    0.021    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n       13    0.003    0.000    0.020    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n      125    0.002    0.000    0.020    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       15    0.018    0.001    0.018    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n        4    0.000    0.000    0.018    0.004 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n20125/125    0.011    0.000    0.015    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       13    0.015    0.001    0.015    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n       11    0.000    0.000    0.013    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n        4    0.008    0.002    0.013    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n        4    0.006    0.002    0.012    0.003 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n       63    0.000    0.000    0.011    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       13    0.011    0.001    0.011    0.001 {built-in method torch.repeat_interleave}\n       47    0.010    0.000    0.010    0.000 {built-in method torch.tensor}\n       11    0.002    0.000    0.009    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n       13    0.009    0.001    0.009    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n       62    0.000    0.000    0.009    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        4    0.000    0.000    0.008    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n       30    0.003    0.000    0.008    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n       34    0.000    0.000    0.006    0.000 {built-in method builtins.next}\n       34    0.000    0.000    0.006    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n       49    0.006    0.000    0.006    0.000 {built-in method torch._C._cuda_synchronize}\n       17    0.000    0.000    0.006    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       17    0.000    0.000    0.006    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n        4    0.002    0.000    0.005    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n       13    0.003    0.000    0.004    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n    91/61    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n       61    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n        4    0.003    0.001    0.003    0.001 {built-in method torch.bincount}\n       31    0.001    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n       30    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n        4    0.000    0.000    0.002    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n      8/4    0.000    0.000    0.002    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        4    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        4    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n        4    0.002    0.000    0.002    0.000 {built-in method torch._unique2}\n       30    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n      125    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n       30    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:812(bcat)\n        4    0.002    0.000    0.002    0.000 {method 'item' of 'torch._C.TensorBase' objects}\n       30    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:795(cat)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 96,
        "primitive_calls": 96,
        "total_time": 0.040111157,
        "cumulative_time": 0.040111157,
        "time_percent": 3.9913011170996238,
        "time_per_call": 0.00041782455208333333
      },
      {
        "rank": 2,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.027210823000000002,
        "cumulative_time": 0.10619486500000001,
        "time_percent": 10.567027106815786,
        "time_per_call": 0.026548716250000003
      },
      {
        "rank": 3,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 30,
        "primitive_calls": 30,
        "total_time": 0.024033416000000002,
        "cumulative_time": 0.072074656,
        "time_percent": 7.171861310492017,
        "time_per_call": 0.002402488533333333
      },
      {
        "rank": 4,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 49,
        "primitive_calls": 49,
        "total_time": 0.02052004,
        "cumulative_time": 0.02052004,
        "time_percent": 2.0418672683744563,
        "time_per_call": 0.0004187763265306122
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.020493516,
        "cumulative_time": 0.033938823,
        "time_percent": 3.377116799521549,
        "time_per_call": 0.0026106786923076925
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.020213082,
        "cumulative_time": 0.110592677,
        "time_percent": 11.004635823722008,
        "time_per_call": 0.02764816925
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 15,
        "primitive_calls": 15,
        "total_time": 0.017621835000000002,
        "cumulative_time": 0.0179365,
        "time_percent": 1.7847895159657796,
        "time_per_call": 0.0011957666666666668
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.015638936000000003,
        "cumulative_time": 0.033333652000000005,
        "time_percent": 3.3168986490369776,
        "time_per_call": 0.0030303320000000006
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.014549839,
        "cumulative_time": 0.014549839,
        "time_percent": 1.4477963987505937,
        "time_per_call": 0.0011192183846153846
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 125,
        "primitive_calls": 20125,
        "total_time": 0.011377613,
        "cumulative_time": 0.014679463,
        "time_percent": 1.46069476555669,
        "time_per_call": 0.000117435704
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.010948540000000001,
        "cumulative_time": 0.010948540000000001,
        "time_percent": 1.0894455109487347,
        "time_per_call": 0.0008421953846153847
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 47,
        "primitive_calls": 47,
        "total_time": 0.009928597,
        "cumulative_time": 0.009928597,
        "time_percent": 0.9879550544336572,
        "time_per_call": 0.00021124674468085109
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.008944135,
        "cumulative_time": 0.008944135,
        "time_percent": 0.8899951705952995,
        "time_per_call": 0.0006880103846153846
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.007809686000000001,
        "cumulative_time": 0.012746693000000002,
        "time_percent": 1.2683725381002087,
        "time_per_call": 0.0031866732500000004
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 0.0073517,
        "cumulative_time": 0.028524518000000002,
        "time_percent": 2.838360921828516,
        "time_per_call": 0.0009201457419354839
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.006959394000000001,
        "cumulative_time": 0.038764932,
        "time_percent": 3.8573436412190985,
        "time_per_call": 0.0029819178461538464
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 49,
        "primitive_calls": 49,
        "total_time": 0.0063421020000000005,
        "cumulative_time": 0.0063421020000000005,
        "time_percent": 0.6310772535770972,
        "time_per_call": 0.0001294306530612245
      },
      {
        "rank": 18,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.006266579,
        "cumulative_time": 0.011796852,
        "time_percent": 1.173857651771524,
        "time_per_call": 0.002949213
      },
      {
        "rank": 19,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.0030467040000000003,
        "cumulative_time": 0.004167474,
        "time_percent": 0.41468870199091074,
        "time_per_call": 0.00032057492307692307
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 30,
        "primitive_calls": 30,
        "total_time": 0.0029898840000000004,
        "cumulative_time": 0.008413771,
        "time_percent": 0.8372207660656713,
        "time_per_call": 0.0002804590333333334
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0027977830000000003,
        "cumulative_time": 0.0027977830000000003,
        "time_percent": 0.2783962181221134,
        "time_per_call": 0.0006994457500000001
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.0027396820000000002,
        "cumulative_time": 0.020071730000000003,
        "time_percent": 1.997257729841152,
        "time_per_call": 0.001543979230769231
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 125,
        "primitive_calls": 125,
        "total_time": 0.001967098,
        "cumulative_time": 0.019842456,
        "time_percent": 1.9744435893185561,
        "time_per_call": 0.000158739648
      },
      {
        "rank": 24,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.001964421,
        "cumulative_time": 0.001964421,
        "time_percent": 0.19547169212181933,
        "time_per_call": 0.00049110525
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.001882587,
        "cumulative_time": 0.008954388,
        "time_percent": 0.8910154056973091,
        "time_per_call": 0.0008140352727272728
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0017847370000000002,
        "cumulative_time": 0.00454245,
        "time_percent": 0.4520010669193408,
        "time_per_call": 0.0011356125
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0017119580000000002,
        "cumulative_time": 0.0017119580000000002,
        "time_percent": 0.1703501067752206,
        "time_per_call": 0.00042798950000000005
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full_like>",
        "total_calls": 15,
        "primitive_calls": 15,
        "total_time": 0.0016165720000000001,
        "cumulative_time": 0.0016165720000000001,
        "time_percent": 0.1608586266776591,
        "time_per_call": 0.00010777146666666668
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 21208,
        "primitive_calls": 21208,
        "total_time": 0.00143734,
        "cumulative_time": 0.00143734,
        "time_percent": 0.14302396581709106,
        "time_per_call": 6.777348170501697e-08
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 92,
        "primitive_calls": 92,
        "total_time": 0.001417157,
        "cumulative_time": 0.001471489,
        "time_percent": 0.14642199649089674,
        "time_per_call": 1.5994445652173913e-05
      },
      {
        "rank": 31,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 0.0013764860000000001,
        "cumulative_time": 0.002377789,
        "time_percent": 0.23660429171682074,
        "time_per_call": 7.670287096774194e-05
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 125,
        "primitive_calls": 125,
        "total_time": 0.0013387310000000001,
        "cumulative_time": 0.0013387310000000001,
        "time_percent": 0.13321177785512137,
        "time_per_call": 1.0709848000000002e-05
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 125,
        "primitive_calls": 125,
        "total_time": 0.001278779,
        "cumulative_time": 0.001278779,
        "time_percent": 0.12724619365189438,
        "time_per_call": 1.0230232e-05
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 15314,
        "primitive_calls": 15314,
        "total_time": 0.001241216,
        "cumulative_time": 0.001241216,
        "time_percent": 0.12350844946611554,
        "time_per_call": 8.105106438552958e-08
      },
      {
        "rank": 35,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 15,
        "primitive_calls": 15,
        "total_time": 0.0008455820000000001,
        "cumulative_time": 0.000861595,
        "time_percent": 0.08573387912962596,
        "time_per_call": 5.743966666666667e-05
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 32,
        "primitive_calls": 32,
        "total_time": 0.0008241020000000001,
        "cumulative_time": 0.0008241020000000001,
        "time_percent": 0.08200310036442066,
        "time_per_call": 2.5753187500000002e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 0.0006891250000000001,
        "cumulative_time": 0.000841795,
        "time_percent": 0.08376366016739126,
        "time_per_call": 2.7154677419354838e-05
      },
      {
        "rank": 38,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000635344,
        "cumulative_time": 0.00064351,
        "time_percent": 0.06403311133270921,
        "time_per_call": 0.00064351
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.000635198,
        "cumulative_time": 0.0009553500000000001,
        "time_percent": 0.09506306492782358,
        "time_per_call": 3.411964285714286e-05
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 64,
        "primitive_calls": 64,
        "total_time": 0.000615567,
        "cumulative_time": 0.000615567,
        "time_percent": 0.06125261494575347,
        "time_per_call": 9.618234375e-06
      },
      {
        "rank": 41,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 367,
        "function_name": "get_nn_features",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0005858920000000001,
        "cumulative_time": 0.000991129,
        "time_percent": 0.09862329039498494,
        "time_per_call": 0.00024778225
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 30,
        "primitive_calls": 30,
        "total_time": 0.000583876,
        "cumulative_time": 0.000583876,
        "time_percent": 0.058099170040087834,
        "time_per_call": 1.9462533333333332e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 39,
        "primitive_calls": 39,
        "total_time": 0.0005786330000000001,
        "cumulative_time": 0.000630682,
        "time_percent": 0.06275664825960081,
        "time_per_call": 1.6171333333333336e-05
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.ones>",
        "total_calls": 32,
        "primitive_calls": 32,
        "total_time": 0.0005608550000000001,
        "cumulative_time": 0.0005608550000000001,
        "time_percent": 0.055808442225461344,
        "time_per_call": 1.7526718750000002e-05
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 93,
        "primitive_calls": 93,
        "total_time": 0.000547749,
        "cumulative_time": 0.000684055,
        "time_percent": 0.06806758243492161,
        "time_per_call": 7.355430107526882e-06
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.000518622,
        "cumulative_time": 0.000518622,
        "time_percent": 0.05160600498141804,
        "time_per_call": 4.714745454545455e-05
      },
      {
        "rank": 47,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 211,
        "primitive_calls": 211,
        "total_time": 0.0004980960000000001,
        "cumulative_time": 0.000919608,
        "time_percent": 0.09150652118296539,
        "time_per_call": 4.358331753554502e-06
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 5104,
        "primitive_calls": 5104,
        "total_time": 0.000486466,
        "cumulative_time": 0.001406074,
        "time_percent": 0.13991281096490774,
        "time_per_call": 2.7548471786833857e-07
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros>",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 0.00047029300000000005,
        "cumulative_time": 0.00047029300000000005,
        "time_percent": 0.046796979111426114,
        "time_per_call": 1.5170741935483872e-05
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 4875,
        "primitive_calls": 4875,
        "total_time": 0.000450481,
        "cumulative_time": 0.000450481,
        "time_percent": 0.0448255660770931,
        "time_per_call": 9.240635897435898e-08
      }
    ]
  },
  {
    "config": {
      "num_simulations": 25000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 3072,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 25000,
    "wave_size": 3072,
    "total_time_ms": 1080.3154639997956,
    "simulations_per_second": 23141.388634241313,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 31.3986873626709,
        "cpu_time_ms": 29.32930600036343,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 39.920894622802734,
        "cpu_time_ms": 36.6714800002228,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.05836820602417,
        "cpu_time_ms": 4.5909509990451625,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4724479913711548,
        "cpu_time_ms": 1.6032399998948677,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 37.23750305175781,
        "cpu_time_ms": 34.236122999573126,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 44.955360412597656,
        "cpu_time_ms": 41.17021499951079,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.257823944091797,
        "cpu_time_ms": 4.1800620001595234,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5493439435958862,
        "cpu_time_ms": 1.6605930013611214,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 42.4200325012207,
        "cpu_time_ms": 38.985775001492584,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 40.22633743286133,
        "cpu_time_ms": 36.86397700039379,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.6428799629211426,
        "cpu_time_ms": 3.5477650017128326,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4858239889144897,
        "cpu_time_ms": 1.6121809985634172,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 42.186912536621094,
        "cpu_time_ms": 38.80589499931375,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 47.956607818603516,
        "cpu_time_ms": 43.87582500021381,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.6185920238494873,
        "cpu_time_ms": 3.5313509997649817,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 2.703360080718994,
        "cpu_time_ms": 2.771112000118592,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 48.59404754638672,
        "cpu_time_ms": 44.64561299937486,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 58.16972732543945,
        "cpu_time_ms": 53.18644199905975,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.8951680660247803,
        "cpu_time_ms": 3.8340400005836273,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.7655359506607056,
        "cpu_time_ms": 1.8588189996080473,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 49.884544372558594,
        "cpu_time_ms": 46.67053999946802,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 56.32992172241211,
        "cpu_time_ms": 51.52558599911572,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.144991874694824,
        "cpu_time_ms": 4.184419998637168,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6412479877471924,
        "cpu_time_ms": 1.7536729992571054,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 58.44025421142578,
        "cpu_time_ms": 53.54022299979988,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 190.0830078125,
        "cpu_time_ms": 173.1805079998594,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 5.10700798034668,
        "cpu_time_ms": 4.910008001388633,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.7643519639968872,
        "cpu_time_ms": 1.8853399997169618,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 44.83625411987305,
        "cpu_time_ms": 41.316462000395404,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 90.73609924316406,
        "cpu_time_ms": 82.79194200076745,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.6912641525268555,
        "cpu_time_ms": 4.596884999045869,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5523840188980103,
        "cpu_time_ms": 1.8297000005986774,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 56.82649612426758,
        "cpu_time_ms": 56.10550900019007,
        "memory_allocated_mb": 0.0830078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "expansion",
        "gpu_time_ms": 113.71123504638672,
        "cpu_time_ms": 103.70004200012772,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.9707839488983154,
        "cpu_time_ms": 4.4604699996853014,
        "memory_allocated_mb": 0.001953125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.544160008430481,
        "cpu_time_ms": 1.6403329991589999,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      }
    ],
    "peak_gpu_memory_mb": 720.88232421875,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 274.1,
    "avg_ram_usage_mb": 1258.36328125,
    "final_tree_nodes": 2601,
    "final_tree_edges": 2600,
    "tree_memory_mb": 12.203712463378906,
    "efficiency_score": 32871.91427136778,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth"
    ],
    "cprofile_stats": "         215134 function calls (159352 primitive calls) in 1.078 seconds\n\n   Ordered by: cumulative time\n   List reduced from 214 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    1.078    1.078 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    1.078    1.078 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n        9    0.000    0.000    1.076    0.120 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n       36    0.001    0.000    1.040    0.029 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n        9    0.000    0.000    0.524    0.058 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n        9    0.000    0.000    0.388    0.043 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n        9    0.041    0.005    0.305    0.034 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n       91    0.149    0.002    0.264    0.003 {built-in method time.sleep}\n        9    0.068    0.008    0.260    0.029 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n        9    0.000    0.000    0.183    0.020 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n       48    0.030    0.001    0.154    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n      184    0.017    0.000    0.130    0.001 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n      285    0.126    0.000    0.126    0.000 {built-in method torch.where}\n       30    0.049    0.002    0.110    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n       48    0.058    0.001    0.097    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n       92    0.016    0.000    0.089    0.001 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n       48    0.011    0.000    0.072    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n       30    0.000    0.000    0.064    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n      164    0.064    0.000    0.064    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n       92    0.012    0.000    0.062    0.001 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n      348    0.006    0.000    0.060    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       48    0.058    0.001    0.058    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n       39    0.050    0.001    0.052    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n56028/348    0.035    0.000    0.045    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       48    0.042    0.001    0.042    0.001 {built-in method torch.repeat_interleave}\n       48    0.035    0.001    0.035    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n       30    0.000    0.000    0.035    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n      162    0.033    0.000    0.033    0.000 {built-in method torch.tensor}\n      164    0.001    0.000    0.032    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        9    0.020    0.002    0.032    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n      184    0.001    0.000    0.030    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n       30    0.005    0.000    0.026    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n        9    0.013    0.001    0.024    0.003 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n        9    0.000    0.000    0.020    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n  276/184    0.001    0.000    0.014    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n       48    0.010    0.000    0.014    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n      109    0.000    0.000    0.012    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        9    0.005    0.001    0.011    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n       74    0.000    0.000    0.010    0.000 {built-in method builtins.next}\n       74    0.000    0.000    0.010    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n      109    0.009    0.000    0.010    0.000 {built-in method torch._C._cuda_synchronize}\n        9    0.009    0.001    0.009    0.001 {built-in method torch.bincount}\n       92    0.000    0.000    0.009    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n       37    0.000    0.000    0.009    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       92    0.005    0.000    0.009    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n       37    0.000    0.000    0.008    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n       92    0.001    0.000    0.008    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n       92    0.002    0.000    0.007    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1113(memory_info)\n       92    0.000    0.000    0.007    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:812(bcat)\n      276    0.000    0.000    0.007    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:765(open_binary)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 91,
        "primitive_calls": 91,
        "total_time": 0.148908752,
        "cumulative_time": 0.26443340400000004,
        "time_percent": 3.29859652737928,
        "time_per_call": 0.002905861582417583
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 285,
        "primitive_calls": 285,
        "total_time": 0.125966468,
        "cumulative_time": 0.12597381400000002,
        "time_percent": 1.5714231981112468,
        "time_per_call": 0.00044201338245614043
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.06845340600000001,
        "cumulative_time": 0.259876017,
        "time_percent": 3.2417467470386554,
        "time_per_call": 0.028875113
      },
      {
        "rank": 4,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 164,
        "primitive_calls": 164,
        "total_time": 0.063775856,
        "cumulative_time": 0.06381629400000001,
        "time_percent": 0.7960575426341189,
        "time_per_call": 0.00038912374390243906
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 48,
        "primitive_calls": 48,
        "total_time": 0.058340703,
        "cumulative_time": 0.058340703,
        "time_percent": 0.727753897237075,
        "time_per_call": 0.0012154313125
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 48,
        "primitive_calls": 48,
        "total_time": 0.0580726,
        "cumulative_time": 0.09747478700000001,
        "time_percent": 1.2159204890212545,
        "time_per_call": 0.002030724729166667
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 39,
        "primitive_calls": 39,
        "total_time": 0.050279742,
        "cumulative_time": 0.052482933,
        "time_percent": 0.6546828725938096,
        "time_per_call": 0.0013457162307692308
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 30,
        "primitive_calls": 30,
        "total_time": 0.049461634000000004,
        "cumulative_time": 0.10964757300000001,
        "time_percent": 1.367766318711255,
        "time_per_call": 0.0036549191000000004
      },
      {
        "rank": 9,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 48,
        "primitive_calls": 48,
        "total_time": 0.041534190000000006,
        "cumulative_time": 0.041534190000000006,
        "time_percent": 0.5181060063860586,
        "time_per_call": 0.0008652956250000001
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.041111894,
        "cumulative_time": 0.30530782100000003,
        "time_percent": 3.8084723900174686,
        "time_per_call": 0.03392309122222223
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 48,
        "primitive_calls": 48,
        "total_time": 0.035481229,
        "cumulative_time": 0.035481229,
        "time_percent": 0.4426001291673007,
        "time_per_call": 0.0007391922708333334
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 348,
        "primitive_calls": 56028,
        "total_time": 0.035382862,
        "cumulative_time": 0.044903126,
        "time_percent": 0.5601308051537779,
        "time_per_call": 0.00012903197126436783
      },
      {
        "rank": 13,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 162,
        "primitive_calls": 162,
        "total_time": 0.032876094,
        "cumulative_time": 0.032876094,
        "time_percent": 0.41010314075976106,
        "time_per_call": 0.00020293885185185186
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 48,
        "primitive_calls": 48,
        "total_time": 0.030000963000000002,
        "cumulative_time": 0.15427807400000002,
        "time_percent": 1.9244963436887252,
        "time_per_call": 0.003214126541666667
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0197522,
        "cumulative_time": 0.031875347000000005,
        "time_percent": 0.39761961738846563,
        "time_per_call": 0.003541705222222223
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 184,
        "primitive_calls": 184,
        "total_time": 0.016585899,
        "cumulative_time": 0.12974201500000002,
        "time_percent": 1.6184285103942104,
        "time_per_call": 0.0007051196467391305
      },
      {
        "rank": 17,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 92,
        "primitive_calls": 92,
        "total_time": 0.016130773,
        "cumulative_time": 0.088646454,
        "time_percent": 1.1057940521345293,
        "time_per_call": 0.0009635484130434783
      },
      {
        "rank": 18,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.012938703000000001,
        "cumulative_time": 0.023718112000000003,
        "time_percent": 0.29586459462282166,
        "time_per_call": 0.0026353457777777783
      },
      {
        "rank": 19,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 92,
        "primitive_calls": 92,
        "total_time": 0.011998116000000001,
        "cumulative_time": 0.061955242,
        "time_percent": 0.7728423982098075,
        "time_per_call": 0.0006734265434782608
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 48,
        "primitive_calls": 48,
        "total_time": 0.010664753,
        "cumulative_time": 0.07195050600000001,
        "time_percent": 0.8975253717748233,
        "time_per_call": 0.0014989688750000002
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 48,
        "primitive_calls": 48,
        "total_time": 0.009792682,
        "cumulative_time": 0.013796905000000002,
        "time_percent": 0.17210542326786304,
        "time_per_call": 0.0002874355208333334
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 109,
        "primitive_calls": 109,
        "total_time": 0.009466939,
        "cumulative_time": 0.009500706000000001,
        "time_percent": 0.11851375561935998,
        "time_per_call": 8.716244036697249e-05
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.009316843,
        "cumulative_time": 0.009316843,
        "time_percent": 0.11622021083969387,
        "time_per_call": 0.0010352047777777778
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 348,
        "primitive_calls": 348,
        "total_time": 0.005904721000000001,
        "cumulative_time": 0.060494873000000005,
        "time_percent": 0.7546254557236292,
        "time_per_call": 0.000173835841954023
      },
      {
        "rank": 25,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 276,
        "primitive_calls": 276,
        "total_time": 0.005604866,
        "cumulative_time": 0.006067823,
        "time_percent": 0.07569126885554944,
        "time_per_call": 2.1984865942028984e-05
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 30,
        "primitive_calls": 30,
        "total_time": 0.0052553980000000005,
        "cumulative_time": 0.026026325000000003,
        "time_percent": 0.3246577170917655,
        "time_per_call": 0.0008675441666666667
      },
      {
        "rank": 27,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 92,
        "primitive_calls": 92,
        "total_time": 0.005190785000000001,
        "cumulative_time": 0.008725822000000001,
        "time_percent": 0.10884769364361291,
        "time_per_call": 9.484589130434784e-05
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.00482463,
        "cumulative_time": 0.00482463,
        "time_percent": 0.06018342434486792,
        "time_per_call": 0.00053607
      },
      {
        "rank": 29,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0045739430000000005,
        "cumulative_time": 0.011417213,
        "time_percent": 0.1424206570897131,
        "time_per_call": 0.0012685792222222223
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 348,
        "primitive_calls": 348,
        "total_time": 0.004232696,
        "cumulative_time": 0.004232696,
        "time_percent": 0.052799518199494064,
        "time_per_call": 1.2162919540229886e-05
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.004231998,
        "cumulative_time": 0.004231998,
        "time_percent": 0.05279081120430631,
        "time_per_call": 0.00047022199999999996
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 58529,
        "primitive_calls": 58529,
        "total_time": 0.004123837,
        "cumulative_time": 0.004123837,
        "time_percent": 0.05144158870215272,
        "time_per_call": 7.045801226742299e-08
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 348,
        "primitive_calls": 348,
        "total_time": 0.0039046040000000003,
        "cumulative_time": 0.0039046040000000003,
        "time_percent": 0.04870683128668285,
        "time_per_call": 1.122012643678161e-05
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 42621,
        "primitive_calls": 42621,
        "total_time": 0.003580372,
        "cumulative_time": 0.003580372,
        "time_percent": 0.04466229480571224,
        "time_per_call": 8.400488022336408e-08
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 96,
        "primitive_calls": 96,
        "total_time": 0.00261017,
        "cumulative_time": 0.00261017,
        "time_percent": 0.032559796030419724,
        "time_per_call": 2.7189270833333337e-05
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 144,
        "primitive_calls": 144,
        "total_time": 0.002378185,
        "cumulative_time": 0.002446109,
        "time_percent": 0.03051326546093701,
        "time_per_call": 1.6986868055555557e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 78,
        "primitive_calls": 78,
        "total_time": 0.0023731150000000003,
        "cumulative_time": 0.0023731150000000003,
        "time_percent": 0.029602723330943773,
        "time_per_call": 3.0424551282051285e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 92,
        "primitive_calls": 92,
        "total_time": 0.00230219,
        "cumulative_time": 0.00230219,
        "time_percent": 0.0287179903313853,
        "time_per_call": 2.5023804347826087e-05
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 92,
        "primitive_calls": 92,
        "total_time": 0.002179428,
        "cumulative_time": 0.002613413,
        "time_percent": 0.032600249877688926,
        "time_per_call": 2.8406663043478265e-05
      },
      {
        "rank": 40,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 39,
        "primitive_calls": 39,
        "total_time": 0.002167698,
        "cumulative_time": 0.002167698,
        "time_percent": 0.027040309533688904,
        "time_per_call": 5.5582e-05
      },
      {
        "rank": 41,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 76,
        "primitive_calls": 76,
        "total_time": 0.001922913,
        "cumulative_time": 0.0030287450000000002,
        "time_percent": 0.03778118644691862,
        "time_per_call": 3.985190789473684e-05
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full_like>",
        "total_calls": 39,
        "primitive_calls": 39,
        "total_time": 0.001824089,
        "cumulative_time": 0.001824089,
        "time_percent": 0.022754060379719436,
        "time_per_call": 4.6771512820512824e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 96,
        "primitive_calls": 96,
        "total_time": 0.0017965070000000001,
        "cumulative_time": 0.0017965070000000001,
        "time_percent": 0.022409996853546412,
        "time_per_call": 1.8713614583333334e-05
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 165,
        "primitive_calls": 165,
        "total_time": 0.0017782980000000002,
        "cumulative_time": 0.0017782980000000002,
        "time_percent": 0.022182854052151136,
        "time_per_call": 1.0777563636363638e-05
      },
      {
        "rank": 45,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1113,
        "function_name": "memory_info",
        "total_calls": 92,
        "primitive_calls": 92,
        "total_time": 0.0017260250000000002,
        "cumulative_time": 0.006995874,
        "time_percent": 0.08726796740998345,
        "time_per_call": 7.604210869565217e-05
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.cumsum>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0016323680000000001,
        "cumulative_time": 0.0016323680000000001,
        "time_percent": 0.020362493296062777,
        "time_per_call": 0.00018137422222222225
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 276,
        "primitive_calls": 276,
        "total_time": 0.0015727940000000002,
        "cumulative_time": 0.0017549750000000002,
        "time_percent": 0.021891918165669613,
        "time_per_call": 6.3586050724637685e-06
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 30,
        "primitive_calls": 30,
        "total_time": 0.0015263100000000001,
        "cumulative_time": 0.0015263100000000001,
        "time_percent": 0.01903950404731873,
        "time_per_call": 5.0877e-05
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.topk>",
        "total_calls": 48,
        "primitive_calls": 48,
        "total_time": 0.001445611,
        "cumulative_time": 0.001445611,
        "time_percent": 0.018032848166721356,
        "time_per_call": 3.0116895833333334e-05
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 14262,
        "primitive_calls": 14262,
        "total_time": 0.001407044,
        "cumulative_time": 0.004036592,
        "time_percent": 0.05035327667470854,
        "time_per_call": 2.830312719113729e-07
      }
    ]
  },
  {
    "config": {
      "num_simulations": 50000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 3072,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 50000,
    "wave_size": 3072,
    "total_time_ms": 2548.108700000739,
    "simulations_per_second": 19622.396799628485,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 30.62393569946289,
        "cpu_time_ms": 28.43861900146294,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 34.446144104003906,
        "cpu_time_ms": 31.59821900044335,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.79088020324707,
        "cpu_time_ms": 4.631972000424867,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.415168046951294,
        "cpu_time_ms": 1.549997001347947,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 36.19535827636719,
        "cpu_time_ms": 33.28379900085565,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 39.57382583618164,
        "cpu_time_ms": 36.25952299989876,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.386591911315918,
        "cpu_time_ms": 4.217887999402592,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.3856639862060547,
        "cpu_time_ms": 1.4984859990363475,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 35.35939025878906,
        "cpu_time_ms": 32.51592499873368,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 37.01417541503906,
        "cpu_time_ms": 33.920968999154866,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.548959970474243,
        "cpu_time_ms": 3.949464999095653,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5391680002212524,
        "cpu_time_ms": 1.6571569994994206,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 38.353248596191406,
        "cpu_time_ms": 35.28609099885216,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 51.0230712890625,
        "cpu_time_ms": 46.684795001056045,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.9893438816070557,
        "cpu_time_ms": 3.9503540010628058,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4629759788513184,
        "cpu_time_ms": 1.6134289999172324,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 49.53071975708008,
        "cpu_time_ms": 45.40980199999467,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 66.05337524414062,
        "cpu_time_ms": 60.432734000642085,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.951616048812866,
        "cpu_time_ms": 3.8688910008204402,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5615999698638916,
        "cpu_time_ms": 1.704504998997436,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 49.049537658691406,
        "cpu_time_ms": 45.04838999855565,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 118.16108703613281,
        "cpu_time_ms": 107.75333700075862,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.87340784072876,
        "cpu_time_ms": 5.11825000103272,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.827839970588684,
        "cpu_time_ms": 1.9661070000438485,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 53.959232330322266,
        "cpu_time_ms": 49.51429900029325,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 111.96412658691406,
        "cpu_time_ms": 102.09087499970337,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 5.26694393157959,
        "cpu_time_ms": 5.073390999314142,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.84934401512146,
        "cpu_time_ms": 1.98477300000377,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 43.7611198425293,
        "cpu_time_ms": 40.281066998431925,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 91.67430114746094,
        "cpu_time_ms": 83.6449670005095,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.763743877410889,
        "cpu_time_ms": 4.565854000247782,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6261119842529297,
        "cpu_time_ms": 1.731517000735039,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 46.02339172363281,
        "cpu_time_ms": 42.303348000132246,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 103.89933013916016,
        "cpu_time_ms": 94.74819999923056,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.7082879543304443,
        "cpu_time_ms": 3.594665000491659,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5534080266952515,
        "cpu_time_ms": 1.6448539990960853,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 60.31577682495117,
        "cpu_time_ms": 55.24273099945276,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 135.30125427246094,
        "cpu_time_ms": 123.34917599946493,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.4994239807128906,
        "cpu_time_ms": 3.45754800036957,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4039039611816406,
        "cpu_time_ms": 1.5410470005008392,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 46.35007858276367,
        "cpu_time_ms": 42.57241799859912,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 112.1530532836914,
        "cpu_time_ms": 102.2570020013518,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.7088000774383545,
        "cpu_time_ms": 3.815956999460468,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6179200410842896,
        "cpu_time_ms": 1.7371850008203182,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 58.493377685546875,
        "cpu_time_ms": 53.63219999890134,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 178.58457946777344,
        "cpu_time_ms": 162.74940699986473,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.24073600769043,
        "cpu_time_ms": 4.128251999645727,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6774719953536987,
        "cpu_time_ms": 1.7971999986912124,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 54.08544158935547,
        "cpu_time_ms": 49.592232000577496,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 148.112548828125,
        "cpu_time_ms": 134.99846499871637,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.187744140625,
        "cpu_time_ms": 4.059597000377835,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5411200523376465,
        "cpu_time_ms": 1.6267720002360875,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 62.671104431152344,
        "cpu_time_ms": 57.37245000091207,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 112.56243133544922,
        "cpu_time_ms": 102.65523599991866,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.7857279777526855,
        "cpu_time_ms": 3.694078999615158,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.46943998336792,
        "cpu_time_ms": 1.6043790001276648,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 64.0315170288086,
        "cpu_time_ms": 58.627294998586876,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 109.9354248046875,
        "cpu_time_ms": 100.27548199832381,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.016128063201904,
        "cpu_time_ms": 3.9339450013358146,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 2.564095973968506,
        "cpu_time_ms": 2.634688000398455,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 60.70832061767578,
        "cpu_time_ms": 55.62294199989992,
        "memory_allocated_mb": 0.59765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 130.461669921875,
        "cpu_time_ms": 118.91781600024842,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.8765439987182617,
        "cpu_time_ms": 3.7867669998377096,
        "memory_allocated_mb": 0.01171875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5208959579467773,
        "cpu_time_ms": 1.6356030009774258,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 131.7296600341797,
        "cpu_time_ms": 120.21559499953582,
        "memory_allocated_mb": 0.16552734375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "expansion",
        "gpu_time_ms": 140.05308532714844,
        "cpu_time_ms": 127.71369300025981,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 5.275712013244629,
        "cpu_time_ms": 5.100798000057694,
        "memory_allocated_mb": 0.00341796875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.9333120584487915,
        "cpu_time_ms": 2.0523329985735472,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      }
    ],
    "peak_gpu_memory_mb": 720.88232421875,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 188.5,
    "avg_ram_usage_mb": 1259.67578125,
    "final_tree_nodes": 6851,
    "final_tree_edges": 6850,
    "tree_memory_mb": 12.203712463378906,
    "efficiency_score": 27873.251497178193,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth"
    ],
    "cprofile_stats": "         503378 function calls (371932 primitive calls) in 2.546 seconds\n\n   Ordered by: cumulative time\n   List reduced from 214 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    2.546    2.546 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    2.546    2.546 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n       17    0.000    0.000    2.543    0.150 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n       68    0.004    0.000    2.251    0.033 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n       17    0.000    0.000    1.576    0.093 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n      227    0.391    0.002    1.084    0.005 {built-in method time.sleep}\n       17    0.000    0.000    0.851    0.050 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n       17    0.054    0.003    0.524    0.031 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n      133    0.078    0.001    0.482    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n       17    0.114    0.007    0.482    0.028 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n      228    0.024    0.000    0.389    0.002 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n      228    0.037    0.000    0.340    0.001 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n      133    0.182    0.001    0.300    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n      685    0.295    0.000    0.295    0.000 {built-in method torch.where}\n      133    0.030    0.000    0.272    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n       67    0.123    0.002    0.267    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n      435    0.173    0.000    0.173    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n      133    0.168    0.001    0.168    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n      456    0.007    0.000    0.158    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n      820    0.014    0.000    0.140    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n      133    0.125    0.001    0.125    0.001 {built-in method torch.repeat_interleave}\n       84    0.110    0.001    0.114    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n       67    0.001    0.000    0.110    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n132020/820    0.082    0.000    0.105    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n      133    0.089    0.001    0.090    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n      433    0.088    0.000    0.088    0.000 {built-in method torch.tensor}\n  684/456    0.006    0.000    0.087    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n       17    0.000    0.000    0.078    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n      456    0.001    0.000    0.076    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n      364    0.002    0.000    0.068    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       67    0.000    0.000    0.053    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n       67    0.011    0.000    0.053    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n       17    0.028    0.002    0.053    0.003 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n       17    0.029    0.002    0.047    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n      133    0.027    0.000    0.038    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n       17    0.000    0.000    0.037    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n      228    0.013    0.000    0.024    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n      205    0.001    0.000    0.023    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n      228    0.001    0.000    0.022    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n       17    0.009    0.001    0.022    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n      228    0.001    0.000    0.019    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n      205    0.018    0.000    0.018    0.000 {built-in method torch._C._cuda_synchronize}\n      138    0.000    0.000    0.018    0.000 {built-in method builtins.next}\n      138    0.000    0.000    0.018    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n      228    0.000    0.000    0.017    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:812(bcat)\n       17    0.017    0.001    0.017    0.001 {built-in method torch.bincount}\n       69    0.000    0.000    0.016    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n      228    0.001    0.000    0.016    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:795(cat)\n       69    0.000    0.000    0.016    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n      684    0.001    0.000    0.015    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:765(open_binary)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 227,
        "primitive_calls": 227,
        "total_time": 0.39088364200000003,
        "cumulative_time": 1.084457346,
        "time_percent": 5.642326754705373,
        "time_per_call": 0.004777345136563876
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 685,
        "primitive_calls": 685,
        "total_time": 0.294653843,
        "cumulative_time": 0.294692459,
        "time_percent": 1.5332563811372035,
        "time_per_call": 0.0004302079693430657
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 133,
        "primitive_calls": 133,
        "total_time": 0.181727502,
        "cumulative_time": 0.300155963,
        "time_percent": 1.5616824643827496,
        "time_per_call": 0.0022568117518796996
      },
      {
        "rank": 4,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 435,
        "primitive_calls": 435,
        "total_time": 0.17274625700000001,
        "cumulative_time": 0.172783232,
        "time_percent": 0.8989744560023163,
        "time_per_call": 0.0003972028321839081
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 133,
        "primitive_calls": 133,
        "total_time": 0.167530596,
        "cumulative_time": 0.167530596,
        "time_percent": 0.8716454985796528,
        "time_per_call": 0.0012596285413533834
      },
      {
        "rank": 6,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 133,
        "primitive_calls": 133,
        "total_time": 0.125426967,
        "cumulative_time": 0.125426967,
        "time_percent": 0.6525843863532167,
        "time_per_call": 0.0009430599022556391
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 67,
        "primitive_calls": 67,
        "total_time": 0.122644742,
        "cumulative_time": 0.266502413,
        "time_percent": 1.386586296464113,
        "time_per_call": 0.003977647955223881
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.114432164,
        "cumulative_time": 0.48176754800000005,
        "time_percent": 2.506589987753382,
        "time_per_call": 0.028339267529411766
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 84,
        "primitive_calls": 84,
        "total_time": 0.110326014,
        "cumulative_time": 0.11424949300000001,
        "time_percent": 0.5944290694725252,
        "time_per_call": 0.001360113011904762
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 133,
        "primitive_calls": 133,
        "total_time": 0.08946658,
        "cumulative_time": 0.089779386,
        "time_percent": 0.4671134678715349,
        "time_per_call": 0.000675032977443609
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 433,
        "primitive_calls": 433,
        "total_time": 0.08812534400000001,
        "cumulative_time": 0.088156331,
        "time_percent": 0.4586688695803834,
        "time_per_call": 0.00020359429792147807
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 820,
        "primitive_calls": 132020,
        "total_time": 0.08226773100000001,
        "cumulative_time": 0.104602924,
        "time_percent": 0.5442389033395997,
        "time_per_call": 0.00012756454146341465
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 133,
        "primitive_calls": 133,
        "total_time": 0.078132503,
        "cumulative_time": 0.481932656,
        "time_percent": 2.507449028719126,
        "time_per_call": 0.003623553804511278
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.054370041,
        "cumulative_time": 0.5235021980000001,
        "time_percent": 2.723731337905908,
        "time_per_call": 0.030794246941176474
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 228,
        "primitive_calls": 228,
        "total_time": 0.037215334,
        "cumulative_time": 0.339808074,
        "time_percent": 1.7679885654028327,
        "time_per_call": 0.0014903862894736842
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 133,
        "primitive_calls": 133,
        "total_time": 0.030075009000000003,
        "cumulative_time": 0.272323652,
        "time_percent": 1.4168736403383408,
        "time_per_call": 0.002047546255639098
      },
      {
        "rank": 17,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.028590752,
        "cumulative_time": 0.046892205000000006,
        "time_percent": 0.24397561032209478,
        "time_per_call": 0.0027583650000000005
      },
      {
        "rank": 18,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.028328594000000002,
        "cumulative_time": 0.052893396,
        "time_percent": 0.2751992270593427,
        "time_per_call": 0.003111376235294118
      },
      {
        "rank": 19,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 133,
        "primitive_calls": 133,
        "total_time": 0.027060259000000003,
        "cumulative_time": 0.037528266000000005,
        "time_percent": 0.19525594076200764,
        "time_per_call": 0.0002821674135338346
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 228,
        "primitive_calls": 228,
        "total_time": 0.023645875,
        "cumulative_time": 0.389042714,
        "time_percent": 2.0241516386255274,
        "time_per_call": 0.0017063276929824562
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 205,
        "primitive_calls": 205,
        "total_time": 0.018222213,
        "cumulative_time": 0.018222213,
        "time_percent": 0.0948084129994358,
        "time_per_call": 8.888884390243903e-05
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.016547358,
        "cumulative_time": 0.016547358,
        "time_percent": 0.08609430431493245,
        "time_per_call": 0.000973374
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 820,
        "primitive_calls": 820,
        "total_time": 0.013823021000000001,
        "cumulative_time": 0.140458271,
        "time_percent": 0.7307908082379828,
        "time_per_call": 0.00017129057439024389
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 228,
        "primitive_calls": 228,
        "total_time": 0.013280391,
        "cumulative_time": 0.024169959,
        "time_percent": 0.12575396056732685,
        "time_per_call": 0.00010600859210526317
      },
      {
        "rank": 25,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 684,
        "primitive_calls": 684,
        "total_time": 0.012879309,
        "cumulative_time": 0.014480828000000001,
        "time_percent": 0.07534234846216507,
        "time_per_call": 2.1170801169590646e-05
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 67,
        "primitive_calls": 67,
        "total_time": 0.010826704000000001,
        "cumulative_time": 0.05314951800000001,
        "time_percent": 0.2765318050702705,
        "time_per_call": 0.0007932763880597015
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 136950,
        "primitive_calls": 136950,
        "total_time": 0.009647870000000001,
        "cumulative_time": 0.009647870000000001,
        "time_percent": 0.05019693511017937,
        "time_per_call": 7.044811975173421e-08
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 820,
        "primitive_calls": 820,
        "total_time": 0.009494132,
        "cumulative_time": 0.009494132,
        "time_percent": 0.049397051155485865,
        "time_per_call": 1.1578209756097562e-05
      },
      {
        "rank": 29,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.009318749000000001,
        "cumulative_time": 0.022316344000000002,
        "time_percent": 0.11610978088059236,
        "time_per_call": 0.001312726117647059
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 820,
        "primitive_calls": 820,
        "total_time": 0.009233051,
        "cumulative_time": 0.009233051,
        "time_percent": 0.048038671946862545,
        "time_per_call": 1.1259818292682927e-05
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 100405,
        "primitive_calls": 100405,
        "total_time": 0.008283074000000001,
        "cumulative_time": 0.008283074000000001,
        "time_percent": 0.04309603343440717,
        "time_per_call": 8.249662865395151e-08
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.008134984000000001,
        "cumulative_time": 0.008134984000000001,
        "time_percent": 0.04232553547781504,
        "time_per_call": 0.00047852847058823535
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.007053286000000001,
        "cumulative_time": 0.007053286000000001,
        "time_percent": 0.03669756533364739,
        "time_per_call": 0.0004148991764705883
      },
      {
        "rank": 34,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 456,
        "primitive_calls": 456,
        "total_time": 0.006793615,
        "cumulative_time": 0.15773778100000002,
        "time_percent": 0.8206944286439063,
        "time_per_call": 0.0003459161864035088
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 399,
        "primitive_calls": 399,
        "total_time": 0.006164060000000001,
        "cumulative_time": 0.006164060000000001,
        "time_percent": 0.0320710084023989,
        "time_per_call": 1.5448771929824564e-05
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 228,
        "primitive_calls": 228,
        "total_time": 0.006004916000000001,
        "cumulative_time": 0.007224508,
        "time_percent": 0.03758841685045214,
        "time_per_call": 3.1686438596491226e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 234,
        "primitive_calls": 234,
        "total_time": 0.0057579020000000005,
        "cumulative_time": 0.0057579020000000005,
        "time_percent": 0.029957807584966627,
        "time_per_call": 2.4606418803418805e-05
      },
      {
        "rank": 38,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 1642,
        "function_name": "wrapper",
        "total_calls": 456,
        "primitive_calls": 684,
        "total_time": 0.005734805,
        "cumulative_time": 0.086544965,
        "time_percent": 0.4502850880264498,
        "time_per_call": 0.0001897915899122807
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 228,
        "primitive_calls": 228,
        "total_time": 0.005220654,
        "cumulative_time": 0.005220654,
        "time_percent": 0.02716255816783376,
        "time_per_call": 2.2897605263157893e-05
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 266,
        "primitive_calls": 266,
        "total_time": 0.004470202,
        "cumulative_time": 0.004506849,
        "time_percent": 0.023448699744542244,
        "time_per_call": 1.694304135338346e-05
      },
      {
        "rank": 41,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 84,
        "primitive_calls": 84,
        "total_time": 0.004311213,
        "cumulative_time": 0.004311213,
        "time_percent": 0.02243082454543456,
        "time_per_call": 5.132396428571429e-05
      },
      {
        "rank": 42,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 169,
        "primitive_calls": 169,
        "total_time": 0.004116696,
        "cumulative_time": 0.0076476240000000004,
        "time_percent": 0.03978984850283538,
        "time_per_call": 4.525221301775148e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 684,
        "primitive_calls": 684,
        "total_time": 0.003835081,
        "cumulative_time": 0.00472163,
        "time_percent": 0.024566184528219823,
        "time_per_call": 6.90296783625731e-06
      },
      {
        "rank": 44,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 390,
        "function_name": "_profile_phase",
        "total_calls": 68,
        "primitive_calls": 68,
        "total_time": 0.0037674870000000004,
        "cumulative_time": 2.251074618,
        "time_percent": 11.712123663349299,
        "time_per_call": 0.0331040385
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 353,
        "primitive_calls": 353,
        "total_time": 0.0034758690000000004,
        "cumulative_time": 0.0035053980000000003,
        "time_percent": 0.018238246985226015,
        "time_per_call": 9.9303059490085e-06
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 33670,
        "primitive_calls": 33670,
        "total_time": 0.003363511,
        "cumulative_time": 0.00966357,
        "time_percent": 0.05027862069272035,
        "time_per_call": 2.87008316008316e-07
      },
      {
        "rank": 47,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 1539,
        "primitive_calls": 1539,
        "total_time": 0.0032876760000000002,
        "cumulative_time": 0.006300059,
        "time_percent": 0.03277859805462775,
        "time_per_call": 4.093605588044185e-06
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.ones>",
        "total_calls": 234,
        "primitive_calls": 234,
        "total_time": 0.003059234,
        "cumulative_time": 0.00311728,
        "time_percent": 0.016218906544165697,
        "time_per_call": 1.3321709401709402e-05
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 31980,
        "primitive_calls": 31980,
        "total_time": 0.003017858,
        "cumulative_time": 0.003017858,
        "time_percent": 0.015701623487643975,
        "time_per_call": 9.436704190118824e-08
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'numpy' of 'torch._C.TensorBase' objects>",
        "total_calls": 435,
        "primitive_calls": 435,
        "total_time": 0.0030048180000000002,
        "cumulative_time": 0.0030048180000000002,
        "time_percent": 0.01563377762800483,
        "time_per_call": 6.907627586206897e-06
      }
    ]
  },
  {
    "config": {
      "num_simulations": 1000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 3648,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 1000,
    "wave_size": 3648,
    "total_time_ms": 71.41734200013161,
    "simulations_per_second": 14002.201314047184,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 29.738943099975586,
        "cpu_time_ms": 27.636237999104196,
        "memory_allocated_mb": 0.19482421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "expansion",
        "gpu_time_ms": 35.40719985961914,
        "cpu_time_ms": 32.462134999150294,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.674880027770996,
        "cpu_time_ms": 4.507532999923569,
        "memory_allocated_mb": 0.00390625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.8045120239257812,
        "cpu_time_ms": 1.9226610002078814,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      }
    ],
    "peak_gpu_memory_mb": 750.38916015625,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 181.3,
    "avg_ram_usage_mb": 1262.30078125,
    "final_tree_nodes": 351,
    "final_tree_edges": 350,
    "tree_memory_mb": 13.794532775878906,
    "efficiency_score": 19107.75755689052,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "cprofile_stats": "         16555 function calls (12387 primitive calls) in 0.070 seconds\n\n   Ordered by: cumulative time\n   List reduced from 214 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    0.070    0.070 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    0.070    0.070 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n        1    0.000    0.000    0.068    0.068 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n        4    0.003    0.001    0.068    0.017 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n        1    0.000    0.000    0.033    0.033 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n        1    0.000    0.000    0.028    0.028 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n        1    0.003    0.003    0.028    0.028 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n        1    0.005    0.005    0.022    0.022 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n        3    0.001    0.000    0.009    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n        2    0.004    0.002    0.008    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n        5    0.005    0.001    0.008    0.002 {built-in method time.sleep}\n       19    0.008    0.000    0.008    0.000 {built-in method torch.where}\n        3    0.004    0.001    0.007    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n       13    0.005    0.000    0.005    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n        1    0.000    0.000    0.005    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n       26    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        3    0.004    0.001    0.004    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n        2    0.000    0.000    0.004    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n        1    0.003    0.003    0.004    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n  4186/26    0.002    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        3    0.000    0.000    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n        6    0.001    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n       14    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        3    0.002    0.001    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n        2    0.000    0.000    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n       11    0.002    0.000    0.002    0.000 {built-in method torch.tensor}\n        3    0.002    0.001    0.002    0.001 {built-in method torch.repeat_interleave}\n       12    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        3    0.002    0.001    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n       13    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n       13    0.001    0.000    0.001    0.000 {built-in method torch._C._cuda_synchronize}\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:489(_extract_policy)\n       10    0.000    0.000    0.001    0.000 {built-in method builtins.next}\n       10    0.000    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n        5    0.000    0.000    0.001    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n        5    0.000    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n        1    0.001    0.001    0.001    0.001 {built-in method torch.bincount}\n        2    0.000    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n        3    0.001    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n      2/1    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n        1    0.001    0.001    0.001    0.001 {built-in method torch._unique2}\n        6    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n       26    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n    18/12    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.007911019,
        "cumulative_time": 0.007911019,
        "time_percent": 1.552064175751362,
        "time_per_call": 0.0004163694210526316
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.005459582,
        "cumulative_time": 0.008375218,
        "time_percent": 1.6431354572537331,
        "time_per_call": 0.0016750436
      },
      {
        "rank": 3,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.005354992,
        "cumulative_time": 0.005354992,
        "time_percent": 1.0505967998098777,
        "time_per_call": 0.00041192246153846153
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.004544357000000001,
        "cumulative_time": 0.022239642,
        "time_percent": 4.363199182018824,
        "time_per_call": 0.022239642
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.004077522,
        "cumulative_time": 0.006653911,
        "time_percent": 1.305431941414617,
        "time_per_call": 0.0022179703333333333
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.003991323000000001,
        "cumulative_time": 0.008378970000000001,
        "time_percent": 1.6438715627778662,
        "time_per_call": 0.004189485000000001
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0038270310000000003,
        "cumulative_time": 0.003918779,
        "time_percent": 0.7688259247748926,
        "time_per_call": 0.0013062596666666667
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 390,
        "function_name": "_profile_phase",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.002995221,
        "cumulative_time": 0.06766303900000001,
        "time_percent": 13.274823237609123,
        "time_per_call": 0.016915759750000002
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0029525230000000003,
        "cumulative_time": 0.028128829,
        "time_percent": 5.518599790587788,
        "time_per_call": 0.028128829
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.002896984,
        "cumulative_time": 0.0038284260000000002,
        "time_percent": 0.7510995541933453,
        "time_per_call": 0.0038284260000000002
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.00235429,
        "cumulative_time": 0.0023647440000000002,
        "time_percent": 0.4639395313325603,
        "time_per_call": 0.0007882480000000001
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 26,
        "primitive_calls": 4186,
        "total_time": 0.002315965,
        "cumulative_time": 0.003058027,
        "time_percent": 0.5999548421234244,
        "time_per_call": 0.00011761642307692308
      },
      {
        "rank": 13,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.00219132,
        "cumulative_time": 0.00219132,
        "time_percent": 0.4299154469996185,
        "time_per_call": 0.0001992109090909091
      },
      {
        "rank": 14,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.002048012,
        "cumulative_time": 0.002048012,
        "time_percent": 0.40179982587690644,
        "time_per_call": 0.0006826706666666667
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0019431410000000002,
        "cumulative_time": 0.0019431410000000002,
        "time_percent": 0.3812251663829499,
        "time_per_call": 0.0006477136666666667
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.001485699,
        "cumulative_time": 0.001485699,
        "time_percent": 0.2914795418706014,
        "time_per_call": 0.00011428453846153847
      },
      {
        "rank": 17,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0013137230000000001,
        "cumulative_time": 0.00854645,
        "time_percent": 1.6767294927303587,
        "time_per_call": 0.002848816666666667
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000880523,
        "cumulative_time": 0.000880523,
        "time_percent": 0.17274995853569772,
        "time_per_call": 0.000880523
      },
      {
        "rank": 19,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.0006390430000000001,
        "cumulative_time": 0.002663038,
        "time_percent": 0.5224618824028302,
        "time_per_call": 0.00044383966666666666
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0006159210000000001,
        "cumulative_time": 0.0006224830000000001,
        "time_percent": 0.12212504663612048,
        "time_per_call": 0.0006224830000000001
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0006013300000000001,
        "cumulative_time": 0.001441716,
        "time_percent": 0.28285050954972435,
        "time_per_call": 0.001441716
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0005975840000000001,
        "cumulative_time": 0.0005975840000000001,
        "time_percent": 0.11724010755153061,
        "time_per_call": 0.0005975840000000001
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.000538664,
        "cumulative_time": 0.000754971,
        "time_percent": 0.1481178901012855,
        "time_per_call": 0.000251657
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 26,
        "primitive_calls": 26,
        "total_time": 0.00045326300000000003,
        "cumulative_time": 0.004332728,
        "time_percent": 0.8500386501504861,
        "time_per_call": 0.0001666433846153846
      },
      {
        "rank": 25,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000451617,
        "cumulative_time": 0.000451617,
        "time_percent": 0.08860281676232896,
        "time_per_call": 0.000451617
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.000449767,
        "cumulative_time": 0.002814511,
        "time_percent": 0.5521793962772864,
        "time_per_call": 0.0009381703333333334
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 26,
        "primitive_calls": 26,
        "total_time": 0.00038423900000000003,
        "cumulative_time": 0.00038423900000000003,
        "time_percent": 0.07538391537506454,
        "time_per_call": 1.4778423076923079e-05
      },
      {
        "rank": 28,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.00037342900000000005,
        "cumulative_time": 0.0005470200000000001,
        "time_percent": 0.10731994771084612,
        "time_per_call": 9.117000000000001e-05
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 4467,
        "primitive_calls": 4467,
        "total_time": 0.00034126800000000004,
        "cumulative_time": 0.00034126800000000004,
        "time_percent": 0.06695342750792482,
        "time_per_call": 7.639758226997987e-08
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 26,
        "primitive_calls": 26,
        "total_time": 0.000301231,
        "cumulative_time": 0.000301231,
        "time_percent": 0.059098561604485914,
        "time_per_call": 1.1585807692307693e-05
      },
      {
        "rank": 31,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000277273,
        "cumulative_time": 0.0008657350000000001,
        "time_percent": 0.1698486982769357,
        "time_per_call": 0.00043286750000000004
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 3187,
        "primitive_calls": 3187,
        "total_time": 0.00027137600000000004,
        "cumulative_time": 0.00027137600000000004,
        "time_percent": 0.05324130402906398,
        "time_per_call": 8.51509256353938e-08
      },
      {
        "rank": 33,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.00020442300000000002,
        "cumulative_time": 0.00020442300000000002,
        "time_percent": 0.040105783464762346,
        "time_per_call": 6.814100000000001e-05
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.00018627500000000001,
        "cumulative_time": 0.00019682300000000002,
        "time_percent": 0.038614738160015843,
        "time_per_call": 1.0934611111111113e-05
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.00017837400000000002,
        "cumulative_time": 0.00017837400000000002,
        "time_percent": 0.034995225682743714,
        "time_per_call": 2.5482000000000004e-05
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.00015825,
        "cumulative_time": 0.00015825,
        "time_percent": 0.03104709466791232,
        "time_per_call": 1.2173076923076922e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.000130931,
        "cumulative_time": 0.000130931,
        "time_percent": 0.02568737536786369,
        "time_per_call": 1.454788888888889e-05
      },
      {
        "rank": 38,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 367,
        "function_name": "get_nn_features",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00013091100000000002,
        "cumulative_time": 0.000212298,
        "time_percent": 0.041650781066720065,
        "time_per_call": 0.000212298
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1098,
        "function_name": "remove_virtual_loss",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000126875,
        "cumulative_time": 0.00014975900000000001,
        "time_percent": 0.02938124392020146,
        "time_per_call": 0.00014975900000000001
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.000121132,
        "cumulative_time": 0.000121132,
        "time_percent": 0.023764907875599088,
        "time_per_call": 2.4226400000000002e-05
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00011645600000000001,
        "cumulative_time": 0.00011645600000000001,
        "time_percent": 0.022847522632836636,
        "time_per_call": 5.8228000000000006e-05
      },
      {
        "rank": 42,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.00010641,
        "cumulative_time": 0.000159189,
        "time_percent": 0.031231317239117186,
        "time_per_call": 3.18378e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.00010364200000000001,
        "cumulative_time": 0.00010364200000000001,
        "time_percent": 0.020333541772965365,
        "time_per_call": 1.7273666666666667e-05
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 1065,
        "primitive_calls": 1065,
        "total_time": 0.00010271500000000001,
        "cumulative_time": 0.0002944,
        "time_percent": 0.05775838654175917,
        "time_per_call": 2.764319248826291e-07
      },
      {
        "rank": 45,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 46,
        "primitive_calls": 46,
        "total_time": 0.00010220200000000001,
        "cumulative_time": 0.000191685,
        "time_percent": 0.037606713057938536,
        "time_per_call": 4.1670652173913045e-06
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 1014,
        "primitive_calls": 1014,
        "total_time": 9.952600000000001e-05,
        "cumulative_time": 9.952600000000001e-05,
        "time_percent": 0.01952602302634213,
        "time_per_call": 9.815187376725839e-08
      },
      {
        "rank": 47,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 782,
        "function_name": "batch_select_ucb_optimized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 9.832000000000001e-05,
        "cumulative_time": 0.002311949,
        "time_percent": 0.45358167121886406,
        "time_per_call": 0.0011559745
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.ones>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 9.267800000000001e-05,
        "cumulative_time": 9.267800000000001e-05,
        "time_percent": 0.018182512730696862,
        "time_per_call": 1.3239714285714287e-05
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 9.2569e-05,
        "cumulative_time": 9.2569e-05,
        "time_percent": 0.01816112800198405,
        "time_per_call": 1.5428166666666666e-05
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 9.148600000000001e-05,
        "cumulative_time": 9.148600000000001e-05,
        "time_percent": 0.017948654046057673,
        "time_per_call": 1.3069428571428573e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 5000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 3648,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 5000,
    "wave_size": 3648,
    "total_time_ms": 144.48331099993084,
    "simulations_per_second": 34606.07294639305,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 32.86076736450195,
        "cpu_time_ms": 30.491552999592386,
        "memory_allocated_mb": 0.7099609375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "expansion",
        "gpu_time_ms": 34.57686233520508,
        "cpu_time_ms": 31.672187000367558,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.958847999572754,
        "cpu_time_ms": 3.81635900157562,
        "memory_allocated_mb": 0.01416015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5308799743652344,
        "cpu_time_ms": 1.6248579995590262,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "selection",
        "gpu_time_ms": 36.1497917175293,
        "cpu_time_ms": 33.273247001488926,
        "memory_allocated_mb": 0.263671875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1352
      },
      {
        "name": "expansion",
        "gpu_time_ms": 34.76105499267578,
        "cpu_time_ms": 31.862209001701558,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1352
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.436448097229004,
        "cpu_time_ms": 3.363191999596893,
        "memory_allocated_mb": 0.00537109375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1352
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4089280366897583,
        "cpu_time_ms": 1.5264560006471584,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1352
      }
    ],
    "peak_gpu_memory_mb": 780.0771484375,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 188.7,
    "avg_ram_usage_mb": 1262.30078125,
    "final_tree_nodes": 501,
    "final_tree_edges": 500,
    "tree_memory_mb": 13.794532775878906,
    "efficiency_score": 45427.069320113114,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "cprofile_stats": "         36411 function calls (27114 primitive calls) in 0.143 seconds\n\n   Ordered by: cumulative time\n   List reduced from 214 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    0.143    0.143 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    0.143    0.143 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n        2    0.000    0.000    0.141    0.070 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n        8    0.000    0.000    0.140    0.018 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n        2    0.000    0.000    0.065    0.032 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n        2    0.000    0.000    0.064    0.032 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n        2    0.016    0.008    0.063    0.031 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n        2    0.008    0.004    0.049    0.024 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n        5    0.009    0.002    0.019    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n        6    0.004    0.001    0.017    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n       44    0.016    0.000    0.016    0.000 {built-in method torch.where}\n       28    0.003    0.000    0.014    0.001 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n        7    0.012    0.002    0.013    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n        6    0.008    0.001    0.013    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n        5    0.000    0.000    0.010    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n       58    0.001    0.000    0.009    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        6    0.001    0.000    0.008    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n       24    0.008    0.000    0.008    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n       13    0.006    0.000    0.008    0.001 {built-in method time.sleep}\n        2    0.000    0.000    0.008    0.004 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n  9338/58    0.005    0.000    0.007    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        6    0.006    0.001    0.006    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n        5    0.000    0.000    0.006    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n        2    0.004    0.002    0.006    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n       30    0.000    0.000    0.005    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        5    0.001    0.000    0.005    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n       28    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        6    0.004    0.001    0.004    0.001 {built-in method torch.repeat_interleave}\n       22    0.004    0.000    0.004    0.000 {built-in method torch.tensor}\n        2    0.000    0.000    0.004    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n        6    0.004    0.001    0.004    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n        2    0.002    0.001    0.003    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n       25    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        2    0.001    0.001    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n       25    0.002    0.000    0.002    0.000 {built-in method torch._C._cuda_synchronize}\n       18    0.000    0.000    0.002    0.000 {built-in method builtins.next}\n       18    0.000    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:489(_extract_policy)\n        9    0.000    0.000    0.002    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n        2    0.002    0.001    0.002    0.001 {built-in method torch.bincount}\n        9    0.000    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n        6    0.001    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n       14    0.001    0.000    0.001    0.000 {built-in method torch.zeros_like}\n       58    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n    42/28    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n       14    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n       14    0.001    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n        2    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n      4/2    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n       14    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 44,
        "primitive_calls": 44,
        "total_time": 0.016030640000000002,
        "cumulative_time": 0.016030640000000002,
        "time_percent": 1.5026061057808928,
        "time_per_call": 0.0003643327272727273
      },
      {
        "rank": 2,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.015730432000000003,
        "cumulative_time": 0.062914837,
        "time_percent": 5.897220461591654,
        "time_per_call": 0.0314574185
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.01198766,
        "cumulative_time": 0.013349189000000001,
        "time_percent": 1.2512646343890905,
        "time_per_call": 0.0019070270000000002
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.008592919000000001,
        "cumulative_time": 0.019269887000000003,
        "time_percent": 1.8062316828216372,
        "time_per_call": 0.0038539774000000008
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.008267593,
        "cumulative_time": 0.012924189,
        "time_percent": 1.2114279469607108,
        "time_per_call": 0.0021540315
      },
      {
        "rank": 6,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 24,
        "primitive_calls": 24,
        "total_time": 0.008104192,
        "cumulative_time": 0.008104192,
        "time_percent": 0.7596333260319402,
        "time_per_call": 0.00033767466666666663
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0076949290000000005,
        "cumulative_time": 0.048974698000000004,
        "time_percent": 4.590564085000678,
        "time_per_call": 0.024487349000000002
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.006303504000000001,
        "cumulative_time": 0.006303504000000001,
        "time_percent": 0.5908487495330368,
        "time_per_call": 0.001050584
      },
      {
        "rank": 9,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.005821042,
        "cumulative_time": 0.007970704,
        "time_percent": 0.7471210443109061,
        "time_per_call": 0.0006131310769230769
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 58,
        "primitive_calls": 9338,
        "total_time": 0.004879408,
        "cumulative_time": 0.00650398,
        "time_percent": 0.609640043059841,
        "time_per_call": 0.00011213758620689656
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.00441347,
        "cumulative_time": 0.00441347,
        "time_percent": 0.41368947026948366,
        "time_per_call": 0.0007355783333333333
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 22,
        "primitive_calls": 22,
        "total_time": 0.004040666,
        "cumulative_time": 0.004040666,
        "time_percent": 0.3787452904576022,
        "time_per_call": 0.00018366663636363637
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.003806443,
        "cumulative_time": 0.005658736,
        "time_percent": 0.5304124641687509,
        "time_per_call": 0.002829368
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.0036316110000000003,
        "cumulative_time": 0.0036316110000000003,
        "time_percent": 0.3404031818081532,
        "time_per_call": 0.0006052685
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.0035124740000000002,
        "cumulative_time": 0.017485107,
        "time_percent": 1.638938216966523,
        "time_per_call": 0.0029141845
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.0031989690000000003,
        "cumulative_time": 0.014333258000000001,
        "time_percent": 1.343504750061933,
        "time_per_call": 0.0005119020714285715
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.00221766,
        "cumulative_time": 0.00221766,
        "time_percent": 0.20786877233510667,
        "time_per_call": 8.87064e-05
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.001759916,
        "cumulative_time": 0.001759916,
        "time_percent": 0.16496287904048032,
        "time_per_call": 0.000879958
      },
      {
        "rank": 19,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.001717252,
        "cumulative_time": 0.0030133210000000002,
        "time_percent": 0.28244876893734655,
        "time_per_call": 0.0015066605000000001
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.001320694,
        "cumulative_time": 0.001320694,
        "time_percent": 0.12379311545067384,
        "time_per_call": 9.433528571428572e-05
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.0012887200000000001,
        "cumulative_time": 0.008494201,
        "time_percent": 0.7961901886843047,
        "time_per_call": 0.0014157001666666666
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.0010708030000000002,
        "cumulative_time": 0.001519492,
        "time_percent": 0.1424271243621727,
        "time_per_call": 0.00025324866666666667
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0010123,
        "cumulative_time": 0.0010123,
        "time_percent": 0.09488630278529102,
        "time_per_call": 0.00050615
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0010002610000000001,
        "cumulative_time": 0.0023740510000000003,
        "time_percent": 0.2225278297083107,
        "time_per_call": 0.0011870255000000001
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 58,
        "primitive_calls": 58,
        "total_time": 0.0009074930000000001,
        "cumulative_time": 0.009226309,
        "time_percent": 0.8648131476485781,
        "time_per_call": 0.0001590742931034483
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.0008304860000000001,
        "cumulative_time": 0.004559756,
        "time_percent": 0.42740135181571415,
        "time_per_call": 0.0009119512
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0007795870000000001,
        "cumulative_time": 0.0007795870000000001,
        "time_percent": 0.07307332621700749,
        "time_per_call": 0.00038979350000000005
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 58,
        "primitive_calls": 58,
        "total_time": 0.000682429,
        "cumulative_time": 0.000682429,
        "time_percent": 0.06396637827073334,
        "time_per_call": 1.1766017241379311e-05
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 9885,
        "primitive_calls": 9885,
        "total_time": 0.000671041,
        "cumulative_time": 0.000671041,
        "time_percent": 0.06289894251441715,
        "time_per_call": 6.788477491148205e-08
      },
      {
        "rank": 30,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.0006656640000000001,
        "cumulative_time": 0.001090341,
        "time_percent": 0.10220134966434555,
        "time_per_call": 7.78815e-05
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 58,
        "primitive_calls": 58,
        "total_time": 0.0006418390000000001,
        "cumulative_time": 0.0006418390000000001,
        "time_percent": 0.06016174028786763,
        "time_per_call": 1.1066189655172415e-05
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 7107,
        "primitive_calls": 7107,
        "total_time": 0.000620709,
        "cumulative_time": 0.000620709,
        "time_percent": 0.05818115392231078,
        "time_per_call": 8.733769523005488e-08
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 42,
        "primitive_calls": 42,
        "total_time": 0.00044554200000000005,
        "cumulative_time": 0.00044554200000000005,
        "time_percent": 0.041762158565212024,
        "time_per_call": 1.0608142857142859e-05
      },
      {
        "rank": 34,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.00041602900000000005,
        "cumulative_time": 0.00041602900000000005,
        "time_percent": 0.038995805256803164,
        "time_per_call": 5.943271428571429e-05
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 15,
        "primitive_calls": 15,
        "total_time": 0.00036500000000000004,
        "cumulative_time": 0.00036500000000000004,
        "time_percent": 0.03421268449731426,
        "time_per_call": 2.4333333333333336e-05
      },
      {
        "rank": 36,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 59,
        "primitive_calls": 59,
        "total_time": 0.00030402,
        "cumulative_time": 0.00034818200000000005,
        "time_percent": 0.032636276475736636,
        "time_per_call": 5.901389830508475e-06
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 30,
        "primitive_calls": 30,
        "total_time": 0.000282006,
        "cumulative_time": 0.000282006,
        "time_percent": 0.026433376176300285,
        "time_per_call": 9.4002e-06
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.000265713,
        "cumulative_time": 0.000265713,
        "time_percent": 0.024906178180369488,
        "time_per_call": 1.4761833333333333e-05
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 367,
        "function_name": "get_nn_features",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000253986,
        "cumulative_time": 0.00040657700000000003,
        "time_percent": 0.038109837328396,
        "time_per_call": 0.00020328850000000002
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 2262,
        "primitive_calls": 2262,
        "total_time": 0.00025110000000000003,
        "cumulative_time": 0.00025110000000000003,
        "time_percent": 0.023536452266508523,
        "time_per_call": 1.1100795755968172e-07
      },
      {
        "rank": 41,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.000249508,
        "cumulative_time": 0.00037535000000000004,
        "time_percent": 0.03518282500292303,
        "time_per_call": 3.127916666666667e-05
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.00024004100000000003,
        "cumulative_time": 0.00024004100000000003,
        "time_percent": 0.022499854792930995,
        "time_per_call": 1.7145785714285717e-05
      },
      {
        "rank": 43,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 390,
        "function_name": "_profile_phase",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.00023881700000000003,
        "cumulative_time": 0.14028701300000002,
        "time_percent": 13.149576205040065,
        "time_per_call": 0.017535876625000002
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 2370,
        "primitive_calls": 2370,
        "total_time": 0.000226419,
        "cumulative_time": 0.000610369,
        "time_percent": 0.05721195075052385,
        "time_per_call": 2.575396624472574e-07
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.000216927,
        "cumulative_time": 0.000216927,
        "time_percent": 0.020333301397120248,
        "time_per_call": 4.33854e-05
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.00020118000000000002,
        "cumulative_time": 0.00020118000000000002,
        "time_percent": 0.018857281827862147,
        "time_per_call": 1.6765000000000003e-05
      },
      {
        "rank": 47,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 99,
        "primitive_calls": 99,
        "total_time": 0.00019770900000000001,
        "cumulative_time": 0.00038395000000000004,
        "time_percent": 0.03598893208970907,
        "time_per_call": 3.878282828282828e-06
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros>",
        "total_calls": 15,
        "primitive_calls": 15,
        "total_time": 0.000185192,
        "cumulative_time": 0.000185192,
        "time_percent": 0.017358672513497594,
        "time_per_call": 1.2346133333333334e-05
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.00017880400000000002,
        "cumulative_time": 0.000212808,
        "time_percent": 0.01994721359590261,
        "time_per_call": 1.7734e-05
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 42,
        "primitive_calls": 42,
        "total_time": 0.000168622,
        "cumulative_time": 0.000168622,
        "time_percent": 0.01580551037070171,
        "time_per_call": 4.014809523809524e-06
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 3648,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 10000,
    "wave_size": 3648,
    "total_time_ms": 224.4059649983683,
    "simulations_per_second": 44562.09530826292,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 30.134239196777344,
        "cpu_time_ms": 30.97198599971307,
        "memory_allocated_mb": 0.7099609375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "expansion",
        "gpu_time_ms": 34.61030578613281,
        "cpu_time_ms": 31.75064800052496,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.900320053100586,
        "cpu_time_ms": 3.782510000746697,
        "memory_allocated_mb": 0.01416015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5779839754104614,
        "cpu_time_ms": 1.6733980010030791,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "selection",
        "gpu_time_ms": 38.73068618774414,
        "cpu_time_ms": 35.65164800056664,
        "memory_allocated_mb": 0.7099609375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "expansion",
        "gpu_time_ms": 35.54822540283203,
        "cpu_time_ms": 32.5790919996507,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 5.297696113586426,
        "cpu_time_ms": 5.182449000130873,
        "memory_allocated_mb": 0.01416015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.7048959732055664,
        "cpu_time_ms": 1.878905999546987,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "selection",
        "gpu_time_ms": 37.5450553894043,
        "cpu_time_ms": 34.54898300151399,
        "memory_allocated_mb": 0.52685546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2704
      },
      {
        "name": "expansion",
        "gpu_time_ms": 35.96550369262695,
        "cpu_time_ms": 32.94957199977944,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2704
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.006303787231445,
        "cpu_time_ms": 3.893179000442615,
        "memory_allocated_mb": 0.0107421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2704
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4113600254058838,
        "cpu_time_ms": 1.5663199992559385,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2704
      }
    ],
    "peak_gpu_memory_mb": 779.30078125,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 188.5,
    "avg_ram_usage_mb": 1262.30078125,
    "final_tree_nodes": 651,
    "final_tree_edges": 650,
    "tree_memory_mb": 13.794532775878906,
    "efficiency_score": 58554.52309757483,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "cprofile_stats": "         54531 function calls (40537 primitive calls) in 0.223 seconds\n\n   Ordered by: cumulative time\n   List reduced from 212 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        3    0.000    0.000    0.098    0.033 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n       20    0.024    0.001    0.089    0.004 {built-in method time.sleep}\n        3    0.017    0.006    0.074    0.025 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n        3    0.005    0.002    0.036    0.012 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n        8    0.017    0.002    0.035    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n       69    0.029    0.000    0.029    0.000 {built-in method torch.where}\n        9    0.005    0.001    0.026    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n        9    0.011    0.001    0.018    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n        8    0.000    0.000    0.017    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n       11    0.014    0.001    0.016    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n        3    0.000    0.000    0.014    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n       87    0.001    0.000    0.013    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        9    0.002    0.000    0.012    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n       35    0.012    0.000    0.012    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n        3    0.006    0.002    0.011    0.004 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n        9    0.010    0.001    0.010    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n 14007/87    0.007    0.000    0.010    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        8    0.000    0.000    0.009    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n        9    0.008    0.001    0.008    0.001 {built-in method torch.repeat_interleave}\n        3    0.005    0.002    0.008    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n       45    0.000    0.000    0.007    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       42    0.000    0.000    0.007    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        8    0.001    0.000    0.006    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n       33    0.006    0.000    0.006    0.000 {built-in method torch.tensor}\n        3    0.000    0.000    0.006    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n        9    0.006    0.001    0.006    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n       20    0.003    0.000    0.005    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n        3    0.002    0.001    0.004    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n       37    0.003    0.000    0.003    0.000 {built-in method torch._C._cuda_synchronize}\n       26    0.000    0.000    0.003    0.000 {built-in method builtins.next}\n       26    0.000    0.000    0.003    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n       13    0.000    0.000    0.003    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       13    0.000    0.000    0.003    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n       22    0.003    0.000    0.003    0.000 {built-in method torch.zeros_like}\n        9    0.002    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n    61/41    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n       41    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n        3    0.002    0.001    0.002    0.001 {built-in method torch.bincount}\n        3    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n      6/3    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        3    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n       21    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n        3    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n        3    0.001    0.000    0.001    0.000 {built-in method torch._unique2}\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:489(_extract_policy)\n       21    0.001    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n       87    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n       30    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:33(wrapped)\n       20    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n      171    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 69,
        "primitive_calls": 69,
        "total_time": 0.029264617000000003,
        "cumulative_time": 0.029272892000000002,
        "time_percent": 4.381648910692286,
        "time_per_call": 0.0004242448115942029
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 20,
        "primitive_calls": 20,
        "total_time": 0.024083414,
        "cumulative_time": 0.08946818200000001,
        "time_percent": 13.39184943537247,
        "time_per_call": 0.004473409100000001
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.016845712000000002,
        "cumulative_time": 0.035376373,
        "time_percent": 5.295235134939658,
        "time_per_call": 0.004422046625
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.016730536,
        "cumulative_time": 0.073854429,
        "time_percent": 11.05473891604734,
        "time_per_call": 0.024618143
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.014025523000000002,
        "cumulative_time": 0.015536926000000001,
        "time_percent": 2.3256108376106694,
        "time_per_call": 0.0014124478181818184
      },
      {
        "rank": 6,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 35,
        "primitive_calls": 35,
        "total_time": 0.011564627000000001,
        "cumulative_time": 0.011564627000000001,
        "time_percent": 1.731025936798886,
        "time_per_call": 0.0003304179142857143
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.011442918000000002,
        "cumulative_time": 0.018318001,
        "time_percent": 2.7418899754663877,
        "time_per_call": 0.0020353334444444446
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.010355583,
        "cumulative_time": 0.010355583,
        "time_percent": 1.5500528260594668,
        "time_per_call": 0.0011506203333333334
      },
      {
        "rank": 9,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.008292603,
        "cumulative_time": 0.008292603,
        "time_percent": 1.241260170049259,
        "time_per_call": 0.0009214003333333334
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 87,
        "primitive_calls": 14007,
        "total_time": 0.007239435000000001,
        "cumulative_time": 0.009530935,
        "time_percent": 1.426617191107356,
        "time_per_call": 0.00010955097701149426
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 33,
        "primitive_calls": 33,
        "total_time": 0.006417012000000001,
        "cumulative_time": 0.006417012000000001,
        "time_percent": 0.9605164272699579,
        "time_per_call": 0.0001944549090909091
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.005694898,
        "cumulative_time": 0.005694898,
        "time_percent": 0.8524283701864402,
        "time_per_call": 0.0006327664444444445
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.005608728,
        "cumulative_time": 0.011379867,
        "time_percent": 1.703370539691572,
        "time_per_call": 0.003793289
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.005204424,
        "cumulative_time": 0.025837399,
        "time_percent": 3.86741464367347,
        "time_per_call": 0.002870822111111111
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.005077886,
        "cumulative_time": 0.007852615,
        "time_percent": 1.1754015271479126,
        "time_per_call": 0.0026175383333333336
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.004872139,
        "cumulative_time": 0.036274070000000005,
        "time_percent": 5.429604949926907,
        "time_per_call": 0.012091356666666669
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 37,
        "primitive_calls": 37,
        "total_time": 0.0034233700000000002,
        "cumulative_time": 0.0034233700000000002,
        "time_percent": 0.5124196622389292,
        "time_per_call": 9.252351351351353e-05
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 22,
        "primitive_calls": 22,
        "total_time": 0.002622217,
        "cumulative_time": 0.002622217,
        "time_percent": 0.3925008250516825,
        "time_per_call": 0.00011919168181818182
      },
      {
        "rank": 19,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 20,
        "primitive_calls": 20,
        "total_time": 0.002570789,
        "cumulative_time": 0.005454419,
        "time_percent": 0.8164327962474398,
        "time_per_call": 0.00027272095
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0018274460000000001,
        "cumulative_time": 0.012183029000000001,
        "time_percent": 1.8235900896564146,
        "time_per_call": 0.001353669888888889
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.001763428,
        "cumulative_time": 0.001763428,
        "time_percent": 0.26395486907423693,
        "time_per_call": 0.0005878093333333334
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.001624919,
        "cumulative_time": 0.0036913070000000004,
        "time_percent": 0.5525252269430986,
        "time_per_call": 0.0012304356666666667
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0016177670000000002,
        "cumulative_time": 0.0023010120000000003,
        "time_percent": 0.34442195609814985,
        "time_per_call": 0.000255668
      },
      {
        "rank": 24,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0014546770000000001,
        "cumulative_time": 0.0014546770000000001,
        "time_percent": 0.21774014991272897,
        "time_per_call": 0.0004848923333333334
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 87,
        "primitive_calls": 87,
        "total_time": 0.001342875,
        "cumulative_time": 0.013177382000000001,
        "time_percent": 1.9724276469190727,
        "time_per_call": 0.00015146416091954025
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.001247648,
        "cumulative_time": 0.006440428000000001,
        "time_percent": 0.9640214000923485,
        "time_per_call": 0.0008050535000000001
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 14816,
        "primitive_calls": 14816,
        "total_time": 0.0009990860000000002,
        "cumulative_time": 0.0009990860000000002,
        "time_percent": 0.1495460060313793,
        "time_per_call": 6.743291036717063e-08
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 87,
        "primitive_calls": 87,
        "total_time": 0.000955799,
        "cumulative_time": 0.000955799,
        "time_percent": 0.14306668596976263,
        "time_per_call": 1.098619540229885e-05
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 87,
        "primitive_calls": 87,
        "total_time": 0.0009195370000000001,
        "cumulative_time": 0.0009195370000000001,
        "time_percent": 0.13763888769142638,
        "time_per_call": 1.0569390804597703e-05
      },
      {
        "rank": 30,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 21,
        "primitive_calls": 21,
        "total_time": 0.0008810000000000001,
        "cumulative_time": 0.001379779,
        "time_percent": 0.20652920635057487,
        "time_per_call": 6.57037619047619e-05
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 10660,
        "primitive_calls": 10660,
        "total_time": 0.000858207,
        "cumulative_time": 0.000858207,
        "time_percent": 0.1284588405784606,
        "time_per_call": 8.050722326454034e-08
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 62,
        "primitive_calls": 62,
        "total_time": 0.000694391,
        "cumulative_time": 0.000710594,
        "time_percent": 0.10636371104175409,
        "time_per_call": 1.1461193548387098e-05
      },
      {
        "rank": 33,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0006421510000000001,
        "cumulative_time": 0.000648949,
        "time_percent": 0.09713651384170886,
        "time_per_call": 0.000648949
      },
      {
        "rank": 34,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.000640011,
        "cumulative_time": 0.000640011,
        "time_percent": 0.09579864883118078,
        "time_per_call": 5.818281818181818e-05
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.000533743,
        "cumulative_time": 0.000533743,
        "time_percent": 0.07989215532717552,
        "time_per_call": 2.320621739130435e-05
      },
      {
        "rank": 36,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 367,
        "function_name": "get_nn_features",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.000473241,
        "cumulative_time": 0.00071816,
        "time_percent": 0.10749621122855824,
        "time_per_call": 0.00023938666666666668
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.00045184200000000004,
        "cumulative_time": 0.00045184200000000004,
        "time_percent": 0.06763298300369586,
        "time_per_call": 0.000150614
      },
      {
        "rank": 38,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.00043997700000000003,
        "cumulative_time": 0.00065023,
        "time_percent": 0.0973282575291654,
        "time_per_call": 3.422263157894737e-05
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 47,
        "primitive_calls": 47,
        "total_time": 0.00042772100000000005,
        "cumulative_time": 0.00042772100000000005,
        "time_percent": 0.06402248379593706,
        "time_per_call": 9.100446808510639e-06
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros>",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.00042080300000000003,
        "cumulative_time": 0.00042080300000000003,
        "time_percent": 0.06298697807398211,
        "time_per_call": 1.8295782608695653e-05
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 0.00041384200000000004,
        "cumulative_time": 0.00041384200000000004,
        "time_percent": 0.06194503599093378,
        "time_per_call": 1.5327481481481483e-05
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.00037730200000000004,
        "cumulative_time": 0.00037730200000000004,
        "time_percent": 0.05647562588971467,
        "time_per_call": 4.7162750000000005e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.00033581700000000003,
        "cumulative_time": 0.00033581700000000003,
        "time_percent": 0.05026603426275585,
        "time_per_call": 1.86565e-05
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 20,
        "primitive_calls": 20,
        "total_time": 0.00033270200000000004,
        "cumulative_time": 0.00033270200000000004,
        "time_percent": 0.04979977229052549,
        "time_per_call": 1.6635100000000003e-05
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 3393,
        "primitive_calls": 3393,
        "total_time": 0.000328052,
        "cumulative_time": 0.000328052,
        "time_percent": 0.04910374719554276,
        "time_per_call": 9.668493958149131e-08
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 3558,
        "primitive_calls": 3558,
        "total_time": 0.00032237000000000005,
        "cumulative_time": 0.000906566,
        "time_percent": 0.13569735188346488,
        "time_per_call": 2.54796514896009e-07
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 20,
        "primitive_calls": 20,
        "total_time": 0.000305882,
        "cumulative_time": 0.000378196,
        "time_percent": 0.0566094423273307,
        "time_per_call": 1.89098e-05
      },
      {
        "rank": 48,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 152,
        "primitive_calls": 152,
        "total_time": 0.000304736,
        "cumulative_time": 0.000584196,
        "time_percent": 0.08744410244914617,
        "time_per_call": 3.843394736842106e-06
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 63,
        "primitive_calls": 63,
        "total_time": 0.00029113,
        "cumulative_time": 0.00029113,
        "time_percent": 0.04357715825856377,
        "time_per_call": 4.621111111111111e-06
      },
      {
        "rank": 50,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 390,
        "function_name": "_profile_phase",
        "total_calls": 0,
        "primitive_calls": 11,
        "total_time": 0.00028337500000000004,
        "cumulative_time": 0.0,
        "time_percent": 0.0,
        "time_per_call": 0
      }
    ]
  },
  {
    "config": {
      "num_simulations": 25000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 3648,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 25000,
    "wave_size": 3648,
    "total_time_ms": 661.5391420000378,
    "simulations_per_second": 37790.65880276903,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 29.769407272338867,
        "cpu_time_ms": 28.05011599957652,
        "memory_allocated_mb": 0.7099609375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "expansion",
        "gpu_time_ms": 33.677791595458984,
        "cpu_time_ms": 30.85467500022787,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.5050880908966064,
        "cpu_time_ms": 3.4083139998983825,
        "memory_allocated_mb": 0.01416015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6535999774932861,
        "cpu_time_ms": 1.8404080001346301,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "selection",
        "gpu_time_ms": 37.176353454589844,
        "cpu_time_ms": 35.0516010003048,
        "memory_allocated_mb": 0.7099609375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "expansion",
        "gpu_time_ms": 41.813663482666016,
        "cpu_time_ms": 38.25831699941773,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.108799934387207,
        "cpu_time_ms": 3.9983250007935567,
        "memory_allocated_mb": 0.01416015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4018559455871582,
        "cpu_time_ms": 1.4985130001150537,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "selection",
        "gpu_time_ms": 37.155006408691406,
        "cpu_time_ms": 34.18919000068854,
        "memory_allocated_mb": 0.7099609375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "expansion",
        "gpu_time_ms": 36.81955337524414,
        "cpu_time_ms": 33.723223001288716,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.750080108642578,
        "cpu_time_ms": 3.711897999892244,
        "memory_allocated_mb": 0.01416015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "backup",
        "gpu_time_ms": 2.263904094696045,
        "cpu_time_ms": 2.320280000276398,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "selection",
        "gpu_time_ms": 36.65193557739258,
        "cpu_time_ms": 33.72952199970314,
        "memory_allocated_mb": 0.7099609375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "expansion",
        "gpu_time_ms": 48.71481704711914,
        "cpu_time_ms": 44.52718799984723,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.207520008087158,
        "cpu_time_ms": 4.04203599828179,
        "memory_allocated_mb": 0.01416015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.565567970275879,
        "cpu_time_ms": 1.6505769999639597,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "selection",
        "gpu_time_ms": 48.36751937866211,
        "cpu_time_ms": 44.51137499927427,
        "memory_allocated_mb": 0.7099609375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "expansion",
        "gpu_time_ms": 54.97516632080078,
        "cpu_time_ms": 50.252573999387096,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.413856029510498,
        "cpu_time_ms": 3.360229999088915,
        "memory_allocated_mb": 0.01416015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.3783040046691895,
        "cpu_time_ms": 1.4937840005586622,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "selection",
        "gpu_time_ms": 52.67513656616211,
        "cpu_time_ms": 48.29848900044453,
        "memory_allocated_mb": 0.7099609375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "expansion",
        "gpu_time_ms": 62.692543029785156,
        "cpu_time_ms": 57.26485799823422,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.077375888824463,
        "cpu_time_ms": 4.021293998448527,
        "memory_allocated_mb": 0.01416015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.536895990371704,
        "cpu_time_ms": 2.236805001302855,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "selection",
        "gpu_time_ms": 52.258270263671875,
        "cpu_time_ms": 47.97077399962291,
        "memory_allocated_mb": 0.60595703125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3112
      },
      {
        "name": "expansion",
        "gpu_time_ms": 87.05718231201172,
        "cpu_time_ms": 79.45255500089843,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3112
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 5.745279788970947,
        "cpu_time_ms": 5.521838000277057,
        "memory_allocated_mb": 0.01220703125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3112
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.7643519639968872,
        "cpu_time_ms": 1.9109679997200146,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3112
      }
    ],
    "peak_gpu_memory_mb": 778.43359375,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 188.5,
    "avg_ram_usage_mb": 1262.30078125,
    "final_tree_nodes": 1751,
    "final_tree_edges": 1750,
    "tree_memory_mb": 13.794532775878906,
    "efficiency_score": 49712.18473192401,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth"
    ],
    "cprofile_stats": "         148772 function calls (110463 primitive calls) in 0.660 seconds\n\n   Ordered by: cumulative time\n   List reduced from 214 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    0.659    0.659 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    0.659    0.659 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n        7    0.000    0.000    0.658    0.094 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n       28    0.001    0.000    0.657    0.023 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n        7    0.000    0.000    0.337    0.048 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n        7    0.000    0.000    0.275    0.039 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n        7    0.027    0.004    0.217    0.031 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n        7    0.052    0.007    0.200    0.029 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n       60    0.057    0.001    0.178    0.003 {built-in method time.sleep}\n      207    0.085    0.000    0.085    0.000 {built-in method torch.where}\n       31    0.016    0.001    0.085    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n       31    0.045    0.001    0.079    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n       23    0.035    0.002    0.076    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n       61    0.013    0.000    0.053    0.001 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n       31    0.007    0.000    0.045    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n       30    0.041    0.001    0.044    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n       23    0.000    0.000    0.041    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n      239    0.004    0.000    0.039    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n      109    0.037    0.000    0.037    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n       31    0.034    0.001    0.034    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n        7    0.000    0.000    0.031    0.004 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n38479/239    0.022    0.000    0.029    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       31    0.026    0.001    0.026    0.001 {built-in method torch.repeat_interleave}\n       23    0.000    0.000    0.021    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n        7    0.014    0.002    0.021    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n      117    0.000    0.000    0.021    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       31    0.020    0.001    0.020    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n      107    0.020    0.000    0.020    0.000 {built-in method torch.tensor}\n       23    0.004    0.000    0.019    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n      122    0.000    0.000    0.019    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n      122    0.005    0.000    0.019    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n        7    0.000    0.000    0.015    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n        7    0.007    0.001    0.013    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n       85    0.000    0.000    0.010    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        7    0.004    0.001    0.009    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n       31    0.006    0.000    0.008    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n       58    0.000    0.000    0.008    0.000 {built-in method builtins.next}\n       58    0.000    0.000    0.008    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n  183/122    0.000    0.000    0.008    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n       85    0.007    0.000    0.007    0.000 {built-in method torch._C._cuda_synchronize}\n       29    0.000    0.000    0.007    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       29    0.000    0.000    0.007    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n       61    0.001    0.000    0.006    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n        7    0.006    0.001    0.006    0.001 {built-in method torch.bincount}\n       61    0.003    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n        7    0.000    0.000    0.004    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n     14/7    0.000    0.000    0.004    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n       61    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n        7    0.000    0.000    0.004    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        7    0.000    0.000    0.004    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 207,
        "primitive_calls": 207,
        "total_time": 0.084906204,
        "cumulative_time": 0.084906204,
        "time_percent": 1.7145657913801393,
        "time_per_call": 0.0004101748985507246
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 60,
        "primitive_calls": 60,
        "total_time": 0.056619409,
        "cumulative_time": 0.178152308,
        "time_percent": 3.597544567558554,
        "time_per_call": 0.0029692051333333335
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.052104040000000004,
        "cumulative_time": 0.19988433400000002,
        "time_percent": 4.036393398404694,
        "time_per_call": 0.02855490485714286
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 0.044564859000000005,
        "cumulative_time": 0.078744323,
        "time_percent": 1.590134950341065,
        "time_per_call": 0.002540139451612903
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 30,
        "primitive_calls": 30,
        "total_time": 0.041368542,
        "cumulative_time": 0.043827538000000006,
        "time_percent": 0.8850377691506872,
        "time_per_call": 0.0014609179333333335
      },
      {
        "rank": 6,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 109,
        "primitive_calls": 109,
        "total_time": 0.037382758,
        "cumulative_time": 0.037382758,
        "time_percent": 0.7548941659698064,
        "time_per_call": 0.00034296108256880734
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.034501851,
        "cumulative_time": 0.07595267900000001,
        "time_percent": 1.5337614808109512,
        "time_per_call": 0.003302290391304348
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 0.033902012,
        "cumulative_time": 0.033902012,
        "time_percent": 0.6846052148811056,
        "time_per_call": 0.0010936132903225807
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.027396338000000003,
        "cumulative_time": 0.217485897,
        "time_percent": 4.391833123334834,
        "time_per_call": 0.031069413857142857
      },
      {
        "rank": 10,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 0.025701822000000003,
        "cumulative_time": 0.025701822000000003,
        "time_percent": 0.519013484307242,
        "time_per_call": 0.0008290910322580646
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 239,
        "primitive_calls": 38479,
        "total_time": 0.022451291,
        "cumulative_time": 0.02875476,
        "time_percent": 0.5806634322663392,
        "time_per_call": 0.00012031280334728034
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 0.020265083,
        "cumulative_time": 0.020265083,
        "time_percent": 0.4092259038135684,
        "time_per_call": 0.0006537123548387097
      },
      {
        "rank": 13,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 107,
        "primitive_calls": 107,
        "total_time": 0.020209667,
        "cumulative_time": 0.020209667,
        "time_percent": 0.40810685274993674,
        "time_per_call": 0.0001888753925233645
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 0.016291072,
        "cumulative_time": 0.084809174,
        "time_percent": 1.712606401949214,
        "time_per_call": 0.0027357798064516128
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.014089525,
        "cumulative_time": 0.021210699000000003,
        "time_percent": 0.42832133817525203,
        "time_per_call": 0.0030300998571428576
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 61,
        "primitive_calls": 61,
        "total_time": 0.013467979000000001,
        "cumulative_time": 0.053330309000000006,
        "time_percent": 1.0769333587817964,
        "time_per_call": 0.0008742673606557378
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 85,
        "primitive_calls": 85,
        "total_time": 0.007292471,
        "cumulative_time": 0.007292471,
        "time_percent": 0.14726157479884175,
        "time_per_call": 8.579377647058824e-05
      },
      {
        "rank": 18,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.006714267,
        "cumulative_time": 0.013388893,
        "time_percent": 0.270370559991694,
        "time_per_call": 0.0019126990000000001
      },
      {
        "rank": 19,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 0.006582472000000001,
        "cumulative_time": 0.044604914,
        "time_percent": 0.9007358245794744,
        "time_per_call": 0.0014388681935483872
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 0.005947471,
        "cumulative_time": 0.008281411,
        "time_percent": 0.1672318786617665,
        "time_per_call": 0.00026714229032258064
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.005678166,
        "cumulative_time": 0.005678166,
        "time_percent": 0.11466287176585825,
        "time_per_call": 0.0008111665714285714
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 122,
        "primitive_calls": 122,
        "total_time": 0.005194405,
        "cumulative_time": 0.018696794000000003,
        "time_percent": 0.3775564315757356,
        "time_per_call": 0.0001532524098360656
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.004082767,
        "cumulative_time": 0.004082767,
        "time_percent": 0.08244594979626833,
        "time_per_call": 0.0005832524285714286
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.0038937430000000003,
        "cumulative_time": 0.009303061000000001,
        "time_percent": 0.1878627166717136,
        "time_per_call": 0.0013290087142857146
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 239,
        "primitive_calls": 239,
        "total_time": 0.003762609,
        "cumulative_time": 0.038720895000000005,
        "time_percent": 0.7819160302894038,
        "time_per_call": 0.00016201211297071132
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.003733768,
        "cumulative_time": 0.019391615,
        "time_percent": 0.3915874005934123,
        "time_per_call": 0.0008431136956521739
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 183,
        "primitive_calls": 183,
        "total_time": 0.0030212420000000004,
        "cumulative_time": 0.003260343,
        "time_percent": 0.06583821102125469,
        "time_per_call": 1.7816081967213114e-05
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.0028990250000000004,
        "cumulative_time": 0.0028990250000000004,
        "time_percent": 0.058541883386469734,
        "time_per_call": 0.0004141464285714286
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 40387,
        "primitive_calls": 40387,
        "total_time": 0.002680089,
        "cumulative_time": 0.002680089,
        "time_percent": 0.05412076739709394,
        "time_per_call": 6.636019016020006e-08
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 239,
        "primitive_calls": 239,
        "total_time": 0.002584975,
        "cumulative_time": 0.002584975,
        "time_percent": 0.052200068991105485,
        "time_per_call": 1.08157949790795e-05
      },
      {
        "rank": 31,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 61,
        "primitive_calls": 61,
        "total_time": 0.0025271720000000003,
        "cumulative_time": 0.004361528,
        "time_percent": 0.08807515063265149,
        "time_per_call": 7.150045901639345e-05
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 239,
        "primitive_calls": 239,
        "total_time": 0.0024935720000000003,
        "cumulative_time": 0.0024935720000000003,
        "time_percent": 0.05035430920387582,
        "time_per_call": 1.0433355648535566e-05
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 29276,
        "primitive_calls": 29276,
        "total_time": 0.002422659,
        "cumulative_time": 0.002422659,
        "time_percent": 0.04892231721464333,
        "time_per_call": 8.275239103702692e-08
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 60,
        "primitive_calls": 60,
        "total_time": 0.0017427660000000002,
        "cumulative_time": 0.0017427660000000002,
        "time_percent": 0.03519279893823072,
        "time_per_call": 2.9046100000000003e-05
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 68,
        "primitive_calls": 68,
        "total_time": 0.0017177490000000002,
        "cumulative_time": 0.0017177490000000002,
        "time_percent": 0.03468761450667897,
        "time_per_call": 2.5261014705882356e-05
      },
      {
        "rank": 36,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 30,
        "primitive_calls": 30,
        "total_time": 0.0015486290000000002,
        "cumulative_time": 0.0015486290000000002,
        "time_percent": 0.03127246516566957,
        "time_per_call": 5.162096666666667e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 93,
        "primitive_calls": 93,
        "total_time": 0.00135187,
        "cumulative_time": 0.00135187,
        "time_percent": 0.027299183654389606,
        "time_per_call": 1.4536236559139786e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 127,
        "primitive_calls": 127,
        "total_time": 0.001292701,
        "cumulative_time": 0.001292701,
        "time_percent": 0.02610434583888473,
        "time_per_call": 1.0178748031496064e-05
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 56,
        "primitive_calls": 56,
        "total_time": 0.0012659020000000002,
        "cumulative_time": 0.0018815750000000001,
        "time_percent": 0.03799585868797157,
        "time_per_call": 3.359955357142857e-05
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 61,
        "primitive_calls": 61,
        "total_time": 0.001164661,
        "cumulative_time": 0.001164661,
        "time_percent": 0.023518751458427994,
        "time_per_call": 1.9092803278688523e-05
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.0011125970000000001,
        "cumulative_time": 0.0011125970000000001,
        "time_percent": 0.022467389494790855,
        "time_per_call": 4.8373782608695655e-05
      },
      {
        "rank": 42,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 367,
        "function_name": "get_nn_features",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.001028143,
        "cumulative_time": 0.002165264,
        "time_percent": 0.04372457380978811,
        "time_per_call": 0.0003093234285714286
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 62,
        "primitive_calls": 62,
        "total_time": 0.001008817,
        "cumulative_time": 0.001008817,
        "time_percent": 0.020371692956179483,
        "time_per_call": 1.627124193548387e-05
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 183,
        "primitive_calls": 183,
        "total_time": 0.0009912640000000002,
        "cumulative_time": 0.0009936790000000001,
        "time_percent": 0.02006600154934292,
        "time_per_call": 5.429939890710384e-06
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 9811,
        "primitive_calls": 9811,
        "total_time": 0.0009386230000000001,
        "cumulative_time": 0.0027796490000000004,
        "time_percent": 0.056131246751344746,
        "time_per_call": 2.833196412190399e-07
      },
      {
        "rank": 46,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 451,
        "primitive_calls": 451,
        "total_time": 0.0009020260000000001,
        "cumulative_time": 0.0018410260000000002,
        "time_percent": 0.03717702655322352,
        "time_per_call": 4.08209756097561e-06
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 61,
        "primitive_calls": 61,
        "total_time": 0.000891561,
        "cumulative_time": 0.001095766,
        "time_percent": 0.02212751024598214,
        "time_per_call": 1.7963377049180327e-05
      },
      {
        "rank": 48,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 61,
        "primitive_calls": 61,
        "total_time": 0.000887842,
        "cumulative_time": 0.006213861,
        "time_percent": 0.1254805067364828,
        "time_per_call": 0.0001018665737704918
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 9321,
        "primitive_calls": 9321,
        "total_time": 0.0008675200000000001,
        "cumulative_time": 0.0008675200000000001,
        "time_percent": 0.017518391416227946,
        "time_per_call": 9.307155884561744e-08
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.ones>",
        "total_calls": 68,
        "primitive_calls": 68,
        "total_time": 0.0008501740000000001,
        "cumulative_time": 0.0008501740000000001,
        "time_percent": 0.017168112439943952,
        "time_per_call": 1.2502558823529412e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 50000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 3648,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 50000,
    "wave_size": 3648,
    "total_time_ms": 1915.0217700007488,
    "simulations_per_second": 26109.36375933755,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 35.713600158691406,
        "cpu_time_ms": 34.483567000279436,
        "memory_allocated_mb": 0.7099609375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "expansion",
        "gpu_time_ms": 39.00486373901367,
        "cpu_time_ms": 37.275529000908136,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.201568126678467,
        "cpu_time_ms": 4.23025399868493,
        "memory_allocated_mb": 0.01416015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5676159858703613,
        "cpu_time_ms": 1.7597490004845895,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "selection",
        "gpu_time_ms": 38.022369384765625,
        "cpu_time_ms": 36.54239699972095,
        "memory_allocated_mb": 0.7099609375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "expansion",
        "gpu_time_ms": 46.75183868408203,
        "cpu_time_ms": 44.597825000892044,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.210879802703857,
        "cpu_time_ms": 4.265731999112177,
        "memory_allocated_mb": 0.01416015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4963840246200562,
        "cpu_time_ms": 1.7081949990824796,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "selection",
        "gpu_time_ms": 38.26201629638672,
        "cpu_time_ms": 36.6953780012409,
        "memory_allocated_mb": 0.7099609375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "expansion",
        "gpu_time_ms": 37.68684768676758,
        "cpu_time_ms": 36.166612000670284,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.275968074798584,
        "cpu_time_ms": 4.287689000193495,
        "memory_allocated_mb": 0.01416015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.7141120433807373,
        "cpu_time_ms": 1.9672480011649895,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "selection",
        "gpu_time_ms": 44.37648010253906,
        "cpu_time_ms": 43.90605300068273,
        "memory_allocated_mb": 0.7099609375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "expansion",
        "gpu_time_ms": 56.86783981323242,
        "cpu_time_ms": 54.47062900020683,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.173920154571533,
        "cpu_time_ms": 4.275575000065146,
        "memory_allocated_mb": 0.01416015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6066559553146362,
        "cpu_time_ms": 1.82016799953999,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "selection",
        "gpu_time_ms": 53.11056137084961,
        "cpu_time_ms": 50.83109000042896,
        "memory_allocated_mb": 0.7099609375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "expansion",
        "gpu_time_ms": 61.24911880493164,
        "cpu_time_ms": 58.35164100062684,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.9446399211883545,
        "cpu_time_ms": 4.088464998858399,
        "memory_allocated_mb": 0.01416015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6394239664077759,
        "cpu_time_ms": 1.9145240003126673,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "selection",
        "gpu_time_ms": 53.72515106201172,
        "cpu_time_ms": 51.402890001554624,
        "memory_allocated_mb": 0.7099609375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "expansion",
        "gpu_time_ms": 59.83295822143555,
        "cpu_time_ms": 57.039059000089765,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.5539839267730713,
        "cpu_time_ms": 3.6356129985506414,
        "memory_allocated_mb": 0.01416015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.392416000366211,
        "cpu_time_ms": 1.5548529991065152,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "selection",
        "gpu_time_ms": 53.545440673828125,
        "cpu_time_ms": 51.25341399980243,
        "memory_allocated_mb": 0.7099609375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "expansion",
        "gpu_time_ms": 90.64278411865234,
        "cpu_time_ms": 86.21073900030751,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.162975788116455,
        "cpu_time_ms": 4.244895000738325,
        "memory_allocated_mb": 0.01416015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5820800065994263,
        "cpu_time_ms": 1.892406000479241,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "selection",
        "gpu_time_ms": 43.191680908203125,
        "cpu_time_ms": 41.34187499948894,
        "memory_allocated_mb": 0.7099609375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "expansion",
        "gpu_time_ms": 90.11180877685547,
        "cpu_time_ms": 85.89350399961404,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.236256122589111,
        "cpu_time_ms": 4.247574001055909,
        "memory_allocated_mb": 0.01416015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5537279844284058,
        "cpu_time_ms": 1.7174210006487556,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "selection",
        "gpu_time_ms": 54.7410888671875,
        "cpu_time_ms": 52.32767300003616,
        "memory_allocated_mb": 0.7099609375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "expansion",
        "gpu_time_ms": 95.96646118164062,
        "cpu_time_ms": 91.28708199932589,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.222015857696533,
        "cpu_time_ms": 4.305235999709112,
        "memory_allocated_mb": 0.01416015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4049919843673706,
        "cpu_time_ms": 1.5806210012669908,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "selection",
        "gpu_time_ms": 60.5928955078125,
        "cpu_time_ms": 57.834037999782595,
        "memory_allocated_mb": 0.7099609375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "expansion",
        "gpu_time_ms": 139.5858612060547,
        "cpu_time_ms": 132.61327100008202,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.67958402633667,
        "cpu_time_ms": 4.754659001264372,
        "memory_allocated_mb": 0.01416015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "backup",
        "gpu_time_ms": 2.136159896850586,
        "cpu_time_ms": 2.3038519993860973,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "selection",
        "gpu_time_ms": 57.5689582824707,
        "cpu_time_ms": 55.07979899994098,
        "memory_allocated_mb": 0.7099609375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "expansion",
        "gpu_time_ms": 124.29625701904297,
        "cpu_time_ms": 118.2303999994474,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.639008045196533,
        "cpu_time_ms": 3.737721999641508,
        "memory_allocated_mb": 0.01416015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6178879737854004,
        "cpu_time_ms": 1.8051179995381972,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "selection",
        "gpu_time_ms": 55.38995361328125,
        "cpu_time_ms": 52.99233100049605,
        "memory_allocated_mb": 0.7099609375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "expansion",
        "gpu_time_ms": 103.9110107421875,
        "cpu_time_ms": 98.90953899957822,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.574016094207764,
        "cpu_time_ms": 4.5767420015181415,
        "memory_allocated_mb": 0.01416015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4038399457931519,
        "cpu_time_ms": 1.6002680004021386,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "selection",
        "gpu_time_ms": 51.974815368652344,
        "cpu_time_ms": 49.811787001090124,
        "memory_allocated_mb": 0.7099609375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "expansion",
        "gpu_time_ms": 128.46156311035156,
        "cpu_time_ms": 122.17963200055237,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.5215680599212646,
        "cpu_time_ms": 3.583907000574982,
        "memory_allocated_mb": 0.01416015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5455039739608765,
        "cpu_time_ms": 1.708603998849867,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3648
      },
      {
        "name": "selection",
        "gpu_time_ms": 70.32809448242188,
        "cpu_time_ms": 67.14667599953827,
        "memory_allocated_mb": 0.501953125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2576
      },
      {
        "name": "expansion",
        "gpu_time_ms": 106.06243133544922,
        "cpu_time_ms": 100.95185599857359,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2576
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.038656234741211,
        "cpu_time_ms": 4.107847998966463,
        "memory_allocated_mb": 0.01025390625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2576
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4141440391540527,
        "cpu_time_ms": 1.5930389999994077,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 2576
      }
    ],
    "peak_gpu_memory_mb": 779.2099609375,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 188.5,
    "avg_ram_usage_mb": 1262.30078125,
    "final_tree_nodes": 5251,
    "final_tree_edges": 5250,
    "tree_memory_mb": 13.794532775878906,
    "efficiency_score": 34311.66159297356,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth"
    ],
    "cprofile_stats": "         390024 function calls (288395 primitive calls) in 1.913 seconds\n\n   Ordered by: cumulative time\n   List reduced from 214 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    1.913    1.913 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    1.913    1.913 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n       14    0.000    0.000    1.911    0.137 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n       56    0.004    0.000    1.744    0.031 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n       14    0.000    0.000    1.248    0.089 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n      173    0.178    0.001    0.635    0.004 {built-in method time.sleep}\n       14    0.000    0.000    0.571    0.041 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n       14    0.049    0.003    0.439    0.031 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n      174    0.028    0.000    0.381    0.002 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n       14    0.110    0.008    0.352    0.025 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n      101    0.063    0.001    0.331    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n      528    0.237    0.000    0.237    0.000 {built-in method torch.where}\n      101    0.133    0.001    0.223    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n       52    0.108    0.002    0.223    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n      101    0.024    0.000    0.159    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n      348    0.017    0.000    0.159    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n      174    0.017    0.000    0.136    0.001 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n      333    0.131    0.000    0.131    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n      101    0.123    0.001    0.123    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n      634    0.011    0.000    0.112    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       52    0.000    0.000    0.100    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n       66    0.098    0.001    0.100    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n      101    0.095    0.001    0.095    0.001 {built-in method torch.repeat_interleave}\n102074/634    0.065    0.000    0.083    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n      101    0.070    0.001    0.070    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n      331    0.068    0.000    0.068    0.000 {built-in method torch.tensor}\n       14    0.000    0.000    0.060    0.004 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n      348    0.001    0.000    0.058    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n      286    0.001    0.000    0.056    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       52    0.002    0.000    0.050    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n       52    0.010    0.000    0.047    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n       14    0.022    0.002    0.044    0.003 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n       14    0.027    0.002    0.043    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n       14    0.000    0.000    0.035    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n      101    0.020    0.000    0.028    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n  522/348    0.001    0.000    0.027    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n      169    0.000    0.000    0.020    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n      174    0.009    0.000    0.017    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n       14    0.007    0.000    0.017    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n      174    0.001    0.000    0.016    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n      114    0.000    0.000    0.016    0.000 {built-in method builtins.next}\n      169    0.016    0.000    0.016    0.000 {built-in method torch._C._cuda_synchronize}\n      114    0.000    0.000    0.016    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n       57    0.000    0.000    0.015    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n      174    0.001    0.000    0.015    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n       57    0.000    0.000    0.014    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n      174    0.000    0.000    0.013    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:812(bcat)\n       14    0.012    0.001    0.012    0.001 {built-in method torch.bincount}\n      522    0.001    0.000    0.012    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:765(open_binary)\n      174    0.001    0.000    0.011    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:795(cat)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 528,
        "primitive_calls": 528,
        "total_time": 0.236840193,
        "cumulative_time": 0.23692311000000002,
        "time_percent": 1.6453737121844823,
        "time_per_call": 0.0004487180113636364
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 173,
        "primitive_calls": 173,
        "total_time": 0.178339772,
        "cumulative_time": 0.63457039,
        "time_percent": 4.406937922757534,
        "time_per_call": 0.003668036936416185
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 101,
        "primitive_calls": 101,
        "total_time": 0.13270114800000002,
        "cumulative_time": 0.22295916300000002,
        "time_percent": 1.5483974766786364,
        "time_per_call": 0.002207516465346535
      },
      {
        "rank": 4,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 333,
        "primitive_calls": 333,
        "total_time": 0.130571676,
        "cumulative_time": 0.130571676,
        "time_percent": 0.9067887182734914,
        "time_per_call": 0.0003921071351351351
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 101,
        "primitive_calls": 101,
        "total_time": 0.12281931700000001,
        "cumulative_time": 0.12281931700000001,
        "time_percent": 0.8529504594982424,
        "time_per_call": 0.0012160328415841586
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.10952238900000001,
        "cumulative_time": 0.35230441300000004,
        "time_percent": 2.446668962925503,
        "time_per_call": 0.02516460092857143
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 52,
        "primitive_calls": 52,
        "total_time": 0.107566879,
        "cumulative_time": 0.222918167,
        "time_percent": 1.5481127693712542,
        "time_per_call": 0.0042868878269230765
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 66,
        "primitive_calls": 66,
        "total_time": 0.09798973400000001,
        "cumulative_time": 0.099560007,
        "time_percent": 0.6914201755274233,
        "time_per_call": 0.0015084849545454547
      },
      {
        "rank": 9,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 101,
        "primitive_calls": 101,
        "total_time": 0.095273285,
        "cumulative_time": 0.095294973,
        "time_percent": 0.6618005456602776,
        "time_per_call": 0.0009435145841584159
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 101,
        "primitive_calls": 101,
        "total_time": 0.070448573,
        "cumulative_time": 0.070448573,
        "time_percent": 0.4892483053894973,
        "time_per_call": 0.0006975106237623762
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 331,
        "primitive_calls": 331,
        "total_time": 0.06793537200000001,
        "cumulative_time": 0.06793537200000001,
        "time_percent": 0.4717947321233194,
        "time_per_call": 0.00020524281570996982
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 634,
        "primitive_calls": 102074,
        "total_time": 0.06533936600000001,
        "cumulative_time": 0.08328001700000001,
        "time_percent": 0.5783595813936292,
        "time_per_call": 0.00013135649369085174
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 101,
        "primitive_calls": 101,
        "total_time": 0.06333359000000001,
        "cumulative_time": 0.330697406,
        "time_percent": 2.2966135237714838,
        "time_per_call": 0.0032742317425742576
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.048667727,
        "cumulative_time": 0.43899765900000004,
        "time_percent": 3.0487325944232597,
        "time_per_call": 0.031356975642857145
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 174,
        "primitive_calls": 174,
        "total_time": 0.027938763000000002,
        "cumulative_time": 0.381207038,
        "time_percent": 2.64739070504735,
        "time_per_call": 0.0021908450459770116
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.026999583,
        "cumulative_time": 0.042721688,
        "time_percent": 0.29669179327988404,
        "time_per_call": 0.003051549142857143
      },
      {
        "rank": 17,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 101,
        "primitive_calls": 101,
        "total_time": 0.02401847,
        "cumulative_time": 0.158993821,
        "time_percent": 1.1041736429728828,
        "time_per_call": 0.0015741962475247526
      },
      {
        "rank": 18,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.022238203,
        "cumulative_time": 0.044051253000000005,
        "time_percent": 0.30592530072303964,
        "time_per_call": 0.003146518071428572
      },
      {
        "rank": 19,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 101,
        "primitive_calls": 101,
        "total_time": 0.020185070000000003,
        "cumulative_time": 0.028117015000000002,
        "time_percent": 0.19526587062822517,
        "time_per_call": 0.0002783862871287129
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 348,
        "primitive_calls": 348,
        "total_time": 0.017335134000000002,
        "cumulative_time": 0.158667097,
        "time_percent": 1.1019046237930326,
        "time_per_call": 0.000455939933908046
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 174,
        "primitive_calls": 174,
        "total_time": 0.016581747,
        "cumulative_time": 0.13601669900000002,
        "time_percent": 0.9446030864304851,
        "time_per_call": 0.0007817051666666667
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 169,
        "primitive_calls": 169,
        "total_time": 0.016208421,
        "cumulative_time": 0.016208421,
        "time_percent": 0.11256356473380294,
        "time_per_call": 9.590781656804734e-05
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.011985941,
        "cumulative_time": 0.011985941,
        "time_percent": 0.08323946210732326,
        "time_per_call": 0.0008561386428571428
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 634,
        "primitive_calls": 634,
        "total_time": 0.010800618000000001,
        "cumulative_time": 0.11152895800000001,
        "time_percent": 0.7745416461928395,
        "time_per_call": 0.0001759131829652997
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 52,
        "primitive_calls": 52,
        "total_time": 0.009891623,
        "cumulative_time": 0.047213967,
        "time_percent": 0.32788958472538043,
        "time_per_call": 0.0009079609038461539
      },
      {
        "rank": 26,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 522,
        "primitive_calls": 522,
        "total_time": 0.009832542000000001,
        "cumulative_time": 0.010565675,
        "time_percent": 0.07337605815019385,
        "time_per_call": 2.0240756704980844e-05
      },
      {
        "rank": 27,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 174,
        "primitive_calls": 174,
        "total_time": 0.009391346,
        "cumulative_time": 0.017185846,
        "time_percent": 0.11935154502256379,
        "time_per_call": 9.876922988505747e-05
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 106080,
        "primitive_calls": 106080,
        "total_time": 0.007585813,
        "cumulative_time": 0.007585813,
        "time_percent": 0.05268163707519837,
        "time_per_call": 7.151030354449472e-08
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 634,
        "primitive_calls": 634,
        "total_time": 0.007443756,
        "cumulative_time": 0.007443756,
        "time_percent": 0.051695085558835986,
        "time_per_call": 1.1740940063091484e-05
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 634,
        "primitive_calls": 634,
        "total_time": 0.007388952000000001,
        "cumulative_time": 0.007388952000000001,
        "time_percent": 0.05131448503015579,
        "time_per_call": 1.1654498422712935e-05
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.007139356,
        "cumulative_time": 0.007139356,
        "time_percent": 0.049581101161159644,
        "time_per_call": 0.0005099540000000001
      },
      {
        "rank": 32,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.006771061,
        "cumulative_time": 0.016796973,
        "time_percent": 0.11665091606501583,
        "time_per_call": 0.0011997837857142858
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 77635,
        "primitive_calls": 77635,
        "total_time": 0.006723527000000001,
        "cumulative_time": 0.006723527000000001,
        "time_percent": 0.046693269301431146,
        "time_per_call": 8.660432794487024e-08
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.0062214160000000004,
        "cumulative_time": 0.0062214160000000004,
        "time_percent": 0.04320622981423776,
        "time_per_call": 0.0004443868571428572
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 303,
        "primitive_calls": 303,
        "total_time": 0.0047687400000000005,
        "cumulative_time": 0.0047687400000000005,
        "time_percent": 0.03311774624367638,
        "time_per_call": 1.573841584158416e-05
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 181,
        "primitive_calls": 181,
        "total_time": 0.00446486,
        "cumulative_time": 0.004543426000000001,
        "time_percent": 0.031552994993419986,
        "time_per_call": 2.510180110497238e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 522,
        "primitive_calls": 522,
        "total_time": 0.003833817,
        "cumulative_time": 0.0040805220000000005,
        "time_percent": 0.02833823864117961,
        "time_per_call": 7.817091954022989e-06
      },
      {
        "rank": 38,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 66,
        "primitive_calls": 66,
        "total_time": 0.0036940540000000004,
        "cumulative_time": 0.0036940540000000004,
        "time_percent": 0.02565431182711528,
        "time_per_call": 5.5970515151515156e-05
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 390,
        "function_name": "_profile_phase",
        "total_calls": 56,
        "primitive_calls": 56,
        "total_time": 0.0036479660000000003,
        "cumulative_time": 1.743866445,
        "time_percent": 12.11073080276384,
        "time_per_call": 0.03114047223214286
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 174,
        "primitive_calls": 174,
        "total_time": 0.0036386070000000003,
        "cumulative_time": 0.0036386070000000003,
        "time_percent": 0.025269245818909106,
        "time_per_call": 2.0911534482758623e-05
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 202,
        "primitive_calls": 202,
        "total_time": 0.003519578,
        "cumulative_time": 0.003519578,
        "time_percent": 0.024442618194497088,
        "time_per_call": 1.7423653465346537e-05
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 174,
        "primitive_calls": 174,
        "total_time": 0.003337357,
        "cumulative_time": 0.003876519,
        "time_percent": 0.026921487133035167,
        "time_per_call": 2.2278844827586207e-05
      },
      {
        "rank": 43,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 134,
        "primitive_calls": 134,
        "total_time": 0.003278144,
        "cumulative_time": 0.005692797,
        "time_percent": 0.03953509867653975,
        "time_per_call": 4.2483559701492536e-05
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 278,
        "primitive_calls": 278,
        "total_time": 0.0028758480000000003,
        "cumulative_time": 0.0028758480000000003,
        "time_percent": 0.01997206899503522,
        "time_per_call": 1.0344776978417267e-05
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 26030,
        "primitive_calls": 26030,
        "total_time": 0.0026972180000000004,
        "cumulative_time": 0.007636973000000001,
        "time_percent": 0.053036930904978664,
        "time_per_call": 2.933912024587015e-07
      },
      {
        "rank": 46,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 1188,
        "primitive_calls": 1188,
        "total_time": 0.002553552,
        "cumulative_time": 0.0049397550000000005,
        "time_percent": 0.03430540406814623,
        "time_per_call": 4.158042929292929e-06
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 24726,
        "primitive_calls": 24726,
        "total_time": 0.002524166,
        "cumulative_time": 0.002524166,
        "time_percent": 0.017529722539898512,
        "time_per_call": 1.0208549704764216e-07
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 52,
        "primitive_calls": 52,
        "total_time": 0.0024750560000000002,
        "cumulative_time": 0.0024750560000000002,
        "time_percent": 0.01718866546443897,
        "time_per_call": 4.7597230769230777e-05
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.ones>",
        "total_calls": 181,
        "primitive_calls": 181,
        "total_time": 0.002385936,
        "cumulative_time": 0.002385936,
        "time_percent": 0.016569748613187604,
        "time_per_call": 1.318196685082873e-05
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'numpy' of 'torch._C.TensorBase' objects>",
        "total_calls": 333,
        "primitive_calls": 333,
        "total_time": 0.002383736,
        "cumulative_time": 0.002383736,
        "time_percent": 0.016554470145136068,
        "time_per_call": 7.1583663663663664e-06
      }
    ]
  },
  {
    "config": {
      "num_simulations": 1000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 4096,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 1000,
    "wave_size": 4096,
    "total_time_ms": 70.47339599921543,
    "simulations_per_second": 14189.751832182643,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 27.509023666381836,
        "cpu_time_ms": 25.633639001171105,
        "memory_allocated_mb": 0.19482421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "expansion",
        "gpu_time_ms": 37.77251052856445,
        "cpu_time_ms": 34.60607099987101,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.9531519412994385,
        "cpu_time_ms": 3.8683090006088605,
        "memory_allocated_mb": 0.00390625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4438400268554688,
        "cpu_time_ms": 1.5515919985773508,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      }
    ],
    "peak_gpu_memory_mb": 802.39697265625,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 184.5,
    "avg_ram_usage_mb": 1262.30078125,
    "final_tree_nodes": 351,
    "final_tree_edges": 350,
    "tree_memory_mb": 15.031837463378906,
    "efficiency_score": 18108.62499649518,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "cprofile_stats": "         16555 function calls (12387 primitive calls) in 0.069 seconds\n\n   Ordered by: cumulative time\n   List reduced from 214 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    0.069    0.069 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    0.069    0.069 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n        1    0.000    0.000    0.067    0.067 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n        4    0.001    0.000    0.067    0.017 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n        1    0.000    0.000    0.035    0.035 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n        1    0.005    0.005    0.034    0.034 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n        1    0.000    0.000    0.026    0.026 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n        1    0.006    0.006    0.018    0.018 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n        3    0.002    0.001    0.011    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n       19    0.008    0.000    0.008    0.000 {built-in method torch.where}\n        3    0.004    0.001    0.007    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n       13    0.006    0.000    0.006    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n        3    0.001    0.000    0.005    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n        2    0.000    0.000    0.004    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n        2    0.001    0.001    0.004    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n        1    0.000    0.000    0.004    0.004 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n        3    0.004    0.001    0.004    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n       26    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        1    0.002    0.002    0.003    0.003 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n        5    0.002    0.000    0.003    0.001 {built-in method time.sleep}\n        3    0.003    0.001    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n  4186/26    0.002    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        2    0.000    0.000    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n        1    0.002    0.002    0.003    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n        3    0.003    0.001    0.003    0.001 {built-in method torch.repeat_interleave}\n       11    0.002    0.000    0.002    0.000 {built-in method torch.tensor}\n       14    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        3    0.002    0.001    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n       12    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        2    0.000    0.000    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n       13    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:489(_extract_policy)\n       13    0.001    0.000    0.001    0.000 {built-in method torch._C._cuda_synchronize}\n       10    0.000    0.000    0.001    0.000 {built-in method builtins.next}\n       10    0.000    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n        5    0.000    0.000    0.001    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n        5    0.000    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n        6    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n        1    0.001    0.001    0.001    0.001 {built-in method torch.bincount}\n        3    0.001    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n    18/12    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n        1    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n        6    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n      2/1    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        1    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        1    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n        1    0.000    0.000    0.000    0.000 {method 'item' of 'torch._C.TensorBase' objects}\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.007617118000000001,
        "cumulative_time": 0.007626587000000001,
        "time_percent": 1.5114239706855943,
        "time_per_call": 0.0004013993157894737
      },
      {
        "rank": 2,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.006287034,
        "cumulative_time": 0.01817772,
        "time_percent": 3.602429466865184,
        "time_per_call": 0.01817772
      },
      {
        "rank": 3,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.006069955,
        "cumulative_time": 0.006069955,
        "time_percent": 1.202933302666432,
        "time_per_call": 0.0004669196153846154
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.005073439,
        "cumulative_time": 0.034319442000000006,
        "time_percent": 6.801368331516307,
        "time_per_call": 0.034319442000000006
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.00442495,
        "cumulative_time": 0.007285363,
        "time_percent": 1.4438007818367393,
        "time_per_call": 0.0024284543333333336
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.004001244,
        "cumulative_time": 0.004119093,
        "time_percent": 0.8163148073552738,
        "time_per_call": 0.001373031
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.003142976,
        "cumulative_time": 0.003142976,
        "time_percent": 0.6228696093927109,
        "time_per_call": 0.0010476586666666667
      },
      {
        "rank": 8,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0027287070000000004,
        "cumulative_time": 0.0027287070000000004,
        "time_percent": 0.5407704873461191,
        "time_per_call": 0.0009095690000000002
      },
      {
        "rank": 9,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.002322584,
        "cumulative_time": 0.0033494640000000003,
        "time_percent": 0.6637910481514803,
        "time_per_call": 0.0006698928000000001
      },
      {
        "rank": 10,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.002287097,
        "cumulative_time": 0.002287097,
        "time_percent": 0.4532529726708829,
        "time_per_call": 0.0002079179090909091
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 26,
        "primitive_calls": 4186,
        "total_time": 0.0021394680000000003,
        "cumulative_time": 0.002814996,
        "time_percent": 0.5578710938174658,
        "time_per_call": 0.00010826907692307693
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.001941809,
        "cumulative_time": 0.001941809,
        "time_percent": 0.38482438725120727,
        "time_per_call": 0.0006472696666666667
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0018362550000000002,
        "cumulative_time": 0.0027894860000000003,
        "time_percent": 0.5528155656379289,
        "time_per_call": 0.0027894860000000003
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.001819344,
        "cumulative_time": 0.010862865000000001,
        "time_percent": 2.152784010897872,
        "time_per_call": 0.0036209550000000004
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.001779795,
        "cumulative_time": 0.003432477,
        "time_percent": 0.6802424225445769,
        "time_per_call": 0.003432477
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 390,
        "function_name": "_profile_phase",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.001460111,
        "cumulative_time": 0.066776575,
        "time_percent": 13.233667449841507,
        "time_per_call": 0.01669414375
      },
      {
        "rank": 17,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0013394470000000001,
        "cumulative_time": 0.004229471,
        "time_percent": 0.8381893306559763,
        "time_per_call": 0.0021147355
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.0013246500000000001,
        "cumulative_time": 0.0013246500000000001,
        "time_percent": 0.26251687193349693,
        "time_per_call": 0.00010189615384615386
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0009017300000000001,
        "cumulative_time": 0.0009017300000000001,
        "time_percent": 0.17870330949956004,
        "time_per_call": 0.0009017300000000001
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000650582,
        "cumulative_time": 0.0006568520000000001,
        "time_percent": 0.13017380618522728,
        "time_per_call": 0.0006568520000000001
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.000533797,
        "cumulative_time": 0.000758809,
        "time_percent": 0.1503794701052994,
        "time_per_call": 0.00025293633333333337
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0005201170000000001,
        "cumulative_time": 0.0049945020000000005,
        "time_percent": 0.9898018660820551,
        "time_per_call": 0.0016648340000000002
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0004966220000000001,
        "cumulative_time": 0.001162814,
        "time_percent": 0.23044449018267263,
        "time_per_call": 0.001162814
      },
      {
        "rank": 24,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000478977,
        "cumulative_time": 0.000478977,
        "time_percent": 0.09492284284006383,
        "time_per_call": 0.000478977
      },
      {
        "rank": 25,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00047545000000000004,
        "cumulative_time": 0.00047545000000000004,
        "time_percent": 0.09422386801100752,
        "time_per_call": 0.00047545000000000004
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000402486,
        "cumulative_time": 0.0016341720000000001,
        "time_percent": 0.3238574126307376,
        "time_per_call": 0.0008170860000000001
      },
      {
        "rank": 27,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 26,
        "primitive_calls": 26,
        "total_time": 0.00038575800000000004,
        "cumulative_time": 0.003862691,
        "time_percent": 0.7655014974262417,
        "time_per_call": 0.00014856503846153848
      },
      {
        "rank": 28,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.000323431,
        "cumulative_time": 0.000926238,
        "time_percent": 0.1835602630324526,
        "time_per_call": 0.000154373
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 4467,
        "primitive_calls": 4467,
        "total_time": 0.000298602,
        "cumulative_time": 0.000298602,
        "time_percent": 0.059176433769739974,
        "time_per_call": 6.684620550705171e-08
      },
      {
        "rank": 30,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.000286746,
        "cumulative_time": 0.000434557,
        "time_percent": 0.08611976319541359,
        "time_per_call": 7.242616666666667e-05
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 26,
        "primitive_calls": 26,
        "total_time": 0.000273251,
        "cumulative_time": 0.000273251,
        "time_percent": 0.0541524159383233,
        "time_per_call": 1.0509653846153847e-05
      },
      {
        "rank": 32,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.000261922,
        "cumulative_time": 0.000261922,
        "time_percent": 0.051907254090186365,
        "time_per_call": 8.730733333333333e-05
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 26,
        "primitive_calls": 26,
        "total_time": 0.00026162200000000004,
        "cumulative_time": 0.00026162200000000004,
        "time_percent": 0.051847800603167134,
        "time_per_call": 1.0062384615384617e-05
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 3187,
        "primitive_calls": 3187,
        "total_time": 0.000251767,
        "cumulative_time": 0.000251767,
        "time_percent": 0.04989475355458477,
        "time_per_call": 7.899811735174146e-08
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.00021388400000000001,
        "cumulative_time": 0.00021388400000000001,
        "time_percent": 0.04238716539208399,
        "time_per_call": 1.1882444444444446e-05
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.000180545,
        "cumulative_time": 0.000180545,
        "time_percent": 0.03578009937963477,
        "time_per_call": 2.5792142857142856e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.000161705,
        "cumulative_time": 0.000161705,
        "time_percent": 0.03204642039482589,
        "time_per_call": 1.2438846153846153e-05
      },
      {
        "rank": 38,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 367,
        "function_name": "get_nn_features",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00012892100000000002,
        "cumulative_time": 0.00020523400000000002,
        "time_percent": 0.04067292318302895,
        "time_per_call": 0.00020523400000000002
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.00011977600000000001,
        "cumulative_time": 0.00011977600000000001,
        "time_percent": 0.023737002870725495,
        "time_per_call": 1.3308444444444445e-05
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.00011975600000000001,
        "cumulative_time": 0.00011975600000000001,
        "time_percent": 0.023733039304924212,
        "time_per_call": 2.3951200000000002e-05
      },
      {
        "rank": 41,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.00010911,
        "cumulative_time": 0.00016303700000000002,
        "time_percent": 0.03231039387719137,
        "time_per_call": 3.26074e-05
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000106496,
        "cumulative_time": 0.000106496,
        "time_percent": 0.021105195178673375,
        "time_per_call": 5.3248e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.00010434600000000001,
        "cumulative_time": 0.00010434600000000001,
        "time_percent": 0.020679111855035417,
        "time_per_call": 1.7391e-05
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 1065,
        "primitive_calls": 1065,
        "total_time": 0.00010295800000000001,
        "cumulative_time": 0.00029156900000000004,
        "time_percent": 0.05778264585571869,
        "time_per_call": 2.7377370892018785e-07
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.00010235000000000001,
        "cumulative_time": 0.00010235000000000001,
        "time_percent": 0.020283547988067346,
        "time_per_call": 1.7058333333333336e-05
      },
      {
        "rank": 46,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 46,
        "primitive_calls": 46,
        "total_time": 9.8763e-05,
        "cumulative_time": 0.00018861100000000001,
        "time_percent": 0.03737860546729233,
        "time_per_call": 4.100239130434783e-06
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 1014,
        "primitive_calls": 1014,
        "total_time": 9.526300000000001e-05,
        "cumulative_time": 9.526300000000001e-05,
        "time_percent": 0.018879058446382605,
        "time_per_call": 9.394773175542408e-08
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 9.028500000000001e-05,
        "cumulative_time": 9.028500000000001e-05,
        "time_percent": 0.01789252691844319,
        "time_per_call": 1.2897857142857144e-05
      },
      {
        "rank": 49,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1098,
        "function_name": "remove_virtual_loss",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 8.232500000000001e-05,
        "cumulative_time": 0.00010316800000000001,
        "time_percent": 0.020445657829339835,
        "time_per_call": 0.00010316800000000001
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 8.126800000000001e-05,
        "cumulative_time": 8.126800000000001e-05,
        "time_percent": 0.01610555327693461,
        "time_per_call": 1.3544666666666668e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 5000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 4096,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 5000,
    "wave_size": 4096,
    "total_time_ms": 176.42533300022478,
    "simulations_per_second": 28340.601176553424,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 47.139678955078125,
        "cpu_time_ms": 43.50339699885808,
        "memory_allocated_mb": 0.796875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "expansion",
        "gpu_time_ms": 37.72614288330078,
        "cpu_time_ms": 34.730329000012716,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.78985595703125,
        "cpu_time_ms": 4.722839001260581,
        "memory_allocated_mb": 0.015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "backup",
        "gpu_time_ms": 2.4247360229492188,
        "cpu_time_ms": 2.4471260003338102,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "selection",
        "gpu_time_ms": 36.73574447631836,
        "cpu_time_ms": 34.36773499925039,
        "memory_allocated_mb": 0.1767578125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 904
      },
      {
        "name": "expansion",
        "gpu_time_ms": 48.354366302490234,
        "cpu_time_ms": 44.25259900017409,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 904
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.531775951385498,
        "cpu_time_ms": 3.4881700012192596,
        "memory_allocated_mb": 0.00390625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 904
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4469120502471924,
        "cpu_time_ms": 2.0469470000534784,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 904
      }
    ],
    "peak_gpu_memory_mb": 461.1669921875,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 186.6,
    "avg_ram_usage_mb": 1262.30078125,
    "final_tree_nodes": 851,
    "final_tree_edges": 850,
    "tree_memory_mb": 15.031837463378906,
    "efficiency_score": 62928.995562179174,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "cprofile_stats": "         40026 function calls (29767 primitive calls) in 0.175 seconds\n\n   Ordered by: cumulative time\n   List reduced from 214 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    0.174    0.174 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    0.174    0.174 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n        2    0.000    0.000    0.173    0.087 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n        8    0.002    0.000    0.173    0.022 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n        2    0.000    0.000    0.080    0.040 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n        2    0.000    0.000    0.079    0.039 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n        2    0.012    0.006    0.068    0.034 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n        2    0.016    0.008    0.056    0.028 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n       52    0.024    0.000    0.024    0.000 {built-in method torch.where}\n        7    0.004    0.001    0.021    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n        6    0.008    0.001    0.020    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n       15    0.009    0.001    0.020    0.001 {built-in method time.sleep}\n        7    0.009    0.001    0.015    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n       16    0.005    0.000    0.014    0.001 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n        8    0.011    0.001    0.013    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n        6    0.000    0.000    0.011    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n       64    0.001    0.000    0.010    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        7    0.002    0.000    0.010    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n       27    0.009    0.000    0.009    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n        2    0.000    0.000    0.009    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n 10304/64    0.006    0.000    0.007    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        7    0.007    0.001    0.007    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n        2    0.004    0.002    0.007    0.004 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n        6    0.000    0.000    0.006    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n        2    0.004    0.002    0.006    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n       32    0.000    0.000    0.006    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        7    0.005    0.001    0.005    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n        2    0.000    0.000    0.005    0.003 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n       25    0.005    0.000    0.005    0.000 {built-in method torch.tensor}\n       32    0.000    0.000    0.005    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        6    0.001    0.000    0.005    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n        7    0.005    0.001    0.005    0.001 {built-in method torch.repeat_interleave}\n       25    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        2    0.001    0.001    0.003    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n       18    0.000    0.000    0.003    0.000 {built-in method builtins.next}\n       18    0.000    0.000    0.003    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n        9    0.000    0.000    0.003    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n        9    0.000    0.000    0.003    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n       25    0.003    0.000    0.003    0.000 {built-in method torch._C._cuda_synchronize}\n        2    0.002    0.001    0.002    0.001 {built-in method torch.bincount}\n    48/32    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n        8    0.002    0.000    0.002    0.000 {built-in method torch.full_like}\n        7    0.001    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n       16    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n       32    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n        2    0.000    0.000    0.002    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n      4/2    0.000    0.000    0.002    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        2    0.000    0.000    0.002    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        2    0.000    0.000    0.002    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n       16    0.001    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 52,
        "primitive_calls": 52,
        "total_time": 0.023768842000000002,
        "cumulative_time": 0.023768842000000002,
        "time_percent": 1.837728455852739,
        "time_per_call": 0.00045709311538461543
      },
      {
        "rank": 2,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.015603853,
        "cumulative_time": 0.056330240000000004,
        "time_percent": 4.355268337137089,
        "time_per_call": 0.028165120000000002
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.011703215000000001,
        "cumulative_time": 0.06848711,
        "time_percent": 5.295197423000947,
        "time_per_call": 0.034243555
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.011362875000000001,
        "cumulative_time": 0.013192284,
        "time_percent": 1.019983880766711,
        "time_per_call": 0.0016490355
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.009307899000000001,
        "cumulative_time": 0.014604416,
        "time_percent": 1.1291652687291638,
        "time_per_call": 0.002086345142857143
      },
      {
        "rank": 6,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 0.009155671,
        "cumulative_time": 0.009194787000000001,
        "time_percent": 0.7109105994900735,
        "time_per_call": 0.0003405476666666667
      },
      {
        "rank": 7,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 15,
        "primitive_calls": 15,
        "total_time": 0.009155135,
        "cumulative_time": 0.019502162,
        "time_percent": 1.5078428329848783,
        "time_per_call": 0.0013001441333333333
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.008369854000000001,
        "cumulative_time": 0.019983534,
        "time_percent": 1.5450609280965688,
        "time_per_call": 0.003330589
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.007445506,
        "cumulative_time": 0.007445506,
        "time_percent": 0.5756619630195826,
        "time_per_call": 0.0010636437142857143
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 64,
        "primitive_calls": 10304,
        "total_time": 0.00571638,
        "cumulative_time": 0.007490936,
        "time_percent": 0.5791744607571413,
        "time_per_call": 0.000117045875
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.0052202970000000005,
        "cumulative_time": 0.0052202970000000005,
        "time_percent": 0.4036161435589788,
        "time_per_call": 0.0007457567142857143
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.005007649,
        "cumulative_time": 0.005007649,
        "time_percent": 0.38717490167263985,
        "time_per_call": 0.00020030596
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.004787232000000001,
        "cumulative_time": 0.014172762,
        "time_percent": 1.0957912053699703,
        "time_per_call": 0.000885797625
      },
      {
        "rank": 14,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.004603157,
        "cumulative_time": 0.004603157,
        "time_percent": 0.3559009145526621,
        "time_per_call": 0.0006575938571428572
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.004089645,
        "cumulative_time": 0.007107434,
        "time_percent": 0.5495233511962954,
        "time_per_call": 0.003553717
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.004075629,
        "cumulative_time": 0.021142238,
        "time_percent": 1.6346480990959131,
        "time_per_call": 0.0030203197142857144
      },
      {
        "rank": 17,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.003941601,
        "cumulative_time": 0.005929224,
        "time_percent": 0.458428040622467,
        "time_per_call": 0.002964612
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.002587233,
        "cumulative_time": 0.002587233,
        "time_percent": 0.20003632091211043,
        "time_per_call": 0.00010348932
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0018922210000000001,
        "cumulative_time": 0.0018922210000000001,
        "time_percent": 0.14630028574644593,
        "time_per_call": 0.0009461105000000001
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 390,
        "function_name": "_profile_phase",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.0018123500000000001,
        "cumulative_time": 0.172514618,
        "time_percent": 13.338261180294989,
        "time_per_call": 0.02156432725
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full_like>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.001755124,
        "cumulative_time": 0.001755124,
        "time_percent": 0.13570039795586517,
        "time_per_call": 0.0002193905
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.001515754,
        "cumulative_time": 0.010086113,
        "time_percent": 0.7798249855439419,
        "time_per_call": 0.0014408732857142858
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.001237482,
        "cumulative_time": 0.001741679,
        "time_percent": 0.13466087490762665,
        "time_per_call": 0.0002488112857142857
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.001145736,
        "cumulative_time": 0.003132714,
        "time_percent": 0.24221111242391435,
        "time_per_call": 0.001566357
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 64,
        "primitive_calls": 64,
        "total_time": 0.001129365,
        "cumulative_time": 0.010368935000000001,
        "time_percent": 0.8016918496234449,
        "time_per_call": 0.00016201460937500002
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.000979033,
        "cumulative_time": 0.004738111000000001,
        "time_percent": 0.3663351126524749,
        "time_per_call": 0.0007896851666666667
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0009118010000000001,
        "cumulative_time": 0.0009118010000000001,
        "time_percent": 0.0704974455118589,
        "time_per_call": 0.00045590050000000003
      },
      {
        "rank": 28,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.0007872980000000001,
        "cumulative_time": 0.0013405790000000002,
        "time_percent": 0.10364914603827183,
        "time_per_call": 8.378618750000001e-05
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 10860,
        "primitive_calls": 10860,
        "total_time": 0.0007517540000000001,
        "cumulative_time": 0.0007517540000000001,
        "time_percent": 0.058123139427706236,
        "time_per_call": 6.922228360957644e-08
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 48,
        "primitive_calls": 48,
        "total_time": 0.000733475,
        "cumulative_time": 0.000785083,
        "time_percent": 0.060700027763499614,
        "time_per_call": 1.6355895833333335e-05
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 64,
        "primitive_calls": 64,
        "total_time": 0.0007309,
        "cumulative_time": 0.0007309,
        "time_percent": 0.05651077693994376,
        "time_per_call": 1.14203125e-05
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 64,
        "primitive_calls": 64,
        "total_time": 0.00070514,
        "cumulative_time": 0.00070514,
        "time_percent": 0.0545190987158735,
        "time_per_call": 1.10178125e-05
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 7841,
        "primitive_calls": 7841,
        "total_time": 0.0006850340000000001,
        "cumulative_time": 0.0006850340000000001,
        "time_percent": 0.05296456912064228,
        "time_per_call": 8.736564213748247e-08
      },
      {
        "rank": 34,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000538154,
        "cumulative_time": 0.000544588,
        "time_percent": 0.04210574769759214,
        "time_per_call": 0.000544588
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00046700400000000003,
        "cumulative_time": 0.00046700400000000003,
        "time_percent": 0.0361072087482029,
        "time_per_call": 0.00023350200000000002
      },
      {
        "rank": 36,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.00045387700000000005,
        "cumulative_time": 0.00045387700000000005,
        "time_percent": 0.03509227241096027,
        "time_per_call": 5.6734625000000006e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.00045135300000000004,
        "cumulative_time": 0.00045135300000000004,
        "time_percent": 0.03489712505701798,
        "time_per_call": 2.655017647058824e-05
      },
      {
        "rank": 38,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.00037528500000000005,
        "cumulative_time": 0.000547849,
        "time_percent": 0.04235787746035197,
        "time_per_call": 3.42405625e-05
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.000370923,
        "cumulative_time": 0.000370923,
        "time_percent": 0.028678542775885565,
        "time_per_call": 2.31826875e-05
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 34,
        "primitive_calls": 34,
        "total_time": 0.000313794,
        "cumulative_time": 0.000313794,
        "time_percent": 0.02426151695046205,
        "time_per_call": 9.229235294117648e-06
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.00030316100000000003,
        "cumulative_time": 0.00030316100000000003,
        "time_percent": 0.02343940846612436,
        "time_per_call": 5.052683333333334e-05
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 48,
        "primitive_calls": 48,
        "total_time": 0.00030183900000000004,
        "cumulative_time": 0.00030183900000000004,
        "time_percent": 0.02333719578707852,
        "time_per_call": 6.2883125000000005e-06
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 21,
        "primitive_calls": 21,
        "total_time": 0.000290403,
        "cumulative_time": 0.000290403,
        "time_percent": 0.022453001991641113,
        "time_per_call": 1.3828714285714286e-05
      },
      {
        "rank": 44,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 367,
        "function_name": "get_nn_features",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000281737,
        "cumulative_time": 0.000448655,
        "time_percent": 0.03468852459705907,
        "time_per_call": 0.0002243275
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 2620,
        "primitive_calls": 2620,
        "total_time": 0.00025383700000000003,
        "cumulative_time": 0.0007004380000000001,
        "time_percent": 0.05415555558661969,
        "time_per_call": 2.673427480916031e-07
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 2496,
        "primitive_calls": 2496,
        "total_time": 0.000245911,
        "cumulative_time": 0.000245911,
        "time_percent": 0.0190130273198502,
        "time_per_call": 9.852203525641026e-08
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.00023445400000000002,
        "cumulative_time": 0.00023445400000000002,
        "time_percent": 0.018127209873686653,
        "time_per_call": 1.6746714285714288e-05
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.000231517,
        "cumulative_time": 0.000231517,
        "time_percent": 0.017900130722130196,
        "time_per_call": 1.44698125e-05
      },
      {
        "rank": 49,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 114,
        "primitive_calls": 114,
        "total_time": 0.000230217,
        "cumulative_time": 0.00044660100000000003,
        "time_percent": 0.03452971609270191,
        "time_per_call": 3.917552631578947e-06
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.000225202,
        "cumulative_time": 0.000225202,
        "time_percent": 0.017411875753768253,
        "time_per_call": 1.608585714285714e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 4096,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 10000,
    "wave_size": 4096,
    "total_time_ms": 240.84012099956453,
    "simulations_per_second": 41521.32110919377,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 35.31184005737305,
        "cpu_time_ms": 35.6982320008683,
        "memory_allocated_mb": 0.796875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "expansion",
        "gpu_time_ms": 38.18956756591797,
        "cpu_time_ms": 35.03510800146614,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.8833279609680176,
        "cpu_time_ms": 4.0870950015232665,
        "memory_allocated_mb": 0.015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.549280047416687,
        "cpu_time_ms": 2.3679260011704173,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "selection",
        "gpu_time_ms": 38.60006332397461,
        "cpu_time_ms": 35.49537999970198,
        "memory_allocated_mb": 0.796875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "expansion",
        "gpu_time_ms": 40.43600082397461,
        "cpu_time_ms": 37.03002200018091,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.6663999557495117,
        "cpu_time_ms": 3.7401120007416466,
        "memory_allocated_mb": 0.015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6670080423355103,
        "cpu_time_ms": 1.7760279988578986,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "selection",
        "gpu_time_ms": 39.06614303588867,
        "cpu_time_ms": 36.04602999985218,
        "memory_allocated_mb": 0.3525390625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1808
      },
      {
        "name": "expansion",
        "gpu_time_ms": 39.04569625854492,
        "cpu_time_ms": 35.761839999395306,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1808
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.833631992340088,
        "cpu_time_ms": 3.7320380015444243,
        "memory_allocated_mb": 0.00732421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1808
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.501312017440796,
        "cpu_time_ms": 1.5969600008247653,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1808
      }
    ],
    "peak_gpu_memory_mb": 824.3798828125,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 184.9,
    "avg_ram_usage_mb": 1262.30078125,
    "final_tree_nodes": 651,
    "final_tree_edges": 650,
    "tree_memory_mb": 15.031837463378906,
    "efficiency_score": 51575.534170919156,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "cprofile_stats": "         54554 function calls (40609 primitive calls) in 0.239 seconds\n\n   Ordered by: cumulative time\n   List reduced from 214 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    0.239    0.239 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    0.239    0.239 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n        3    0.000    0.000    0.237    0.079 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n       12    0.002    0.000    0.233    0.019 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n        3    0.000    0.000    0.109    0.036 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n        3    0.000    0.000    0.109    0.036 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n       20    0.030    0.002    0.097    0.005 {built-in method time.sleep}\n        3    0.015    0.005    0.047    0.016 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n        3    0.007    0.002    0.044    0.015 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n        9    0.005    0.001    0.030    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n       69    0.029    0.000    0.029    0.000 {built-in method torch.where}\n        8    0.013    0.002    0.028    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n        9    0.013    0.001    0.022    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n       42    0.003    0.000    0.019    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n       11    0.014    0.001    0.016    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n        9    0.002    0.000    0.015    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n       87    0.001    0.000    0.015    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       21    0.002    0.000    0.014    0.001 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n       35    0.014    0.000    0.014    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n        8    0.000    0.000    0.013    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n        3    0.000    0.000    0.013    0.004 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n        3    0.000    0.000    0.011    0.004 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n 14007/87    0.008    0.000    0.011    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        9    0.010    0.001    0.010    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n        3    0.005    0.002    0.009    0.003 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n        8    0.000    0.000    0.009    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n       45    0.000    0.000    0.009    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        9    0.008    0.001    0.008    0.001 {built-in method torch.repeat_interleave}\n        3    0.004    0.001    0.007    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n       33    0.007    0.000    0.007    0.000 {built-in method torch.tensor}\n        8    0.001    0.000    0.007    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n       42    0.000    0.000    0.006    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        9    0.006    0.001    0.006    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n       37    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        3    0.002    0.001    0.004    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n       26    0.000    0.000    0.004    0.000 {built-in method builtins.next}\n       26    0.000    0.000    0.004    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n       37    0.003    0.000    0.003    0.000 {built-in method torch._C._cuda_synchronize}\n       13    0.000    0.000    0.003    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       13    0.000    0.000    0.003    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n        3    0.003    0.001    0.003    0.001 {built-in method torch.bincount}\n    63/42    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n       21    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n       22    0.003    0.000    0.003    0.000 {built-in method torch.zeros_like}\n        9    0.002    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n       21    0.002    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n       21    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n       21    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n       87    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n        3    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 20,
        "primitive_calls": 20,
        "total_time": 0.030427912,
        "cumulative_time": 0.097072828,
        "time_percent": 5.4751493389772685,
        "time_per_call": 0.0048536414
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 69,
        "primitive_calls": 69,
        "total_time": 0.028708808000000002,
        "cumulative_time": 0.028708808000000002,
        "time_percent": 1.6192482941160973,
        "time_per_call": 0.00041606968115942035
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.01453154,
        "cumulative_time": 0.047480140000000004,
        "time_percent": 2.6779981843688345,
        "time_per_call": 0.015826713333333336
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.014202316000000001,
        "cumulative_time": 0.015644918,
        "time_percent": 0.8824123517453677,
        "time_per_call": 0.0014222652727272729
      },
      {
        "rank": 5,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 35,
        "primitive_calls": 35,
        "total_time": 0.014014054000000001,
        "cumulative_time": 0.014014054000000001,
        "time_percent": 0.790427559136237,
        "time_per_call": 0.0004004015428571429
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.01339477,
        "cumulative_time": 0.021743076,
        "time_percent": 1.2263636554271655,
        "time_per_call": 0.0024158973333333333
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.013349306,
        "cumulative_time": 0.028031909,
        "time_percent": 1.5810695041419927,
        "time_per_call": 0.003503988625
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.009920701,
        "cumulative_time": 0.009920701,
        "time_percent": 0.5595522520714152,
        "time_per_call": 0.0011023001111111113
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 87,
        "primitive_calls": 14007,
        "total_time": 0.008319962,
        "cumulative_time": 0.010640083,
        "time_percent": 0.6001271890843982,
        "time_per_call": 0.00012229980459770116
      },
      {
        "rank": 10,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.00808295,
        "cumulative_time": 0.00808295,
        "time_percent": 0.45589851723992536,
        "time_per_call": 0.0008981055555555556
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 33,
        "primitive_calls": 33,
        "total_time": 0.007055149,
        "cumulative_time": 0.007055149,
        "time_percent": 0.39792798025556786,
        "time_per_call": 0.00021379239393939394
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0066981770000000005,
        "cumulative_time": 0.044159916,
        "time_percent": 2.4907292790181375,
        "time_per_call": 0.014719972
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.006354697,
        "cumulative_time": 0.006354697,
        "time_percent": 0.35842074240333077,
        "time_per_call": 0.0007060774444444445
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0052637560000000005,
        "cumulative_time": 0.029648763,
        "time_percent": 1.672264097847687,
        "time_per_call": 0.0032943070000000002
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.004952118,
        "cumulative_time": 0.00922001,
        "time_percent": 0.5200315340237518,
        "time_per_call": 0.003073336666666667
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.004294262,
        "cumulative_time": 0.0073496360000000005,
        "time_percent": 0.4145377807178291,
        "time_per_call": 0.0024498786666666667
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 37,
        "primitive_calls": 37,
        "total_time": 0.003178354,
        "cumulative_time": 0.0032111180000000002,
        "time_percent": 0.18111505513240028,
        "time_per_call": 8.678697297297297e-05
      },
      {
        "rank": 18,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 42,
        "primitive_calls": 42,
        "total_time": 0.003122021,
        "cumulative_time": 0.018553621000000003,
        "time_percent": 1.0464704474642974,
        "time_per_call": 0.00044175288095238104
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0029336030000000003,
        "cumulative_time": 0.0029336030000000003,
        "time_percent": 0.16546251775287452,
        "time_per_call": 0.0009778676666666669
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 22,
        "primitive_calls": 22,
        "total_time": 0.002536249,
        "cumulative_time": 0.002536249,
        "time_percent": 0.14305076221568158,
        "time_per_call": 0.00011528404545454546
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.002206675,
        "cumulative_time": 0.01492598,
        "time_percent": 0.8418624574385318,
        "time_per_call": 0.0016584422222222222
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 21,
        "primitive_calls": 21,
        "total_time": 0.00202433,
        "cumulative_time": 0.014029003000000002,
        "time_percent": 0.7912707199790256,
        "time_per_call": 0.000668047761904762
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 390,
        "function_name": "_profile_phase",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.001846837,
        "cumulative_time": 0.23313234300000002,
        "time_percent": 13.149244953187846,
        "time_per_call": 0.01942769525
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.001812112,
        "cumulative_time": 0.0038863,
        "time_percent": 0.21919700202890305,
        "time_per_call": 0.0012954333333333333
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0016897070000000001,
        "cumulative_time": 0.002441528,
        "time_percent": 0.1377082618350677,
        "time_per_call": 0.0002712808888888889
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 21,
        "primitive_calls": 21,
        "total_time": 0.0015353180000000001,
        "cumulative_time": 0.002216346,
        "time_percent": 0.12500743603395292,
        "time_per_call": 0.00010554028571428572
      },
      {
        "rank": 27,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 87,
        "primitive_calls": 87,
        "total_time": 0.0014813670000000001,
        "cumulative_time": 0.014616594,
        "time_percent": 0.8244123162580481,
        "time_per_call": 0.0001680068275862069
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0014219670000000001,
        "cumulative_time": 0.0014219670000000001,
        "time_percent": 0.08020248137921242,
        "time_per_call": 0.000473989
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0013891740000000002,
        "cumulative_time": 0.0013891740000000002,
        "time_percent": 0.07835287448125451,
        "time_per_call": 0.0004630580000000001
      },
      {
        "rank": 30,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.001284344,
        "cumulative_time": 0.0066314930000000005,
        "time_percent": 0.37403272639159524,
        "time_per_call": 0.0008289366250000001
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 87,
        "primitive_calls": 87,
        "total_time": 0.001100007,
        "cumulative_time": 0.001100007,
        "time_percent": 0.06204313527283215,
        "time_per_call": 1.2643758620689656e-05
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 14816,
        "primitive_calls": 14816,
        "total_time": 0.0009999,
        "cumulative_time": 0.0009999,
        "time_percent": 0.05639685107395213,
        "time_per_call": 6.748785097192224e-08
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 87,
        "primitive_calls": 87,
        "total_time": 0.0009574160000000001,
        "cumulative_time": 0.0009574160000000001,
        "time_percent": 0.05400064763258222,
        "time_per_call": 1.1004781609195404e-05
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 63,
        "primitive_calls": 63,
        "total_time": 0.0009084270000000001,
        "cumulative_time": 0.000915089,
        "time_percent": 0.051613299382350014,
        "time_per_call": 1.4525222222222222e-05
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 10660,
        "primitive_calls": 10660,
        "total_time": 0.000884518,
        "cumulative_time": 0.000884518,
        "time_percent": 0.049889018820112006,
        "time_per_call": 8.297542213883678e-08
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.000635633,
        "cumulative_time": 0.000635633,
        "time_percent": 0.03585128476716613,
        "time_per_call": 2.763621739130435e-05
      },
      {
        "rank": 37,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.000621544,
        "cumulative_time": 0.000621544,
        "time_percent": 0.0350566300669152,
        "time_per_call": 5.6504e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 21,
        "primitive_calls": 21,
        "total_time": 0.000553788,
        "cumulative_time": 0.000591301,
        "time_percent": 0.033350849521831157,
        "time_per_call": 2.8157190476190476e-05
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000526953,
        "cumulative_time": 0.000533041,
        "time_percent": 0.030064840377348256,
        "time_per_call": 0.000533041
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 63,
        "primitive_calls": 63,
        "total_time": 0.000513296,
        "cumulative_time": 0.0006475350000000001,
        "time_percent": 0.03652258721889349,
        "time_per_call": 1.0278333333333335e-05
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 21,
        "primitive_calls": 21,
        "total_time": 0.0004974840000000001,
        "cumulative_time": 0.0004974840000000001,
        "time_percent": 0.028059336993373343,
        "time_per_call": 2.368971428571429e-05
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 47,
        "primitive_calls": 47,
        "total_time": 0.00047796000000000004,
        "cumulative_time": 0.00047796000000000004,
        "time_percent": 0.026958134752781443,
        "time_per_call": 1.0169361702127661e-05
      },
      {
        "rank": 43,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.00045713400000000005,
        "cumulative_time": 0.0007029250000000001,
        "time_percent": 0.03964672121327913,
        "time_per_call": 3.699605263157895e-05
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 0.00041540800000000003,
        "cumulative_time": 0.00041540800000000003,
        "time_percent": 0.023430046115539862,
        "time_per_call": 1.538548148148148e-05
      },
      {
        "rank": 45,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 367,
        "function_name": "get_nn_features",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.00040566800000000003,
        "cumulative_time": 0.000666786,
        "time_percent": 0.03760839157935418,
        "time_per_call": 0.000222262
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.000371461,
        "cumulative_time": 0.000371461,
        "time_percent": 0.02095132582936427,
        "time_per_call": 4.6432625e-05
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros>",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.000350272,
        "cumulative_time": 0.000350272,
        "time_percent": 0.019756213440719435,
        "time_per_call": 1.5229217391304347e-05
      },
      {
        "rank": 48,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 152,
        "primitive_calls": 152,
        "total_time": 0.00033809300000000003,
        "cumulative_time": 0.000672746,
        "time_percent": 0.037944550427639764,
        "time_per_call": 4.42596052631579e-06
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 3393,
        "primitive_calls": 3393,
        "total_time": 0.00033342100000000003,
        "cumulative_time": 0.00033342100000000003,
        "time_percent": 0.01880577505943414,
        "time_per_call": 9.826731506041852e-08
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.000333285,
        "cumulative_time": 0.000333285,
        "time_percent": 0.018798104320614198,
        "time_per_call": 1.7541315789473686e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 25000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 4096,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 25000,
    "wave_size": 4096,
    "total_time_ms": 734.8584510000364,
    "simulations_per_second": 34020.1571690148,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 28.29465675354004,
        "cpu_time_ms": 26.35130700036825,
        "memory_allocated_mb": 0.796875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "expansion",
        "gpu_time_ms": 36.08041763305664,
        "cpu_time_ms": 33.043298000848154,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.4157121181488037,
        "cpu_time_ms": 3.334893999635824,
        "memory_allocated_mb": 0.015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.9763200283050537,
        "cpu_time_ms": 2.0592860000760993,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "selection",
        "gpu_time_ms": 42.20854568481445,
        "cpu_time_ms": 38.79737399984151,
        "memory_allocated_mb": 0.796875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "expansion",
        "gpu_time_ms": 35.7911376953125,
        "cpu_time_ms": 32.770018000519485,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.519040107727051,
        "cpu_time_ms": 4.362914000012097,
        "memory_allocated_mb": 0.015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4521600008010864,
        "cpu_time_ms": 1.562064000609098,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "selection",
        "gpu_time_ms": 36.532928466796875,
        "cpu_time_ms": 33.62021300017659,
        "memory_allocated_mb": 0.796875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "expansion",
        "gpu_time_ms": 35.42745590209961,
        "cpu_time_ms": 32.53509100068186,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 7.576735973358154,
        "cpu_time_ms": 7.157758998801,
        "memory_allocated_mb": 0.015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4837759733200073,
        "cpu_time_ms": 1.5788880009495188,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "selection",
        "gpu_time_ms": 39.5928955078125,
        "cpu_time_ms": 36.353065001094365,
        "memory_allocated_mb": 0.796875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "expansion",
        "gpu_time_ms": 46.92464065551758,
        "cpu_time_ms": 42.91558200020518,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.179808139801025,
        "cpu_time_ms": 4.030889000205207,
        "memory_allocated_mb": 0.015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5022079944610596,
        "cpu_time_ms": 1.6322680003213463,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "selection",
        "gpu_time_ms": 46.466495513916016,
        "cpu_time_ms": 42.77243100113992,
        "memory_allocated_mb": 0.796875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "expansion",
        "gpu_time_ms": 58.5918083190918,
        "cpu_time_ms": 53.53273199943942,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.4705278873443604,
        "cpu_time_ms": 3.3975779988395516,
        "memory_allocated_mb": 0.015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.8575359582901,
        "cpu_time_ms": 64.51274699975329,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "selection",
        "gpu_time_ms": 55.40729522705078,
        "cpu_time_ms": 50.82756599949789,
        "memory_allocated_mb": 0.796875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "expansion",
        "gpu_time_ms": 65.77356719970703,
        "cpu_time_ms": 60.09984099910071,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.8934080600738525,
        "cpu_time_ms": 3.7990790006006137,
        "memory_allocated_mb": 0.015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.367967963218689,
        "cpu_time_ms": 1.4819349999015685,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "selection",
        "gpu_time_ms": 50.8125114440918,
        "cpu_time_ms": 46.60177799996745,
        "memory_allocated_mb": 0.0830078125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "expansion",
        "gpu_time_ms": 93.85145568847656,
        "cpu_time_ms": 85.65799399912066,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.693023920059204,
        "cpu_time_ms": 3.60297699990042,
        "memory_allocated_mb": 0.001953125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      },
      {
        "name": "backup",
        "gpu_time_ms": 2.53657603263855,
        "cpu_time_ms": 2.575950000391458,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 424
      }
    ],
    "peak_gpu_memory_mb": 824.0830078125,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 188.0,
    "avg_ram_usage_mb": 1262.30078125,
    "final_tree_nodes": 1751,
    "final_tree_edges": 1750,
    "tree_memory_mb": 15.031837463378906,
    "efficiency_score": 42273.2183661253,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth"
    ],
    "cprofile_stats": "         159050 function calls (117855 primitive calls) in 0.733 seconds\n\n   Ordered by: cumulative time\n   List reduced from 214 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    0.733    0.733 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    0.733    0.733 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n        7    0.000    0.000    0.731    0.104 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n       28    0.002    0.000    0.731    0.026 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n        7    0.000    0.000    0.343    0.049 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n        7    0.000    0.000    0.278    0.040 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n        7    0.033    0.005    0.240    0.034 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n       66    0.114    0.002    0.225    0.003 {built-in method time.sleep}\n        7    0.048    0.007    0.171    0.024 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n       31    0.016    0.001    0.092    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n       23    0.040    0.002    0.085    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n      207    0.084    0.000    0.084    0.000 {built-in method torch.where}\n        7    0.000    0.000    0.078    0.011 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n       31    0.043    0.001    0.070    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n       31    0.007    0.000    0.049    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n       67    0.006    0.000    0.046    0.001 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n       23    0.000    0.000    0.045    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n      257    0.004    0.000    0.043    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       30    0.040    0.001    0.042    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n      109    0.039    0.000    0.039    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n        7    0.000    0.000    0.032    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n       31    0.032    0.001    0.032    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n41377/257    0.025    0.000    0.032    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       31    0.027    0.001    0.027    0.001 {built-in method torch.repeat_interleave}\n       23    0.000    0.000    0.025    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n        7    0.015    0.002    0.025    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n      123    0.001    0.000    0.022    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        7    0.012    0.002    0.022    0.003 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n      134    0.000    0.000    0.022    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n       67    0.007    0.000    0.021    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n      107    0.020    0.000    0.020    0.000 {built-in method torch.tensor}\n       31    0.019    0.001    0.019    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n       23    0.004    0.000    0.018    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n        7    0.008    0.001    0.014    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n      134    0.001    0.000    0.010    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n  201/134    0.000    0.000    0.009    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n       85    0.000    0.000    0.009    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n       31    0.006    0.000    0.008    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n       85    0.007    0.000    0.007    0.000 {built-in method torch._C._cuda_synchronize}\n       58    0.000    0.000    0.007    0.000 {built-in method builtins.next}\n       58    0.000    0.000    0.007    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n       67    0.004    0.000    0.007    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n       29    0.000    0.000    0.006    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       29    0.000    0.000    0.006    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n       67    0.000    0.000    0.006    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n       67    0.000    0.000    0.005    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n        7    0.005    0.001    0.005    0.001 {method 'item' of 'torch._C.TensorBase' objects}\n      201    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:765(open_binary)\n       67    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:812(bcat)\n      201    0.004    0.000    0.004    0.000 {built-in method _io.open}\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 66,
        "primitive_calls": 66,
        "total_time": 0.114081495,
        "cumulative_time": 0.22525472400000002,
        "time_percent": 4.165223859066115,
        "time_per_call": 0.0034129503636363637
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 207,
        "primitive_calls": 207,
        "total_time": 0.084259816,
        "cumulative_time": 0.08430082800000001,
        "time_percent": 1.558821115443638,
        "time_per_call": 0.00040725037681159425
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.047856159,
        "cumulative_time": 0.17057028000000002,
        "time_percent": 3.1540443959949442,
        "time_per_call": 0.02436718285714286
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 0.043230013000000005,
        "cumulative_time": 0.070409704,
        "time_percent": 1.30195795143716,
        "time_per_call": 0.0022712807741935483
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.040250776,
        "cumulative_time": 0.085433007,
        "time_percent": 1.579756432136635,
        "time_per_call": 0.0037144785652173913
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 30,
        "primitive_calls": 30,
        "total_time": 0.039778275,
        "cumulative_time": 0.041701417000000005,
        "time_percent": 0.7711080769398884,
        "time_per_call": 0.0013900472333333335
      },
      {
        "rank": 7,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 109,
        "primitive_calls": 109,
        "total_time": 0.038596046,
        "cumulative_time": 0.038596046,
        "time_percent": 0.7136861274652482,
        "time_per_call": 0.0003540921651376147
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.032723551000000003,
        "cumulative_time": 0.240461957,
        "time_percent": 4.446423421042793,
        "time_per_call": 0.034351708142857144
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 0.032249078,
        "cumulative_time": 0.032249078,
        "time_percent": 0.5963232501107686,
        "time_per_call": 0.0010402928387096774
      },
      {
        "rank": 10,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 0.026868948,
        "cumulative_time": 0.026868948,
        "time_percent": 0.4968383405695268,
        "time_per_call": 0.0008667402580645161
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 257,
        "primitive_calls": 41377,
        "total_time": 0.024895491000000002,
        "cumulative_time": 0.032022806,
        "time_percent": 0.5921392156261528,
        "time_per_call": 0.0001246023579766537
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 107,
        "primitive_calls": 107,
        "total_time": 0.020399419000000002,
        "cumulative_time": 0.020399419000000002,
        "time_percent": 0.3772091666760633,
        "time_per_call": 0.0001906487757009346
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 0.019379071,
        "cumulative_time": 0.019379071,
        "time_percent": 0.3583417362458345,
        "time_per_call": 0.0006251313225806452
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 0.016435106,
        "cumulative_time": 0.09176996700000001,
        "time_percent": 1.6969342498411268,
        "time_per_call": 0.0029603215161290324
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.014804238,
        "cumulative_time": 0.024624029000000002,
        "time_percent": 0.4553271570772293,
        "time_per_call": 0.0035177184285714288
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.011504608000000001,
        "cumulative_time": 0.02198077,
        "time_percent": 0.4064502001061016,
        "time_per_call": 0.00314011
      },
      {
        "rank": 17,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.008393573,
        "cumulative_time": 0.014119174000000002,
        "time_percent": 0.2610800757950184,
        "time_per_call": 0.002017024857142857
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 85,
        "primitive_calls": 85,
        "total_time": 0.007107739,
        "cumulative_time": 0.007107739,
        "time_percent": 0.13143042481459669,
        "time_per_call": 8.362045882352941e-05
      },
      {
        "rank": 19,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 0.007049988,
        "cumulative_time": 0.048975811,
        "time_percent": 0.9056201480343324,
        "time_per_call": 0.001579864870967742
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 67,
        "primitive_calls": 67,
        "total_time": 0.006503294000000001,
        "cumulative_time": 0.020618077000000002,
        "time_percent": 0.38125240937660565,
        "time_per_call": 0.00030773249253731347
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 0.006065495000000001,
        "cumulative_time": 0.008408514,
        "time_percent": 0.15548327915241172,
        "time_per_call": 0.0002712423870967742
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 67,
        "primitive_calls": 67,
        "total_time": 0.00558518,
        "cumulative_time": 0.045680035,
        "time_percent": 0.844677386943393,
        "time_per_call": 0.0006817915671641791
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.004531711,
        "cumulative_time": 0.004531711,
        "time_percent": 0.08379664783231078,
        "time_per_call": 0.0006473872857142857
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 257,
        "primitive_calls": 257,
        "total_time": 0.004283157,
        "cumulative_time": 0.043077425,
        "time_percent": 0.7965520776253782,
        "time_per_call": 0.00016761643968871595
      },
      {
        "rank": 25,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 201,
        "primitive_calls": 201,
        "total_time": 0.003828581,
        "cumulative_time": 0.004067184000000001,
        "time_percent": 0.07520699914827074,
        "time_per_call": 2.023474626865672e-05
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.0037898240000000002,
        "cumulative_time": 0.018116681000000003,
        "time_percent": 0.3349986655475859,
        "time_per_call": 0.0007876817826086958
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.003621336,
        "cumulative_time": 0.003621336,
        "time_percent": 0.06696274706716052,
        "time_per_call": 0.0005173337142857143
      },
      {
        "rank": 28,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 67,
        "primitive_calls": 67,
        "total_time": 0.003611169,
        "cumulative_time": 0.006729329,
        "time_percent": 0.12443318039494489,
        "time_per_call": 0.00010043774626865672
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.0034423640000000003,
        "cumulative_time": 0.0034423640000000003,
        "time_percent": 0.06365334502103615,
        "time_per_call": 0.0004917662857142857
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 43309,
        "primitive_calls": 43309,
        "total_time": 0.0029568610000000003,
        "cumulative_time": 0.0029568610000000003,
        "time_percent": 0.054675825511841844,
        "time_per_call": 6.827359209402203e-08
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 257,
        "primitive_calls": 257,
        "total_time": 0.002861726,
        "cumulative_time": 0.002861726,
        "time_percent": 0.05291666785780634,
        "time_per_call": 1.1135120622568094e-05
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 257,
        "primitive_calls": 257,
        "total_time": 0.002817155,
        "cumulative_time": 0.002817155,
        "time_percent": 0.052092497827869746,
        "time_per_call": 1.0961692607003892e-05
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 31478,
        "primitive_calls": 31478,
        "total_time": 0.0026650930000000003,
        "cumulative_time": 0.0026650930000000003,
        "time_percent": 0.04928069322191037,
        "time_per_call": 8.466525827562107e-08
      },
      {
        "rank": 34,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 390,
        "function_name": "_profile_phase",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.002220403,
        "cumulative_time": 0.7306431800000001,
        "time_percent": 13.510448756670417,
        "time_per_call": 0.026094399285714286
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 68,
        "primitive_calls": 68,
        "total_time": 0.001675702,
        "cumulative_time": 0.001675702,
        "time_percent": 0.03098569400517792,
        "time_per_call": 2.4642676470588237e-05
      },
      {
        "rank": 36,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 30,
        "primitive_calls": 30,
        "total_time": 0.0016312400000000002,
        "cumulative_time": 0.0016312400000000002,
        "time_percent": 0.030163539512996006,
        "time_per_call": 5.437466666666667e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full_like>",
        "total_calls": 30,
        "primitive_calls": 30,
        "total_time": 0.001537374,
        "cumulative_time": 0.001537374,
        "time_percent": 0.028427847156306075,
        "time_per_call": 5.1245799999999996e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 93,
        "primitive_calls": 93,
        "total_time": 0.0014006840000000001,
        "cumulative_time": 0.0014006840000000001,
        "time_percent": 0.02590028884727036,
        "time_per_call": 1.5061118279569894e-05
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 127,
        "primitive_calls": 127,
        "total_time": 0.001348915,
        "cumulative_time": 0.001348915,
        "time_percent": 0.024943019360837773,
        "time_per_call": 1.0621377952755905e-05
      },
      {
        "rank": 40,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 56,
        "primitive_calls": 56,
        "total_time": 0.001347796,
        "cumulative_time": 0.0020412010000000003,
        "time_percent": 0.037744198902348494,
        "time_per_call": 3.645001785714286e-05
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 67,
        "primitive_calls": 67,
        "total_time": 0.0013470790000000002,
        "cumulative_time": 0.0013470790000000002,
        "time_percent": 0.024909069568933538,
        "time_per_call": 2.010565671641791e-05
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 201,
        "primitive_calls": 201,
        "total_time": 0.001291878,
        "cumulative_time": 0.001291878,
        "time_percent": 0.02388833837998716,
        "time_per_call": 6.427253731343283e-06
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 67,
        "primitive_calls": 67,
        "total_time": 0.001286176,
        "cumulative_time": 0.0016112840000000002,
        "time_percent": 0.029794529683344118,
        "time_per_call": 2.4049014925373135e-05
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 10023,
        "primitive_calls": 10023,
        "total_time": 0.001101249,
        "cumulative_time": 0.001101249,
        "time_percent": 0.020363384741146205,
        "time_per_call": 1.0987219395390602e-07
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 62,
        "primitive_calls": 62,
        "total_time": 0.001032388,
        "cumulative_time": 0.001032388,
        "time_percent": 0.019090064141844804,
        "time_per_call": 1.665141935483871e-05
      },
      {
        "rank": 46,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 134,
        "primitive_calls": 134,
        "total_time": 0.0010250650000000001,
        "cumulative_time": 0.009572297,
        "time_percent": 0.17700299084722856,
        "time_per_call": 7.143505223880597e-05
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 10513,
        "primitive_calls": 10513,
        "total_time": 0.0010144610000000001,
        "cumulative_time": 0.002813004,
        "time_percent": 0.05201574097264401,
        "time_per_call": 2.675738609340816e-07
      },
      {
        "rank": 48,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 367,
        "function_name": "get_nn_features",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.000996228,
        "cumulative_time": 0.001582105,
        "time_percent": 0.029254975773772438,
        "time_per_call": 0.000226015
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.0009645560000000001,
        "cumulative_time": 0.0009645560000000001,
        "time_percent": 0.017835770958594305,
        "time_per_call": 4.1937217391304355e-05
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.ones>",
        "total_calls": 68,
        "primitive_calls": 68,
        "total_time": 0.000943005,
        "cumulative_time": 0.000943005,
        "time_percent": 0.017437267709504913,
        "time_per_call": 1.3867720588235294e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 50000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 4096,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 50000,
    "wave_size": 4096,
    "total_time_ms": 1815.1839160000236,
    "simulations_per_second": 27545.418158056964,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 30.859455108642578,
        "cpu_time_ms": 28.708662001008634,
        "memory_allocated_mb": 0.796875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "expansion",
        "gpu_time_ms": 42.24553680419922,
        "cpu_time_ms": 38.64971199982392,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.5241599082946777,
        "cpu_time_ms": 3.47193800007517,
        "memory_allocated_mb": 0.015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4796799421310425,
        "cpu_time_ms": 1.6017090001696488,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "selection",
        "gpu_time_ms": 42.823265075683594,
        "cpu_time_ms": 39.32331199939654,
        "memory_allocated_mb": 0.796875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "expansion",
        "gpu_time_ms": 36.92243194580078,
        "cpu_time_ms": 33.85151200018299,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 75.20764923095703,
        "cpu_time_ms": 68.66148700100894,
        "memory_allocated_mb": 0.015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5923199653625488,
        "cpu_time_ms": 1.7030179988068994,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "selection",
        "gpu_time_ms": 45.53590393066406,
        "cpu_time_ms": 41.89670300002035,
        "memory_allocated_mb": 0.796875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "expansion",
        "gpu_time_ms": 43.73654556274414,
        "cpu_time_ms": 40.02503300034732,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.059072017669678,
        "cpu_time_ms": 4.049361999932444,
        "memory_allocated_mb": 0.015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.7489919662475586,
        "cpu_time_ms": 1.8840279990399722,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "selection",
        "gpu_time_ms": 45.281951904296875,
        "cpu_time_ms": 41.629010998804006,
        "memory_allocated_mb": 0.796875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "expansion",
        "gpu_time_ms": 57.47324752807617,
        "cpu_time_ms": 52.5273470011598,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.9992001056671143,
        "cpu_time_ms": 4.037331998915761,
        "memory_allocated_mb": 0.015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5495680570602417,
        "cpu_time_ms": 1.7242169997189194,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "selection",
        "gpu_time_ms": 50.908958435058594,
        "cpu_time_ms": 46.69575700063433,
        "memory_allocated_mb": 0.796875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "expansion",
        "gpu_time_ms": 64.6127700805664,
        "cpu_time_ms": 59.09841600077925,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 7.485536098480225,
        "cpu_time_ms": 7.2863830009737285,
        "memory_allocated_mb": 0.015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4636160135269165,
        "cpu_time_ms": 2.2498939997603884,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "selection",
        "gpu_time_ms": 48.80601501464844,
        "cpu_time_ms": 44.825302000390366,
        "memory_allocated_mb": 0.796875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "expansion",
        "gpu_time_ms": 59.579105377197266,
        "cpu_time_ms": 54.425401000116835,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.8681280612945557,
        "cpu_time_ms": 3.7751380004920065,
        "memory_allocated_mb": 0.015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4591360092163086,
        "cpu_time_ms": 1.5719430011813529,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "selection",
        "gpu_time_ms": 51.8232307434082,
        "cpu_time_ms": 48.98025699912978,
        "memory_allocated_mb": 0.796875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "expansion",
        "gpu_time_ms": 94.22188568115234,
        "cpu_time_ms": 85.94870399974752,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.8222720623016357,
        "cpu_time_ms": 3.732302000571508,
        "memory_allocated_mb": 0.015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.661952018737793,
        "cpu_time_ms": 2.1719060005125357,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "selection",
        "gpu_time_ms": 42.449951171875,
        "cpu_time_ms": 39.033741000821465,
        "memory_allocated_mb": 0.796875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "expansion",
        "gpu_time_ms": 108.15673828125,
        "cpu_time_ms": 98.75443899909442,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.432831764221191,
        "cpu_time_ms": 4.353375999926357,
        "memory_allocated_mb": 0.015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4215999841690063,
        "cpu_time_ms": 1.5479560006497195,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "selection",
        "gpu_time_ms": 47.11257553100586,
        "cpu_time_ms": 43.24536100102705,
        "memory_allocated_mb": 0.796875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "expansion",
        "gpu_time_ms": 101.5638427734375,
        "cpu_time_ms": 92.67365699997754,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 79.02435302734375,
        "cpu_time_ms": 72.13738199970976,
        "memory_allocated_mb": 0.015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4878720045089722,
        "cpu_time_ms": 2.2444789992732694,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "selection",
        "gpu_time_ms": 66.24374389648438,
        "cpu_time_ms": 60.69476599986956,
        "memory_allocated_mb": 0.796875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "expansion",
        "gpu_time_ms": 136.62661743164062,
        "cpu_time_ms": 124.6232229987072,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.6939198970794678,
        "cpu_time_ms": 3.5938629989686888,
        "memory_allocated_mb": 0.015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5005120038986206,
        "cpu_time_ms": 1.629169000807451,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "selection",
        "gpu_time_ms": 47.748321533203125,
        "cpu_time_ms": 43.89775799972995,
        "memory_allocated_mb": 0.796875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "expansion",
        "gpu_time_ms": 118.10633850097656,
        "cpu_time_ms": 107.67602199848625,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.952383995056152,
        "cpu_time_ms": 4.791520001163008,
        "memory_allocated_mb": 0.015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5923199653625488,
        "cpu_time_ms": 1.7821069995989092,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "selection",
        "gpu_time_ms": 56.06499099731445,
        "cpu_time_ms": 51.398829999016016,
        "memory_allocated_mb": 0.796875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "expansion",
        "gpu_time_ms": 101.96803283691406,
        "cpu_time_ms": 93.00769899891748,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.195583820343018,
        "cpu_time_ms": 4.064855998876737,
        "memory_allocated_mb": 0.015625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6558079719543457,
        "cpu_time_ms": 1.806076999855577,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4096
      },
      {
        "name": "selection",
        "gpu_time_ms": 49.27510452270508,
        "cpu_time_ms": 45.17830700024206,
        "memory_allocated_mb": 0.16552734375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "expansion",
        "gpu_time_ms": 132.09507751464844,
        "cpu_time_ms": 120.40494600114471,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.939328193664551,
        "cpu_time_ms": 5.2559499999915715,
        "memory_allocated_mb": 0.00341796875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4069119691848755,
        "cpu_time_ms": 1.5560390002065105,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 848
      }
    ],
    "peak_gpu_memory_mb": 824.3798828125,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 188.2,
    "avg_ram_usage_mb": 1262.30078125,
    "final_tree_nodes": 4751,
    "final_tree_edges": 4750,
    "tree_memory_mb": 15.031837463378906,
    "efficiency_score": 34215.42517221484,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth"
    ],
    "cprofile_stats": "         369422 function calls (272922 primitive calls) in 1.813 seconds\n\n   Ordered by: cumulative time\n   List reduced from 214 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    1.813    1.813 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    1.813    1.813 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n       13    0.000    0.000    1.811    0.139 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n       52    0.003    0.000    1.803    0.035 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n       13    0.000    0.000    1.007    0.077 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n       13    0.079    0.006    0.700    0.054 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n       13    0.000    0.000    0.581    0.045 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n      165    0.267    0.002    0.567    0.003 {built-in method time.sleep}\n       13    0.109    0.008    0.383    0.029 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n       91    0.056    0.001    0.291    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n       91    0.125    0.001    0.208    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n      477    0.202    0.000    0.202    0.000 {built-in method torch.where}\n       13    0.000    0.000    0.195    0.015 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n       47    0.079    0.002    0.172    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n       91    0.020    0.000    0.137    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n      301    0.115    0.000    0.115    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n      166    0.017    0.000    0.113    0.001 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n       91    0.104    0.001    0.104    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n      602    0.010    0.000    0.102    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       60    0.083    0.001    0.086    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n       47    0.000    0.000    0.085    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n       91    0.083    0.001    0.083    0.001 {built-in method torch.repeat_interleave}\n96922/602    0.060    0.000    0.076    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       91    0.063    0.001    0.063    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n      299    0.062    0.000    0.062    0.000 {built-in method torch.tensor}\n      166    0.010    0.000    0.054    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n      332    0.001    0.000    0.054    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n      270    0.001    0.000    0.051    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       13    0.027    0.002    0.046    0.004 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n       47    0.010    0.000    0.042    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n       47    0.000    0.000    0.041    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n       13    0.023    0.002    0.037    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n       13    0.000    0.000    0.037    0.003 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n       91    0.019    0.000    0.027    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n  498/332    0.001    0.000    0.023    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n      332    0.001    0.000    0.022    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n      157    0.001    0.000    0.018    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n       13    0.007    0.001    0.016    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n      106    0.000    0.000    0.015    0.000 {built-in method builtins.next}\n      106    0.000    0.000    0.015    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n       53    0.000    0.000    0.014    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n      166    0.001    0.000    0.014    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n      166    0.008    0.000    0.014    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n       53    0.000    0.000    0.014    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n      157    0.013    0.000    0.013    0.000 {built-in method torch._C._cuda_synchronize}\n      166    0.001    0.000    0.012    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n       13    0.011    0.001    0.011    0.001 {built-in method torch.bincount}\n      166    0.000    0.000    0.011    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:812(bcat)\n      166    0.001    0.000    0.010    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:795(cat)\n      602    0.001    0.000    0.009    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 165,
        "primitive_calls": 165,
        "total_time": 0.266785141,
        "cumulative_time": 0.5671130200000001,
        "time_percent": 4.21756878478822,
        "time_per_call": 0.0034370486060606065
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 477,
        "primitive_calls": 477,
        "total_time": 0.20157878,
        "cumulative_time": 0.20158747400000002,
        "time_percent": 1.4991880062050185,
        "time_per_call": 0.000422615249475891
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 91,
        "primitive_calls": 91,
        "total_time": 0.12460027800000001,
        "cumulative_time": 0.20763598100000002,
        "time_percent": 1.5441702115470384,
        "time_per_call": 0.002281714076923077
      },
      {
        "rank": 4,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 301,
        "primitive_calls": 301,
        "total_time": 0.11469404700000001,
        "cumulative_time": 0.114701046,
        "time_percent": 0.8530214157173779,
        "time_per_call": 0.00038106659800664453
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.108945998,
        "cumulative_time": 0.38261253500000003,
        "time_percent": 2.8454551868421043,
        "time_per_call": 0.029431733461538465
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 91,
        "primitive_calls": 91,
        "total_time": 0.104021942,
        "cumulative_time": 0.104059855,
        "time_percent": 0.7738838304181207,
        "time_per_call": 0.00114351489010989
      },
      {
        "rank": 7,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 91,
        "primitive_calls": 91,
        "total_time": 0.082958327,
        "cumulative_time": 0.082958327,
        "time_percent": 0.6169536548348928,
        "time_per_call": 0.000911629967032967
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 60,
        "primitive_calls": 60,
        "total_time": 0.082675366,
        "cumulative_time": 0.085587647,
        "time_percent": 0.6365076724048288,
        "time_per_call": 0.0014264607833333334
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.079269685,
        "cumulative_time": 0.699907311,
        "time_percent": 5.2051480445972835,
        "time_per_call": 0.05383902392307693
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 47,
        "primitive_calls": 47,
        "total_time": 0.07876828200000001,
        "cumulative_time": 0.17185519500000002,
        "time_percent": 1.2780717077095012,
        "time_per_call": 0.0036564935106382984
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 91,
        "primitive_calls": 91,
        "total_time": 0.062671113,
        "cumulative_time": 0.062671113,
        "time_percent": 0.4660794596053096,
        "time_per_call": 0.0006886935494505495
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 299,
        "primitive_calls": 299,
        "total_time": 0.062155054,
        "cumulative_time": 0.062155054,
        "time_percent": 0.4622415749989766,
        "time_per_call": 0.0002078764347826087
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 602,
        "primitive_calls": 96922,
        "total_time": 0.059684037,
        "cumulative_time": 0.076062551,
        "time_percent": 0.5656703857530232,
        "time_per_call": 0.00012634975249169436
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 91,
        "primitive_calls": 91,
        "total_time": 0.055987565,
        "cumulative_time": 0.29113979,
        "time_percent": 2.165180567206511,
        "time_per_call": 0.003199338351648352
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.027266384,
        "cumulative_time": 0.04599331,
        "time_percent": 0.34204813101467474,
        "time_per_call": 0.003537946923076923
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.022776951,
        "cumulative_time": 0.03656572,
        "time_percent": 0.27193598776008754,
        "time_per_call": 0.0028127476923076925
      },
      {
        "rank": 17,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 91,
        "primitive_calls": 91,
        "total_time": 0.019965137,
        "cumulative_time": 0.13712297,
        "time_percent": 1.0197712582043197,
        "time_per_call": 0.0015068458241758243
      },
      {
        "rank": 18,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 91,
        "primitive_calls": 91,
        "total_time": 0.019249873,
        "cumulative_time": 0.026623714000000003,
        "time_percent": 0.19799817874315268,
        "time_per_call": 0.0002925682857142858
      },
      {
        "rank": 19,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 166,
        "primitive_calls": 166,
        "total_time": 0.017287096000000002,
        "cumulative_time": 0.11321644800000001,
        "time_percent": 0.841980593232366,
        "time_per_call": 0.000682026795180723
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 157,
        "primitive_calls": 157,
        "total_time": 0.012544504000000001,
        "cumulative_time": 0.012574854000000002,
        "time_percent": 0.09351806400718729,
        "time_per_call": 8.009461146496816e-05
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.011428487000000001,
        "cumulative_time": 0.011428487000000001,
        "time_percent": 0.08499263520445707,
        "time_per_call": 0.0008791143846153847
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 166,
        "primitive_calls": 166,
        "total_time": 0.010282144,
        "cumulative_time": 0.053674953000000004,
        "time_percent": 0.3991758226566105,
        "time_per_call": 0.00032334309036144584
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 602,
        "primitive_calls": 602,
        "total_time": 0.009958719000000001,
        "cumulative_time": 0.10221426500000001,
        "time_percent": 0.7601583427304685,
        "time_per_call": 0.00016979113787375416
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 47,
        "primitive_calls": 47,
        "total_time": 0.009799955,
        "cumulative_time": 0.042444322,
        "time_percent": 0.3156546248201106,
        "time_per_call": 0.0009030706808510639
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 166,
        "primitive_calls": 166,
        "total_time": 0.008309977000000001,
        "cumulative_time": 0.013656854000000001,
        "time_percent": 0.1015648011904402,
        "time_per_call": 8.227020481927712e-05
      },
      {
        "rank": 26,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 498,
        "primitive_calls": 498,
        "total_time": 0.007940845,
        "cumulative_time": 0.00806054,
        "time_percent": 0.059945514727446796,
        "time_per_call": 1.618582329317269e-05
      },
      {
        "rank": 27,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.007209053000000001,
        "cumulative_time": 0.016066297,
        "time_percent": 0.1194836131858454,
        "time_per_call": 0.0012358690000000001
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 602,
        "primitive_calls": 602,
        "total_time": 0.007020519,
        "cumulative_time": 0.007020519,
        "time_percent": 0.05221097161093674,
        "time_per_call": 1.166199169435216e-05
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 100660,
        "primitive_calls": 100660,
        "total_time": 0.006910249,
        "cumulative_time": 0.006910249,
        "time_percent": 0.051390903487833886,
        "time_per_call": 6.864940393403537e-08
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 602,
        "primitive_calls": 602,
        "total_time": 0.006795461,
        "cumulative_time": 0.006795461,
        "time_percent": 0.0505372354029991,
        "time_per_call": 1.1288141196013289e-05
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.006221269000000001,
        "cumulative_time": 0.006221269000000001,
        "time_percent": 0.046267020877374006,
        "time_per_call": 0.0004785591538461539
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 73715,
        "primitive_calls": 73715,
        "total_time": 0.0061483760000000005,
        "cumulative_time": 0.0061483760000000005,
        "time_percent": 0.04572492215879835,
        "time_per_call": 8.340739333921184e-08
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.005817366,
        "cumulative_time": 0.005846849,
        "time_percent": 0.0434824928402635,
        "time_per_call": 0.0004497576153846154
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 273,
        "primitive_calls": 273,
        "total_time": 0.004161062,
        "cumulative_time": 0.004315785,
        "time_percent": 0.032096106871002936,
        "time_per_call": 1.5808736263736263e-05
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 164,
        "primitive_calls": 164,
        "total_time": 0.004084422,
        "cumulative_time": 0.004084422,
        "time_percent": 0.030375480942233114,
        "time_per_call": 2.490501219512195e-05
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 166,
        "primitive_calls": 166,
        "total_time": 0.004054865,
        "cumulative_time": 0.0053318540000000005,
        "time_percent": 0.03965252110672438,
        "time_per_call": 3.211960240963856e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 166,
        "primitive_calls": 166,
        "total_time": 0.0037656910000000003,
        "cumulative_time": 0.0037656910000000003,
        "time_percent": 0.028005107015102445,
        "time_per_call": 2.2684885542168675e-05
      },
      {
        "rank": 38,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 60,
        "primitive_calls": 60,
        "total_time": 0.003393856,
        "cumulative_time": 0.003393856,
        "time_percent": 0.025239803391687618,
        "time_per_call": 5.656426666666667e-05
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 390,
        "function_name": "_profile_phase",
        "total_calls": 52,
        "primitive_calls": 52,
        "total_time": 0.0031837170000000004,
        "cumulative_time": 1.803497528,
        "time_percent": 13.41244973979881,
        "time_per_call": 0.03468264476923077
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 182,
        "primitive_calls": 182,
        "total_time": 0.0030463950000000004,
        "cumulative_time": 0.0030463950000000004,
        "time_percent": 0.022655767025301074,
        "time_per_call": 1.6738434065934066e-05
      },
      {
        "rank": 41,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 123,
        "primitive_calls": 123,
        "total_time": 0.0030260730000000002,
        "cumulative_time": 0.005858151000000001,
        "time_percent": 0.043566544802966956,
        "time_per_call": 4.762724390243903e-05
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 253,
        "primitive_calls": 253,
        "total_time": 0.0029328450000000003,
        "cumulative_time": 0.0029328450000000003,
        "time_percent": 0.02181130583569075,
        "time_per_call": 1.1592272727272728e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 498,
        "primitive_calls": 498,
        "total_time": 0.002786242,
        "cumulative_time": 0.0028223220000000004,
        "time_percent": 0.020989356174226183,
        "time_per_call": 5.667313253012049e-06
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 24658,
        "primitive_calls": 24658,
        "total_time": 0.002426179,
        "cumulative_time": 0.006833342,
        "time_percent": 0.05081895301042868,
        "time_per_call": 2.771247465325655e-07
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 23478,
        "primitive_calls": 23478,
        "total_time": 0.002333668,
        "cumulative_time": 0.002333668,
        "time_percent": 0.0173552801007093,
        "time_per_call": 9.939807479342364e-08
      },
      {
        "rank": 46,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 1075,
        "primitive_calls": 1075,
        "total_time": 0.00230911,
        "cumulative_time": 0.004407163,
        "time_percent": 0.03277567688055126,
        "time_per_call": 4.099686511627907e-06
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 47,
        "primitive_calls": 47,
        "total_time": 0.0022965200000000002,
        "cumulative_time": 0.0022965200000000002,
        "time_percent": 0.017079013748691294,
        "time_per_call": 4.8862127659574474e-05
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.ones>",
        "total_calls": 164,
        "primitive_calls": 164,
        "total_time": 0.002240941,
        "cumulative_time": 0.00236722,
        "time_percent": 0.017604803322495345,
        "time_per_call": 1.4434268292682929e-05
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full_like>",
        "total_calls": 60,
        "primitive_calls": 60,
        "total_time": 0.002195676,
        "cumulative_time": 0.002195676,
        "time_percent": 0.01632904594415529,
        "time_per_call": 3.6594600000000004e-05
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'numpy' of 'torch._C.TensorBase' objects>",
        "total_calls": 301,
        "primitive_calls": 301,
        "total_time": 0.0021240770000000003,
        "cumulative_time": 0.0021240770000000003,
        "time_percent": 0.015796570587793254,
        "time_per_call": 7.0567342192691035e-06
      }
    ]
  },
  {
    "config": {
      "num_simulations": 1000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 4864,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 1000,
    "wave_size": 4864,
    "total_time_ms": 73.5158980005508,
    "simulations_per_second": 13602.499965279723,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 29.4006404876709,
        "cpu_time_ms": 27.384122999137617,
        "memory_allocated_mb": 0.19482421875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "expansion",
        "gpu_time_ms": 38.5546875,
        "cpu_time_ms": 35.33699000035995,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.230432033538818,
        "cpu_time_ms": 4.0836669995769626,
        "memory_allocated_mb": 0.00390625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6332800388336182,
        "cpu_time_ms": 1.7388079995726002,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      }
    ],
    "peak_gpu_memory_mb": 662.95849609375,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 183.5,
    "avg_ram_usage_mb": 1262.30078125,
    "final_tree_nodes": 351,
    "final_tree_edges": 350,
    "tree_memory_mb": 17.152931213378906,
    "efficiency_score": 21010.30463674263,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "cprofile_stats": "         16555 function calls (12387 primitive calls) in 0.072 seconds\n\n   Ordered by: cumulative time\n   List reduced from 214 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    0.072    0.072 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    0.072    0.072 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n        1    0.000    0.000    0.070    0.070 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n        4    0.002    0.000    0.070    0.017 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n        1    0.000    0.000    0.036    0.036 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n        1    0.000    0.000    0.028    0.028 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n        1    0.002    0.002    0.020    0.020 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n        1    0.006    0.006    0.019    0.019 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n        5    0.005    0.001    0.017    0.003 {built-in method time.sleep}\n        3    0.002    0.001    0.010    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n       19    0.008    0.000    0.008    0.000 {built-in method torch.where}\n        3    0.005    0.002    0.008    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n        2    0.003    0.001    0.006    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n       13    0.005    0.000    0.005    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n        2    0.000    0.000    0.005    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n        3    0.001    0.000    0.005    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n        3    0.005    0.002    0.005    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n        1    0.000    0.000    0.004    0.004 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n       26    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        3    0.004    0.001    0.004    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n        2    0.000    0.000    0.003    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n        1    0.002    0.002    0.003    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n  4186/26    0.002    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        3    0.003    0.001    0.003    0.001 {built-in method torch.repeat_interleave}\n       14    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        1    0.001    0.001    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n       11    0.002    0.000    0.002    0.000 {built-in method torch.tensor}\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n        3    0.002    0.001    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n       12    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n       13    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        2    0.000    0.000    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n       13    0.001    0.000    0.001    0.000 {built-in method torch._C._cuda_synchronize}\n       10    0.000    0.000    0.001    0.000 {built-in method builtins.next}\n       10    0.000    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n        1    0.001    0.001    0.001    0.001 {built-in method torch.bincount}\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:489(_extract_policy)\n        5    0.000    0.000    0.001    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n        5    0.000    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n        3    0.001    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n    18/12    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n        6    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n        6    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n       12    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n        1    0.001    0.001    0.001    0.001 {method 'item' of 'torch._C.TensorBase' objects}\n        6    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n        1    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n      2/1    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.007889175,
        "cumulative_time": 0.007889175,
        "time_percent": 1.501950815489799,
        "time_per_call": 0.00041521973684210527
      },
      {
        "rank": 2,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0060562820000000005,
        "cumulative_time": 0.018878201,
        "time_percent": 3.5940550674728775,
        "time_per_call": 0.018878201
      },
      {
        "rank": 3,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.0052034460000000005,
        "cumulative_time": 0.0052034460000000005,
        "time_percent": 0.990638433430255,
        "time_per_call": 0.000400265076923077
      },
      {
        "rank": 4,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.005115892,
        "cumulative_time": 0.016559612,
        "time_percent": 3.1526392490462767,
        "time_per_call": 0.0033119224000000003
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.004850649,
        "cumulative_time": 0.007659667,
        "time_percent": 1.458256800873387,
        "time_per_call": 0.0025532223333333335
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.004505837,
        "cumulative_time": 0.004595481,
        "time_percent": 0.8748933108364153,
        "time_per_call": 0.0015318270000000001
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.003932578,
        "cumulative_time": 0.003932578,
        "time_percent": 0.7486890244008078,
        "time_per_call": 0.0013108593333333333
      },
      {
        "rank": 8,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0029541180000000004,
        "cumulative_time": 0.0029541180000000004,
        "time_percent": 0.562408609157877,
        "time_per_call": 0.0009847060000000001
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.002510708,
        "cumulative_time": 0.005951343,
        "time_percent": 1.1330239818624264,
        "time_per_call": 0.0029756715
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 26,
        "primitive_calls": 4186,
        "total_time": 0.0024040570000000002,
        "cumulative_time": 0.00309725,
        "time_percent": 0.5896582549221915,
        "time_per_call": 0.00011912500000000001
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.00217103,
        "cumulative_time": 0.00217103,
        "time_percent": 0.413323354970934,
        "time_per_call": 0.00019736636363636365
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0019803480000000003,
        "cumulative_time": 0.020498291000000002,
        "time_percent": 3.902489789312217,
        "time_per_call": 0.020498291000000002
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0019575860000000003,
        "cumulative_time": 0.003283601,
        "time_percent": 0.6251359869305877,
        "time_per_call": 0.003283601
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.001925732,
        "cumulative_time": 0.009606771,
        "time_percent": 1.8289488492362953,
        "time_per_call": 0.003202257
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0019014720000000002,
        "cumulative_time": 0.0019014720000000002,
        "time_percent": 0.3620045722183903,
        "time_per_call": 0.0006338240000000001
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 390,
        "function_name": "_profile_phase",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00160322,
        "cumulative_time": 0.06974253000000001,
        "time_percent": 13.277668426397154,
        "time_per_call": 0.017435632500000003
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.001477294,
        "cumulative_time": 0.001477294,
        "time_percent": 0.2812490441672528,
        "time_per_call": 0.00011363800000000001
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0012719060000000002,
        "cumulative_time": 0.0012719060000000002,
        "time_percent": 0.24214702474293806,
        "time_per_call": 0.0012719060000000002
      },
      {
        "rank": 19,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.001026638,
        "cumulative_time": 0.002379449,
        "time_percent": 0.45300241989389084,
        "time_per_call": 0.002379449
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.00073041,
        "cumulative_time": 0.004662988000000001,
        "time_percent": 0.8877453763187085,
        "time_per_call": 0.0015543293333333335
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0007064580000000001,
        "cumulative_time": 0.00098504,
        "time_percent": 0.18753312371573344,
        "time_per_call": 0.00032834666666666667
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000623576,
        "cumulative_time": 0.001282706,
        "time_percent": 0.24420314199313084,
        "time_per_call": 0.001282706
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000519251,
        "cumulative_time": 0.000519251,
        "time_percent": 0.09885564243332079,
        "time_per_call": 0.000519251
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000518769,
        "cumulative_time": 0.0005249930000000001,
        "time_percent": 0.09994881143800664,
        "time_per_call": 0.0005249930000000001
      },
      {
        "rank": 25,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00046372000000000004,
        "cumulative_time": 0.00046372000000000004,
        "time_percent": 0.08828358252401924,
        "time_per_call": 0.00046372000000000004
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 26,
        "primitive_calls": 26,
        "total_time": 0.00044255900000000003,
        "cumulative_time": 0.004288895,
        "time_percent": 0.8165250920153402,
        "time_per_call": 0.0001649575
      },
      {
        "rank": 27,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00033956300000000003,
        "cumulative_time": 0.0017057620000000002,
        "time_percent": 0.3247450623077205,
        "time_per_call": 0.0008528810000000001
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 26,
        "primitive_calls": 26,
        "total_time": 0.000311739,
        "cumulative_time": 0.000311739,
        "time_percent": 0.05934925328313472,
        "time_per_call": 1.1989961538461539e-05
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 4467,
        "primitive_calls": 4467,
        "total_time": 0.00030244,
        "cumulative_time": 0.00030244,
        "time_percent": 0.05757889825447334,
        "time_per_call": 6.770539511976719e-08
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 26,
        "primitive_calls": 26,
        "total_time": 0.000293685,
        "cumulative_time": 0.000293685,
        "time_percent": 0.05591211061322909,
        "time_per_call": 1.1295576923076924e-05
      },
      {
        "rank": 31,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.000277925,
        "cumulative_time": 0.000503704,
        "time_percent": 0.09589578549917749,
        "time_per_call": 8.395066666666666e-05
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 3187,
        "primitive_calls": 3187,
        "total_time": 0.000264963,
        "cumulative_time": 0.000264963,
        "time_percent": 0.050443981015077445,
        "time_per_call": 8.313868842171321e-08
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.00024651400000000003,
        "cumulative_time": 0.00024651400000000003,
        "time_percent": 0.046931637760558274,
        "time_per_call": 1.3695222222222223e-05
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.000214422,
        "cumulative_time": 0.000214422,
        "time_percent": 0.04082192342785572,
        "time_per_call": 3.063171428571429e-05
      },
      {
        "rank": 35,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.000203995,
        "cumulative_time": 0.000203995,
        "time_percent": 0.03883681837528531,
        "time_per_call": 6.799833333333333e-05
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.000152628,
        "cumulative_time": 0.000152628,
        "time_percent": 0.02905750589466922,
        "time_per_call": 1.6958666666666667e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.0001482,
        "cumulative_time": 0.0001482,
        "time_percent": 0.028214497822090165,
        "time_per_call": 2.47e-05
      },
      {
        "rank": 38,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 367,
        "function_name": "get_nn_features",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00013674500000000002,
        "cumulative_time": 0.00021874100000000003,
        "time_percent": 0.041644179946705974,
        "time_per_call": 0.00021874100000000003
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.00013555000000000002,
        "cumulative_time": 0.00013555000000000002,
        "time_percent": 0.025806175302188414,
        "time_per_call": 2.259166666666667e-05
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.00013100200000000002,
        "cumulative_time": 0.00013100200000000002,
        "time_percent": 0.024940321482384998,
        "time_per_call": 1.0077076923076924e-05
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.000122745,
        "cumulative_time": 0.000122745,
        "time_percent": 0.023368343692121846,
        "time_per_call": 2.4549e-05
      },
      {
        "rank": 42,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.00011871700000000001,
        "cumulative_time": 0.00017969600000000002,
        "time_percent": 0.034210744943578376,
        "time_per_call": 3.59392e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 1065,
        "primitive_calls": 1065,
        "total_time": 0.00010477900000000001,
        "cumulative_time": 0.000299652,
        "time_percent": 0.05704811539396061,
        "time_per_call": 2.813633802816902e-07
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000103323,
        "cumulative_time": 0.000103323,
        "time_percent": 0.01967075950385845,
        "time_per_call": 5.16615e-05
      },
      {
        "rank": 45,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 46,
        "primitive_calls": 46,
        "total_time": 0.00010212,
        "cumulative_time": 0.000194873,
        "time_percent": 0.03710016082377987,
        "time_per_call": 4.236369565217391e-06
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'numpy' of 'torch._C.TensorBase' objects>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 9.7645e-05,
        "cumulative_time": 9.7645e-05,
        "time_percent": 0.018589774897692268,
        "time_per_call": 7.5111538461538464e-06
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 1014,
        "primitive_calls": 1014,
        "total_time": 9.692300000000001e-05,
        "cumulative_time": 9.692300000000001e-05,
        "time_percent": 0.018452319651892344,
        "time_per_call": 9.558481262327417e-08
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 9.681800000000001e-05,
        "cumulative_time": 9.681800000000001e-05,
        "time_percent": 0.018432329623071026,
        "time_per_call": 1.6136333333333333e-05
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.ones>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 9.135500000000001e-05,
        "cumulative_time": 9.135500000000001e-05,
        "time_percent": 0.017392276980681833,
        "time_per_call": 1.3050714285714286e-05
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 8.789400000000001e-05,
        "cumulative_time": 8.789400000000001e-05,
        "time_percent": 0.016733367554485786,
        "time_per_call": 4.8830000000000005e-06
      }
    ]
  },
  {
    "config": {
      "num_simulations": 5000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 4864,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 5000,
    "wave_size": 4864,
    "total_time_ms": 176.08289700001478,
    "simulations_per_second": 28395.71636534115,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 38.000606536865234,
        "cpu_time_ms": 39.42979900057253,
        "memory_allocated_mb": 0.9462890625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "expansion",
        "gpu_time_ms": 44.28656005859375,
        "cpu_time_ms": 40.560049999839975,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.070047855377197,
        "cpu_time_ms": 3.990379000242683,
        "memory_allocated_mb": 0.0185546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "backup",
        "gpu_time_ms": 2.4821760654449463,
        "cpu_time_ms": 2.7105959998152684,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "selection",
        "gpu_time_ms": 40.93904113769531,
        "cpu_time_ms": 37.726454000221565,
        "memory_allocated_mb": 0.02734375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 136
      },
      {
        "name": "expansion",
        "gpu_time_ms": 42.42851257324219,
        "cpu_time_ms": 38.86467300071672,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 136
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.033184051513672,
        "cpu_time_ms": 3.9574410002387594,
        "memory_allocated_mb": 0.0009765625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 136
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5915839672088623,
        "cpu_time_ms": 1.6931659993133508,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 136
      }
    ],
    "peak_gpu_memory_mb": 902.43017578125,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 183.3,
    "avg_ram_usage_mb": 1262.30078125,
    "final_tree_nodes": 501,
    "final_tree_edges": 500,
    "tree_memory_mb": 17.152931213378906,
    "efficiency_score": 32221.012038894503,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "cprofile_stats": "         39837 function calls (29578 primitive calls) in 0.174 seconds\n\n   Ordered by: cumulative time\n   List reduced from 214 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    0.174    0.174 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    0.174    0.174 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n        2    0.000    0.000    0.172    0.086 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n        8    0.002    0.000    0.172    0.021 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n        2    0.000    0.000    0.080    0.040 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n        2    0.000    0.000    0.078    0.039 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n        2    0.009    0.005    0.073    0.037 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n        2    0.014    0.007    0.056    0.028 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n        5    0.012    0.002    0.023    0.005 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n        6    0.004    0.001    0.022    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n       44    0.022    0.000    0.022    0.000 {built-in method torch.where}\n       15    0.008    0.001    0.021    0.001 {built-in method time.sleep}\n        7    0.016    0.002    0.020    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n        6    0.007    0.001    0.012    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n        6    0.002    0.000    0.011    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n       64    0.001    0.000    0.010    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        6    0.010    0.002    0.010    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n       24    0.010    0.000    0.010    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n        5    0.000    0.000    0.009    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n        2    0.000    0.000    0.009    0.004 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n 10304/64    0.006    0.000    0.008    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        5    0.001    0.000    0.007    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n        2    0.004    0.002    0.007    0.004 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n        6    0.006    0.001    0.006    0.001 {built-in method torch.repeat_interleave}\n       16    0.000    0.000    0.006    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n       32    0.000    0.000    0.006    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        2    0.003    0.002    0.006    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n        2    0.000    0.000    0.005    0.003 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n       32    0.000    0.000    0.005    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n       22    0.005    0.000    0.005    0.000 {built-in method torch.tensor}\n        6    0.004    0.001    0.004    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n        7    0.004    0.001    0.004    0.001 {built-in method torch.full_like}\n        5    0.001    0.000    0.004    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n       25    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n       25    0.003    0.000    0.003    0.000 {built-in method torch._C._cuda_synchronize}\n        2    0.001    0.000    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n       18    0.000    0.000    0.002    0.000 {built-in method builtins.next}\n       18    0.000    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n       16    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n        2    0.002    0.001    0.002    0.001 {built-in method torch.bincount}\n        9    0.000    0.000    0.002    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n        9    0.000    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n    48/32    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n       32    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n        6    0.001    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n        2    0.000    0.000    0.002    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n      4/2    0.000    0.000    0.002    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:489(_extract_policy)\n        2    0.000    0.000    0.002    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        2    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 44,
        "primitive_calls": 44,
        "total_time": 0.021633507,
        "cumulative_time": 0.021633507,
        "time_percent": 1.6632461387440276,
        "time_per_call": 0.0004916706136363637
      },
      {
        "rank": 2,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.016401657,
        "cumulative_time": 0.020238729,
        "time_percent": 1.5560116010010199,
        "time_per_call": 0.002891247
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.013923343000000001,
        "cumulative_time": 0.055720014000000005,
        "time_percent": 4.283914676259524,
        "time_per_call": 0.027860007000000003
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.011734671,
        "cumulative_time": 0.023100848,
        "time_percent": 1.7760595282915843,
        "time_per_call": 0.0046201696
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.009949880000000001,
        "cumulative_time": 0.009949880000000001,
        "time_percent": 0.7649753454660138,
        "time_per_call": 0.0016583133333333336
      },
      {
        "rank": 6,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 24,
        "primitive_calls": 24,
        "total_time": 0.009686977000000001,
        "cumulative_time": 0.009686977000000001,
        "time_percent": 0.7447626079004298,
        "time_per_call": 0.0004036240416666667
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.009153248000000001,
        "cumulative_time": 0.07308693000000001,
        "time_percent": 5.619133047413674,
        "time_per_call": 0.036543465000000004
      },
      {
        "rank": 8,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 15,
        "primitive_calls": 15,
        "total_time": 0.007772333,
        "cumulative_time": 0.021317687000000002,
        "time_percent": 1.6389649902673549,
        "time_per_call": 0.0014211791333333334
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.007375966,
        "cumulative_time": 0.012096388000000001,
        "time_percent": 0.9300050442006278,
        "time_per_call": 0.002016064666666667
      },
      {
        "rank": 10,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.0064480380000000006,
        "cumulative_time": 0.0064480380000000006,
        "time_percent": 0.49574367697178096,
        "time_per_call": 0.0010746730000000002
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 64,
        "primitive_calls": 10304,
        "total_time": 0.005965265,
        "cumulative_time": 0.0077036940000000005,
        "time_percent": 0.5922821158661669,
        "time_per_call": 0.00012037021875000001
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 22,
        "primitive_calls": 22,
        "total_time": 0.004544665000000001,
        "cumulative_time": 0.004544665000000001,
        "time_percent": 0.34940689519896734,
        "time_per_call": 0.00020657568181818185
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.00431503,
        "cumulative_time": 0.00431503,
        "time_percent": 0.3317518970023973,
        "time_per_call": 0.0007191716666666666
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.003987028,
        "cumulative_time": 0.021997953,
        "time_percent": 1.691265793730189,
        "time_per_call": 0.0036663255
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.003949382,
        "cumulative_time": 0.0070266140000000005,
        "time_percent": 0.5402262612319272,
        "time_per_call": 0.0035133070000000002
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full_like>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.0036883090000000003,
        "cumulative_time": 0.0036883090000000003,
        "time_percent": 0.28356778689395323,
        "time_per_call": 0.0005269012857142858
      },
      {
        "rank": 17,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.003377985,
        "cumulative_time": 0.005731259000000001,
        "time_percent": 0.44063564922192033,
        "time_per_call": 0.0028656295000000004
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.0025657130000000003,
        "cumulative_time": 0.0025657130000000003,
        "time_percent": 0.19725938288116465,
        "time_per_call": 0.00010262852000000002
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.002267985,
        "cumulative_time": 0.002267985,
        "time_percent": 0.1743691993156437,
        "time_per_call": 0.0011339925
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 390,
        "function_name": "_profile_phase",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.0020687640000000003,
        "cumulative_time": 0.17184027000000002,
        "time_percent": 13.211573396686498,
        "time_per_call": 0.021480033750000002
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.0015078720000000002,
        "cumulative_time": 0.011457752,
        "time_percent": 0.8809048746782785,
        "time_per_call": 0.0019096253333333332
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0014932180000000001,
        "cumulative_time": 0.0014932180000000001,
        "time_percent": 0.114802887613325,
        "time_per_call": 0.0007466090000000001
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.001216588,
        "cumulative_time": 0.0017125520000000002,
        "time_percent": 0.13166591535058841,
        "time_per_call": 0.0002854253333333334
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 64,
        "primitive_calls": 64,
        "total_time": 0.00103936,
        "cumulative_time": 0.010456554,
        "time_percent": 0.803929897499671,
        "time_per_call": 0.00016338365625
      },
      {
        "rank": 25,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0009470360000000001,
        "cumulative_time": 0.0009470360000000001,
        "time_percent": 0.0728108470925028,
        "time_per_call": 0.00047351800000000003
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.0008939680000000001,
        "cumulative_time": 0.001476,
        "time_percent": 0.11347911833186292,
        "time_per_call": 9.225e-05
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 48,
        "primitive_calls": 48,
        "total_time": 0.0008602900000000001,
        "cumulative_time": 0.0009172150000000001,
        "time_percent": 0.07051812298154449,
        "time_per_call": 1.9108645833333336e-05
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 10859,
        "primitive_calls": 10859,
        "total_time": 0.0007498940000000001,
        "cumulative_time": 0.0007498940000000001,
        "time_percent": 0.05765400403953524,
        "time_per_call": 6.905737176535593e-08
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 64,
        "primitive_calls": 64,
        "total_time": 0.000726691,
        "cumulative_time": 0.000726691,
        "time_percent": 0.05587009077215433,
        "time_per_call": 1.1354546875e-05
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 64,
        "primitive_calls": 64,
        "total_time": 0.0006859800000000001,
        "cumulative_time": 0.0006859800000000001,
        "time_percent": 0.05274011219057678,
        "time_per_call": 1.0718437500000002e-05
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 7841,
        "primitive_calls": 7841,
        "total_time": 0.000647805,
        "cumulative_time": 0.000647805,
        "time_percent": 0.049805108571119555,
        "time_per_call": 8.261765080984568e-08
      },
      {
        "rank": 32,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.000640025,
        "cumulative_time": 0.003635746,
        "time_percent": 0.27952659251937484,
        "time_per_call": 0.0007271492
      },
      {
        "rank": 33,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0005963170000000001,
        "cumulative_time": 0.002526014,
        "time_percent": 0.1942072097655436,
        "time_per_call": 0.001263007
      },
      {
        "rank": 34,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1257,
        "function_name": "ensure_consistent",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.0005924950000000001,
        "cumulative_time": 0.007176434000000001,
        "time_percent": 0.5517448530398403,
        "time_per_call": 0.0014352868
      },
      {
        "rank": 35,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.000414615,
        "cumulative_time": 0.000414615,
        "time_percent": 0.03187679176637218,
        "time_per_call": 5.923071428571429e-05
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.000370201,
        "cumulative_time": 0.000370201,
        "time_percent": 0.02846211591163549,
        "time_per_call": 2.31375625e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 15,
        "primitive_calls": 15,
        "total_time": 0.000367065,
        "cumulative_time": 0.000367065,
        "time_percent": 0.028221011226616032,
        "time_per_call": 2.4471e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.000325911,
        "cumulative_time": 0.000325911,
        "time_percent": 0.025056973532964617,
        "time_per_call": 1.8106166666666666e-05
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.000315947,
        "cumulative_time": 0.000450941,
        "time_percent": 0.034669638956428585,
        "time_per_call": 3.757841666666667e-05
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 30,
        "primitive_calls": 30,
        "total_time": 0.000293096,
        "cumulative_time": 0.000293096,
        "time_percent": 0.02253406210473963,
        "time_per_call": 9.769866666666668e-06
      },
      {
        "rank": 41,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 367,
        "function_name": "get_nn_features",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000285319,
        "cumulative_time": 0.00048101800000000005,
        "time_percent": 0.03698204508249054,
        "time_per_call": 0.00024050900000000002
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 48,
        "primitive_calls": 48,
        "total_time": 0.000263971,
        "cumulative_time": 0.000263971,
        "time_percent": 0.0202948484723443,
        "time_per_call": 5.4993958333333336e-06
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.000263551,
        "cumulative_time": 0.000369732,
        "time_percent": 0.028426057844902666,
        "time_per_call": 2.310825e-05
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.00025582700000000003,
        "cumulative_time": 0.00025582700000000003,
        "time_percent": 0.01966871436686009,
        "time_per_call": 2.131891666666667e-05
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 2496,
        "primitive_calls": 2496,
        "total_time": 0.000254172,
        "cumulative_time": 0.000254172,
        "time_percent": 0.019541473214529984,
        "time_per_call": 1.0183173076923077e-07
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 2604,
        "primitive_calls": 2604,
        "total_time": 0.00024165900000000003,
        "cumulative_time": 0.0006552810000000001,
        "time_percent": 0.050379884918442724,
        "time_per_call": 2.516440092165899e-07
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.000239265,
        "cumulative_time": 0.000239265,
        "time_percent": 0.01839538024910107,
        "time_per_call": 4.7853000000000004e-05
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros>",
        "total_calls": 15,
        "primitive_calls": 15,
        "total_time": 0.00022115600000000002,
        "cumulative_time": 0.00022115600000000002,
        "time_percent": 0.017003108329133793,
        "time_per_call": 1.4743733333333334e-05
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'split' of 'bytes' objects>",
        "total_calls": 880,
        "primitive_calls": 880,
        "total_time": 0.000219692,
        "cumulative_time": 0.000219692,
        "time_percent": 0.01689055180525991,
        "time_per_call": 2.4965e-07
      },
      {
        "rank": 50,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 99,
        "primitive_calls": 99,
        "total_time": 0.000214505,
        "cumulative_time": 0.00041362200000000005,
        "time_percent": 0.03180044707497413,
        "time_per_call": 4.1780000000000005e-06
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 4864,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 10000,
    "wave_size": 4864,
    "total_time_ms": 245.08504799996444,
    "simulations_per_second": 40802.16268436519,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 31.723648071289062,
        "cpu_time_ms": 32.423636001112754,
        "memory_allocated_mb": 0.9462890625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "expansion",
        "gpu_time_ms": 34.460384368896484,
        "cpu_time_ms": 31.587785000738222,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.5207040309906006,
        "cpu_time_ms": 3.4735509998427005,
        "memory_allocated_mb": 0.0185546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4786239862442017,
        "cpu_time_ms": 1.5535060010734014,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "selection",
        "gpu_time_ms": 41.18617630004883,
        "cpu_time_ms": 37.80703899974469,
        "memory_allocated_mb": 0.9462890625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "expansion",
        "gpu_time_ms": 37.119712829589844,
        "cpu_time_ms": 34.02534699853277,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.432607889175415,
        "cpu_time_ms": 3.3893939998961287,
        "memory_allocated_mb": 0.0185546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.545375943183899,
        "cpu_time_ms": 1.691079998636269,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "selection",
        "gpu_time_ms": 38.72652816772461,
        "cpu_time_ms": 35.61944600005518,
        "memory_allocated_mb": 0.0537109375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 272
      },
      {
        "name": "expansion",
        "gpu_time_ms": 50.79315185546875,
        "cpu_time_ms": 46.55945999911637,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 272
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 5.238592147827148,
        "cpu_time_ms": 5.127876000187825,
        "memory_allocated_mb": 0.00146484375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 272
      },
      {
        "name": "backup",
        "gpu_time_ms": 2.528480052947998,
        "cpu_time_ms": 2.6216659989586333,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 272
      }
    ],
    "peak_gpu_memory_mb": 902.43017578125,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 186.3,
    "avg_ram_usage_mb": 1262.30078125,
    "final_tree_nodes": 651,
    "final_tree_edges": 650,
    "tree_memory_mb": 17.152931213378906,
    "efficiency_score": 46298.77824355666,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth",
      "Tree too small - increase num_simulations for better performance"
    ],
    "cprofile_stats": "         56267 function calls (41841 primitive calls) in 0.243 seconds\n\n   Ordered by: cumulative time\n   List reduced from 214 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    0.243    0.243 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    0.243    0.243 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n        3    0.000    0.000    0.241    0.080 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n       12    0.002    0.000    0.240    0.020 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n       21    0.035    0.002    0.130    0.006 {built-in method time.sleep}\n        3    0.000    0.000    0.113    0.038 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n        3    0.000    0.000    0.107    0.036 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n        3    0.009    0.003    0.048    0.016 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n        8    0.017    0.002    0.033    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n       69    0.029    0.000    0.029    0.000 {built-in method torch.where}\n        9    0.005    0.001    0.029    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n       44    0.004    0.000    0.027    0.001 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n        9    0.012    0.001    0.021    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n       90    0.002    0.000    0.015    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       35    0.015    0.000    0.015    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n       11    0.013    0.001    0.014    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n        3    0.007    0.002    0.014    0.005 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n        9    0.002    0.000    0.014    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n        3    0.000    0.000    0.013    0.004 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n        8    0.000    0.000    0.013    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n        9    0.011    0.001    0.011    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n 14490/90    0.009    0.000    0.011    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        3    0.006    0.002    0.011    0.004 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n        8    0.000    0.000    0.009    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n        9    0.009    0.001    0.009    0.001 {built-in method torch.repeat_interleave}\n       46    0.000    0.000    0.009    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        3    0.005    0.002    0.007    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n        3    0.000    0.000    0.007    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n       44    0.000    0.000    0.007    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n       33    0.007    0.000    0.007    0.000 {built-in method torch.tensor}\n        9    0.007    0.001    0.007    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n        8    0.001    0.000    0.006    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n        3    0.002    0.001    0.005    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n       37    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n       37    0.004    0.000    0.004    0.000 {built-in method torch._C._cuda_synchronize}\n       26    0.000    0.000    0.003    0.000 {built-in method builtins.next}\n       26    0.000    0.000    0.003    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n    66/44    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n       13    0.000    0.000    0.003    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       22    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n       13    0.000    0.000    0.003    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n        3    0.003    0.001    0.003    0.001 {built-in method torch.bincount}\n        9    0.002    0.000    0.003    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n       11    0.002    0.000    0.002    0.000 {built-in method torch.full_like}\n        3    0.000    0.000    0.002    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n       22    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n      6/3    0.000    0.000    0.002    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        3    0.000    0.000    0.002    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        3    0.000    0.000    0.002    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:489(_extract_policy)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 21,
        "primitive_calls": 21,
        "total_time": 0.035161315000000005,
        "cumulative_time": 0.130023221,
        "time_percent": 7.209102955084472,
        "time_per_call": 0.006191581952380952
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 69,
        "primitive_calls": 69,
        "total_time": 0.029277976,
        "cumulative_time": 0.029323545000000003,
        "time_percent": 1.6258361643959929,
        "time_per_call": 0.0004249789130434783
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.017220029,
        "cumulative_time": 0.033244082,
        "time_percent": 1.843209297093713,
        "time_per_call": 0.00415551025
      },
      {
        "rank": 4,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 35,
        "primitive_calls": 35,
        "total_time": 0.014692406000000002,
        "cumulative_time": 0.014692406000000002,
        "time_percent": 0.8146165484694524,
        "time_per_call": 0.0004197830285714286
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.013108156000000001,
        "cumulative_time": 0.014498378000000001,
        "time_percent": 0.8038587175419357,
        "time_per_call": 0.0013180343636363637
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.01161966,
        "cumulative_time": 0.021037649000000002,
        "time_percent": 1.1664268613521724,
        "time_per_call": 0.002337516555555556
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.011424687000000001,
        "cumulative_time": 0.011424687000000001,
        "time_percent": 0.6334387363978251,
        "time_per_call": 0.0012694096666666667
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.008727889,
        "cumulative_time": 0.047674874000000006,
        "time_percent": 2.643320726816019,
        "time_per_call": 0.01589162466666667
      },
      {
        "rank": 9,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.008593955,
        "cumulative_time": 0.008593955,
        "time_percent": 0.4764895524804987,
        "time_per_call": 0.0009548838888888889
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 90,
        "primitive_calls": 14490,
        "total_time": 0.00854191,
        "cumulative_time": 0.011041439,
        "time_percent": 0.6121896528258205,
        "time_per_call": 0.00012268265555555555
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 33,
        "primitive_calls": 33,
        "total_time": 0.0066739550000000005,
        "cumulative_time": 0.0066739550000000005,
        "time_percent": 0.3700356624191058,
        "time_per_call": 0.00020224106060606062
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.006574335000000001,
        "cumulative_time": 0.013683701000000001,
        "time_percent": 0.7586891676494644,
        "time_per_call": 0.004561233666666667
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0065554920000000004,
        "cumulative_time": 0.0065554920000000004,
        "time_percent": 0.36346751284705225,
        "time_per_call": 0.0007283880000000001
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.005913249000000001,
        "cumulative_time": 0.010585944,
        "time_percent": 0.5869348535271152,
        "time_per_call": 0.003528648
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.00529628,
        "cumulative_time": 0.029063766,
        "time_percent": 1.611432786736483,
        "time_per_call": 0.0032293073333333334
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0046605530000000004,
        "cumulative_time": 0.007414670000000001,
        "time_percent": 0.41110440886536864,
        "time_per_call": 0.002471556666666667
      },
      {
        "rank": 17,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 44,
        "primitive_calls": 44,
        "total_time": 0.00442424,
        "cumulative_time": 0.027290074,
        "time_percent": 1.513090904876706,
        "time_per_call": 0.0006202289545454545
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 37,
        "primitive_calls": 37,
        "total_time": 0.003544656,
        "cumulative_time": 0.003544656,
        "time_percent": 0.19653251048409193,
        "time_per_call": 9.580151351351352e-05
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0026279990000000002,
        "cumulative_time": 0.0026279990000000002,
        "time_percent": 0.14570870657679708,
        "time_per_call": 0.0008759996666666668
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full_like>",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.00249459,
        "cumulative_time": 0.00249459,
        "time_percent": 0.13831188000429687,
        "time_per_call": 0.0002267809090909091
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.002123677,
        "cumulative_time": 0.013548364,
        "time_percent": 0.7511854436290274,
        "time_per_call": 0.001505373777777778
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 390,
        "function_name": "_profile_phase",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.0018237940000000001,
        "cumulative_time": 0.24041446000000002,
        "time_percent": 13.329715882296423,
        "time_per_call": 0.020034538333333334
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.0017849810000000002,
        "cumulative_time": 0.0025623720000000003,
        "time_percent": 0.1420700349918705,
        "time_per_call": 0.00028470800000000005
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.001635109,
        "cumulative_time": 0.004512602,
        "time_percent": 0.2502000193743862,
        "time_per_call": 0.0015042006666666668
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 90,
        "primitive_calls": 90,
        "total_time": 0.0015275900000000001,
        "cumulative_time": 0.015114093,
        "time_percent": 0.8379968721873265,
        "time_per_call": 0.00016793436666666668
      },
      {
        "rank": 26,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 66,
        "primitive_calls": 66,
        "total_time": 0.001410835,
        "cumulative_time": 0.001442818,
        "time_percent": 0.07999666080760348,
        "time_per_call": 2.1860878787878788e-05
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0013784930000000002,
        "cumulative_time": 0.0013784930000000002,
        "time_percent": 0.0764301782668748,
        "time_per_call": 0.0004594976666666667
      },
      {
        "rank": 28,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.00130779,
        "cumulative_time": 0.00627241,
        "time_percent": 0.3477721065416568,
        "time_per_call": 0.00078405125
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.001135748,
        "cumulative_time": 0.001135748,
        "time_percent": 0.06297124621325353,
        "time_per_call": 0.00037858266666666667
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 90,
        "primitive_calls": 90,
        "total_time": 0.0011012930000000002,
        "cumulative_time": 0.0011012930000000002,
        "time_percent": 0.061060897889261216,
        "time_per_call": 1.223658888888889e-05
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 15303,
        "primitive_calls": 15303,
        "total_time": 0.0010550120000000001,
        "cumulative_time": 0.0010550120000000001,
        "time_percent": 0.05849486013617198,
        "time_per_call": 6.894151473567275e-08
      },
      {
        "rank": 32,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 22,
        "primitive_calls": 22,
        "total_time": 0.001026999,
        "cumulative_time": 0.0017533030000000001,
        "time_percent": 0.09721141916995327,
        "time_per_call": 7.969559090909092e-05
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 90,
        "primitive_calls": 90,
        "total_time": 0.001002904,
        "cumulative_time": 0.001002904,
        "time_percent": 0.0556057459156933,
        "time_per_call": 1.1143377777777778e-05
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 11027,
        "primitive_calls": 11027,
        "total_time": 0.000987374,
        "cumulative_time": 0.000987374,
        "time_percent": 0.05474468919035297,
        "time_per_call": 8.954148907227714e-08
      },
      {
        "rank": 35,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00076928,
        "cumulative_time": 0.000775768,
        "time_percent": 0.04301225072143052,
        "time_per_call": 0.000775768
      },
      {
        "rank": 36,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.00063232,
        "cumulative_time": 0.00063232,
        "time_percent": 0.03505881446021871,
        "time_per_call": 5.7483636363636365e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.000628244,
        "cumulative_time": 0.000628244,
        "time_percent": 0.03483282172277588,
        "time_per_call": 2.731495652173913e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 22,
        "primitive_calls": 22,
        "total_time": 0.000540978,
        "cumulative_time": 0.000540978,
        "time_percent": 0.02999438153001676,
        "time_per_call": 2.4589909090909093e-05
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.00048051400000000003,
        "cumulative_time": 0.00071498,
        "time_percent": 0.039641876206299304,
        "time_per_call": 3.763052631578948e-05
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 47,
        "primitive_calls": 47,
        "total_time": 0.00046719000000000003,
        "cumulative_time": 0.000490266,
        "time_percent": 0.027182668158770226,
        "time_per_call": 1.0431191489361703e-05
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 0.000460493,
        "cumulative_time": 0.000460493,
        "time_percent": 0.02553191208127134,
        "time_per_call": 1.7055296296296297e-05
      },
      {
        "rank": 42,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 367,
        "function_name": "get_nn_features",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.000406696,
        "cumulative_time": 0.000674587,
        "time_percent": 0.03740229704939834,
        "time_per_call": 0.00022486233333333334
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.argsort>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.000380547,
        "cumulative_time": 0.000380547,
        "time_percent": 0.021099327344371283,
        "time_per_call": 4.7568375e-05
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 3675,
        "primitive_calls": 3675,
        "total_time": 0.00035653800000000005,
        "cumulative_time": 0.0009962060000000001,
        "time_percent": 0.05523437708463538,
        "time_per_call": 2.7107646258503406e-07
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 22,
        "primitive_calls": 22,
        "total_time": 0.00035534200000000003,
        "cumulative_time": 0.00035534200000000003,
        "time_percent": 0.019701842813643466,
        "time_per_call": 1.6151909090909093e-05
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 66,
        "primitive_calls": 66,
        "total_time": 0.00035347000000000004,
        "cumulative_time": 0.00035347000000000004,
        "time_percent": 0.01959805027083361,
        "time_per_call": 5.355606060606061e-06
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.00033983900000000004,
        "cumulative_time": 0.00033983900000000004,
        "time_percent": 0.018842283096132128,
        "time_per_call": 1.7886263157894738e-05
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros>",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.000338707,
        "cumulative_time": 0.000338707,
        "time_percent": 0.018779519656783428,
        "time_per_call": 1.4726391304347826e-05
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 3510,
        "primitive_calls": 3510,
        "total_time": 0.000336839,
        "cumulative_time": 0.000336839,
        "time_percent": 0.0186759488929112,
        "time_per_call": 9.596552706552707e-08
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.00033633800000000004,
        "cumulative_time": 0.00033633800000000004,
        "time_percent": 0.018648171080973306,
        "time_per_call": 1.8685444444444448e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 25000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 4864,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 25000,
    "wave_size": 4864,
    "total_time_ms": 621.6293260004022,
    "simulations_per_second": 40216.892856151746,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 31.857152938842773,
        "cpu_time_ms": 33.534485999553,
        "memory_allocated_mb": 0.9462890625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "expansion",
        "gpu_time_ms": 36.07379150390625,
        "cpu_time_ms": 33.10042299926863,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.8853440284729004,
        "cpu_time_ms": 3.75804900068033,
        "memory_allocated_mb": 0.0185546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "backup",
        "gpu_time_ms": 2.337951898574829,
        "cpu_time_ms": 2.3779510011081584,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "selection",
        "gpu_time_ms": 38.47983932495117,
        "cpu_time_ms": 35.38460299932922,
        "memory_allocated_mb": 0.9462890625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "expansion",
        "gpu_time_ms": 34.39158248901367,
        "cpu_time_ms": 31.52441100064607,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.3870720863342285,
        "cpu_time_ms": 3.319891999126412,
        "memory_allocated_mb": 0.0185546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.4981119632720947,
        "cpu_time_ms": 1.588203000210342,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "selection",
        "gpu_time_ms": 38.03299331665039,
        "cpu_time_ms": 34.96346999963862,
        "memory_allocated_mb": 0.9462890625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "expansion",
        "gpu_time_ms": 35.30556869506836,
        "cpu_time_ms": 32.36208499947679,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.669055938720703,
        "cpu_time_ms": 3.5585919995355653,
        "memory_allocated_mb": 0.0185546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6591999530792236,
        "cpu_time_ms": 1.768400999935693,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "selection",
        "gpu_time_ms": 40.096031188964844,
        "cpu_time_ms": 37.805990999913774,
        "memory_allocated_mb": 0.9462890625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "expansion",
        "gpu_time_ms": 51.3256950378418,
        "cpu_time_ms": 46.914227001252584,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.154592037200928,
        "cpu_time_ms": 4.032438999274746,
        "memory_allocated_mb": 0.0185546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5953919887542725,
        "cpu_time_ms": 1.6895940007088939,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "selection",
        "gpu_time_ms": 52.63024139404297,
        "cpu_time_ms": 48.35806700066314,
        "memory_allocated_mb": 0.9462890625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "expansion",
        "gpu_time_ms": 137.38645935058594,
        "cpu_time_ms": 125.22911599990039,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.03110408782959,
        "cpu_time_ms": 3.952364999349811,
        "memory_allocated_mb": 0.0185546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "backup",
        "gpu_time_ms": 2.2896640300750732,
        "cpu_time_ms": 2.3715079987596255,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "selection",
        "gpu_time_ms": 52.015262603759766,
        "cpu_time_ms": 47.72836400115921,
        "memory_allocated_mb": 0.1328125,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 680
      },
      {
        "name": "expansion",
        "gpu_time_ms": 70.94393920898438,
        "cpu_time_ms": 64.77356599862105,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 680
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.7326719760894775,
        "cpu_time_ms": 3.6655060011980822,
        "memory_allocated_mb": 0.0029296875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 680
      },
      {
        "name": "backup",
        "gpu_time_ms": 2.302783966064453,
        "cpu_time_ms": 2.3646080007893033,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 680
      }
    ],
    "peak_gpu_memory_mb": 508.90625,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 188.4,
    "avg_ram_usage_mb": 1262.30078125,
    "final_tree_nodes": 1351,
    "final_tree_edges": 1350,
    "tree_memory_mb": 17.152931213378906,
    "efficiency_score": 80922.75990852813,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth"
    ],
    "cprofile_stats": "         135278 function calls (100174 primitive calls) in 0.620 seconds\n\n   Ordered by: cumulative time\n   List reduced from 214 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    0.619    0.619 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    0.619    0.619 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n        6    0.000    0.000    0.617    0.103 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n       24    0.002    0.000    0.617    0.026 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n        6    0.000    0.000    0.336    0.056 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n        6    0.000    0.000    0.241    0.040 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n       56    0.108    0.002    0.214    0.004 {built-in method time.sleep}\n        6    0.030    0.005    0.197    0.033 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n        6    0.045    0.007    0.171    0.029 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n       23    0.014    0.001    0.077    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n       19    0.033    0.002    0.070    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n      166    0.067    0.000    0.067    0.000 {built-in method torch.where}\n       23    0.034    0.001    0.057    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n       25    0.038    0.002    0.040    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n      219    0.006    0.000    0.039    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       19    0.000    0.000    0.038    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n       23    0.005    0.000    0.035    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n       83    0.032    0.000    0.032    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n35259/219    0.021    0.000    0.027    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       23    0.027    0.001    0.027    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n        6    0.000    0.000    0.025    0.004 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n      105    0.000    0.000    0.023    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       23    0.018    0.001    0.018    0.001 {built-in method torch.repeat_interleave}\n      114    0.000    0.000    0.018    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n       81    0.017    0.000    0.017    0.000 {built-in method torch.tensor}\n       23    0.016    0.001    0.016    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n        6    0.009    0.002    0.016    0.003 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n       19    0.001    0.000    0.015    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n       57    0.001    0.000    0.015    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n        6    0.000    0.000    0.014    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n       19    0.003    0.000    0.014    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n        6    0.009    0.001    0.014    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n      114    0.004    0.000    0.012    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n       57    0.004    0.000    0.011    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n        6    0.003    0.001    0.009    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n       73    0.000    0.000    0.008    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n       23    0.005    0.000    0.007    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n       73    0.007    0.000    0.007    0.000 {built-in method torch._C._cuda_synchronize}\n       50    0.000    0.000    0.006    0.000 {built-in method builtins.next}\n       50    0.000    0.000    0.006    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n  171/114    0.000    0.000    0.006    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n       25    0.000    0.000    0.006    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       25    0.000    0.000    0.005    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n        6    0.005    0.001    0.005    0.001 {built-in method torch.bincount}\n       57    0.003    0.000    0.005    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n        6    0.000    0.000    0.004    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n     12/6    0.000    0.000    0.004    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        6    0.000    0.000    0.004    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        6    0.000    0.000    0.004    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n       57    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 56,
        "primitive_calls": 56,
        "total_time": 0.107833946,
        "cumulative_time": 0.213595326,
        "time_percent": 4.689575116531993,
        "time_per_call": 0.00381420225
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 166,
        "primitive_calls": 166,
        "total_time": 0.06681479600000001,
        "cumulative_time": 0.06681479600000001,
        "time_percent": 1.4669469159534014,
        "time_per_call": 0.00040249877108433743
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.044671488,
        "cumulative_time": 0.171386219,
        "time_percent": 3.7628564397467326,
        "time_per_call": 0.028564369833333336
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.037802263,
        "cumulative_time": 0.040012336,
        "time_percent": 0.8784876465879092,
        "time_per_call": 0.0016004934400000001
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.034047733000000004,
        "cumulative_time": 0.056575268000000005,
        "time_percent": 1.242133776953194,
        "time_per_call": 0.0024597942608695655
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.033236475,
        "cumulative_time": 0.070381311,
        "time_percent": 1.5452512511181984,
        "time_per_call": 0.0037042795263157896
      },
      {
        "rank": 7,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 83,
        "primitive_calls": 83,
        "total_time": 0.031757773,
        "cumulative_time": 0.031757773,
        "time_percent": 0.6972552480725707,
        "time_per_call": 0.0003826237710843374
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.029884252000000004,
        "cumulative_time": 0.19714273300000001,
        "time_percent": 4.328351525266571,
        "time_per_call": 0.03285712216666667
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.026875532,
        "cumulative_time": 0.026883606,
        "time_percent": 0.5902408638859925,
        "time_per_call": 0.0011688524347826087
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 219,
        "primitive_calls": 35259,
        "total_time": 0.021395254000000002,
        "cumulative_time": 0.027303042000000003,
        "time_percent": 0.5994497574765654,
        "time_per_call": 0.00012467142465753426
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.018213163,
        "cumulative_time": 0.018213163,
        "time_percent": 0.3998776452540033,
        "time_per_call": 0.0007918766521739131
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 81,
        "primitive_calls": 81,
        "total_time": 0.016620584,
        "cumulative_time": 0.016620584,
        "time_percent": 0.3649119042456471,
        "time_per_call": 0.0002051923950617284
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.016321982000000002,
        "cumulative_time": 0.016321982000000002,
        "time_percent": 0.35835597188902485,
        "time_per_call": 0.0007096513913043479
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.01445832,
        "cumulative_time": 0.07731304,
        "time_percent": 1.6974402734235985,
        "time_per_call": 0.0033614365217391304
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.009001757,
        "cumulative_time": 0.016120295,
        "time_percent": 0.35392784907266694,
        "time_per_call": 0.0026867158333333334
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.008573891,
        "cumulative_time": 0.013549073,
        "time_percent": 0.2974755898585322,
        "time_per_call": 0.0022581788333333333
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 73,
        "primitive_calls": 73,
        "total_time": 0.006564131000000001,
        "cumulative_time": 0.006564131000000001,
        "time_percent": 0.14411825378265192,
        "time_per_call": 8.991960273972604e-05
      },
      {
        "rank": 18,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 219,
        "primitive_calls": 219,
        "total_time": 0.005589561000000001,
        "cumulative_time": 0.039184213,
        "time_percent": 0.8603058582175598,
        "time_per_call": 0.0001789233470319635
      },
      {
        "rank": 19,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.005161143,
        "cumulative_time": 0.034828009,
        "time_percent": 0.7646635692990412,
        "time_per_call": 0.0015142612608695651
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 23,
        "primitive_calls": 23,
        "total_time": 0.004795363,
        "cumulative_time": 0.0069887510000000005,
        "time_percent": 0.15344096427109122,
        "time_per_call": 0.0003038587391304348
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.004761254,
        "cumulative_time": 0.004761254,
        "time_percent": 0.1045353318353437,
        "time_per_call": 0.0007935423333333334
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 114,
        "primitive_calls": 114,
        "total_time": 0.003889018,
        "cumulative_time": 0.012339830000000001,
        "time_percent": 0.2709261517746647,
        "time_per_call": 0.00010824412280701756
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 57,
        "primitive_calls": 57,
        "total_time": 0.0038575130000000003,
        "cumulative_time": 0.011260800000000001,
        "time_percent": 0.24723559480998883,
        "time_per_call": 0.00019755789473684213
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.003185371,
        "cumulative_time": 0.014234043,
        "time_percent": 0.3125143939734262,
        "time_per_call": 0.0007491601578947368
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.003182958,
        "cumulative_time": 0.009454143,
        "time_percent": 0.20756968137465295,
        "time_per_call": 0.0015756905
      },
      {
        "rank": 26,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full_like>",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.0030904170000000003,
        "cumulative_time": 0.0030904170000000003,
        "time_percent": 0.06785140355977384,
        "time_per_call": 0.00012361668
      },
      {
        "rank": 27,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 57,
        "primitive_calls": 57,
        "total_time": 0.0027627370000000004,
        "cumulative_time": 0.004502097,
        "time_percent": 0.09884543102508402,
        "time_per_call": 7.898415789473684e-05
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.002625456,
        "cumulative_time": 0.002625456,
        "time_percent": 0.057642989468550544,
        "time_per_call": 0.000437576
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 219,
        "primitive_calls": 219,
        "total_time": 0.002521162,
        "cumulative_time": 0.002521162,
        "time_percent": 0.05535317088327126,
        "time_per_call": 1.1512155251141552e-05
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 36916,
        "primitive_calls": 36916,
        "total_time": 0.002463241,
        "cumulative_time": 0.002463241,
        "time_percent": 0.05408149099489838,
        "time_per_call": 6.672556615017878e-08
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 219,
        "primitive_calls": 219,
        "total_time": 0.0024615220000000003,
        "cumulative_time": 0.0024615220000000003,
        "time_percent": 0.054043749627723896,
        "time_per_call": 1.1239826484018267e-05
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 26824,
        "primitive_calls": 26824,
        "total_time": 0.002238574,
        "cumulative_time": 0.002238574,
        "time_percent": 0.049148832624340714,
        "time_per_call": 8.34541455413063e-08
      },
      {
        "rank": 33,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 390,
        "function_name": "_profile_phase",
        "total_calls": 24,
        "primitive_calls": 24,
        "total_time": 0.002230019,
        "cumulative_time": 0.616573602,
        "time_percent": 13.537132462578796,
        "time_per_call": 0.02569056675
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 171,
        "primitive_calls": 171,
        "total_time": 0.002173962,
        "cumulative_time": 0.0021963200000000003,
        "time_percent": 0.04822112830288031,
        "time_per_call": 1.2843976608187136e-05
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.001830124,
        "cumulative_time": 0.001830124,
        "time_percent": 0.04018114127913079,
        "time_per_call": 0.00030502066666666667
      },
      {
        "rank": 36,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.0015450490000000002,
        "cumulative_time": 0.0015450490000000002,
        "time_percent": 0.033922199890378875,
        "time_per_call": 6.180196000000001e-05
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 54,
        "primitive_calls": 54,
        "total_time": 0.001387664,
        "cumulative_time": 0.001387664,
        "time_percent": 0.030466746095873146,
        "time_per_call": 2.5697481481481483e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 69,
        "primitive_calls": 69,
        "total_time": 0.0012779010000000001,
        "cumulative_time": 0.0012779010000000001,
        "time_percent": 0.02805685331799513,
        "time_per_call": 1.8520304347826088e-05
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1257,
        "function_name": "ensure_consistent",
        "total_calls": 19,
        "primitive_calls": 19,
        "total_time": 0.0011501500000000002,
        "cumulative_time": 0.015397365000000001,
        "time_percent": 0.33805561721027844,
        "time_per_call": 0.0008103876315789474
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 106,
        "primitive_calls": 106,
        "total_time": 0.0010792450000000002,
        "cumulative_time": 0.0010792450000000002,
        "time_percent": 0.023695277380000216,
        "time_per_call": 1.0181556603773586e-05
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 57,
        "primitive_calls": 57,
        "total_time": 0.001052191,
        "cumulative_time": 0.001052191,
        "time_percent": 0.023101295444259463,
        "time_per_call": 1.8459491228070178e-05
      },
      {
        "rank": 42,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 46,
        "primitive_calls": 46,
        "total_time": 0.001050341,
        "cumulative_time": 0.0015791520000000001,
        "time_percent": 0.03467094558249711,
        "time_per_call": 3.432939130434783e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 8930,
        "primitive_calls": 8930,
        "total_time": 0.000981467,
        "cumulative_time": 0.002542814,
        "time_percent": 0.05582854963956086,
        "time_per_call": 2.8474960806271e-07
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 57,
        "primitive_calls": 57,
        "total_time": 0.000887311,
        "cumulative_time": 0.0009286880000000001,
        "time_percent": 0.02038973519402697,
        "time_per_call": 1.6292771929824565e-05
      },
      {
        "rank": 45,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 57,
        "primitive_calls": 57,
        "total_time": 0.00085327,
        "cumulative_time": 0.015246869000000001,
        "time_percent": 0.3347514143049321,
        "time_per_call": 0.00026748892982456145
      },
      {
        "rank": 46,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 359,
        "primitive_calls": 359,
        "total_time": 0.0008496140000000001,
        "cumulative_time": 0.001561347,
        "time_percent": 0.03428002932738274,
        "time_per_call": 4.349155988857939e-06
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 8541,
        "primitive_calls": 8541,
        "total_time": 0.000842642,
        "cumulative_time": 0.000842642,
        "time_percent": 0.018500559114972167,
        "time_per_call": 9.865847090504625e-08
      },
      {
        "rank": 48,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 367,
        "function_name": "get_nn_features",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.000842438,
        "cumulative_time": 0.001332321,
        "time_percent": 0.029251667280551924,
        "time_per_call": 0.0002220535
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 171,
        "primitive_calls": 171,
        "total_time": 0.000837327,
        "cumulative_time": 0.000881577,
        "time_percent": 0.019355393397077075,
        "time_per_call": 5.1554210526315795e-06
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 44,
        "primitive_calls": 44,
        "total_time": 0.0008110890000000001,
        "cumulative_time": 0.0008110890000000001,
        "time_percent": 0.017807799744142424,
        "time_per_call": 1.843384090909091e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 50000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "wave_size": 4864,
      "min_wave_size": 1024,
      "max_wave_size": 4096,
      "device": "cuda",
      "enable_quantum": false,
      "quantum_config": null,
      "enable_virtual_loss": true,
      "virtual_loss_value": -1.0,
      "game_type": 2,
      "board_size": 15,
      "adaptive_wave_sizing": true,
      "target_sims_per_second": 100000,
      "memory_pool_size_mb": 1024,
      "cache_legal_moves": true,
      "cache_features": true,
      "use_zobrist_hashing": true,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "max_tree_nodes": 500000,
      "tree_batch_size": 1024,
      "use_optimized_implementation": true
    },
    "num_simulations": 50000,
    "wave_size": 4864,
    "total_time_ms": 1450.1445259993488,
    "simulations_per_second": 34479.32195968062,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 33.57049560546875,
        "cpu_time_ms": 36.26248900036444,
        "memory_allocated_mb": 0.9462890625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "expansion",
        "gpu_time_ms": 39.233150482177734,
        "cpu_time_ms": 38.58494700034498,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.722559928894043,
        "cpu_time_ms": 3.9431389996025246,
        "memory_allocated_mb": 0.0185546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5209920406341553,
        "cpu_time_ms": 1.7250439996132627,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "selection",
        "gpu_time_ms": 37.32380676269531,
        "cpu_time_ms": 36.61866599941277,
        "memory_allocated_mb": 0.9462890625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "expansion",
        "gpu_time_ms": 41.44233703613281,
        "cpu_time_ms": 40.68387200095458,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.521984100341797,
        "cpu_time_ms": 4.6561300005123485,
        "memory_allocated_mb": 0.0185546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.8512320518493652,
        "cpu_time_ms": 2.0992099998693448,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "selection",
        "gpu_time_ms": 49.0081901550293,
        "cpu_time_ms": 48.01621300066472,
        "memory_allocated_mb": 0.9462890625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "expansion",
        "gpu_time_ms": 44.2988166809082,
        "cpu_time_ms": 43.30812400075956,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.758016109466553,
        "cpu_time_ms": 4.904461000478477,
        "memory_allocated_mb": 0.0185546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.99782395362854,
        "cpu_time_ms": 2.2280560006038286,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "selection",
        "gpu_time_ms": 40.585472106933594,
        "cpu_time_ms": 39.829520999774104,
        "memory_allocated_mb": 0.9462890625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "expansion",
        "gpu_time_ms": 53.36272048950195,
        "cpu_time_ms": 52.135394000288215,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 5.252768039703369,
        "cpu_time_ms": 5.3972950008756015,
        "memory_allocated_mb": 0.0185546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6843199729919434,
        "cpu_time_ms": 1.9354109990672441,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "selection",
        "gpu_time_ms": 54.288448333740234,
        "cpu_time_ms": 53.11361300118733,
        "memory_allocated_mb": 0.9462890625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "expansion",
        "gpu_time_ms": 76.30022430419922,
        "cpu_time_ms": 74.4432079991384,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.2224321365356445,
        "cpu_time_ms": 4.417714999362943,
        "memory_allocated_mb": 0.0185546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "backup",
        "gpu_time_ms": 2.008064031600952,
        "cpu_time_ms": 2.272658999572741,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "selection",
        "gpu_time_ms": 56.5516471862793,
        "cpu_time_ms": 55.422945000827895,
        "memory_allocated_mb": 0.9462890625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "expansion",
        "gpu_time_ms": 65.35641479492188,
        "cpu_time_ms": 63.72222899881308,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.6419520378112793,
        "cpu_time_ms": 3.805570000622538,
        "memory_allocated_mb": 0.0185546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.7886719703674316,
        "cpu_time_ms": 2.177385000322829,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "selection",
        "gpu_time_ms": 49.40371322631836,
        "cpu_time_ms": 48.39999599971634,
        "memory_allocated_mb": 0.9462890625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "expansion",
        "gpu_time_ms": 89.15996551513672,
        "cpu_time_ms": 86.87250900038634,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 4.127679824829102,
        "cpu_time_ms": 4.295687000194448,
        "memory_allocated_mb": 0.0185546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.9814399480819702,
        "cpu_time_ms": 2.2239230002014665,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "selection",
        "gpu_time_ms": 41.97455978393555,
        "cpu_time_ms": 41.27628200149047,
        "memory_allocated_mb": 0.9462890625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "expansion",
        "gpu_time_ms": 90.62723541259766,
        "cpu_time_ms": 88.24284300135332,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.5467519760131836,
        "cpu_time_ms": 3.6958850014343625,
        "memory_allocated_mb": 0.0185546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.59225594997406,
        "cpu_time_ms": 2.301129999978002,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "selection",
        "gpu_time_ms": 57.16463851928711,
        "cpu_time_ms": 55.90607799967984,
        "memory_allocated_mb": 0.9462890625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "expansion",
        "gpu_time_ms": 89.36402893066406,
        "cpu_time_ms": 87.05445699888514,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.4424960613250732,
        "cpu_time_ms": 3.5892140003852546,
        "memory_allocated_mb": 0.0185546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.5441919565200806,
        "cpu_time_ms": 1.7312199997832067,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "selection",
        "gpu_time_ms": 56.26544189453125,
        "cpu_time_ms": 55.03242099985073,
        "memory_allocated_mb": 0.9462890625,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "expansion",
        "gpu_time_ms": 143.3272705078125,
        "cpu_time_ms": 139.42659399981494,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 3.8839681148529053,
        "cpu_time_ms": 4.0276950003317324,
        "memory_allocated_mb": 0.0185546875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "backup",
        "gpu_time_ms": 2.2640318870544434,
        "cpu_time_ms": 2.4697980006749276,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 4864
      },
      {
        "name": "selection",
        "gpu_time_ms": 59.19504165649414,
        "cpu_time_ms": 57.883778999894275,
        "memory_allocated_mb": 0.26513671875,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1360
      },
      {
        "name": "expansion",
        "gpu_time_ms": 116.79376220703125,
        "cpu_time_ms": 113.67401200004679,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1360
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 5.170527935028076,
        "cpu_time_ms": 5.326264999894192,
        "memory_allocated_mb": 0.00537109375,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1360
      },
      {
        "name": "backup",
        "gpu_time_ms": 1.6977920532226562,
        "cpu_time_ms": 1.936500000738306,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1360
      }
    ],
    "peak_gpu_memory_mb": 902.43017578125,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 187.7,
    "avg_ram_usage_mb": 1262.30078125,
    "final_tree_nodes": 3701,
    "final_tree_edges": 3700,
    "tree_memory_mb": 17.152931213378906,
    "efficiency_score": 39124.16343585497,
    "bottleneck_phase": "expansion",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Expansion is bottleneck - optimize legal move generation or reduce expansion breadth"
    ],
    "cprofile_stats": "         295794 function calls (218691 primitive calls) in 1.448 seconds\n\n   Ordered by: cumulative time\n   List reduced from 214 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n      2/1    0.000    0.000    1.448    1.448 /home/cosmo/omoknuni_quantum/python/mcts/core/mcts.py:134(search)\n        1    0.000    0.000    1.448    1.448 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:130(search)\n       11    0.000    0.000    1.446    0.131 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:205(_search_wave)\n       44    0.003    0.000    1.233    0.028 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:390(_profile_phase)\n       11    0.000    0.000    0.794    0.072 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:368(instrumented_expand)\n      130    0.158    0.001    0.624    0.005 {built-in method time.sleep}\n       11    0.000    0.000    0.533    0.048 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:365(instrumented_select)\n       11    0.045    0.004    0.328    0.030 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:289(_expand_batch)\n       11    0.074    0.007    0.256    0.023 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:226(_select_batch)\n      131    0.015    0.000    0.243    0.002 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n       70    0.039    0.001    0.231    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:213(clone_states)\n      385    0.183    0.000    0.183    0.000 {built-in method torch.where}\n       70    0.107    0.002    0.177    0.003 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:415(add_children_batch)\n       39    0.079    0.002    0.168    0.004 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:972(batch_action_to_child)\n       11    0.000    0.000    0.145    0.013 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:371(instrumented_evaluate)\n       70    0.016    0.000    0.114    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:119(allocate_states)\n      234    0.096    0.000    0.096    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n      481    0.009    0.000    0.091    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       70    0.090    0.001    0.090    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:153(_reset_states)\n      131    0.013    0.000    0.077    0.001 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n       39    0.000    0.000    0.076    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n       50    0.067    0.001    0.073    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n      262    0.012    0.000    0.072    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n77441/481    0.054    0.000    0.068    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       70    0.068    0.001    0.068    0.001 {built-in method torch.repeat_interleave}\n      232    0.050    0.000    0.050    0.000 {built-in method torch.tensor}\n       70    0.049    0.001    0.049    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1198(set_expanded)\n      262    0.001    0.000    0.048    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n      219    0.001    0.000    0.045    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n       39    0.002    0.000    0.042    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1257(ensure_consistent)\n  393/262    0.003    0.000    0.039    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n       39    0.007    0.000    0.034    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:111(batch_ucb_selection)\n       11    0.015    0.001    0.030    0.003 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:400(_evaluate_batch)\n       11    0.015    0.001    0.027    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:1205(_rebuild_row_pointers)\n       11    0.000    0.000    0.027    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:374(instrumented_backup)\n       70    0.014    0.000    0.019    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py:299(apply_moves)\n      133    0.000    0.000    0.016    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n       11    0.005    0.000    0.015    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py:459(_backup_batch)\n      131    0.008    0.000    0.014    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n       90    0.000    0.000    0.014    0.000 {built-in method builtins.next}\n       90    0.000    0.000    0.014    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:186(timer)\n       45    0.000    0.000    0.013    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n      133    0.013    0.000    0.013    0.000 {built-in method torch._C._cuda_synchronize}\n       45    0.000    0.000    0.012    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:168(end_timer)\n      131    0.001    0.000    0.012    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n       11    0.011    0.001    0.011    0.001 {built-in method torch.bincount}\n      131    0.001    0.000    0.010    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n      131    0.000    0.000    0.009    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:812(bcat)\n      393    0.000    0.000    0.009    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:765(open_binary)\n      481    0.001    0.000    0.008    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 385,
        "primitive_calls": 385,
        "total_time": 0.183249312,
        "cumulative_time": 0.18326254900000002,
        "time_percent": 1.6828031011177695,
        "time_per_call": 0.00047600662077922084
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 130,
        "primitive_calls": 130,
        "total_time": 0.15773118,
        "cumulative_time": 0.6238072720000001,
        "time_percent": 5.728092387394524,
        "time_per_call": 0.004798517476923078
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 415,
        "function_name": "add_children_batch",
        "total_calls": 70,
        "primitive_calls": 70,
        "total_time": 0.10747846100000001,
        "cumulative_time": 0.17650447800000002,
        "time_percent": 1.6207473079487347,
        "time_per_call": 0.002521492542857143
      },
      {
        "rank": 4,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 234,
        "primitive_calls": 234,
        "total_time": 0.096217071,
        "cumulative_time": 0.096263675,
        "time_percent": 0.883938435315516,
        "time_per_call": 0.0004113832264957265
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 153,
        "function_name": "_reset_states",
        "total_calls": 70,
        "primitive_calls": 70,
        "total_time": 0.089672844,
        "cumulative_time": 0.08968556500000001,
        "time_percent": 0.8235351288685789,
        "time_per_call": 0.0012812223571428572
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 972,
        "function_name": "batch_action_to_child",
        "total_calls": 39,
        "primitive_calls": 39,
        "total_time": 0.07926572400000001,
        "cumulative_time": 0.16789752500000002,
        "time_percent": 1.5417142088316047,
        "time_per_call": 0.004305064743589744
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 226,
        "function_name": "_select_batch",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.074368512,
        "cumulative_time": 0.256022054,
        "time_percent": 2.3509151693930708,
        "time_per_call": 0.02327473218181818
      },
      {
        "rank": 8,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.repeat_interleave>",
        "total_calls": 70,
        "primitive_calls": 70,
        "total_time": 0.06781484800000001,
        "cumulative_time": 0.06781484800000001,
        "time_percent": 0.6227078971614116,
        "time_per_call": 0.000968783542857143
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 50,
        "primitive_calls": 50,
        "total_time": 0.06725595100000001,
        "cumulative_time": 0.07269579200000001,
        "time_percent": 0.6675270254797795,
        "time_per_call": 0.0014539158400000002
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 481,
        "primitive_calls": 77441,
        "total_time": 0.053538804,
        "cumulative_time": 0.068282178,
        "time_percent": 0.6269991414856698,
        "time_per_call": 0.00014195879002079002
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.tensor>",
        "total_calls": 232,
        "primitive_calls": 232,
        "total_time": 0.050433018,
        "cumulative_time": 0.050433018,
        "time_percent": 0.4630997416123917,
        "time_per_call": 0.00021738369827586207
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1198,
        "function_name": "set_expanded",
        "total_calls": 70,
        "primitive_calls": 70,
        "total_time": 0.049404356,
        "cumulative_time": 0.049404356,
        "time_percent": 0.4536540822943932,
        "time_per_call": 0.0007057765142857144
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 289,
        "function_name": "_expand_batch",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.044997880000000004,
        "cumulative_time": 0.328362983,
        "time_percent": 3.015183675551088,
        "time_per_call": 0.029851180272727273
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 213,
        "function_name": "clone_states",
        "total_calls": 70,
        "primitive_calls": 70,
        "total_time": 0.038893306,
        "cumulative_time": 0.230913477,
        "time_percent": 2.1203563810819124,
        "time_per_call": 0.0032987639571428573
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 119,
        "function_name": "allocate_states",
        "total_calls": 70,
        "primitive_calls": 70,
        "total_time": 0.016093369,
        "cumulative_time": 0.114369471,
        "time_percent": 1.0501943878997273,
        "time_per_call": 0.0016338495857142858
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1205,
        "function_name": "_rebuild_row_pointers",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.015330254000000001,
        "cumulative_time": 0.027452987,
        "time_percent": 0.2520862659099313,
        "time_per_call": 0.002495726090909091
      },
      {
        "rank": 17,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 400,
        "function_name": "_evaluate_batch",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.015246709,
        "cumulative_time": 0.030377234000000003,
        "time_percent": 0.2789380801343112,
        "time_per_call": 0.0027615667272727277
      },
      {
        "rank": 18,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 131,
        "primitive_calls": 131,
        "total_time": 0.015049132000000002,
        "cumulative_time": 0.24344019000000003,
        "time_percent": 2.2353825639994724,
        "time_per_call": 0.0018583220610687025
      },
      {
        "rank": 19,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/gpu_game_states.py",
        "line_number": 299,
        "function_name": "apply_moves",
        "total_calls": 70,
        "primitive_calls": 70,
        "total_time": 0.013847663000000001,
        "cumulative_time": 0.019203932,
        "time_percent": 0.17633955491503484,
        "time_per_call": 0.0002743418857142857
      },
      {
        "rank": 20,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1964,
        "function_name": "virtual_memory",
        "total_calls": 131,
        "primitive_calls": 131,
        "total_time": 0.013074255000000002,
        "cumulative_time": 0.077390131,
        "time_percent": 0.710632658736567,
        "time_per_call": 0.000590764358778626
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 133,
        "primitive_calls": 133,
        "total_time": 0.012516658,
        "cumulative_time": 0.012534085,
        "time_percent": 0.11509387609616689,
        "time_per_call": 9.424124060150376e-05
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 262,
        "primitive_calls": 262,
        "total_time": 0.011546004,
        "cumulative_time": 0.07179181500000001,
        "time_percent": 0.6592262825989242,
        "time_per_call": 0.00027401456106870234
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.bincount>",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.010606371,
        "cumulative_time": 0.010606371,
        "time_percent": 0.09739269756858819,
        "time_per_call": 0.0009642155454545454
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 481,
        "primitive_calls": 481,
        "total_time": 0.008777166000000001,
        "cumulative_time": 0.09092781700000001,
        "time_percent": 0.8349420722368596,
        "time_per_call": 0.0001890391205821206
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 131,
        "primitive_calls": 131,
        "total_time": 0.008452757,
        "cumulative_time": 0.014177115,
        "time_percent": 0.13018095195709214,
        "time_per_call": 0.00010822225190839696
      },
      {
        "rank": 26,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 393,
        "primitive_calls": 393,
        "total_time": 0.007793329000000001,
        "cumulative_time": 0.007921939000000001,
        "time_percent": 0.07274297770498543,
        "time_per_call": 2.0157605597964378e-05
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.007653556000000001,
        "cumulative_time": 0.007653556000000001,
        "time_percent": 0.07027855850339891,
        "time_per_call": 0.0006957778181818183
      },
      {
        "rank": 28,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 111,
        "function_name": "batch_ucb_selection",
        "total_calls": 39,
        "primitive_calls": 39,
        "total_time": 0.007011248,
        "cumulative_time": 0.033720704000000004,
        "time_percent": 0.30963939753492337,
        "time_per_call": 0.000864633435897436
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 80569,
        "primitive_calls": 80569,
        "total_time": 0.005990597,
        "cumulative_time": 0.005990597,
        "time_percent": 0.055008485171440046,
        "time_per_call": 7.435362236095769e-08
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 481,
        "primitive_calls": 481,
        "total_time": 0.005904899000000001,
        "cumulative_time": 0.005904899000000001,
        "time_percent": 0.054221565743840086,
        "time_per_call": 1.2276297297297299e-05
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 481,
        "primitive_calls": 481,
        "total_time": 0.005869190000000001,
        "cumulative_time": 0.005869190000000001,
        "time_percent": 0.053893668875299776,
        "time_per_call": 1.2202058212058213e-05
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 58902,
        "primitive_calls": 58902,
        "total_time": 0.005706299000000001,
        "cumulative_time": 0.005706299000000001,
        "time_percent": 0.05239792693871799,
        "time_per_call": 9.68778479508336e-08
      },
      {
        "rank": 33,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/unified_mcts.py",
        "line_number": 459,
        "function_name": "_backup_batch",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.005373157,
        "cumulative_time": 0.015460030000000001,
        "time_percent": 0.14196128215685652,
        "time_per_call": 0.0014054572727272728
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'item' of 'torch._C.TensorBase' objects>",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 0.004524731000000001,
        "cumulative_time": 0.004524731000000001,
        "time_percent": 0.04154821266031668,
        "time_per_call": 0.00041133918181818186
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 131,
        "primitive_calls": 131,
        "total_time": 0.0034390790000000003,
        "cumulative_time": 0.0034390790000000003,
        "time_percent": 0.031579244301512994,
        "time_per_call": 2.6252511450381682e-05
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.arange>",
        "total_calls": 210,
        "primitive_calls": 210,
        "total_time": 0.003319021,
        "cumulative_time": 0.0033528280000000004,
        "time_percent": 0.030787246967270372,
        "time_per_call": 1.596584761904762e-05
      },
      {
        "rank": 37,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 390,
        "function_name": "_profile_phase",
        "total_calls": 44,
        "primitive_calls": 44,
        "total_time": 0.0032411780000000004,
        "cumulative_time": 1.2333568700000002,
        "time_percent": 11.325264092124494,
        "time_per_call": 0.02803083795454546
      },
      {
        "rank": 38,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 1642,
        "function_name": "wrapper",
        "total_calls": 262,
        "primitive_calls": 393,
        "total_time": 0.003028845,
        "cumulative_time": 0.039369903000000005,
        "time_percent": 0.3615130053609904,
        "time_per_call": 0.00015026680534351147
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1093,
        "function_name": "apply_virtual_loss",
        "total_calls": 50,
        "primitive_calls": 50,
        "total_time": 0.0028980850000000003,
        "cumulative_time": 0.0028980850000000003,
        "time_percent": 0.026611582409578352,
        "time_per_call": 5.7961700000000004e-05
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 131,
        "primitive_calls": 131,
        "total_time": 0.0028691710000000002,
        "cumulative_time": 0.003822446,
        "time_percent": 0.03509950078592006,
        "time_per_call": 2.9178977099236642e-05
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 131,
        "primitive_calls": 131,
        "total_time": 0.002656756,
        "cumulative_time": 0.002656756,
        "time_percent": 0.02439558578721526,
        "time_per_call": 2.028058015267176e-05
      },
      {
        "rank": 42,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1186,
        "function_name": "is_expanded",
        "total_calls": 100,
        "primitive_calls": 100,
        "total_time": 0.002570451,
        "cumulative_time": 0.0038750790000000005,
        "time_percent": 0.03558280179916271,
        "time_per_call": 3.875079000000001e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 211,
        "primitive_calls": 211,
        "total_time": 0.002432196,
        "cumulative_time": 0.0025355020000000002,
        "time_percent": 0.023282174409187697,
        "time_per_call": 1.2016597156398106e-05
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.floor_divide>",
        "total_calls": 140,
        "primitive_calls": 140,
        "total_time": 0.0024225360000000003,
        "cumulative_time": 0.0024225360000000003,
        "time_percent": 0.02224486735350078,
        "time_per_call": 1.7303828571428574e-05
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 393,
        "primitive_calls": 393,
        "total_time": 0.0022937590000000002,
        "cumulative_time": 0.00240369,
        "time_percent": 0.022071814498911997,
        "time_per_call": 6.1162595419847324e-06
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 19702,
        "primitive_calls": 19702,
        "total_time": 0.002216916,
        "cumulative_time": 0.005811931,
        "time_percent": 0.05336788974970821,
        "time_per_call": 2.9499192975332456e-07
      },
      {
        "rank": 47,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1257,
        "function_name": "ensure_consistent",
        "total_calls": 39,
        "primitive_calls": 39,
        "total_time": 0.002174919,
        "cumulative_time": 0.041531882,
        "time_percent": 0.3813653155334932,
        "time_per_call": 0.0010649200512820513
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 18759,
        "primitive_calls": 18759,
        "total_time": 0.0021074920000000003,
        "cumulative_time": 0.0021074920000000003,
        "time_percent": 0.019351984857423815,
        "time_per_call": 1.1234564742257052e-07
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full_like>",
        "total_calls": 50,
        "primitive_calls": 50,
        "total_time": 0.0019595190000000003,
        "cumulative_time": 0.0019595190000000003,
        "time_percent": 0.017993227028066657,
        "time_per_call": 3.919038000000001e-05
      },
      {
        "rank": 50,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 861,
        "primitive_calls": 861,
        "total_time": 0.001861093,
        "cumulative_time": 0.003595015,
        "time_percent": 0.03301112215003021,
        "time_per_call": 4.175394889663182e-06
      }
    ]
  }
]