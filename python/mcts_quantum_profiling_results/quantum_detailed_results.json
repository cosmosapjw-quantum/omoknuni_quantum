[
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": true,
      "quantum_config": "QuantumConfig(quantum_level='tree_level', min_wave_size=3072, optimal_wave_size=3072, hbar_eff=0.1, temperature=1.0, coupling_strength=0.1, decoherence_rate=0.01, measurement_noise=0.0, path_integral_steps=10, path_integral_beta=1.0, use_wick_rotation=True, interference_alpha=0.05, interference_method='minhash', minhash_size=64, phase_kick_strength=0.1, use_mixed_precision=True, cache_corrections=True, fast_mode=True, enable_quantum=True, uncertainty_decay=0.99, phase_temperature=1.0, device='cuda')",
      "enable_virtual_loss": true,
      "virtual_loss_value": -3.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "tree_level",
    "num_simulations": 1000,
    "wave_size": 3072,
    "total_time_ms": 23.72427799855359,
    "simulations_per_second": 42150.91393133091,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 8.337599754333496,
        "cpu_time_ms": 9.139087997027673,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8097599744796753,
        "cpu_time_ms": 1.093821003451012,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.019968032836914,
        "cpu_time_ms": 1.251722002052702,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.381792068481445,
        "cpu_time_ms": 4.629759998351801,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      }
    ],
    "peak_gpu_memory_mb": 2836.259765625,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 180.6,
    "avg_ram_usage_mb": 1232.1484375,
    "final_tree_nodes": 9,
    "final_tree_edges": 8,
    "tree_memory_mb": 50.92288589477539,
    "efficiency_score": 15218.118026002294,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Consider using classical selection for hot paths",
      "Tree-level quantum may be excessive - consider one-loop for balance",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 5,
    "total_kernel_calls": 5,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         9270 function calls (7024 primitive calls) in 0.022 seconds\n\n   Ordered by: cumulative time\n   List reduced from 175 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.021    0.021 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:214(search)\n        1    0.000    0.000    0.018    0.018 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:296(_run_search_wave_vectorized)\n        4    0.000    0.000    0.018    0.004 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:394(_profile_phase)\n        1    0.000    0.000    0.010    0.010 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:369(instrumented_select)\n        2    0.003    0.001    0.008    0.004 {built-in method time.sleep}\n        1    0.000    0.000    0.005    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:378(instrumented_backup)\n        1    0.003    0.003    0.004    0.004 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:747(_backup_batch_vectorized)\n       13    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n       14    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        3    0.002    0.001    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n    11/10    0.000    0.000    0.002    0.000 {built-in method builtins.next}\n        1    0.002    0.002    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n       10    0.000    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:196(timer)\n       10    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        4    0.002    0.000    0.002    0.000 {built-in method torch.where}\n        5    0.000    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:178(end_timer)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:375(instrumented_evaluate)\n      6/5    0.000    0.000    0.002    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n  2254/14    0.001    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:845(_extract_policy)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:372(instrumented_expand)\n       13    0.001    0.000    0.001    0.000 {built-in method torch._C._cuda_synchronize}\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:915(_get_quantum_phases)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:791(_add_dirichlet_noise_to_root)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:126(batch_ucb_selection)\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:450(_expand_batch_vectorized)\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:699(_evaluate_batch_vectorized)\n        2    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n        1    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n      2/1    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n        1    0.001    0.001    0.001    0.001 {built-in method torch._unique2}\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:974(batch_action_to_child)\n        4    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n      8/5    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n        3    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n        5    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n       39    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n       31    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n        3    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1863(cpu_times)\n       31    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n        3    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n       31    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n       10    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n       14    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n        2    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n        5    0.000    0.000    0.000    0.000 /usr/lib/python3.12/contextlib.py:132(__enter__)\n        2    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 747,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0027576700000000003,
        "cumulative_time": 0.004075565000000001,
        "time_percent": 3.1037867025586787,
        "time_per_call": 0.004075565000000001
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0026972090000000003,
        "cumulative_time": 0.008257216000000001,
        "time_percent": 6.288364244210253,
        "time_per_call": 0.004128608000000001
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0018974270000000001,
        "cumulative_time": 0.0019292830000000002,
        "time_percent": 1.4692644874692258,
        "time_per_call": 0.0006430943333333334
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0018156600000000002,
        "cumulative_time": 0.001845199,
        "time_percent": 1.4052294883714456,
        "time_per_call": 0.001845199
      },
      {
        "rank": 5,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.001636889,
        "cumulative_time": 0.001636889,
        "time_percent": 1.2465889543571438,
        "time_per_call": 0.00040922225
      },
      {
        "rank": 6,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.001398781,
        "cumulative_time": 0.001398781,
        "time_percent": 1.06525545969497,
        "time_per_call": 0.00010759853846153845
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 14,
        "primitive_calls": 2254,
        "total_time": 0.001177022,
        "cumulative_time": 0.0015685050000000002,
        "time_percent": 1.1945104450295359,
        "time_per_call": 0.00011203607142857144
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 450,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000803258,
        "cumulative_time": 0.000815837,
        "time_percent": 0.6213087098489078,
        "time_per_call": 0.000815837
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 699,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000767519,
        "cumulative_time": 0.0007991270000000001,
        "time_percent": 0.6085830446221834,
        "time_per_call": 0.0007991270000000001
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 915,
        "function_name": "_get_quantum_phases",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0006997860000000001,
        "cumulative_time": 0.0012999600000000002,
        "time_percent": 0.9899973529702458,
        "time_per_call": 0.0012999600000000002
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0006952070000000001,
        "cumulative_time": 0.0006952070000000001,
        "time_percent": 0.5294417441816561,
        "time_per_call": 0.00034760350000000005
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000600741,
        "cumulative_time": 0.000600741,
        "time_percent": 0.457500230638403,
        "time_per_call": 0.000600741
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 974,
        "function_name": "batch_action_to_child",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000526636,
        "cumulative_time": 0.000573193,
        "time_percent": 0.4365207796709699,
        "time_per_call": 0.000573193
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 214,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00040244200000000003,
        "cumulative_time": 0.020918488000000002,
        "time_percent": 15.930680750284509,
        "time_per_call": 0.020918488000000002
      },
      {
        "rank": 15,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'to' of 'torch._C.TensorBase' objects>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.00026012,
        "cumulative_time": 0.00026012,
        "time_percent": 0.19809695025586965,
        "time_per_call": 8.670666666666667e-05
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.00022690700000000001,
        "cumulative_time": 0.002273643,
        "time_percent": 1.7315152401607192,
        "time_per_call": 0.00016240307142857143
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.00019821700000000002,
        "cumulative_time": 0.00019821700000000002,
        "time_percent": 0.150954110367783,
        "time_per_call": 2.8316714285714287e-05
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.00019147900000000001,
        "cumulative_time": 0.00019147900000000001,
        "time_percent": 0.14582272004476265,
        "time_per_call": 1.367707142857143e-05
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 2516,
        "primitive_calls": 2516,
        "total_time": 0.000185615,
        "cumulative_time": 0.000185615,
        "time_percent": 0.14135693303761052,
        "time_per_call": 7.377384737678856e-08
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.000168689,
        "cumulative_time": 0.000168689,
        "time_percent": 0.12846677088156389,
        "time_per_call": 1.2049214285714286e-05
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 791,
        "function_name": "_add_dirichlet_noise_to_root",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000155938,
        "cumulative_time": 0.001191103,
        "time_percent": 0.9070962315109069,
        "time_per_call": 0.001191103
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 1719,
        "primitive_calls": 1719,
        "total_time": 0.000148064,
        "cumulative_time": 0.000148064,
        "time_percent": 0.11275959881087608,
        "time_per_call": 8.613379872018615e-08
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.000136634,
        "cumulative_time": 0.000136634,
        "time_percent": 0.10405496963424762,
        "time_per_call": 1.9519142857142857e-05
      },
      {
        "rank": 24,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00012516800000000002,
        "cumulative_time": 0.00012516800000000002,
        "time_percent": 0.09532292430273218,
        "time_per_call": 6.258400000000001e-05
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000104758,
        "cumulative_time": 0.00026358400000000003,
        "time_percent": 0.20073499360388725,
        "time_per_call": 0.00013179200000000001
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 126,
        "function_name": "batch_ucb_selection",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00010062600000000001,
        "cumulative_time": 0.0008561230000000001,
        "time_percent": 0.6519889102871979,
        "time_per_call": 0.0008561230000000001
      },
      {
        "rank": 27,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1100,
        "function_name": "remove_virtual_loss",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 9.768e-05,
        "cumulative_time": 0.000119983,
        "time_percent": 0.09137423643914351,
        "time_per_call": 0.000119983
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 8.7698e-05,
        "cumulative_time": 8.7698e-05,
        "time_percent": 0.06678727642449353,
        "time_per_call": 1.2528285714285714e-05
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 8.652300000000001e-05,
        "cumulative_time": 8.652300000000001e-05,
        "time_percent": 0.06589244359137557,
        "time_per_call": 2.8841000000000004e-05
      },
      {
        "rank": 30,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 845,
        "function_name": "_extract_policy",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 7.854300000000001e-05,
        "cumulative_time": 0.001484691,
        "time_percent": 1.1306810670934082,
        "time_per_call": 0.001484691
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x770c35fd2660>",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 7.454e-05,
        "cumulative_time": 7.454e-05,
        "time_percent": 0.05676667181328819,
        "time_per_call": 7.454e-06
      },
      {
        "rank": 32,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py",
        "line_number": 179,
        "function_name": "record",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 6.2632e-05,
        "cumulative_time": 0.000289419,
        "time_percent": 0.22040989253461302,
        "time_per_call": 2.89419e-05
      },
      {
        "rank": 33,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 6.2618e-05,
        "cumulative_time": 0.017825849,
        "time_percent": 13.575451032683548,
        "time_per_call": 0.00445646225
      },
      {
        "rank": 34,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1095,
        "function_name": "apply_virtual_loss",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 6.234e-05,
        "cumulative_time": 6.234e-05,
        "time_percent": 0.047475641546020735,
        "time_per_call": 6.234e-05
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 5.9145000000000004e-05,
        "cumulative_time": 5.9145000000000004e-05,
        "time_percent": 0.045042457799797826,
        "time_per_call": 7.3931250000000005e-06
      },
      {
        "rank": 36,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 196,
        "function_name": "timer",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 5.8624000000000007e-05,
        "cumulative_time": 0.001809023,
        "time_percent": 1.3776792989494238,
        "time_per_call": 0.0001809023
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 564,
        "primitive_calls": 564,
        "total_time": 5.3472000000000006e-05,
        "cumulative_time": 0.000129576,
        "time_percent": 0.09867988015667602,
        "time_per_call": 2.2974468085106385e-07
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 547,
        "primitive_calls": 547,
        "total_time": 5.2946000000000004e-05,
        "cumulative_time": 5.2946000000000004e-05,
        "time_percent": 0.0403215482402248,
        "time_per_call": 9.679341864716637e-08
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 39,
        "primitive_calls": 39,
        "total_time": 5.2363e-05,
        "cumulative_time": 0.000422888,
        "time_percent": 0.3220545252183769,
        "time_per_call": 1.0843282051282052e-05
      },
      {
        "rank": 40,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 4.7779000000000005e-05,
        "cumulative_time": 0.0023312000000000003,
        "time_percent": 1.7753483409060564,
        "time_per_call": 0.00017932307692307693
      },
      {
        "rank": 41,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 4.7343000000000004e-05,
        "cumulative_time": 7.693000000000001e-05,
        "time_percent": 0.05858679987384305,
        "time_per_call": 2.4816129032258067e-06
      },
      {
        "rank": 42,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 4.2932e-05,
        "cumulative_time": 7.6104e-05,
        "time_percent": 0.05795775143115756,
        "time_per_call": 4.4767058823529415e-06
      },
      {
        "rank": 43,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 4.1484000000000005e-05,
        "cumulative_time": 0.0017764190000000002,
        "time_percent": 1.3528494013400805,
        "time_per_call": 0.0001776419
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.fmod>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 4.1451e-05,
        "cumulative_time": 4.1451e-05,
        "time_percent": 0.03156741767282813,
        "time_per_call": 4.1451e-05
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 3.9699e-05,
        "cumulative_time": 3.9699e-05,
        "time_percent": 0.030233164801659884,
        "time_per_call": 1.3233e-05
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 3.7241000000000005e-05,
        "cumulative_time": 3.7241000000000005e-05,
        "time_percent": 0.028361250670762884,
        "time_per_call": 1.8620500000000002e-05
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 3.4743e-05,
        "cumulative_time": 3.4743e-05,
        "time_percent": 0.026458874145546978,
        "time_per_call": 6.948600000000001e-06
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method __new__ of type object at 0xa43b40>",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 3.2718e-05,
        "cumulative_time": 3.2718e-05,
        "time_percent": 0.024916715433152173,
        "time_per_call": 1.2117777777777778e-06
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 3.1976e-05,
        "cumulative_time": 3.1976e-05,
        "time_percent": 0.024351638018536396,
        "time_per_call": 3.1976e-05
      },
      {
        "rank": 50,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 812,
        "function_name": "_get_device_index",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 3.0901e-05,
        "cumulative_time": 0.000351033,
        "time_percent": 0.26733264162374554,
        "time_per_call": 1.1323645161290322e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": true,
      "quantum_config": "QuantumConfig(quantum_level='one_loop', min_wave_size=3072, optimal_wave_size=3072, hbar_eff=0.1, temperature=1.0, coupling_strength=0.1, decoherence_rate=0.01, measurement_noise=0.0, path_integral_steps=10, path_integral_beta=1.0, use_wick_rotation=True, interference_alpha=0.05, interference_method='minhash', minhash_size=64, phase_kick_strength=0.1, use_mixed_precision=True, cache_corrections=True, fast_mode=True, enable_quantum=True, uncertainty_decay=0.99, phase_temperature=1.0, device='cuda')",
      "enable_virtual_loss": true,
      "virtual_loss_value": -3.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "one_loop",
    "num_simulations": 1000,
    "wave_size": 3072,
    "total_time_ms": 25.71633900515735,
    "simulations_per_second": 38885.78385124929,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 8.759167671203613,
        "cpu_time_ms": 9.151275000476744,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8533440232276917,
        "cpu_time_ms": 1.1654530026135035,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1907520294189453,
        "cpu_time_ms": 1.5093139954842627,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      },
      {
        "name": "backup",
        "gpu_time_ms": 5.08841609954834,
        "cpu_time_ms": 5.442586996650789,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1000
      }
    ],
    "peak_gpu_memory_mb": 2840.4775390625,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 184.3,
    "avg_ram_usage_mb": 1232.3359375,
    "final_tree_nodes": 9,
    "final_tree_edges": 8,
    "tree_memory_mb": 50.92288589477539,
    "efficiency_score": 14018.432505127836,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Consider using classical selection for hot paths",
      "One-loop quantum is a good balance - monitor overhead",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 11,
    "total_kernel_calls": 11,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         10948 function calls (8211 primitive calls) in 0.024 seconds\n\n   Ordered by: cumulative time\n   List reduced from 175 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.023    0.023 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:214(search)\n        1    0.000    0.000    0.019    0.019 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:296(_run_search_wave_vectorized)\n        4    0.000    0.000    0.019    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:394(_profile_phase)\n        1    0.000    0.000    0.010    0.010 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:369(instrumented_select)\n        2    0.003    0.001    0.008    0.004 {built-in method time.sleep}\n        1    0.000    0.000    0.006    0.006 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:378(instrumented_backup)\n        1    0.004    0.004    0.005    0.005 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:747(_backup_batch_vectorized)\n       17    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:845(_extract_policy)\n  2737/17    0.002    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       11    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:375(instrumented_evaluate)\n       13    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        1    0.002    0.002    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n        4    0.002    0.000    0.002    0.000 {built-in method torch.where}\n       13    0.002    0.000    0.002    0.000 {built-in method torch._C._cuda_synchronize}\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:372(instrumented_expand)\n       10    0.000    0.000    0.001    0.000 {built-in method builtins.next}\n        3    0.001    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n       10    0.000    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:196(timer)\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:915(_get_quantum_phases)\n        5    0.000    0.000    0.001    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n        5    0.000    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:178(end_timer)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:791(_add_dirichlet_noise_to_root)\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:699(_evaluate_batch_vectorized)\n        6    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:450(_expand_batch_vectorized)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:126(batch_ucb_selection)\n        2    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n        1    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:974(batch_action_to_child)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n      2/1    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n        1    0.001    0.001    0.001    0.001 {built-in method torch._unique2}\n       43    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n        3    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n       31    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n       17    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n        3    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n        3    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n       31    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n        3    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:812(bcat)\n        3    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:795(cat)\n       31    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n       10    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n        3    0.000    0.000    0.000    0.000 {method 'to' of 'torch._C.TensorBase' objects}\n     3003    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}\n       10    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1056(current_stream)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 747,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0035473590000000004,
        "cumulative_time": 0.004963842,
        "time_percent": 3.6191810598522896,
        "time_per_call": 0.004963842
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.002773497,
        "cumulative_time": 0.008245905000000001,
        "time_percent": 6.012162191572837,
        "time_per_call": 0.004122952500000001
      },
      {
        "rank": 3,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.001775936,
        "cumulative_time": 0.001775936,
        "time_percent": 1.294850628748827,
        "time_per_call": 0.000443984
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.001757539,
        "cumulative_time": 0.0017873110000000002,
        "time_percent": 1.3031442417517833,
        "time_per_call": 0.0017873110000000002
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 17,
        "primitive_calls": 2737,
        "total_time": 0.001628242,
        "cumulative_time": 0.0021426360000000003,
        "time_percent": 1.5622148386990702,
        "time_per_call": 0.0001260374117647059
      },
      {
        "rank": 6,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.0015367100000000002,
        "cumulative_time": 0.0015367100000000002,
        "time_percent": 1.1204288384855143,
        "time_per_call": 0.00011820846153846155
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.001380637,
        "cumulative_time": 0.001411277,
        "time_percent": 1.028974529931686,
        "time_per_call": 0.0004704256666666667
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 699,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.0009319650000000001,
        "cumulative_time": 0.0009652710000000001,
        "time_percent": 0.7037876146792503,
        "time_per_call": 0.0009652710000000001
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 450,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000873615,
        "cumulative_time": 0.000886561,
        "time_percent": 0.646399458242971,
        "time_per_call": 0.000886561
      },
      {
        "rank": 10,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000803014,
        "cumulative_time": 0.000803014,
        "time_percent": 0.5854846023697423,
        "time_per_call": 0.000401507
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 915,
        "function_name": "_get_quantum_phases",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000748157,
        "cumulative_time": 0.001376162,
        "time_percent": 1.0033718731757468,
        "time_per_call": 0.001376162
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000610774,
        "cumulative_time": 0.000610774,
        "time_percent": 0.445320719847695,
        "time_per_call": 0.000610774
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 974,
        "function_name": "batch_action_to_child",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000603193,
        "cumulative_time": 0.0006489940000000001,
        "time_percent": 0.4731872595376277,
        "time_per_call": 0.0006489940000000001
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 214,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000497926,
        "cumulative_time": 0.022901879,
        "time_percent": 16.69796232672774,
        "time_per_call": 0.022901879
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.000279371,
        "cumulative_time": 0.0029598000000000003,
        "time_percent": 2.158016331090072,
        "time_per_call": 0.0001741058823529412
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'to' of 'torch._C.TensorBase' objects>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.00025303,
        "cumulative_time": 0.00025303,
        "time_percent": 0.1844864086275157,
        "time_per_call": 8.434333333333334e-05
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 3003,
        "primitive_calls": 3003,
        "total_time": 0.00022757000000000002,
        "cumulative_time": 0.00022757000000000002,
        "time_percent": 0.16592329767760244,
        "time_per_call": 7.578088578088579e-08
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.000212093,
        "cumulative_time": 0.000212093,
        "time_percent": 0.1546388802317341,
        "time_per_call": 1.2476058823529412e-05
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 2086,
        "primitive_calls": 2086,
        "total_time": 0.000206457,
        "cumulative_time": 0.000206457,
        "time_percent": 0.15052962283528043,
        "time_per_call": 9.897267497603068e-08
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 17,
        "primitive_calls": 17,
        "total_time": 0.000202429,
        "cumulative_time": 0.000202429,
        "time_percent": 0.14759277244618968,
        "time_per_call": 1.1907588235294118e-05
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.00018709300000000002,
        "cumulative_time": 0.00018709300000000002,
        "time_percent": 0.13641115934611625,
        "time_per_call": 6.236433333333334e-05
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.00017997,
        "cumulative_time": 0.00017997,
        "time_percent": 0.131217717111386,
        "time_per_call": 1.9996666666666668e-05
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 791,
        "function_name": "_add_dirichlet_noise_to_root",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00015819,
        "cumulative_time": 0.00117017,
        "time_percent": 0.853181285948939,
        "time_per_call": 0.00117017
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.00015452,
        "cumulative_time": 0.00031702,
        "time_percent": 0.23114208300634323,
        "time_per_call": 0.00010567333333333334
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 126,
        "function_name": "batch_ucb_selection",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00011164700000000001,
        "cumulative_time": 0.000873644,
        "time_percent": 0.6369815594157899,
        "time_per_call": 0.000873644
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1100,
        "function_name": "remove_virtual_loss",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00010347000000000001,
        "cumulative_time": 0.000126227,
        "time_percent": 0.09203322096915552,
        "time_per_call": 0.000126227
      },
      {
        "rank": 27,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 845,
        "function_name": "_extract_policy",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00010115900000000001,
        "cumulative_time": 0.0022244820000000003,
        "time_percent": 1.6218894804432413,
        "time_per_call": 0.0022244820000000003
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 9.2285e-05,
        "cumulative_time": 9.2285e-05,
        "time_percent": 0.06728580887716984,
        "time_per_call": 3.076166666666667e-05
      },
      {
        "rank": 29,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 8.903700000000001e-05,
        "cumulative_time": 0.018994643000000002,
        "time_percent": 13.849162037038221,
        "time_per_call": 0.0047486607500000005
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 8.7865e-05,
        "cumulative_time": 8.7865e-05,
        "time_percent": 0.0640631478245926,
        "time_per_call": 1.2552142857142858e-05
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 664,
        "primitive_calls": 664,
        "total_time": 6.7667e-05,
        "cumulative_time": 6.7667e-05,
        "time_percent": 0.049336607566684204,
        "time_per_call": 1.0190813253012048e-07
      },
      {
        "rank": 32,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1095,
        "function_name": "apply_virtual_loss",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 6.516800000000001e-05,
        "cumulative_time": 6.516800000000001e-05,
        "time_percent": 0.047514564586957846,
        "time_per_call": 6.516800000000001e-05
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 6.157600000000001e-05,
        "cumulative_time": 6.157600000000001e-05,
        "time_percent": 0.044895605650112275,
        "time_per_call": 7.697000000000001e-06
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'split' of 'bytes' objects>",
        "total_calls": 166,
        "primitive_calls": 166,
        "total_time": 6.1535e-05,
        "cumulative_time": 6.1535e-05,
        "time_percent": 0.04486571218785985,
        "time_per_call": 3.7069277108433736e-07
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 680,
        "primitive_calls": 680,
        "total_time": 6.0620000000000006e-05,
        "cumulative_time": 0.00013499,
        "time_percent": 0.09842240169398231,
        "time_per_call": 1.9851470588235294e-07
      },
      {
        "rank": 36,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 320,
        "function_name": "_select_batch_vectorized",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 5.9997e-05,
        "cumulative_time": 5.9997e-05,
        "time_percent": 0.04374434279897664,
        "time_per_call": 5.9997e-05
      },
      {
        "rank": 37,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 178,
        "function_name": "end_timer",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 5.6148000000000005e-05,
        "cumulative_time": 0.0012167810000000001,
        "time_percent": 0.8871657778769205,
        "time_per_call": 0.00024335620000000003
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x770c35fd2660>",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 5.4107e-05,
        "cumulative_time": 5.4107e-05,
        "time_percent": 0.03944989175832506,
        "time_per_call": 5.4107000000000006e-06
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 43,
        "primitive_calls": 43,
        "total_time": 5.3059e-05,
        "cumulative_time": 0.000425666,
        "time_percent": 0.31035684153989684,
        "time_per_call": 9.899209302325581e-06
      },
      {
        "rank": 40,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 11,
        "primitive_calls": 11,
        "total_time": 4.5780000000000006e-05,
        "cumulative_time": 0.002136783,
        "time_percent": 1.5579473646853292,
        "time_per_call": 0.00019425300000000003
      },
      {
        "rank": 41,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 4.5307000000000005e-05,
        "cumulative_time": 7.3967e-05,
        "time_percent": 0.05392999322985991,
        "time_per_call": 2.3860322580645164e-06
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 4.063e-05,
        "cumulative_time": 4.063e-05,
        "time_percent": 0.02962369198330618,
        "time_per_call": 1.3543333333333335e-05
      },
      {
        "rank": 43,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 4.0565e-05,
        "cumulative_time": 7.437000000000001e-05,
        "time_percent": 0.054223824090536075,
        "time_per_call": 4.6481250000000005e-06
      },
      {
        "rank": 44,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 3.9963000000000003e-05,
        "cumulative_time": 0.0017939890000000002,
        "time_percent": 1.3080132305547494,
        "time_per_call": 0.00013799915384615387
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 3.828e-05,
        "cumulative_time": 3.828e-05,
        "time_percent": 0.0279102862200581,
        "time_per_call": 1.914e-05
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 3.6937e-05,
        "cumulative_time": 3.6937e-05,
        "time_percent": 0.026931093054082703,
        "time_per_call": 4.104111111111112e-06
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 3.668e-05,
        "cumulative_time": 3.668e-05,
        "time_percent": 0.026743712083378557,
        "time_per_call": 7.3360000000000006e-06
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method __new__ of type object at 0xa43b40>",
        "total_calls": 30,
        "primitive_calls": 30,
        "total_time": 3.6636e-05,
        "cumulative_time": 3.6636e-05,
        "time_percent": 0.026711631294619866,
        "time_per_call": 1.2212e-06
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sum' of 'torch._C.TensorBase' objects>",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 3.3236000000000005e-05,
        "cumulative_time": 3.3236000000000005e-05,
        "time_percent": 0.024232661254175836,
        "time_per_call": 3.3236000000000005e-05
      },
      {
        "rank": 50,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 812,
        "function_name": "_get_device_index",
        "total_calls": 31,
        "primitive_calls": 31,
        "total_time": 3.2469000000000004e-05,
        "cumulative_time": 0.000352899,
        "time_percent": 0.2573017789125466,
        "time_per_call": 1.1383838709677419e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": true,
      "quantum_config": "QuantumConfig(quantum_level='tree_level', min_wave_size=3072, optimal_wave_size=3072, hbar_eff=0.1, temperature=1.0, coupling_strength=0.1, decoherence_rate=0.01, measurement_noise=0.0, path_integral_steps=10, path_integral_beta=1.0, use_wick_rotation=True, interference_alpha=0.05, interference_method='minhash', minhash_size=64, phase_kick_strength=0.1, use_mixed_precision=True, cache_corrections=True, fast_mode=True, enable_quantum=True, uncertainty_decay=0.99, phase_temperature=1.0, device='cuda')",
      "enable_virtual_loss": true,
      "virtual_loss_value": -3.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "tree_level",
    "num_simulations": 5000,
    "wave_size": 3072,
    "total_time_ms": 43.96291499870131,
    "simulations_per_second": 113732.22180894291,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 8.967552185058594,
        "cpu_time_ms": 9.401850002177525,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8981760144233704,
        "cpu_time_ms": 1.1891399990417995,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 0.9910719990730286,
        "cpu_time_ms": 1.311316002102103,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.838399887084961,
        "cpu_time_ms": 5.103852003230713,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 9.174271583557129,
        "cpu_time_ms": 9.518504004518036,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.9117119908332825,
        "cpu_time_ms": 1.2109289964428172,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.1189759969711304,
        "cpu_time_ms": 1.733381999656558,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.521984100341797,
        "cpu_time_ms": 4.790325998328626,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      }
    ],
    "peak_gpu_memory_mb": 2852.16015625,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 176.2,
    "avg_ram_usage_mb": 1232.5234375,
    "final_tree_nodes": 9,
    "final_tree_edges": 8,
    "tree_memory_mb": 50.92288589477539,
    "efficiency_score": 40832.83853368202,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Consider using classical selection for hot paths",
      "Tree-level quantum may be excessive - consider one-loop for balance",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 21,
    "total_kernel_calls": 21,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         18282 function calls (13796 primitive calls) in 0.042 seconds\n\n   Ordered by: cumulative time\n   List reduced from 175 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.040    0.040 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:214(search)\n        2    0.000    0.000    0.038    0.019 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:296(_run_search_wave_vectorized)\n        8    0.000    0.000    0.038    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:394(_profile_phase)\n        2    0.000    0.000    0.020    0.010 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:369(instrumented_select)\n        2    0.000    0.000    0.011    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:378(instrumented_backup)\n        2    0.003    0.002    0.009    0.005 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:320(_select_batch_vectorized)\n        2    0.006    0.003    0.009    0.004 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:747(_backup_batch_vectorized)\n        3    0.003    0.001    0.009    0.003 {built-in method time.sleep}\n       28    0.000    0.000    0.005    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n       20    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        2    0.000    0.000    0.004    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:375(instrumented_evaluate)\n  4508/28    0.003    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n        2    0.004    0.002    0.004    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n        8    0.004    0.000    0.004    0.000 {built-in method torch.where}\n       25    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        2    0.000    0.000    0.003    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:372(instrumented_expand)\n        2    0.002    0.001    0.003    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:915(_get_quantum_phases)\n       25    0.003    0.000    0.003    0.000 {built-in method torch._C._cuda_synchronize}\n       18    0.000    0.000    0.003    0.000 {built-in method builtins.next}\n       18    0.000    0.000    0.003    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:196(timer)\n        9    0.000    0.000    0.002    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n        9    0.000    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:178(end_timer)\n        4    0.002    0.001    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n        2    0.000    0.000    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n        2    0.000    0.000    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:126(batch_ucb_selection)\n        2    0.002    0.001    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:450(_expand_batch_vectorized)\n        8    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:845(_extract_policy)\n        2    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n      4/2    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        2    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        2    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n        2    0.001    0.001    0.001    0.001 {built-in method torch._unique2}\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:791(_add_dirichlet_noise_to_root)\n        2    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:974(batch_action_to_child)\n        2    0.001    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:699(_evaluate_batch_vectorized)\n       75    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n        8    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n       59    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n        2    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n       28    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n     12/8    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n       59    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n       59    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n        4    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n       18    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n     5008    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}\n       28    0.000    0.000    0.000    0.000 {built-in method torch._C._cuda_memoryStats}\n        9    0.000    0.000    0.000    0.000 /usr/lib/python3.12/contextlib.py:132(__enter__)\n       18    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1056(current_stream)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 747,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00610693,
        "cumulative_time": 0.008953551,
        "time_percent": 3.4646778444337127,
        "time_per_call": 0.0044767755
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.0035458350000000002,
        "cumulative_time": 0.0035458350000000002,
        "time_percent": 1.3721009646918427,
        "time_per_call": 0.00044322937500000003
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0035158760000000002,
        "cumulative_time": 0.003569337,
        "time_percent": 1.3811953294528052,
        "time_per_call": 0.0017846685
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 320,
        "function_name": "_select_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.003104602,
        "cumulative_time": 0.009197815,
        "time_percent": 3.559198562413959,
        "time_per_call": 0.0045989075
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 28,
        "primitive_calls": 4508,
        "total_time": 0.002909816,
        "cumulative_time": 0.003811881,
        "time_percent": 1.475050473975948,
        "time_per_call": 0.00013613860714285715
      },
      {
        "rank": 6,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.0028276580000000003,
        "cumulative_time": 0.0028276580000000003,
        "time_percent": 1.0941942503299242,
        "time_per_call": 0.00011310632
      },
      {
        "rank": 7,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.002745303,
        "cumulative_time": 0.008571368000000001,
        "time_percent": 3.316787809226541,
        "time_per_call": 0.002857122666666667
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.002148374,
        "cumulative_time": 0.002187946,
        "time_percent": 0.8466504553352479,
        "time_per_call": 0.0005469865
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 915,
        "function_name": "_get_quantum_phases",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.001742133,
        "cumulative_time": 0.003000056,
        "time_percent": 1.1609056066425962,
        "time_per_call": 0.001500028
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 450,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.001661455,
        "cumulative_time": 0.00168658,
        "time_percent": 0.6526412100478358,
        "time_per_call": 0.00084329
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0013171460000000002,
        "cumulative_time": 0.0013171460000000002,
        "time_percent": 0.5096845446107904,
        "time_per_call": 0.0006585730000000001
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 974,
        "function_name": "batch_action_to_child",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00110332,
        "cumulative_time": 0.0011980740000000001,
        "time_percent": 0.46360828723621234,
        "time_per_call": 0.0005990370000000001
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 699,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000969538,
        "cumulative_time": 0.001023845,
        "time_percent": 0.3961884047607741,
        "time_per_call": 0.0005119225
      },
      {
        "rank": 14,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000668761,
        "cumulative_time": 0.000668761,
        "time_percent": 0.2587846341547989,
        "time_per_call": 0.0003343805
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.000498095,
        "cumulative_time": 0.0053152930000000004,
        "time_percent": 2.056812754377967,
        "time_per_call": 0.00018983189285714288
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 5008,
        "primitive_calls": 5008,
        "total_time": 0.000424094,
        "cumulative_time": 0.000424094,
        "time_percent": 0.16410797076570746,
        "time_per_call": 8.468330670926519e-08
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.000416471,
        "cumulative_time": 0.000416471,
        "time_percent": 0.16115816468227553,
        "time_per_call": 1.4873964285714286e-05
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.00034156400000000004,
        "cumulative_time": 0.00034156400000000004,
        "time_percent": 0.13217205366408888,
        "time_per_call": 1.2198714285714287e-05
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 3437,
        "primitive_calls": 3437,
        "total_time": 0.000338182,
        "cumulative_time": 0.000338182,
        "time_percent": 0.13086335050599274,
        "time_per_call": 9.839453011347105e-08
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.00026696900000000004,
        "cumulative_time": 0.00026696900000000004,
        "time_percent": 0.10330667457533038,
        "time_per_call": 2.224741666666667e-05
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'to' of 'torch._C.TensorBase' objects>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.00025379600000000003,
        "cumulative_time": 0.00025379600000000003,
        "time_percent": 0.09820923320880157,
        "time_per_call": 5.075920000000001e-05
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00022324,
        "cumulative_time": 0.000345982,
        "time_percent": 0.1338816487416964,
        "time_per_call": 8.64955e-05
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1100,
        "function_name": "remove_virtual_loss",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000195596,
        "cumulative_time": 0.000238442,
        "time_percent": 0.09226782922021255,
        "time_per_call": 0.000119221
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 126,
        "function_name": "batch_ucb_selection",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00019324700000000002,
        "cumulative_time": 0.001791524,
        "time_percent": 0.6932504780026676,
        "time_per_call": 0.000895762
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.00018794700000000002,
        "cumulative_time": 0.037668054,
        "time_percent": 14.57607960648604,
        "time_per_call": 0.00470850675
      },
      {
        "rank": 26,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.000173057,
        "cumulative_time": 0.000173057,
        "time_percent": 0.066966363817458,
        "time_per_call": 1.2361214285714285e-05
      },
      {
        "rank": 27,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 791,
        "function_name": "_add_dirichlet_noise_to_root",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00016620600000000001,
        "cumulative_time": 0.00131452,
        "time_percent": 0.5086683842047701,
        "time_per_call": 0.00131452
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 0.00013945300000000002,
        "cumulative_time": 0.00013945300000000002,
        "time_percent": 0.053962915879946914,
        "time_per_call": 1.0727153846153848e-05
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000136744,
        "cumulative_time": 0.000136744,
        "time_percent": 0.05291463768500828,
        "time_per_call": 3.4186e-05
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x770c35fd2660>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.000127913,
        "cumulative_time": 0.000127913,
        "time_percent": 0.049497382336354534,
        "time_per_call": 7.106277777777778e-06
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 1093,
        "primitive_calls": 1093,
        "total_time": 0.000126715,
        "cumulative_time": 0.000126715,
        "time_percent": 0.04903380268425543,
        "time_per_call": 1.1593321134492224e-07
      },
      {
        "rank": 32,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1095,
        "function_name": "apply_virtual_loss",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000124823,
        "cumulative_time": 0.000124823,
        "time_percent": 0.04830167188144115,
        "time_per_call": 6.24115e-05
      },
      {
        "rank": 33,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 564,
        "function_name": "get_device_properties",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00011406400000000001,
        "cumulative_time": 0.00015887300000000002,
        "time_percent": 0.06147770456422454,
        "time_per_call": 3.9718250000000006e-05
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.000104993,
        "cumulative_time": 0.000104993,
        "time_percent": 0.040628229059132936,
        "time_per_call": 7.4995e-06
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 1121,
        "primitive_calls": 1121,
        "total_time": 0.000100724,
        "cumulative_time": 0.00022603600000000002,
        "time_percent": 0.08746718718019461,
        "time_per_call": 2.016378233719893e-07
      },
      {
        "rank": 36,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 75,
        "primitive_calls": 75,
        "total_time": 9.966900000000001e-05,
        "cumulative_time": 0.0008142000000000001,
        "time_percent": 0.3150639004499923,
        "time_per_call": 1.0856e-05
      },
      {
        "rank": 37,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 812,
        "function_name": "_get_device_index",
        "total_calls": 59,
        "primitive_calls": 59,
        "total_time": 8.8644e-05,
        "cumulative_time": 0.000677388,
        "time_percent": 0.26212294939574965,
        "time_per_call": 1.1481152542372882e-05
      },
      {
        "rank": 38,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 20,
        "primitive_calls": 20,
        "total_time": 8.546000000000001e-05,
        "cumulative_time": 0.003934433,
        "time_percent": 1.5224733567172248,
        "time_per_call": 0.00019672165000000002
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 845,
        "function_name": "_extract_policy",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 8.3779e-05,
        "cumulative_time": 0.001408488,
        "time_percent": 0.5450303647961295,
        "time_per_call": 0.001408488
      },
      {
        "rank": 40,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 59,
        "primitive_calls": 59,
        "total_time": 8.3763e-05,
        "cumulative_time": 0.000137742,
        "time_percent": 0.05330082507465344,
        "time_per_call": 2.334610169491525e-06
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 7.9929e-05,
        "cumulative_time": 7.9929e-05,
        "time_percent": 0.030929430728405094,
        "time_per_call": 1.998225e-05
      },
      {
        "rank": 42,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 7.527e-05,
        "cumulative_time": 7.527e-05,
        "time_percent": 0.029126577974540553,
        "time_per_call": 1.2545000000000001e-05
      },
      {
        "rank": 43,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 7.411100000000001e-05,
        "cumulative_time": 0.003331361,
        "time_percent": 1.2891078242041105,
        "time_per_call": 0.00013325444
      },
      {
        "rank": 44,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 214,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 7.163e-05,
        "cumulative_time": 0.040485745000000004,
        "time_percent": 15.666417013416572,
        "time_per_call": 0.040485745000000004
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 6.945000000000001e-05,
        "cumulative_time": 6.945000000000001e-05,
        "time_percent": 0.02687446313713088,
        "time_per_call": 6.945e-06
      },
      {
        "rank": 46,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 6.767700000000001e-05,
        "cumulative_time": 0.000125312,
        "time_percent": 0.04849089596314103,
        "time_per_call": 4.641185185185186e-06
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 6.3197e-05,
        "cumulative_time": 6.3197e-05,
        "time_percent": 0.024454794051508424,
        "time_per_call": 1.579925e-05
      },
      {
        "rank": 48,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py",
        "line_number": 179,
        "function_name": "record",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 5.9461000000000005e-05,
        "cumulative_time": 0.000515617,
        "time_percent": 0.1995238309485675,
        "time_per_call": 2.864538888888889e-05
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method __new__ of type object at 0xa43b40>",
        "total_calls": 50,
        "primitive_calls": 50,
        "total_time": 5.9156e-05,
        "cumulative_time": 5.9156e-05,
        "time_percent": 0.022891083388626558,
        "time_per_call": 1.18312e-06
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'split' of 'bytes' objects>",
        "total_calls": 221,
        "primitive_calls": 221,
        "total_time": 5.8136e-05,
        "cumulative_time": 5.8136e-05,
        "time_percent": 0.02249638285011146,
        "time_per_call": 2.630588235294118e-07
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": true,
      "quantum_config": "QuantumConfig(quantum_level='one_loop', min_wave_size=3072, optimal_wave_size=3072, hbar_eff=0.1, temperature=1.0, coupling_strength=0.1, decoherence_rate=0.01, measurement_noise=0.0, path_integral_steps=10, path_integral_beta=1.0, use_wick_rotation=True, interference_alpha=0.05, interference_method='minhash', minhash_size=64, phase_kick_strength=0.1, use_mixed_precision=True, cache_corrections=True, fast_mode=True, enable_quantum=True, uncertainty_decay=0.99, phase_temperature=1.0, device='cuda')",
      "enable_virtual_loss": true,
      "virtual_loss_value": -3.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "one_loop",
    "num_simulations": 5000,
    "wave_size": 3072,
    "total_time_ms": 45.810685005562846,
    "simulations_per_second": 109144.8425054732,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 10.372896194458008,
        "cpu_time_ms": 10.771395995107014,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.876416027545929,
        "cpu_time_ms": 1.1655240014079027,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0458240509033203,
        "cpu_time_ms": 1.299761002883315,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 5.939968109130859,
        "cpu_time_ms": 6.215784997039009,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.733951568603516,
        "cpu_time_ms": 9.120622999034822,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.9214720129966736,
        "cpu_time_ms": 1.270797998586204,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0724799633026123,
        "cpu_time_ms": 1.348890997178387,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.877471923828125,
        "cpu_time_ms": 5.140899003890809,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 1928
      }
    ],
    "peak_gpu_memory_mb": 2849.169921875,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 180.9,
    "avg_ram_usage_mb": 1232.7109375,
    "final_tree_nodes": 9,
    "final_tree_edges": 8,
    "tree_memory_mb": 50.92288589477539,
    "efficiency_score": 39226.975501711735,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Consider using classical selection for hot paths",
      "One-loop quantum is a good balance - monitor overhead",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 30,
    "total_kernel_calls": 30,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         18282 function calls (13796 primitive calls) in 0.044 seconds\n\n   Ordered by: cumulative time\n   List reduced from 175 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.043    0.043 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:214(search)\n        8    0.000    0.000    0.040    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:394(_profile_phase)\n        2    0.000    0.000    0.040    0.020 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:296(_run_search_wave_vectorized)\n        2    0.006    0.003    0.019    0.010 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:320(_select_batch_vectorized)\n        2    0.000    0.000    0.013    0.006 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:372(instrumented_expand)\n        2    0.000    0.000    0.012    0.006 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:378(instrumented_backup)\n        2    0.000    0.000    0.012    0.006 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:369(instrumented_select)\n        8    0.003    0.000    0.006    0.001 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:452(wrapper)\n        2    0.003    0.002    0.005    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:747(_backup_batch_vectorized)\n       28    0.000    0.000    0.005    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        8    0.004    0.000    0.004    0.000 {built-in method torch.where}\n        2    0.004    0.002    0.004    0.002 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n       20    0.000    0.000    0.004    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n        2    0.002    0.001    0.004    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:915(_get_quantum_phases)\n        2    0.000    0.000    0.003    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:375(instrumented_evaluate)\n  4508/28    0.003    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       25    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        4    0.003    0.001    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n       25    0.003    0.000    0.003    0.000 {built-in method torch._C._cuda_synchronize}\n       18    0.000    0.000    0.002    0.000 {built-in method builtins.next}\n        2    0.000    0.000    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n       18    0.000    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:196(timer)\n        2    0.000    0.000    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:126(batch_ucb_selection)\n        9    0.000    0.000    0.002    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n        9    0.000    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:178(end_timer)\n        2    0.002    0.001    0.002    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:699(_evaluate_batch_vectorized)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:845(_extract_policy)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:791(_add_dirichlet_noise_to_root)\n        2    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n      4/2    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        2    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        2    0.000    0.000    0.001    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n        2    0.001    0.001    0.001    0.001 {built-in method torch._unique2}\n        8    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        2    0.001    0.001    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:450(_expand_batch_vectorized)\n        4    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n     12/8    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1642(wrapper)\n        3    0.001    0.000    0.001    0.000 {built-in method time.sleep}\n       75    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n        2    0.001    0.000    0.001    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}\n        2    0.001    0.000    0.001    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:974(batch_action_to_child)\n       59    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n        4    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1113(memory_info)\n       59    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n       18    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n       59    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n       28    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n        4    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1009(cpu_percent)\n        9    0.000    0.000    0.000    0.000 /usr/lib/python3.12/contextlib.py:132(__enter__)\n       18    0.000    0.000    0.000    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1056(current_stream)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 320,
        "function_name": "_select_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.006019491,
        "cumulative_time": 0.019212231,
        "time_percent": 7.087372522067703,
        "time_per_call": 0.0096061155
      },
      {
        "rank": 2,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.0038884790000000002,
        "cumulative_time": 0.0038884790000000002,
        "time_percent": 1.4344559576260196,
        "time_per_call": 0.00048605987500000003
      },
      {
        "rank": 3,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.003788608,
        "cumulative_time": 0.003849018,
        "time_percent": 1.4198988347654151,
        "time_per_call": 0.001924509
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 747,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.003369454,
        "cumulative_time": 0.00475818,
        "time_percent": 1.7552877740774668,
        "time_per_call": 0.00237909
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 452,
        "function_name": "wrapper",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.003168315,
        "cumulative_time": 0.005955022000000001,
        "time_percent": 2.1968015734928787,
        "time_per_call": 0.0007443777500000001
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.002675406,
        "cumulative_time": 0.002712963,
        "time_percent": 1.0008092979720244,
        "time_per_call": 0.00067824075
      },
      {
        "rank": 7,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 0.002598627,
        "cumulative_time": 0.002598627,
        "time_percent": 0.9586308635838925,
        "time_per_call": 0.00010394508
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 28,
        "primitive_calls": 4508,
        "total_time": 0.0025078770000000004,
        "cumulative_time": 0.0033203610000000004,
        "time_percent": 1.2248778038711507,
        "time_per_call": 0.00011858432142857144
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 915,
        "function_name": "_get_quantum_phases",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.001933592,
        "cumulative_time": 0.003525704,
        "time_percent": 1.3006286282183568,
        "time_per_call": 0.001762852
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 699,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.001626,
        "cumulative_time": 0.0016906100000000002,
        "time_percent": 0.6236643136100581,
        "time_per_call": 0.0008453050000000001
      },
      {
        "rank": 11,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.001259914,
        "cumulative_time": 0.001259914,
        "time_percent": 0.4647809962189403,
        "time_per_call": 0.000629957
      },
      {
        "rank": 12,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 450,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.001181275,
        "cumulative_time": 0.001193433,
        "time_percent": 0.4402562227743788,
        "time_per_call": 0.0005967165
      },
      {
        "rank": 13,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 3,
        "primitive_calls": 3,
        "total_time": 0.0007991750000000001,
        "cumulative_time": 0.0008484730000000001,
        "time_percent": 0.31300082879059443,
        "time_per_call": 0.00028282433333333336
      },
      {
        "rank": 14,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000764228,
        "cumulative_time": 0.000764228,
        "time_percent": 0.28192293377040684,
        "time_per_call": 0.000382114
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 974,
        "function_name": "batch_action_to_child",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0006576920000000001,
        "cumulative_time": 0.00071128,
        "time_percent": 0.26239047029448664,
        "time_per_call": 0.00035564
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.00046296700000000006,
        "cumulative_time": 0.00466068,
        "time_percent": 1.7193201230065631,
        "time_per_call": 0.00016645285714285716
      },
      {
        "rank": 17,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 214,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000373716,
        "cumulative_time": 0.042864656,
        "time_percent": 15.812728105459719,
        "time_per_call": 0.042864656
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 5008,
        "primitive_calls": 5008,
        "total_time": 0.000368559,
        "cumulative_time": 0.000368559,
        "time_percent": 0.13596104113888444,
        "time_per_call": 7.359404952076677e-08
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.00032796,
        "cumulative_time": 0.00032796,
        "time_percent": 0.1209841112329601,
        "time_per_call": 1.1712857142857143e-05
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 3437,
        "primitive_calls": 3437,
        "total_time": 0.000322202,
        "cumulative_time": 0.000322202,
        "time_percent": 0.11885999087535737,
        "time_per_call": 9.374512656386384e-08
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.000320756,
        "cumulative_time": 0.000320756,
        "time_percent": 0.11832656294255198,
        "time_per_call": 1.1455571428571429e-05
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.000286417,
        "cumulative_time": 0.00034578800000000003,
        "time_percent": 0.12756084234364803,
        "time_per_call": 2.881566666666667e-05
      },
      {
        "rank": 23,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'to' of 'torch._C.TensorBase' objects>",
        "total_calls": 5,
        "primitive_calls": 5,
        "total_time": 0.00027910900000000004,
        "cumulative_time": 0.00027910900000000004,
        "time_percent": 0.10296302689998861,
        "time_per_call": 5.582180000000001e-05
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000209771,
        "cumulative_time": 0.000360434,
        "time_percent": 0.13296373688297577,
        "time_per_call": 9.01085e-05
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 126,
        "function_name": "batch_ucb_selection",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000198101,
        "cumulative_time": 0.002321816,
        "time_percent": 0.8565155665522212,
        "time_per_call": 0.001160908
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1100,
        "function_name": "remove_virtual_loss",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.00019506700000000002,
        "cumulative_time": 0.000239351,
        "time_percent": 0.08829634104073737,
        "time_per_call": 0.0001196755
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 0.000177268,
        "cumulative_time": 0.000177268,
        "time_percent": 0.06539398533371256,
        "time_per_call": 1.2662e-05
      },
      {
        "rank": 28,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.000173582,
        "cumulative_time": 0.040075252000000006,
        "time_percent": 14.783719800149125,
        "time_per_call": 0.005009406500000001
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x770c35fd2660>",
        "total_calls": 18,
        "primitive_calls": 18,
        "total_time": 0.000170948,
        "cumulative_time": 0.000170948,
        "time_percent": 0.0630625437463473,
        "time_per_call": 9.497111111111112e-06
      },
      {
        "rank": 30,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 791,
        "function_name": "_add_dirichlet_noise_to_root",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.00016304900000000002,
        "cumulative_time": 0.001301482,
        "time_percent": 0.4801153892416617,
        "time_per_call": 0.001301482
      },
      {
        "rank": 31,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1095,
        "function_name": "apply_virtual_loss",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000126993,
        "cumulative_time": 0.000126993,
        "time_percent": 0.046847588845613186,
        "time_per_call": 6.34965e-05
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000118257,
        "cumulative_time": 0.000118257,
        "time_percent": 0.0436248873096602,
        "time_per_call": 2.956425e-05
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 1093,
        "primitive_calls": 1093,
        "total_time": 0.00010757500000000001,
        "cumulative_time": 0.00010757500000000001,
        "time_percent": 0.03968430834823052,
        "time_per_call": 9.842177493138153e-08
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00010299400000000001,
        "cumulative_time": 0.00010299400000000001,
        "time_percent": 0.03799438209637606,
        "time_per_call": 2.5748500000000003e-05
      },
      {
        "rank": 35,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 9.974200000000001e-05,
        "cumulative_time": 9.974200000000001e-05,
        "time_percent": 0.03679472259604191,
        "time_per_call": 2.4935500000000002e-05
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 1121,
        "primitive_calls": 1121,
        "total_time": 9.9405e-05,
        "cumulative_time": 0.00021906100000000002,
        "time_percent": 0.08081138062813596,
        "time_per_call": 1.954157002676182e-07
      },
      {
        "rank": 37,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 75,
        "primitive_calls": 75,
        "total_time": 9.907400000000001e-05,
        "cumulative_time": 0.0008146780000000001,
        "time_percent": 0.3005338875809412,
        "time_per_call": 1.0862373333333336e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 14,
        "primitive_calls": 14,
        "total_time": 9.5303e-05,
        "cumulative_time": 9.5303e-05,
        "time_percent": 0.0351571800001061,
        "time_per_call": 6.807357142857143e-06
      },
      {
        "rank": 39,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 845,
        "function_name": "_extract_policy",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 8.626e-05,
        "cumulative_time": 0.0015644620000000002,
        "time_percent": 0.5771284444070595,
        "time_per_call": 0.0015644620000000002
      },
      {
        "rank": 40,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 13,
        "primitive_calls": 13,
        "total_time": 8.4764e-05,
        "cumulative_time": 8.4764e-05,
        "time_percent": 0.03126935359358041,
        "time_per_call": 6.520307692307693e-06
      },
      {
        "rank": 41,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 20,
        "primitive_calls": 20,
        "total_time": 8.3813e-05,
        "cumulative_time": 0.003529804,
        "time_percent": 1.3021411140582615,
        "time_per_call": 0.0001764902
      },
      {
        "rank": 42,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 59,
        "primitive_calls": 59,
        "total_time": 8.2896e-05,
        "cumulative_time": 0.00013749,
        "time_percent": 0.050719921494754495,
        "time_per_call": 2.330338983050848e-06
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 7.941500000000001e-05,
        "cumulative_time": 7.941500000000001e-05,
        "time_percent": 0.029296112920982824,
        "time_per_call": 1.3235833333333335e-05
      },
      {
        "rank": 44,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 25,
        "primitive_calls": 25,
        "total_time": 7.2049e-05,
        "cumulative_time": 0.003105983,
        "time_percent": 1.145793977191374,
        "time_per_call": 0.00012423932
      },
      {
        "rank": 45,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 812,
        "function_name": "_get_device_index",
        "total_calls": 59,
        "primitive_calls": 59,
        "total_time": 7.1531e-05,
        "cumulative_time": 0.0006790450000000001,
        "time_percent": 0.2504990115019679,
        "time_per_call": 1.1509237288135595e-05
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 10,
        "primitive_calls": 10,
        "total_time": 6.899900000000001e-05,
        "cumulative_time": 6.899900000000001e-05,
        "time_percent": 0.02545366108965427,
        "time_per_call": 6.899900000000001e-06
      },
      {
        "rank": 47,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'readline' of '_io.BufferedReader' objects>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 6.5226e-05,
        "cumulative_time": 6.5226e-05,
        "time_percent": 0.024061805217956627,
        "time_per_call": 1.63065e-05
      },
      {
        "rank": 48,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 27,
        "primitive_calls": 27,
        "total_time": 6.367e-05,
        "cumulative_time": 0.00011965600000000001,
        "time_percent": 0.04414097699015451,
        "time_per_call": 4.431703703703704e-06
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method mcts.gpu.unified_cuda_kernels.batched_ucb_selection_quantum>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 6.280000000000001e-05,
        "cumulative_time": 6.280000000000001e-05,
        "time_percent": 0.023166856279515473,
        "time_per_call": 3.1400000000000004e-05
      },
      {
        "rank": 50,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 6.2302e-05,
        "cumulative_time": 6.2302e-05,
        "time_percent": 0.022983144584814853,
        "time_per_call": 1.0383666666666667e-05
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": true,
      "quantum_config": "QuantumConfig(quantum_level='tree_level', min_wave_size=3072, optimal_wave_size=3072, hbar_eff=0.1, temperature=1.0, coupling_strength=0.1, decoherence_rate=0.01, measurement_noise=0.0, path_integral_steps=10, path_integral_beta=1.0, use_wick_rotation=True, interference_alpha=0.05, interference_method='minhash', minhash_size=64, phase_kick_strength=0.1, use_mixed_precision=True, cache_corrections=True, fast_mode=True, enable_quantum=True, uncertainty_decay=0.99, phase_temperature=1.0, device='cuda')",
      "enable_virtual_loss": true,
      "virtual_loss_value": -3.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "tree_level",
    "num_simulations": 10000,
    "wave_size": 3072,
    "total_time_ms": 86.91494899539975,
    "simulations_per_second": 115055.00625133292,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 9.050368309020996,
        "cpu_time_ms": 9.483183006523177,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7881919741630554,
        "cpu_time_ms": 1.075595006113872,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0551999807357788,
        "cpu_time_ms": 1.622276999114547,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 5.033984184265137,
        "cpu_time_ms": 5.299170996295288,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.441280364990234,
        "cpu_time_ms": 9.871153997664806,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8111039996147156,
        "cpu_time_ms": 1.1078879979322664,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.6027840375900269,
        "cpu_time_ms": 2.1287659983499907,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 5.305344104766846,
        "cpu_time_ms": 5.612408996967133,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.708640098571777,
        "cpu_time_ms": 9.08368199452525,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8358719944953918,
        "cpu_time_ms": 1.1473949998617172,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0809279680252075,
        "cpu_time_ms": 1.340441005595494,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.937503814697266,
        "cpu_time_ms": 5.155901002581231,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 9.401727676391602,
        "cpu_time_ms": 9.758146006788593,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.7934719920158386,
        "cpu_time_ms": 1.0836129949893802,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.031872034072876,
        "cpu_time_ms": 1.2880400026915595,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "backup",
        "gpu_time_ms": 6.012095928192139,
        "cpu_time_ms": 8.383795997360721,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      }
    ],
    "peak_gpu_memory_mb": 2852.84033203125,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 183.6,
    "avg_ram_usage_mb": 1233.0859375,
    "final_tree_nodes": 9,
    "final_tree_edges": 8,
    "tree_memory_mb": 50.92288589477539,
    "efficiency_score": 41297.90408476122,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Consider using classical selection for hot paths",
      "Tree-level quantum may be excessive - consider one-loop for balance",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 45,
    "total_kernel_calls": 45,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         36360 function calls (27345 primitive calls) in 0.085 seconds\n\n   Ordered by: cumulative time\n   List reduced from 175 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.084    0.084 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:214(search)\n       16    0.000    0.000    0.081    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:394(_profile_phase)\n        4    0.000    0.000    0.080    0.020 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:296(_run_search_wave_vectorized)\n        4    0.000    0.000    0.041    0.010 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:369(instrumented_select)\n        4    0.009    0.002    0.028    0.007 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:320(_select_batch_vectorized)\n        4    0.000    0.000    0.026    0.007 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:378(instrumented_backup)\n        4    0.012    0.003    0.018    0.004 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:747(_backup_batch_vectorized)\n        7    0.007    0.001    0.013    0.002 {built-in method time.sleep}\n       56    0.001    0.000    0.010    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        4    0.000    0.000    0.009    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:375(instrumented_evaluate)\n       40    0.000    0.000    0.008    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n  9016/56    0.006    0.000    0.008    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       16    0.006    0.000    0.006    0.000 {built-in method torch.where}\n       49    0.000    0.000    0.006    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        4    0.006    0.001    0.006    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n        4    0.003    0.001    0.006    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:915(_get_quantum_phases)\n       49    0.005    0.000    0.005    0.000 {built-in method torch._C._cuda_synchronize}\n       34    0.000    0.000    0.005    0.000 {built-in method builtins.next}\n        4    0.000    0.000    0.005    0.001 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:372(instrumented_expand)\n       34    0.000    0.000    0.005    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:196(timer)\n       17    0.000    0.000    0.004    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n        6    0.004    0.001    0.004    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n       17    0.000    0.000    0.004    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:178(end_timer)\n        4    0.000    0.000    0.003    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n      8/4    0.000    0.000    0.003    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        4    0.000    0.000    0.003    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n        4    0.000    0.000    0.003    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n        4    0.003    0.001    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:450(_expand_batch_vectorized)\n        4    0.003    0.001    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:699(_evaluate_batch_vectorized)\n       16    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        4    0.000    0.000    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n        4    0.000    0.000    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:126(batch_ucb_selection)\n        4    0.002    0.001    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:974(batch_action_to_child)\n        4    0.002    0.001    0.002    0.001 {built-in method torch._unique2}\n        8    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n        8    0.001    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:352(virtual_memory)\n        8    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:845(_extract_policy)\n      147    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n        8    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:812(bcat)\n       24    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:765(open_binary)\n        1    0.000    0.000    0.001    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:791(_add_dirichlet_noise_to_root)\n      115    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n       56    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n        8    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:795(cat)\n      115    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n       24    0.001    0.000    0.001    0.000 {built-in method _io.open}\n      115    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n     9992    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}\n       34    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 747,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.011960352,
        "cumulative_time": 0.017650906,
        "time_percent": 3.30815261209446,
        "time_per_call": 0.0044127265
      },
      {
        "rank": 2,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 320,
        "function_name": "_select_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.008853592,
        "cumulative_time": 0.027824036000000003,
        "time_percent": 5.214812053976737,
        "time_per_call": 0.006956009000000001
      },
      {
        "rank": 3,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.0067763960000000005,
        "cumulative_time": 0.013084508000000002,
        "time_percent": 2.452313174075646,
        "time_per_call": 0.0018692154285714288
      },
      {
        "rank": 4,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.006475659000000001,
        "cumulative_time": 0.006475659000000001,
        "time_percent": 1.2136752773983954,
        "time_per_call": 0.00040472868750000005
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.005906782,
        "cumulative_time": 0.005983945,
        "time_percent": 1.1215176876688133,
        "time_per_call": 0.00149598625
      },
      {
        "rank": 6,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 56,
        "primitive_calls": 9016,
        "total_time": 0.005726083000000001,
        "cumulative_time": 0.007578354000000001,
        "time_percent": 1.420343611850661,
        "time_per_call": 0.00013532775
      },
      {
        "rank": 7,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 49,
        "primitive_calls": 49,
        "total_time": 0.005321852,
        "cumulative_time": 0.005321852,
        "time_percent": 0.9974274745432403,
        "time_per_call": 0.00010860922448979592
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.003987016,
        "cumulative_time": 0.004039029,
        "time_percent": 0.7569993481737014,
        "time_per_call": 0.0006731715
      },
      {
        "rank": 9,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 915,
        "function_name": "_get_quantum_phases",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.003126214,
        "cumulative_time": 0.005604886000000001,
        "time_percent": 1.0504740244716997,
        "time_per_call": 0.0014012215000000002
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 450,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0031171510000000003,
        "cumulative_time": 0.0031654620000000004,
        "time_percent": 0.5932744406313055,
        "time_per_call": 0.0007913655000000001
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 699,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0027215530000000003,
        "cumulative_time": 0.0028468950000000003,
        "time_percent": 0.5335682559642354,
        "time_per_call": 0.0007117237500000001
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.002371766,
        "cumulative_time": 0.002371766,
        "time_percent": 0.4445190455479639,
        "time_per_call": 0.0005929415
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 974,
        "function_name": "batch_action_to_child",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.002366979,
        "cumulative_time": 0.0025357490000000003,
        "time_percent": 0.4752529234457379,
        "time_per_call": 0.0006339372500000001
      },
      {
        "rank": 14,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 24,
        "primitive_calls": 24,
        "total_time": 0.000998025,
        "cumulative_time": 0.001024289,
        "time_percent": 0.19197339393737764,
        "time_per_call": 4.2678708333333334e-05
      },
      {
        "rank": 15,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 56,
        "primitive_calls": 56,
        "total_time": 0.0009898630000000001,
        "cumulative_time": 0.010438944,
        "time_percent": 1.9564786000847656,
        "time_per_call": 0.0001864097142857143
      },
      {
        "rank": 16,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 9992,
        "primitive_calls": 9992,
        "total_time": 0.000949608,
        "cumulative_time": 0.000949608,
        "time_percent": 0.17797659710304933,
        "time_per_call": 9.503682946357086e-08
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.0007807160000000001,
        "cumulative_time": 0.0007807160000000001,
        "time_percent": 0.14632266891591508,
        "time_per_call": 0.00039035800000000005
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 56,
        "primitive_calls": 56,
        "total_time": 0.000689809,
        "cumulative_time": 0.000689809,
        "time_percent": 0.12928477695118126,
        "time_per_call": 1.2318017857142858e-05
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 56,
        "primitive_calls": 56,
        "total_time": 0.0006599290000000001,
        "cumulative_time": 0.0006599290000000001,
        "time_percent": 0.1236846338169205,
        "time_per_call": 1.178444642857143e-05
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 6873,
        "primitive_calls": 6873,
        "total_time": 0.0006431630000000001,
        "cumulative_time": 0.0006431630000000001,
        "time_percent": 0.12054233128047419,
        "time_per_call": 9.357820456860179e-08
      },
      {
        "rank": 21,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.0006117890000000001,
        "cumulative_time": 0.0020668640000000003,
        "time_percent": 0.38737397051709443,
        "time_per_call": 0.00025835800000000004
      },
      {
        "rank": 22,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1100,
        "function_name": "remove_virtual_loss",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00043535300000000003,
        "cumulative_time": 0.00052939,
        "time_percent": 0.09921886793327699,
        "time_per_call": 0.0001323475
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 214,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000424868,
        "cumulative_time": 0.08380630400000001,
        "time_percent": 15.707071551317675,
        "time_per_call": 0.08380630400000001
      },
      {
        "rank": 24,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.00034185700000000004,
        "cumulative_time": 0.00034185700000000004,
        "time_percent": 0.06407122260538785,
        "time_per_call": 4.2732125000000006e-05
      },
      {
        "rank": 25,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.00033794900000000004,
        "cumulative_time": 0.00047759800000000003,
        "time_percent": 0.08951195316722496,
        "time_per_call": 1.705707142857143e-05
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.00032610800000000003,
        "cumulative_time": 0.08068806,
        "time_percent": 15.122646761239029,
        "time_per_call": 0.00504300375
      },
      {
        "rank": 27,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x770c35fd2660>",
        "total_calls": 34,
        "primitive_calls": 34,
        "total_time": 0.000293491,
        "cumulative_time": 0.000293491,
        "time_percent": 0.05500641260432836,
        "time_per_call": 8.632088235294118e-06
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'to' of 'torch._C.TensorBase' objects>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.00029104,
        "cumulative_time": 0.00029104,
        "time_percent": 0.05454704343357625,
        "time_per_call": 3.2337777777777776e-05
      },
      {
        "rank": 29,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 126,
        "function_name": "batch_ucb_selection",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000262375,
        "cumulative_time": 0.0026868810000000003,
        "time_percent": 0.5035782525008619,
        "time_per_call": 0.0006717202500000001
      },
      {
        "rank": 30,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 20,
        "primitive_calls": 20,
        "total_time": 0.000238089,
        "cumulative_time": 0.000238089,
        "time_percent": 0.04462290758678098,
        "time_per_call": 1.1904450000000001e-05
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 24,
        "primitive_calls": 24,
        "total_time": 0.00023525300000000002,
        "cumulative_time": 0.00023525300000000002,
        "time_percent": 0.04409138128394419,
        "time_per_call": 9.802208333333334e-06
      },
      {
        "rank": 32,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1095,
        "function_name": "apply_virtual_loss",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000222882,
        "cumulative_time": 0.000222882,
        "time_percent": 0.04177279457999705,
        "time_per_call": 5.57205e-05
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 2185,
        "primitive_calls": 2185,
        "total_time": 0.00022270900000000003,
        "cumulative_time": 0.00022270900000000003,
        "time_percent": 0.041740370725839526,
        "time_per_call": 1.019263157894737e-07
      },
      {
        "rank": 34,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 147,
        "primitive_calls": 147,
        "total_time": 0.00022008500000000002,
        "cumulative_time": 0.001510587,
        "time_percent": 0.2831159108685942,
        "time_per_call": 1.0276102040816328e-05
      },
      {
        "rank": 35,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 40,
        "primitive_calls": 40,
        "total_time": 0.00020203900000000002,
        "cumulative_time": 0.007911345,
        "time_percent": 1.4827531587857556,
        "time_per_call": 0.000197783625
      },
      {
        "rank": 36,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 2237,
        "primitive_calls": 2237,
        "total_time": 0.00019865,
        "cumulative_time": 0.000418233,
        "time_percent": 0.07838569824201105,
        "time_per_call": 1.8696155565489496e-07
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.00019758200000000002,
        "cumulative_time": 0.000546282,
        "time_percent": 0.10238478553113285,
        "time_per_call": 6.828525e-05
      },
      {
        "rank": 38,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 791,
        "function_name": "_add_dirichlet_noise_to_root",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000172948,
        "cumulative_time": 0.0012709280000000002,
        "time_percent": 0.23819875211980557,
        "time_per_call": 0.0012709280000000002
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 26,
        "primitive_calls": 26,
        "total_time": 0.00017242100000000002,
        "cumulative_time": 0.00017242100000000002,
        "time_percent": 0.032315337327723515,
        "time_per_call": 6.631576923076924e-06
      },
      {
        "rank": 40,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 115,
        "primitive_calls": 115,
        "total_time": 0.00016795000000000002,
        "cumulative_time": 0.000268847,
        "time_percent": 0.05038760646641931,
        "time_per_call": 2.3378e-06
      },
      {
        "rank": 41,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.00016770400000000002,
        "cumulative_time": 0.00016770400000000002,
        "time_percent": 0.0314312718938444,
        "time_per_call": 1.3975333333333335e-05
      },
      {
        "rank": 42,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py",
        "line_number": 765,
        "function_name": "open_binary",
        "total_calls": 24,
        "primitive_calls": 24,
        "total_time": 0.000158503,
        "cumulative_time": 0.0012863190000000002,
        "time_percent": 0.2410833506130923,
        "time_per_call": 5.359662500000001e-05
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.000153361,
        "cumulative_time": 0.000153361,
        "time_percent": 0.028743090736725836,
        "time_per_call": 1.9170125e-05
      },
      {
        "rank": 44,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 49,
        "primitive_calls": 49,
        "total_time": 0.00013967,
        "cumulative_time": 0.006310231,
        "time_percent": 1.182670575978901,
        "time_per_call": 0.00012878022448979592
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.00012446900000000002,
        "cumulative_time": 0.00012446900000000002,
        "time_percent": 0.023328119671295364,
        "time_per_call": 1.0372416666666668e-05
      },
      {
        "rank": 46,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'split' of 'bytes' objects>",
        "total_calls": 441,
        "primitive_calls": 441,
        "total_time": 0.00011597300000000001,
        "cumulative_time": 0.00011597300000000001,
        "time_percent": 0.02173578981625254,
        "time_per_call": 2.629773242630386e-07
      },
      {
        "rank": 47,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 812,
        "function_name": "_get_device_index",
        "total_calls": 115,
        "primitive_calls": 115,
        "total_time": 0.00011497100000000001,
        "cumulative_time": 0.0012211190000000001,
        "time_percent": 0.2288634934392702,
        "time_per_call": 1.0618426086956522e-05
      },
      {
        "rank": 48,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 49,
        "primitive_calls": 49,
        "total_time": 0.000114241,
        "cumulative_time": 0.000219583,
        "time_percent": 0.04115449229753633,
        "time_per_call": 4.481285714285715e-06
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method __new__ of type object at 0xa43b40>",
        "total_calls": 96,
        "primitive_calls": 96,
        "total_time": 0.000112552,
        "cumulative_time": 0.000112552,
        "time_percent": 0.021094622156871475,
        "time_per_call": 1.1724166666666667e-06
      },
      {
        "rank": 50,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 770,
        "function_name": "_get_device_attr",
        "total_calls": 115,
        "primitive_calls": 115,
        "total_time": 0.000105505,
        "cumulative_time": 0.001008791,
        "time_percent": 0.189068741384005,
        "time_per_call": 8.772095652173912e-06
      }
    ]
  },
  {
    "config": {
      "num_simulations": 10000,
      "c_puct": 1.414,
      "temperature": 1.0,
      "dirichlet_alpha": 0.3,
      "dirichlet_epsilon": 0.25,
      "min_wave_size": 3072,
      "max_wave_size": 3072,
      "adaptive_wave_sizing": false,
      "device": "cuda",
      "game_type": "2",
      "board_size": 15,
      "enable_quantum": true,
      "quantum_config": "QuantumConfig(quantum_level='one_loop', min_wave_size=3072, optimal_wave_size=3072, hbar_eff=0.1, temperature=1.0, coupling_strength=0.1, decoherence_rate=0.01, measurement_noise=0.0, path_integral_steps=10, path_integral_beta=1.0, use_wick_rotation=True, interference_alpha=0.05, interference_method='minhash', minhash_size=64, phase_kick_strength=0.1, use_mixed_precision=True, cache_corrections=True, fast_mode=True, enable_quantum=True, uncertainty_decay=0.99, phase_temperature=1.0, device='cuda')",
      "enable_virtual_loss": true,
      "virtual_loss_value": -3.0,
      "memory_pool_size_mb": 2048,
      "max_tree_nodes": 500000,
      "use_mixed_precision": true,
      "use_cuda_graphs": true,
      "use_tensor_cores": true,
      "initial_children_per_expansion": 8,
      "max_children_per_node": 50,
      "progressive_expansion_threshold": 5,
      "enable_debug_logging": false,
      "profile_gpu_kernels": false
    },
    "quantum_level": "one_loop",
    "num_simulations": 10000,
    "wave_size": 3072,
    "total_time_ms": 88.09555899642874,
    "simulations_per_second": 113513.10002363894,
    "phases": [
      {
        "name": "selection",
        "gpu_time_ms": 8.897760391235352,
        "cpu_time_ms": 9.26302099833265,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.9665600061416626,
        "cpu_time_ms": 1.3050609995843843,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.0591039657592773,
        "cpu_time_ms": 1.3981270021758974,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.548384189605713,
        "cpu_time_ms": 4.844709997996688,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.155808448791504,
        "cpu_time_ms": 9.213559002091642,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8167359828948975,
        "cpu_time_ms": 1.0831570034497418,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.2063360214233398,
        "cpu_time_ms": 1.8261359946336597,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.59878396987915,
        "cpu_time_ms": 4.97405599890044,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 8.795424461364746,
        "cpu_time_ms": 9.173418999125715,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.8718079924583435,
        "cpu_time_ms": 1.1832759992103092,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 2.4612159729003906,
        "cpu_time_ms": 2.7150050009367988,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "backup",
        "gpu_time_ms": 7.2130560874938965,
        "cpu_time_ms": 8.598157000960782,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 3072
      },
      {
        "name": "selection",
        "gpu_time_ms": 9.159423828125,
        "cpu_time_ms": 9.616508999897633,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "expansion",
        "gpu_time_ms": 0.876800000667572,
        "cpu_time_ms": 1.1879610028699972,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "evaluation",
        "gpu_time_ms": 1.8067840337753296,
        "cpu_time_ms": 2.057605997833889,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      },
      {
        "name": "backup",
        "gpu_time_ms": 4.839295864105225,
        "cpu_time_ms": 5.152257996087428,
        "memory_allocated_mb": 0,
        "memory_freed_mb": 0,
        "kernel_launches": 0,
        "cpu_gpu_transfers_mb": 0,
        "batch_size": 784
      }
    ],
    "peak_gpu_memory_mb": 2850.2119140625,
    "avg_gpu_utilization": 0,
    "peak_cpu_percent": 181.1,
    "avg_ram_usage_mb": 1233.0859375,
    "final_tree_nodes": 9,
    "final_tree_edges": 8,
    "tree_memory_mb": 50.92288589477539,
    "efficiency_score": 40782.02531212119,
    "bottleneck_phase": "selection",
    "recommendations": [
      "GPU memory underutilized - consider increasing wave_size",
      "Selection is bottleneck - optimize UCB kernel or reduce tree traversal depth",
      "Consider using classical selection for hot paths",
      "One-loop quantum is a good balance - monitor overhead",
      "Tree too small - increase num_simulations for better performance"
    ],
    "quantum_kernel_calls": 60,
    "total_kernel_calls": 60,
    "quantum_overhead_percent": 0.0,
    "cprofile_stats": "         36360 function calls (27345 primitive calls) in 0.086 seconds\n\n   Ordered by: cumulative time\n   List reduced from 175 to 50 due to restriction <50>\n\n   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\n        1    0.000    0.000    0.085    0.085 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:214(search)\n        4    0.000    0.000    0.081    0.020 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:296(_run_search_wave_vectorized)\n       16    0.000    0.000    0.081    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:394(_profile_phase)\n        4    0.000    0.000    0.045    0.011 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:369(instrumented_select)\n        4    0.009    0.002    0.026    0.006 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:320(_select_batch_vectorized)\n        4    0.015    0.004    0.021    0.005 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:747(_backup_batch_vectorized)\n        4    0.000    0.000    0.020    0.005 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:378(instrumented_backup)\n       56    0.001    0.000    0.010    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:225(memory_stats)\n        4    0.000    0.000    0.010    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:375(instrumented_evaluate)\n       40    0.000    0.000    0.008    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:523(memory_allocated)\n  9016/56    0.005    0.000    0.007    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:314(_recurse_add_to_result)\n       16    0.007    0.000    0.007    0.000 {built-in method torch.where}\n       49    0.000    0.000    0.007    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py:1030(synchronize)\n        4    0.000    0.000    0.006    0.002 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:372(instrumented_expand)\n        4    0.003    0.001    0.006    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:915(_get_quantum_phases)\n        4    0.005    0.001    0.005    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:738(batch_get_children)\n       49    0.005    0.000    0.005    0.000 {built-in method torch._C._cuda_synchronize}\n       34    0.000    0.000    0.005    0.000 {built-in method builtins.next}\n       34    0.000    0.000    0.005    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:196(timer)\n        6    0.004    0.001    0.004    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:708(get_children)\n        7    0.003    0.000    0.004    0.001 {built-in method time.sleep}\n       17    0.000    0.000    0.004    0.000 /usr/lib/python3.12/contextlib.py:141(__exit__)\n       17    0.000    0.000    0.004    0.000 /home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py:178(end_timer)\n        4    0.003    0.001    0.004    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:699(_evaluate_batch_vectorized)\n        4    0.004    0.001    0.004    0.001 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:450(_expand_batch_vectorized)\n        4    0.000    0.000    0.004    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:782(batch_select_ucb_optimized)\n        4    0.000    0.000    0.003    0.001 /home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py:126(batch_ucb_selection)\n        4    0.000    0.000    0.003    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py:1055(unique)\n      8/4    0.000    0.000    0.003    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/_jit_internal.py:612(fn)\n        4    0.000    0.000    0.003    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:1090(_return_output)\n       16    0.000    0.000    0.003    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:561(memory_reserved)\n        4    0.000    0.000    0.003    0.001 /home/cosmo/venv/lib/python3.12/site-packages/torch/functional.py:835(_unique_impl)\n        4    0.002    0.001    0.002    0.001 {built-in method torch._unique2}\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:791(_add_dirichlet_noise_to_root)\n        4    0.002    0.000    0.002    0.000 /home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py:974(batch_action_to_child)\n      147    0.000    0.000    0.002    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py:9(_get_device_index)\n        1    0.000    0.000    0.002    0.002 /home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py:845(_extract_policy)\n        8    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py:1964(virtual_memory)\n      115    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:812(_get_device_index)\n       56    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py:330(memory_stats_as_nested_dict)\n      115    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:786(_get_current_device_index)\n        9    0.001    0.000    0.001    0.000 {method 'to' of 'torch._C.TensorBase' objects}\n      115    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py:770(_get_device_attr)\n        8    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py:1701(_parse_stat_file)\n       24    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:765(open_binary)\n       34    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/streams.py:179(record)\n        8    0.000    0.000    0.001    0.000 /home/cosmo/venv/lib/python3.12/site-packages/psutil/_common.py:812(bcat)\n     9992    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}\n       56    0.001    0.000    0.001    0.000 {built-in method torch._C._cuda_memoryStats}\n       24    0.001    0.000    0.001    0.000 {built-in method _io.open}\n\n\n",
    "top_functions": [
      {
        "rank": 1,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 747,
        "function_name": "_backup_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.014788542000000002,
        "cumulative_time": 0.020535318,
        "time_percent": 3.9218610834336816,
        "time_per_call": 0.0051338295
      },
      {
        "rank": 2,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 320,
        "function_name": "_select_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.009162626,
        "cumulative_time": 0.025976727,
        "time_percent": 4.9610682774077794,
        "time_per_call": 0.00649418175
      },
      {
        "rank": 3,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.where>",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.006897238000000001,
        "cumulative_time": 0.006897238000000001,
        "time_percent": 1.3172432633076323,
        "time_per_call": 0.00043107737500000005
      },
      {
        "rank": 4,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 738,
        "function_name": "batch_get_children",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.005406584000000001,
        "cumulative_time": 0.0054869440000000005,
        "time_percent": 1.0479035260413274,
        "time_per_call": 0.0013717360000000001
      },
      {
        "rank": 5,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 314,
        "function_name": "_recurse_add_to_result",
        "total_calls": 56,
        "primitive_calls": 9016,
        "total_time": 0.005385481,
        "cumulative_time": 0.007120755,
        "time_percent": 1.3599308235288008,
        "time_per_call": 0.00012715633928571428
      },
      {
        "rank": 6,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_synchronize>",
        "total_calls": 49,
        "primitive_calls": 49,
        "total_time": 0.0048682050000000004,
        "cumulative_time": 0.0048682050000000004,
        "time_percent": 0.929735966868264,
        "time_per_call": 9.93511224489796e-05
      },
      {
        "rank": 7,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 708,
        "function_name": "get_children",
        "total_calls": 6,
        "primitive_calls": 6,
        "total_time": 0.004438695,
        "cumulative_time": 0.004492315,
        "time_percent": 0.8579480178015932,
        "time_per_call": 0.0007487191666666667
      },
      {
        "rank": 8,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 450,
        "function_name": "_expand_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0035067400000000004,
        "cumulative_time": 0.003554263,
        "time_percent": 0.6787976567973405,
        "time_per_call": 0.00088856575
      },
      {
        "rank": 9,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method time.sleep>",
        "total_calls": 7,
        "primitive_calls": 7,
        "total_time": 0.003460536,
        "cumulative_time": 0.004418785000000001,
        "time_percent": 0.8439051651189673,
        "time_per_call": 0.000631255
      },
      {
        "rank": 10,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 699,
        "function_name": "_evaluate_batch_vectorized",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0034371420000000002,
        "cumulative_time": 0.0036461450000000004,
        "time_percent": 0.6963453977219297,
        "time_per_call": 0.0009115362500000001
      },
      {
        "rank": 11,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 915,
        "function_name": "_get_quantum_phases",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0032286660000000003,
        "cumulative_time": 0.005692881,
        "time_percent": 1.087233635559918,
        "time_per_call": 0.00142322025
      },
      {
        "rank": 12,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._unique2>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.0024897540000000003,
        "cumulative_time": 0.0024897540000000003,
        "time_percent": 0.4754963775054929,
        "time_per_call": 0.0006224385000000001
      },
      {
        "rank": 13,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 974,
        "function_name": "batch_action_to_child",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.001679967,
        "cumulative_time": 0.001807205,
        "time_percent": 0.34514230358092174,
        "time_per_call": 0.00045180125
      },
      {
        "rank": 14,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/__init__.py",
        "line_number": 1009,
        "function_name": "cpu_percent",
        "total_calls": 0,
        "primitive_calls": 7,
        "total_time": 0.001150261,
        "cumulative_time": 0.0,
        "time_percent": 0.0,
        "time_per_call": 0
      },
      {
        "rank": 15,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'to' of 'torch._C.TensorBase' objects>",
        "total_calls": 9,
        "primitive_calls": 9,
        "total_time": 0.001095485,
        "cumulative_time": 0.001095485,
        "time_percent": 0.2092171150690409,
        "time_per_call": 0.00012172055555555556
      },
      {
        "rank": 16,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 225,
        "function_name": "memory_stats",
        "total_calls": 56,
        "primitive_calls": 56,
        "total_time": 0.0009438430000000001,
        "cumulative_time": 0.009971649,
        "time_percent": 1.9043981763886193,
        "time_per_call": 0.00017806516071428572
      },
      {
        "rank": 17,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.isinstance>",
        "total_calls": 9992,
        "primitive_calls": 9992,
        "total_time": 0.000817488,
        "cumulative_time": 0.000817488,
        "time_percent": 0.15612489533271573,
        "time_per_call": 8.18142514011209e-08
      },
      {
        "rank": 18,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch._C._cuda_memoryStats>",
        "total_calls": 56,
        "primitive_calls": 56,
        "total_time": 0.000768144,
        "cumulative_time": 0.000768144,
        "time_percent": 0.1467011156132611,
        "time_per_call": 1.3716857142857143e-05
      },
      {
        "rank": 19,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method _io.open>",
        "total_calls": 24,
        "primitive_calls": 24,
        "total_time": 0.000765709,
        "cumulative_time": 0.000765709,
        "time_percent": 0.14623607622413837,
        "time_per_call": 3.190454166666667e-05
      },
      {
        "rank": 20,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'cpu' of 'torch._C.TensorBase' objects>",
        "total_calls": 2,
        "primitive_calls": 2,
        "total_time": 0.000724227,
        "cumulative_time": 0.000724227,
        "time_percent": 0.13831379123868084,
        "time_per_call": 0.0003621135
      },
      {
        "rank": 21,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'sort' of 'list' objects>",
        "total_calls": 56,
        "primitive_calls": 56,
        "total_time": 0.0006627950000000001,
        "cumulative_time": 0.0006627950000000001,
        "time_percent": 0.1265814299439837,
        "time_per_call": 1.1835625000000002e-05
      },
      {
        "rank": 22,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'append' of 'list' objects>",
        "total_calls": 6873,
        "primitive_calls": 6873,
        "total_time": 0.000659527,
        "cumulative_time": 0.000659527,
        "time_percent": 0.1259573031580892,
        "time_per_call": 9.595911537901936e-08
      },
      {
        "rank": 23,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1100,
        "function_name": "remove_virtual_loss",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000519702,
        "cumulative_time": 0.000623064,
        "time_percent": 0.1189935531599035,
        "time_per_call": 0.000155766
      },
      {
        "rank": 24,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 214,
        "function_name": "search",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000428697,
        "cumulative_time": 0.08508716200000001,
        "time_percent": 16.25005414318966,
        "time_per_call": 0.08508716200000001
      },
      {
        "rank": 25,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/psutil/_pslinux.py",
        "line_number": 352,
        "function_name": "virtual_memory",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.000409355,
        "cumulative_time": 0.000748659,
        "time_percent": 0.14297984559393612,
        "time_per_call": 9.3582375e-05
      },
      {
        "rank": 26,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/unified_kernels.py",
        "line_number": 126,
        "function_name": "batch_ucb_selection",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00038342400000000005,
        "cumulative_time": 0.003470102,
        "time_percent": 0.662724482247871,
        "time_per_call": 0.0008675255
      },
      {
        "rank": 27,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts_comprehensive_profiler.py",
        "line_number": 394,
        "function_name": "_profile_phase",
        "total_calls": 16,
        "primitive_calls": 16,
        "total_time": 0.00037320200000000005,
        "cumulative_time": 0.08109459200000001,
        "time_percent": 15.487548059481348,
        "time_per_call": 0.0050684120000000004
      },
      {
        "rank": 28,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'any' of 'torch._C.TensorBase' objects>",
        "total_calls": 28,
        "primitive_calls": 28,
        "total_time": 0.00034774700000000003,
        "cumulative_time": 0.000380426,
        "time_percent": 0.07265424010119258,
        "time_per_call": 1.3586642857142858e-05
      },
      {
        "rank": 29,
        "filename": "~",
        "line_number": 0,
        "function_name": "<function Event.record at 0x770c35fd2660>",
        "total_calls": 34,
        "primitive_calls": 34,
        "total_time": 0.000294638,
        "cumulative_time": 0.000294638,
        "time_percent": 0.0562703390276563,
        "time_per_call": 8.665823529411764e-06
      },
      {
        "rank": 30,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/gpu/csr_tree.py",
        "line_number": 1095,
        "function_name": "apply_virtual_loss",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.000266402,
        "cumulative_time": 0.000266402,
        "time_percent": 0.050877791926518964,
        "time_per_call": 6.66005e-05
      },
      {
        "rank": 31,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'items' of 'dict' objects>",
        "total_calls": 2185,
        "primitive_calls": 2185,
        "total_time": 0.000223696,
        "cumulative_time": 0.000223696,
        "time_percent": 0.042721745868253946,
        "time_per_call": 1.0237803203661328e-07
      },
      {
        "rank": 32,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method posix.sysconf>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.000221468,
        "cumulative_time": 0.000221468,
        "time_percent": 0.04229623960173836,
        "time_per_call": 2.76835e-05
      },
      {
        "rank": 33,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'float' of 'torch._C.TensorBase' objects>",
        "total_calls": 26,
        "primitive_calls": 26,
        "total_time": 0.000206686,
        "cumulative_time": 0.000206686,
        "time_percent": 0.039473154488797006,
        "time_per_call": 7.949461538461539e-06
      },
      {
        "rank": 34,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method builtins.len>",
        "total_calls": 2237,
        "primitive_calls": 2237,
        "total_time": 0.00020216300000000002,
        "cumulative_time": 0.000424933,
        "time_percent": 0.08115424342426665,
        "time_per_call": 1.8995663835493965e-07
      },
      {
        "rank": 35,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/_utils.py",
        "line_number": 9,
        "function_name": "_get_device_index",
        "total_calls": 147,
        "primitive_calls": 147,
        "total_time": 0.000198244,
        "cumulative_time": 0.001537223,
        "time_percent": 0.2935807987126946,
        "time_per_call": 1.0457299319727891e-05
      },
      {
        "rank": 36,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/memory.py",
        "line_number": 523,
        "function_name": "memory_allocated",
        "total_calls": 40,
        "primitive_calls": 40,
        "total_time": 0.000187345,
        "cumulative_time": 0.007724992000000001,
        "time_percent": 1.4753287723441402,
        "time_per_call": 0.00019312480000000003
      },
      {
        "rank": 37,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.zeros_like>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.000177677,
        "cumulative_time": 0.000177677,
        "time_percent": 0.03393297886700592,
        "time_per_call": 1.4806416666666666e-05
      },
      {
        "rank": 38,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'zero_' of 'torch._C.TensorBase' objects>",
        "total_calls": 20,
        "primitive_calls": 20,
        "total_time": 0.00017639200000000001,
        "cumulative_time": 0.00017639200000000001,
        "time_percent": 0.03368756793681179,
        "time_per_call": 8.819600000000001e-06
      },
      {
        "rank": 39,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'read' of '_io.BufferedReader' objects>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.000173257,
        "cumulative_time": 0.000173257,
        "time_percent": 0.03308884165964556,
        "time_per_call": 2.1657125e-05
      },
      {
        "rank": 40,
        "filename": "<frozen os>",
        "line_number": 680,
        "function_name": "__getitem__",
        "total_calls": 115,
        "primitive_calls": 115,
        "total_time": 0.000165222,
        "cumulative_time": 0.00026835600000000003,
        "time_percent": 0.051250969325428955,
        "time_per_call": 2.333530434782609e-06
      },
      {
        "rank": 41,
        "filename": "/home/cosmo/omoknuni_quantum/python/mcts/core/optimized_mcts.py",
        "line_number": 791,
        "function_name": "_add_dirichlet_noise_to_root",
        "total_calls": 1,
        "primitive_calls": 1,
        "total_time": 0.000161738,
        "cumulative_time": 0.002476259,
        "time_percent": 0.4729190852852829,
        "time_per_call": 0.002476259
      },
      {
        "rank": 42,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/cuda/__init__.py",
        "line_number": 1030,
        "function_name": "synchronize",
        "total_calls": 49,
        "primitive_calls": 49,
        "total_time": 0.00015554200000000002,
        "cumulative_time": 0.006728502000000001,
        "time_percent": 1.285017847963479,
        "time_per_call": 0.0001373163673469388
      },
      {
        "rank": 43,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method torch.full>",
        "total_calls": 8,
        "primitive_calls": 8,
        "total_time": 0.00015158,
        "cumulative_time": 0.00015158,
        "time_percent": 0.028948940699475775,
        "time_per_call": 1.89475e-05
      },
      {
        "rank": 44,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method 'fill_' of 'torch._C.TensorBase' objects>",
        "total_calls": 12,
        "primitive_calls": 12,
        "total_time": 0.00012856100000000002,
        "cumulative_time": 0.0005342880000000001,
        "time_percent": 0.10203900005569015,
        "time_per_call": 4.4524e-05
      },
      {
        "rank": 45,
        "filename": "~",
        "line_number": 0,
        "function_name": "<method '__exit__' of '_io._IOBase' objects>",
        "total_calls": 24,
        "primitive_calls": 24,
        "total_time": 0.00012296,
        "cumulative_time": 0.00022078100000000003,
        "time_percent": 0.0421650354701871,
        "time_per_call": 9.199208333333335e-06
      },
      {
        "rank": 46,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_tensor.py",
        "line_number": 1159,
        "function_name": "__len__",
        "total_calls": 49,
        "primitive_calls": 49,
        "total_time": 0.000117533,
        "cumulative_time": 0.00022277,
        "time_percent": 0.04254489721349926,
        "time_per_call": 4.546326530612245e-06
      },
      {
        "rank": 47,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 812,
        "function_name": "_get_device_index",
        "total_calls": 115,
        "primitive_calls": 115,
        "total_time": 0.00011596000000000001,
        "cumulative_time": 0.001265581,
        "time_percent": 0.24170226493853575,
        "time_per_call": 1.1005052173913043e-05
      },
      {
        "rank": 48,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method mcts.gpu.unified_cuda_kernels.batched_ucb_selection_quantum>",
        "total_calls": 4,
        "primitive_calls": 4,
        "total_time": 0.00011519000000000001,
        "cumulative_time": 0.00011519000000000001,
        "time_percent": 0.021999132333900346,
        "time_per_call": 2.8797500000000003e-05
      },
      {
        "rank": 49,
        "filename": "~",
        "line_number": 0,
        "function_name": "<built-in method __new__ of type object at 0xa43b40>",
        "total_calls": 96,
        "primitive_calls": 96,
        "total_time": 0.000109833,
        "cumulative_time": 0.000109833,
        "time_percent": 0.02097604567783034,
        "time_per_call": 1.14409375e-06
      },
      {
        "rank": 50,
        "filename": "/home/cosmo/venv/lib/python3.12/site-packages/torch/_utils.py",
        "line_number": 770,
        "function_name": "_get_device_attr",
        "total_calls": 115,
        "primitive_calls": 115,
        "total_time": 0.00010974900000000001,
        "cumulative_time": 0.001032895,
        "time_percent": 0.19726359746526606,
        "time_per_call": 8.981695652173913e-06
      }
    ]
  }
]